[2024-04-02 04:14:36,834] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-04-02 04:14:40,594] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-04-02 04:14:40,594] [INFO] [runner.py:568:main] cmd = /home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgMywgNCwgNSwgNiwgN119 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None llava/train_parallel_deepspeed.py --skip_shard=1 --num_stages=8
[2024-04-02 04:14:43,521] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-04-02 04:14:44,959] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]}
[2024-04-02 04:14:44,960] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=8, node_rank=0
[2024-04-02 04:14:44,960] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]})
[2024-04-02 04:14:44,960] [INFO] [launch.py:163:main] dist_world_size=8
[2024-04-02 04:14:44,960] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
[2024-04-02 04:14:44,969] [INFO] [launch.py:253:main] process 1444020 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed.py', '--local_rank=0', '--skip_shard=1', '--num_stages=8']
[2024-04-02 04:14:44,977] [INFO] [launch.py:253:main] process 1444021 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed.py', '--local_rank=1', '--skip_shard=1', '--num_stages=8']
[2024-04-02 04:14:44,991] [INFO] [launch.py:253:main] process 1444022 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed.py', '--local_rank=2', '--skip_shard=1', '--num_stages=8']
[2024-04-02 04:14:45,004] [INFO] [launch.py:253:main] process 1444023 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed.py', '--local_rank=3', '--skip_shard=1', '--num_stages=8']
[2024-04-02 04:14:45,015] [INFO] [launch.py:253:main] process 1444024 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed.py', '--local_rank=4', '--skip_shard=1', '--num_stages=8']
[2024-04-02 04:14:45,026] [INFO] [launch.py:253:main] process 1444025 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed.py', '--local_rank=5', '--skip_shard=1', '--num_stages=8']
[2024-04-02 04:14:45,038] [INFO] [launch.py:253:main] process 1444026 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed.py', '--local_rank=6', '--skip_shard=1', '--num_stages=8']
[2024-04-02 04:14:45,047] [INFO] [launch.py:253:main] process 1444028 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed.py', '--local_rank=7', '--skip_shard=1', '--num_stages=8']
[2024-04-02 04:14:50,953] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-04-02 04:14:50,992] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-04-02 04:14:51,999] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-04-02 04:14:51,999] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-04-02 04:14:51,999] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:35,  1.89s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:04<00:38,  2.12s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:06<00:38,  2.25s/it][2024-04-02 04:15:05,231] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-04-02 04:15:05,235] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-04-02 04:15:05,583] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-04-02 04:15:05,609] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Loading checkpoint shards:  20%|██        | 4/20 [00:09<00:37,  2.36s/it][2024-04-02 04:15:07,931] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-04-02 04:15:07,988] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-04-02 04:15:08,164] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-04-02 04:15:08,185] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-04-02 04:15:08,328] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-04-02 04:15:10,536] [INFO] [comm.py:637:init_distributed] cdb=None
Loading checkpoint shards:  25%|██▌       | 5/20 [00:12<00:39,  2.65s/it]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:25,  1.35s/it]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:35,  1.84s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:34,  1.83s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:15<00:39,  2.84s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:25,  1.36s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:31,  1.75s/it][2024-04-02 04:15:14,602] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:33,  1.85s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:31,  1.77s/it]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:34,  1.91s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:34,  2.05s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:30,  1.77s/it][2024-04-02 04:15:16,953] [INFO] [comm.py:637:init_distributed] cdb=None
Loading checkpoint shards:  35%|███▌      | 7/20 [00:18<00:38,  2.95s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:33,  1.98s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:25,  1.50s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:28,  1.47s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:34,  1.89s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:08<00:36,  2.27s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:08<00:39,  2.46s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:08<00:36,  2.31s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:32,  2.00s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:22<00:40,  3.38s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:31,  1.83s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:10<00:31,  2.11s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:30,  2.00s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:10<00:32,  2.14s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:30,  2.01s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:27,  1.97s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:29,  2.08s/it]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:29,  2.14s/it]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 4/20 [00:08<00:35,  2.20s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:28,  2.03s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:14<00:26,  2.01s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:13<00:25,  1.96s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:14<00:25,  2.00s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:27<00:40,  3.66s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:26,  1.42s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:02<00:42,  2.25s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:10<00:33,  2.22s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:14<00:29,  2.26s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:16<00:25,  2.14s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:16<00:25,  2.16s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:16<00:26,  2.17s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:37,  2.09s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:04<00:43,  2.41s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:32,  2.31s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:31<00:37,  3.78s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:17<00:29,  2.43s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:34,  2.03s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:19<00:24,  2.25s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:18<00:23,  2.17s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:06<00:38,  2.24s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:19<00:26,  2.41s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:15<00:30,  2.32s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:19<00:26,  2.42s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:08<00:36,  2.27s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:21<00:23,  2.30s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:09<00:36,  2.31s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:21<00:23,  2.37s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:21<00:23,  2.33s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:17<00:29,  2.45s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:35<00:36,  4.03s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:10<00:30,  2.05s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:22<00:24,  2.46s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:23<00:19,  2.15s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:23<00:20,  2.26s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:11<00:33,  2.26s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:24<00:21,  2.37s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:20<00:27,  2.48s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:28,  2.07s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:13<00:30,  2.18s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:24<00:22,  2.54s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:22<00:24,  2.43s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:27<00:22,  2.79s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:14<00:28,  2.20s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:15<00:27,  2.15s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:28<00:23,  2.95s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:28<00:25,  3.14s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:42<00:37,  4.68s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:27<00:21,  2.67s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:17<00:26,  2.24s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:25<00:22,  2.47s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:17<00:26,  2.21s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:30<00:21,  3.04s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:26<00:17,  2.15s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:19<00:21,  1.95s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:31<00:20,  3.00s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:18<00:22,  2.08s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:32<00:22,  3.26s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:45<00:30,  4.31s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:31<00:20,  2.94s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:21<00:19,  1.97s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:21<00:21,  2.14s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:30<00:17,  2.47s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:35<00:19,  3.20s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:35<00:20,  3.37s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:35<00:19,  3.22s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:48<00:23,  3.90s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:22<00:17,  1.94s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:34<00:17,  2.94s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:23<00:18,  2.02s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:32<00:14,  2.35s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:25<00:18,  2.35s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:26<00:19,  2.38s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:40<00:18,  3.65s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:27<00:14,  2.06s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:27<00:14,  2.07s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:40<00:19,  3.96s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:40<00:19,  3.91s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:53<00:21,  4.39s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:36<00:15,  3.06s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:40<00:19,  3.98s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:30<00:13,  2.19s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:30<00:13,  2.32s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:43<00:14,  3.53s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:44<00:15,  3.76s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:57<00:16,  4.04s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:42<00:13,  3.48s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:44<00:15,  3.86s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:39<00:12,  3.00s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:32<00:11,  2.20s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:33<00:12,  2.52s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:34<00:08,  2.19s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:42<00:08,  2.96s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:34<00:08,  2.15s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:48<00:11,  3.84s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [01:01<00:12,  4.02s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:46<00:10,  3.62s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:48<00:11,  3.92s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:48<00:11,  3.98s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:37<00:07,  2.34s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:37<00:07,  2.41s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:46<00:06,  3.23s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:51<00:07,  3.67s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:51<00:07,  3.65s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:51<00:07,  3.64s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:38<00:04,  2.01s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [01:04<00:07,  3.82s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:50<00:07,  3.62s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:39<00:04,  2.28s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:53<00:03,  3.47s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:53<00:00,  2.54s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:53<00:00,  2.70s/it]
Loading checkpoint shards:  95%|█████████▌| 19/20 [00:55<00:03,  3.89s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:55<00:03,  3.88s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:56<00:03,  3.88s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:43<00:02,  2.80s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:56<00:00,  2.81s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:56<00:00,  2.82s/it]
Loading checkpoint shards:  95%|█████████▌| 19/20 [00:51<00:03,  3.79s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:55<00:00,  2.83s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:55<00:00,  2.80s/it]
Loading checkpoint shards:  95%|█████████▌| 19/20 [00:43<00:02,  2.86s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [01:09<00:04,  4.10s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:56<00:00,  2.90s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:56<00:00,  2.82s/it]
Loading checkpoint shards: 100%|██████████| 20/20 [00:51<00:00,  2.76s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:51<00:00,  2.59s/it]
Loading checkpoint shards: 100%|██████████| 20/20 [00:43<00:00,  2.10s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:43<00:00,  2.19s/it]
Loading checkpoint shards: 100%|██████████| 20/20 [00:44<00:00,  2.12s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:44<00:00,  2.21s/it]
SEED_LAYERS=False BASE_SEED=1234 SEED_FN=None
Using topology: {ProcessCoord(pipe=0, data=0): 0, ProcessCoord(pipe=1, data=0): 1, ProcessCoord(pipe=2, data=0): 2, ProcessCoord(pipe=3, data=0): 3, ProcessCoord(pipe=4, data=0): 4, ProcessCoord(pipe=5, data=0): 5, ProcessCoord(pipe=6, data=0): 6, ProcessCoord(pipe=7, data=0): 7}
[2024-04-02 04:16:08,002] [INFO] [module.py:375:_partition_layers] Partitioning pipeline stages with method type:LanguageModelLayerWrapper
stage=0 layers=2
     0: LlavaMultiModalModuleWrapper
Loading checkpoint shards: 100%|██████████| 20/20 [01:09<00:00,  2.97s/it]     1: LanguageModelLayerWrapper
stage=1 layers=1
Loading checkpoint shards: 100%|██████████| 20/20 [01:09<00:00,  3.48s/it]
     2: LanguageModelLayerWrapper
stage=2 layers=1
     3: LanguageModelLayerWrapper
stage=3 layers=1
     4: LanguageModelLayerWrapper
stage=4 layers=1
     5: LanguageModelLayerWrapper
stage=5 layers=1
     6: LanguageModelLayerWrapper
stage=6 layers=1
     7: LanguageModelLayerWrapper
stage=7 layers=2
     8: LanguageModelLayerWrapper
     9: LanguageModelFinalWrapper
  loss: loss_fn
Rank 7 initialized with CUDA_MEM (60648325120, 84974239744)
Rank 3 initialized with CUDA_MEM (61174710272, 84974239744)
Rank 2 initialized with CUDA_MEM (61174710272, 84974239744)
Rank 1 initialized with CUDA_MEM (61174710272, 84974239744)
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Rank 5 initialized with CUDA_MEM (61174710272, 84974239744)
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Rank 6 initialized with CUDA_MEM (61174710272, 84974239744)
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Rank 4 initialized with CUDA_MEM (61174710272, 84974239744)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 2.308627128601074 seconds
[2024-04-02 04:16:15,195] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 1.4070265293121338 seconds
Loading extension module fused_adam...
[2024-04-02 04:16:15,223] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Time to load fused_adam op: 1.7076098918914795 seconds
[2024-04-02 04:16:15,228] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 1.0066401958465576 seconds
[2024-04-02 04:16:15,242] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 1.9068043231964111 seconds
[2024-04-02 04:16:15,251] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 2.2070016860961914 seconds
[2024-04-02 04:16:15,262] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Rank 0 initialized with CUDA_MEM (59335507968, 84974239744)
[2024-04-02 04:16:15,369] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-04-02 04:16:15,628] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Loading extension module fused_adam...
Time to load fused_adam op: 0.927154541015625 seconds
Time to load fused_adam op: 0.5063591003417969 seconds
[2024-04-02 04:16:16,696] [INFO] [logging.py:96:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adam as basic optimizer
[2024-04-02 04:16:16,697] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-04-02 04:16:16,698] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
[2024-04-02 04:16:16,701] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-04-02 04:16:16,701] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2024-04-02 04:16:16,701] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = WarmupCosineLR
[2024-04-02 04:16:16,702] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupCosineLR object at 0x147a3aa6afd0>
[2024-04-02 04:16:16,702] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.001], mom=[(0.9, 0.999)]
[2024-04-02 04:16:16,703] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-04-02 04:16:16,703] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-04-02 04:16:16,704] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-04-02 04:16:16,704] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-04-02 04:16:16,704] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-04-02 04:16:16,704] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-04-02 04:16:16,704] [INFO] [config.py:1000:print]   bfloat16_enabled ............. False
[2024-04-02 04:16:16,704] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-04-02 04:16:16,704] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-04-02 04:16:16,704] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x147a3aa6abe0>
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-04-02 04:16:16,705] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 128
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 65536
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   loss_scale ................... 0
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=True, output_path='/home/atuin/b207dd/b207dd11/checkpoint', job_name='deepspeed_monitor_logs') enabled=True
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   optimizer_name ............... adam
[2024-04-02 04:16:16,706] [INFO] [config.py:1000:print]   optimizer_params ............. {'lr': 0.001}
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True, 'use_reentrant': False}
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   scheduler_name ............... WarmupCosineLR
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   scheduler_params ............. {'total_num_steps': 2181, 'warmup_min_ratio': 0.1, 'warmup_num_steps': 65.42999999999999}
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   steps_per_print .............. 1
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   train_batch_size ............. 128
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  1
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  False
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   zero_enabled ................. False
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-04-02 04:16:16,707] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 0
[2024-04-02 04:16:16,707] [INFO] [config.py:986:print_user_config]   json = {
    "train_batch_size": 128, 
    "train_micro_batch_size_per_gpu": 1, 
    "gradient_accumulation_steps": 128, 
    "steps_per_print": 1, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.001
        }
    }, 
    "scheduler": {
        "type": "WarmupCosineLR", 
        "params": {
            "total_num_steps": 2.181000e+03, 
            "warmup_min_ratio": 0.1, 
            "warmup_num_steps": 65.42999999999999
        }
    }, 
    "pipeline": {
        "use_reentrant": false
    }, 
    "csv_monitor": {
        "enabled": true, 
        "output_path": "/home/atuin/b207dd/b207dd11/checkpoint", 
        "job_name": "deepspeed_monitor_logs"
    }
}
[2024-04-02 04:16:16,707] [INFO] [engine.py:101:__init__] CONFIG: micro_batches=128 micro_batch_size=1
[2024-04-02 04:16:16,707] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
[2024-04-02 04:16:22,485] [INFO] [engine.py:160:__init__] RANK=3 STAGE=3 LAYERS=1 [4, 5) STAGE_PARAMS=0 (0.000M) TOTAL_PARAMS=20979712 (20.980M) UNIQUE_PARAMS=20979712 (20.980M)
[2024-04-02 04:16:22,485] [INFO] [engine.py:160:__init__] RANK=2 STAGE=2 LAYERS=1 [3, 4) STAGE_PARAMS=0 (0.000M) TOTAL_PARAMS=20979712 (20.980M) UNIQUE_PARAMS=20979712 (20.980M)
[2024-04-02 04:16:22,485] [INFO] [engine.py:160:__init__] RANK=6 STAGE=6 LAYERS=1 [7, 8) STAGE_PARAMS=0 (0.000M) TOTAL_PARAMS=20979712 (20.980M) UNIQUE_PARAMS=20979712 (20.980M)
[2024-04-02 04:16:22,485] [INFO] [engine.py:160:__init__] RANK=7 STAGE=7 LAYERS=2 [8, 10) STAGE_PARAMS=0 (0.000M) TOTAL_PARAMS=20979712 (20.980M) UNIQUE_PARAMS=20979712 (20.980M)
[2024-04-02 04:16:22,485] [INFO] [engine.py:160:__init__] RANK=1 STAGE=1 LAYERS=1 [2, 3) STAGE_PARAMS=0 (0.000M) TOTAL_PARAMS=20979712 (20.980M) UNIQUE_PARAMS=20979712 (20.980M)
[2024-04-02 04:16:22,485] [INFO] [engine.py:160:__init__] RANK=5 STAGE=5 LAYERS=1 [6, 7) STAGE_PARAMS=0 (0.000M) TOTAL_PARAMS=20979712 (20.980M) UNIQUE_PARAMS=20979712 (20.980M)
[2024-04-02 04:16:22,485] [INFO] [engine.py:160:__init__] RANK=4 STAGE=4 LAYERS=1 [5, 6) STAGE_PARAMS=0 (0.000M) TOTAL_PARAMS=20979712 (20.980M) UNIQUE_PARAMS=20979712 (20.980M)
[2024-04-02 04:16:22,486] [INFO] [engine.py:160:__init__] RANK=0 STAGE=0 LAYERS=2 [0, 2) STAGE_PARAMS=20979712 (20.980M) TOTAL_PARAMS=20979712 (20.980M) UNIQUE_PARAMS=20979712 (20.980M)
Deepspeed engine initialized at --- RANK 0 --- hosting 4 of 4 trainable parameters
Loading latest model checkpoint at shard 1
[2024-04-02 04:16:25,503] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt...
Deepspeed engine initialized at --- RANK 7 --- hosting 0 of 4 trainable parameters
[2024-04-02 04:16:25,806] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt...
Deepspeed engine initialized at --- RANK 2 --- hosting 0 of 4 trainable parameters
Deepspeed engine initialized at --- RANK 1 --- hosting 0 of 4 trainable parameters
[2024-04-02 04:16:27,678] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt...
[2024-04-02 04:16:27,679] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt...
Deepspeed engine initialized at --- RANK 3 --- hosting 0 of 4 trainable parameters
Deepspeed engine initialized at --- RANK 4 --- hosting 0 of 4 trainable parameters
[2024-04-02 04:16:27,837] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt...
[2024-04-02 04:16:27,838] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt...
Deepspeed engine initialized at --- RANK 5 --- hosting 0 of 4 trainable parameters
Deepspeed engine initialized at --- RANK 6 --- hosting 0 of 4 trainable parameters
[2024-04-02 04:16:27,884] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt...
[2024-04-02 04:16:27,884] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt...
[2024-04-02 04:16:28,664] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt.
[2024-04-02 04:16:28,664] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt.
[2024-04-02 04:16:28,664] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt.
[2024-04-02 04:16:28,664] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt.
[2024-04-02 04:16:28,664] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_03_model_states.pt...
[2024-04-02 04:16:28,664] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt.
[2024-04-02 04:16:28,664] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt.
[2024-04-02 04:16:28,664] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_06_model_states.pt...
[2024-04-02 04:16:28,664] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt.
[2024-04-02 04:16:28,665] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_07_model_states.pt...
[2024-04-02 04:16:28,665] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt...
[2024-04-02 04:16:28,665] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_05_model_states.pt...
[2024-04-02 04:16:28,665] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_02_model_states.pt...
[2024-04-02 04:16:28,665] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_01_model_states.pt...
[2024-04-02 04:16:28,665] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt.
[2024-04-02 04:16:28,665] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_04_model_states.pt...
[2024-04-02 04:16:28,672] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_07_model_states.pt.
[2024-04-02 04:16:28,673] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_08-model_states.pt...
[2024-04-02 04:16:28,674] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_04_model_states.pt.
[2024-04-02 04:16:28,674] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_05-model_states.pt...
[2024-04-02 04:16:28,676] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_06_model_states.pt.
[2024-04-02 04:16:28,676] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_03_model_states.pt.
[2024-04-02 04:16:28,676] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_01_model_states.pt.
[2024-04-02 04:16:28,676] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_04-model_states.pt...
[2024-04-02 04:16:28,676] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_07-model_states.pt...
[2024-04-02 04:16:28,676] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_02-model_states.pt...
[2024-04-02 04:16:28,677] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_05_model_states.pt.
[2024-04-02 04:16:28,677] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_06-model_states.pt...
[2024-04-02 04:16:28,682] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_02_model_states.pt.
[2024-04-02 04:16:28,682] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_03-model_states.pt...
[2024-04-02 04:16:28,694] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/mp_rank_00_model_states.pt.
[2024-04-02 04:16:28,694] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_00-model_states.pt...
[2024-04-02 04:16:29,644] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_00-model_states.pt.
[2024-04-02 04:16:29,645] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_00-model_states.pt...
[2024-04-02 04:16:29,870] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_00-model_states.pt.
[2024-04-02 04:16:30,070] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_01-model_states.pt...
[2024-04-02 04:22:39,931] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_05-model_states.pt.
[2024-04-02 04:22:40,185] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_05-model_states.pt...
[2024-04-02 04:22:42,997] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_01-model_states.pt.
[2024-04-02 04:22:43,253] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_01-model_states.pt...
[2024-04-02 04:22:46,308] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_05-model_states.pt.
  0%|          | 0/437 [00:00<?, ?it/s][2024-04-02 04:22:48,421] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_01-model_states.pt.
  0%|          | 0/437 [00:00<?, ?it/s]Shard 0 / 1 skipped
Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_1

  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A[2024-04-02 04:22:59,830] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_03-model_states.pt.
[2024-04-02 04:22:59,902] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_03-model_states.pt...
[2024-04-02 04:23:03,588] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_03-model_states.pt.
[2024-04-02 04:23:05,113] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_04-model_states.pt.
  0%|          | 0/437 [00:00<?, ?it/s][2024-04-02 04:23:05,408] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_04-model_states.pt...

  0%|          | 0/5 [00:00<?, ?it/s][A[2024-04-02 04:23:09,285] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_02-model_states.pt.
[2024-04-02 04:23:09,392] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_02-model_states.pt...
[2024-04-02 04:23:13,604] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_04-model_states.pt.
[2024-04-02 04:23:14,220] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_02-model_states.pt.
[2024-04-02 04:23:14,831] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_07-model_states.pt.
[2024-04-02 04:23:14,967] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_07-model_states.pt...
  0%|          | 0/437 [00:00<?, ?it/s]  0%|          | 0/437 [00:00<?, ?it/s]
  0%|          | 0/5 [00:00<?, ?it/s][A[2024-04-02 04:23:19,136] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_07-model_states.pt.

  0%|          | 0/5 [00:00<?, ?it/s][A  0%|          | 0/437 [00:00<?, ?it/s][2024-04-02 04:23:21,171] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_08-model_states.pt.
[2024-04-02 04:23:21,267] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_08-model_states.pt...
[2024-04-02 04:23:23,508] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_06-model_states.pt.
[2024-04-02 04:23:23,603] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_06-model_states.pt...

  0%|          | 0/5 [00:00<?, ?it/s][A[2024-04-02 04:23:25,084] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_08-model_states.pt.
[2024-04-02 04:23:26,809] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_09-model_states.pt...
[2024-04-02 04:23:27,466] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_06-model_states.pt.
  0%|          | 0/437 [00:00<?, ?it/s]
  0%|          | 0/5 [00:00<?, ?it/s][A[2024-04-02 04:23:34,554] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_09-model_states.pt.
[2024-04-02 04:23:34,556] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_09-model_states.pt...
[2024-04-02 04:23:34,645] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/checkpoint/global_step2180/layer_09-model_states.pt.
  0%|          | 0/437 [00:00<?, ?it/s]
  0%|          | 0/5 [00:00<?, ?it/s][A[2024-04-02 04:25:04,251] [INFO] [logging.py:96:log_dist] [Rank 0] step=2181, skipped=0, lr=[1.0000000000000001e-07], mom=[(0.9, 0.999)]
steps: 2181 loss: 2.4679 iter time (s): 135.568 samples/sec: 0.944

 20%|██        | 1/5 [01:31<06:04, 91.18s/it][A
 20%|██        | 1/5 [01:45<07:01, 105.43s/it][A
 20%|██        | 1/5 [01:37<06:29, 97.46s/it][A
 20%|██        | 1/5 [02:17<09:11, 137.85s/it][A
 20%|██        | 1/5 [01:50<07:21, 110.44s/it][A
 20%|██        | 1/5 [02:01<08:04, 121.10s/it][A
 20%|██        | 1/5 [01:51<07:24, 111.11s/it][A
 20%|██        | 1/5 [02:16<09:05, 136.25s/it][A
 40%|████      | 2/5 [02:55<04:20, 86.89s/it][A[2024-04-02 04:26:34,998] [INFO] [logging.py:96:log_dist] [Rank 0] step=2182, skipped=0, lr=[1.0055124091249083e-07], mom=[(0.9, 0.999)]
steps: 2182 loss: 2.4709 iter time (s): 85.187 samples/sec: 1.503

 40%|████      | 2/5 [03:11<04:41, 93.93s/it] [A
 40%|████      | 2/5 [03:03<04:31, 90.62s/it][A
 40%|████      | 2/5 [03:43<05:21, 107.30s/it][A
 40%|████      | 2/5 [03:16<04:47, 95.96s/it] [A
 40%|████      | 2/5 [03:26<05:01, 100.37s/it][A
 40%|████      | 2/5 [03:16<04:48, 96.26s/it] [A
 40%|████      | 2/5 [03:42<05:19, 106.62s/it][A
 60%|██████    | 3/5 [04:20<02:52, 86.15s/it][A[2024-04-02 04:28:00,273] [INFO] [logging.py:96:log_dist] [Rank 0] step=2183, skipped=0, lr=[1.0220496243433514e-07], mom=[(0.9, 0.999)]
steps: 2183 loss: 2.4885 iter time (s): 84.567 samples/sec: 1.514

 60%|██████    | 3/5 [04:36<02:59, 89.97s/it][A
 60%|██████    | 3/5 [04:28<02:56, 88.17s/it][A
 60%|██████    | 3/5 [05:08<03:14, 97.21s/it] [A
 60%|██████    | 3/5 [04:41<03:02, 91.08s/it][A
 60%|██████    | 3/5 [04:52<03:06, 93.45s/it] [A
 60%|██████    | 3/5 [04:42<03:02, 91.22s/it][A
 60%|██████    | 3/5 [05:07<03:13, 96.84s/it] [A
 80%|████████  | 4/5 [05:45<01:25, 85.67s/it][A[2024-04-02 04:29:25,214] [INFO] [logging.py:96:log_dist] [Rank 0] step=2184, skipped=0, lr=[1.049611609187595e-07], mom=[(0.9, 0.999)]
steps: 2184 loss: 2.4035 iter time (s): 84.290 samples/sec: 1.519

 80%|████████  | 4/5 [06:01<01:27, 87.99s/it][A
 80%|████████  | 4/5 [05:53<01:26, 86.88s/it][A
 80%|████████  | 4/5 [06:33<01:32, 92.37s/it][A
 80%|████████  | 4/5 [06:06<01:28, 88.67s/it][A
 80%|████████  | 4/5 [06:17<01:30, 90.09s/it][A
 80%|████████  | 4/5 [06:32<01:32, 92.15s/it][A
 80%|████████  | 4/5 [06:07<01:28, 88.75s/it][A
100%|██████████| 5/5 [07:10<00:00, 85.55s/it][A100%|██████████| 5/5 [07:10<00:00, 86.12s/it]
  0%|          | 2/437 [07:14<26:13:25, 217.02s/it][2024-04-02 04:30:50,562] [INFO] [logging.py:96:log_dist] [Rank 0] step=2185, skipped=0, lr=[1.0881983028790071e-07], mom=[(0.9, 0.999)]
steps: 2185 loss: 2.5787 iter time (s): 84.691 samples/sec: 1.511

100%|██████████| 5/5 [07:26<00:00, 87.01s/it][A100%|██████████| 5/5 [07:26<00:00, 89.36s/it]
  0%|          | 2/437 [07:30<27:11:30, 225.04s/it]
100%|██████████| 5/5 [07:18<00:00, 86.32s/it][A100%|██████████| 5/5 [07:18<00:00, 87.75s/it]
  0%|          | 2/437 [07:21<26:41:03, 220.84s/it]
100%|██████████| 5/5 [07:59<00:00, 89.82s/it][A100%|██████████| 5/5 [07:59<00:00, 95.84s/it]
  0%|          | 2/437 [08:02<29:09:56, 241.37s/it]
100%|██████████| 5/5 [07:31<00:00, 87.46s/it][A100%|██████████| 5/5 [07:31<00:00, 90.36s/it]
  0%|          | 2/437 [07:35<27:30:01, 227.59s/it]
100%|██████████| 5/5 [07:42<00:00, 88.39s/it][A100%|██████████| 5/5 [07:42<00:00, 92.50s/it]
  0%|          | 2/437 [07:45<28:08:38, 232.92s/it]
100%|██████████| 5/5 [07:57<00:00, 89.69s/it][A100%|██████████| 5/5 [07:57<00:00, 95.52s/it]
  0%|          | 2/437 [08:00<29:02:05, 240.29s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_2

100%|██████████| 5/5 [07:32<00:00, 87.52s/it][A100%|██████████| 5/5 [07:32<00:00, 90.50s/it]
  0%|          | 2/437 [07:35<27:31:00, 227.73s/it]
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:24<05:39, 84.93s/it][A[2024-04-02 04:32:18,703] [INFO] [logging.py:96:log_dist] [Rank 0] step=2186, skipped=0, lr=[1.1378096203269476e-07], mom=[(0.9, 0.999)]
steps: 2186 loss: 2.4603 iter time (s): 84.165 samples/sec: 1.521

 20%|██        | 1/5 [01:25<05:41, 85.29s/it][A
 20%|██        | 1/5 [01:25<05:41, 85.41s/it][A
 20%|██        | 1/5 [01:25<05:40, 85.23s/it][A
 20%|██        | 1/5 [01:25<05:41, 85.29s/it][A
 20%|██        | 1/5 [01:25<05:41, 85.39s/it][A
 20%|██        | 1/5 [01:25<05:41, 85.38s/it][A
 20%|██        | 1/5 [01:25<05:42, 85.70s/it][A
 40%|████      | 2/5 [02:50<04:16, 85.52s/it][A[2024-04-02 04:33:44,630] [INFO] [logging.py:96:log_dist] [Rank 0] step=2187, skipped=0, lr=[1.1984454521282136e-07], mom=[(0.9, 0.999)]
steps: 2187 loss: 2.4970 iter time (s): 84.507 samples/sec: 1.515

 40%|████      | 2/5 [02:50<04:16, 85.52s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.53s/it][A
 40%|████      | 2/5 [02:50<04:16, 85.48s/it][A
 40%|████      | 2/5 [02:50<04:16, 85.53s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.52s/it][A
 40%|████      | 2/5 [02:50<04:16, 85.40s/it][A
 40%|████      | 2/5 [02:50<04:16, 85.42s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.60s/it][A[2024-04-02 04:35:10,304] [INFO] [logging.py:96:log_dist] [Rank 0] step=2188, skipped=0, lr=[1.2701056645703691e-07], mom=[(0.9, 0.999)]
steps: 2188 loss: 2.5118 iter time (s): 84.973 samples/sec: 1.506

 60%|██████    | 3/5 [04:16<02:51, 85.59s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.58s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.54s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.63s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.62s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.54s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.53s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.88s/it][A[2024-04-02 04:36:36,623] [INFO] [logging.py:96:log_dist] [Rank 0] step=2189, skipped=0, lr=[1.3527900996295262e-07], mom=[(0.9, 0.999)]
steps: 2189 loss: 2.4392 iter time (s): 85.607 samples/sec: 1.495

 80%|████████  | 4/5 [05:42<01:25, 85.89s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.87s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.85s/it][A
 80%|████████  | 4/5 [05:43<01:25, 85.88s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.83s/it][A
 80%|████████  | 4/5 [05:43<01:25, 85.88s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.84s/it][A
100%|██████████| 5/5 [07:08<00:00, 85.63s/it][A100%|██████████| 5/5 [07:08<00:00, 85.61s/it]
  1%|          | 3/437 [14:25<36:55:26, 306.28s/it][2024-04-02 04:38:01,812] [INFO] [logging.py:96:log_dist] [Rank 0] step=2190, skipped=0, lr=[1.4464985749708983e-07], mom=[(0.9, 0.999)]
steps: 2190 loss: 2.5063 iter time (s): 84.531 samples/sec: 1.514

100%|██████████| 5/5 [07:08<00:00, 85.61s/it][A100%|██████████| 5/5 [07:08<00:00, 85.62s/it]
  1%|          | 3/437 [14:41<37:29:19, 310.97s/it]
100%|██████████| 5/5 [07:08<00:00, 85.62s/it][A100%|██████████| 5/5 [07:08<00:00, 85.63s/it]
  1%|          | 3/437 [14:32<37:11:44, 308.54s/it]
100%|██████████| 5/5 [07:08<00:00, 85.62s/it][A100%|██████████| 5/5 [07:08<00:00, 85.61s/it]
  1%|          | 3/437 [15:14<38:38:19, 320.51s/it]
100%|██████████| 5/5 [07:08<00:00, 85.61s/it][A100%|██████████| 5/5 [07:08<00:00, 85.63s/it]
  1%|          | 3/437 [14:46<37:40:01, 312.45s/it]
100%|██████████| 5/5 [07:08<00:00, 85.61s/it][A100%|██████████| 5/5 [07:08<00:00, 85.63s/it]
  1%|          | 3/437 [14:57<38:02:26, 315.55s/it]
100%|██████████| 5/5 [07:07<00:00, 85.59s/it][A100%|██████████| 5/5 [07:07<00:00, 85.59s/it]
  1%|          | 3/437 [14:46<37:40:33, 312.52s/it]
100%|██████████| 5/5 [07:08<00:00, 85.59s/it][A100%|██████████| 5/5 [07:08<00:00, 85.61s/it]
  1%|          | 3/437 [15:11<38:33:38, 319.86s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_3

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:25<05:43, 85.92s/it][A[2024-04-02 04:39:30,999] [INFO] [logging.py:96:log_dist] [Rank 0] step=2191, skipped=0, lr=[1.5512308839504664e-07], mom=[(0.9, 0.999)]
steps: 2191 loss: 2.4201 iter time (s): 85.352 samples/sec: 1.500

 20%|██        | 1/5 [01:24<05:38, 84.74s/it][A
 20%|██        | 1/5 [01:25<05:41, 85.45s/it][A
 20%|██        | 1/5 [01:26<05:44, 86.06s/it][A
 20%|██        | 1/5 [01:25<05:43, 85.89s/it][A
 20%|██        | 1/5 [01:25<05:43, 85.86s/it][A
 20%|██        | 1/5 [01:25<05:43, 85.91s/it][A
 20%|██        | 1/5 [01:26<05:44, 86.10s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.66s/it][A[2024-04-02 04:40:56,477] [INFO] [logging.py:96:log_dist] [Rank 0] step=2192, skipped=0, lr=[1.6669867956144242e-07], mom=[(0.9, 0.999)]
steps: 2192 loss: 2.4670 iter time (s): 84.836 samples/sec: 1.509

 40%|████      | 2/5 [02:50<04:15, 85.21s/it][A
 40%|████      | 2/5 [02:50<04:16, 85.48s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.73s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.66s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.65s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.67s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.76s/it][A
 60%|██████    | 3/5 [04:17<02:51, 85.71s/it][A[2024-04-02 04:42:21,802] [INFO] [logging.py:96:log_dist] [Rank 0] step=2193, skipped=0, lr=[1.7937660546986223e-07], mom=[(0.9, 0.999)]
steps: 2193 loss: 2.4736 iter time (s): 84.653 samples/sec: 1.512

 60%|██████    | 3/5 [04:15<02:50, 85.26s/it][A
 60%|██████    | 3/5 [04:16<02:50, 85.40s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.55s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.51s/it][A
 60%|██████    | 3/5 [04:16<02:50, 85.49s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.51s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.56s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.17s/it][A[2024-04-02 04:43:46,605] [INFO] [logging.py:96:log_dist] [Rank 0] step=2194, skipped=0, lr=[1.9315683816318988e-07], mom=[(0.9, 0.999)]
steps: 2194 loss: 2.5558 iter time (s): 84.125 samples/sec: 1.522

 80%|████████  | 4/5 [05:40<01:25, 85.06s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.19s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.25s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.22s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.24s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.26s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.24s/it][A
100%|██████████| 5/5 [07:06<00:00, 85.22s/it][A100%|██████████| 5/5 [07:06<00:00, 85.36s/it]
  1%|          | 4/437 [21:35<42:23:39, 352.47s/it][2024-04-02 04:45:11,889] [INFO] [logging.py:96:log_dist] [Rank 0] step=2195, skipped=0, lr=[2.0803934725355247e-07], mom=[(0.9, 0.999)]
steps: 2195 loss: 2.4987 iter time (s): 84.605 samples/sec: 1.513

100%|██████████| 5/5 [07:05<00:00, 85.17s/it][A100%|██████████| 5/5 [07:05<00:00, 85.14s/it]
  1%|          | 4/437 [21:51<42:45:07, 355.44s/it]
100%|██████████| 5/5 [07:06<00:00, 85.21s/it][A100%|██████████| 5/5 [07:06<00:00, 85.27s/it]
  1%|          | 4/437 [21:43<42:33:49, 353.88s/it]
100%|██████████| 5/5 [07:06<00:00, 85.25s/it][A100%|██████████| 5/5 [07:06<00:00, 85.38s/it]
  1%|          | 4/437 [22:24<43:27:55, 361.38s/it]
100%|██████████| 5/5 [07:06<00:00, 85.24s/it][A100%|██████████| 5/5 [07:06<00:00, 85.35s/it]
  1%|          | 4/437 [21:56<42:51:32, 356.33s/it]
100%|██████████| 5/5 [07:06<00:00, 85.23s/it][A100%|██████████| 5/5 [07:06<00:00, 85.35s/it]
  1%|          | 4/437 [22:07<43:05:35, 358.28s/it]
100%|██████████| 5/5 [07:06<00:00, 85.24s/it][A100%|██████████| 5/5 [07:06<00:00, 85.36s/it]
  1%|          | 4/437 [21:56<42:51:53, 356.38s/it]
100%|██████████| 5/5 [07:07<00:00, 85.26s/it][A100%|██████████| 5/5 [07:07<00:00, 85.40s/it]
  1%|          | 4/437 [22:21<43:25:05, 360.98s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_4

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:24<05:39, 85.00s/it][A[2024-04-02 04:46:40,075] [INFO] [logging.py:96:log_dist] [Rank 0] step=2196, skipped=0, lr=[2.240240999221538e-07], mom=[(0.9, 0.999)]
steps: 2196 loss: 2.4343 iter time (s): 84.235 samples/sec: 1.520

 20%|██        | 1/5 [01:23<05:35, 83.76s/it][A
 20%|██        | 1/5 [01:25<05:40, 85.08s/it][A
 20%|██        | 1/5 [01:25<05:40, 85.16s/it][A
 20%|██        | 1/5 [01:25<05:40, 85.05s/it][A
 20%|██        | 1/5 [01:24<05:39, 84.97s/it][A
 20%|██        | 1/5 [01:25<05:40, 85.11s/it][A
 20%|██        | 1/5 [01:25<05:40, 85.10s/it][A
 40%|████      | 2/5 [02:49<04:14, 84.85s/it][A[2024-04-02 04:48:04,812] [INFO] [logging.py:96:log_dist] [Rank 0] step=2197, skipped=0, lr=[2.41111060919774e-07], mom=[(0.9, 0.999)]
steps: 2197 loss: 2.4358 iter time (s): 84.033 samples/sec: 1.523

 40%|████      | 2/5 [02:48<04:12, 84.32s/it][A
 40%|████      | 2/5 [02:49<04:14, 84.85s/it][A
 40%|████      | 2/5 [02:49<04:14, 84.91s/it][A
 40%|████      | 2/5 [02:49<04:14, 84.83s/it][A
 40%|████      | 2/5 [02:49<04:14, 84.88s/it][A
 40%|████      | 2/5 [02:49<04:14, 84.84s/it][A
 40%|████      | 2/5 [02:49<04:14, 84.88s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.37s/it][A[2024-04-02 04:49:30,798] [INFO] [logging.py:96:log_dist] [Rank 0] step=2198, skipped=0, lr=[2.5930019256643646e-07], mom=[(0.9, 0.999)]
steps: 2198 loss: 2.5096 iter time (s): 85.294 samples/sec: 1.501

 60%|██████    | 3/5 [04:14<02:50, 85.10s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.36s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.39s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.35s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.35s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.39s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.38s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.41s/it][A[2024-04-02 04:50:56,273] [INFO] [logging.py:96:log_dist] [Rank 0] step=2199, skipped=0, lr=[2.7859145475185174e-07], mom=[(0.9, 0.999)]
steps: 2199 loss: 2.4966 iter time (s): 84.797 samples/sec: 1.509

 80%|████████  | 4/5 [05:39<01:25, 85.24s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.42s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.44s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.43s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.42s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.44s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.43s/it][A
100%|██████████| 5/5 [07:06<00:00, 85.24s/it][A100%|██████████| 5/5 [07:06<00:00, 85.23s/it]
  1%|          | 5/437 [28:44<45:30:14, 379.20s/it][2024-04-02 04:52:20,757] [INFO] [logging.py:96:log_dist] [Rank 0] step=2200, skipped=0, lr=[2.9898480493514037e-07], mom=[(0.9, 0.999)]
steps: 2200 loss: 2.5368 iter time (s): 83.784 samples/sec: 1.528

100%|██████████| 5/5 [07:04<00:00, 84.95s/it][A100%|██████████| 5/5 [07:04<00:00, 84.88s/it]
  1%|          | 5/437 [29:00<45:42:47, 380.94s/it]
100%|██████████| 5/5 [07:05<00:00, 85.08s/it][A100%|██████████| 5/5 [07:05<00:00, 85.14s/it]
  1%|          | 5/437 [28:51<45:35:39, 379.95s/it]
100%|██████████| 5/5 [07:05<00:00, 85.06s/it][A100%|██████████| 5/5 [07:05<00:00, 85.15s/it]
  1%|          | 5/437 [29:32<46:10:48, 384.83s/it]
100%|██████████| 5/5 [07:05<00:00, 85.05s/it][A100%|██████████| 5/5 [07:05<00:00, 85.13s/it]
  1%|          | 5/437 [29:05<45:47:08, 381.55s/it]
100%|██████████| 5/5 [07:05<00:00, 85.04s/it][A100%|██████████| 5/5 [07:05<00:00, 85.12s/it]
  1%|          | 5/437 [29:15<45:56:16, 382.82s/it]
100%|██████████| 5/5 [07:05<00:00, 85.06s/it][A100%|██████████| 5/5 [07:05<00:00, 85.14s/it]
  1%|          | 5/437 [29:05<45:47:21, 381.58s/it]
100%|██████████| 5/5 [07:05<00:00, 85.05s/it][A100%|██████████| 5/5 [07:05<00:00, 85.14s/it]
  1%|          | 5/437 [29:30<46:08:55, 384.57s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_5

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:24<05:39, 85.00s/it][A[2024-04-02 04:53:49,342] [INFO] [logging.py:96:log_dist] [Rank 0] step=2201, skipped=0, lr=[3.2048019814522104e-07], mom=[(0.9, 0.999)]
steps: 2201 loss: 2.5066 iter time (s): 84.733 samples/sec: 1.511

 20%|██        | 1/5 [01:25<05:41, 85.37s/it][A
 20%|██        | 1/5 [01:25<05:41, 85.46s/it][A
 20%|██        | 1/5 [01:25<05:42, 85.57s/it][A
 20%|██        | 1/5 [01:25<05:41, 85.43s/it][A
 20%|██        | 1/5 [01:25<05:41, 85.40s/it][A
 20%|██        | 1/5 [01:25<05:42, 85.51s/it][A
 20%|██        | 1/5 [01:25<05:42, 85.57s/it][A
 40%|████      | 2/5 [02:50<04:15, 85.30s/it][A[2024-04-02 04:55:14,859] [INFO] [logging.py:96:log_dist] [Rank 0] step=2202, skipped=0, lr=[3.4307758698086633e-07], mom=[(0.9, 0.999)]
steps: 2202 loss: 2.5687 iter time (s): 84.817 samples/sec: 1.509

 40%|████      | 2/5 [02:50<04:16, 85.47s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.53s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.57s/it][A
 40%|████      | 2/5 [02:50<04:16, 85.48s/it][A
 40%|████      | 2/5 [02:50<04:16, 85.49s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.58s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.59s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.16s/it][A[2024-04-02 04:56:39,831] [INFO] [logging.py:96:log_dist] [Rank 0] step=2203, skipped=0, lr=[3.667769216105916e-07], mom=[(0.9, 0.999)]
steps: 2203 loss: 2.5491 iter time (s): 84.196 samples/sec: 1.520

 60%|██████    | 3/5 [04:15<02:50, 85.20s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.21s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.24s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.24s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.23s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.24s/it][A
 60%|██████    | 3/5 [04:16<02:50, 85.26s/it][A
 80%|████████  | 4/5 [05:40<01:25, 85.23s/it][A[2024-04-02 04:58:05,164] [INFO] [logging.py:96:log_dist] [Rank 0] step=2204, skipped=0, lr=[3.9157814977304353e-07], mom=[(0.9, 0.999)]
steps: 2204 loss: 2.5197 iter time (s): 84.657 samples/sec: 1.512

 80%|████████  | 4/5 [05:41<01:25, 85.26s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.28s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.30s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.27s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.27s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.28s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.29s/it][A
100%|██████████| 5/5 [07:06<00:00, 85.39s/it][A100%|██████████| 5/5 [07:06<00:00, 85.30s/it]
  1%|▏         | 6/437 [35:54<47:24:06, 395.93s/it][2024-04-02 04:59:30,828] [INFO] [logging.py:96:log_dist] [Rank 0] step=2205, skipped=0, lr=[4.1748121677688916e-07], mom=[(0.9, 0.999)]
steps: 2205 loss: 2.4778 iter time (s): 84.984 samples/sec: 1.506

100%|██████████| 5/5 [07:06<00:00, 85.40s/it][A100%|██████████| 5/5 [07:06<00:00, 85.36s/it]
  1%|▏         | 6/437 [36:10<47:33:33, 397.25s/it]
100%|██████████| 5/5 [07:06<00:00, 85.40s/it][A100%|██████████| 5/5 [07:06<00:00, 85.37s/it]
  1%|▏         | 6/437 [36:01<47:28:43, 396.57s/it]
100%|██████████| 5/5 [07:06<00:00, 85.41s/it][A100%|██████████| 5/5 [07:06<00:00, 85.40s/it]
  1%|▏         | 6/437 [36:43<47:52:18, 399.86s/it]
100%|██████████| 5/5 [07:06<00:00, 85.38s/it][A100%|██████████| 5/5 [07:06<00:00, 85.36s/it]
  1%|▏         | 6/437 [36:15<47:36:25, 397.65s/it]
100%|██████████| 5/5 [07:06<00:00, 85.39s/it][A100%|██████████| 5/5 [07:06<00:00, 85.36s/it]
  1%|▏         | 6/437 [36:26<47:42:32, 398.50s/it]
100%|██████████| 5/5 [07:06<00:00, 85.40s/it][A100%|██████████| 5/5 [07:06<00:00, 85.39s/it]
  1%|▏         | 6/437 [36:40<47:50:58, 399.67s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_6

100%|██████████| 5/5 [07:06<00:00, 85.40s/it][A100%|██████████| 5/5 [07:06<00:00, 85.38s/it]
  1%|▏         | 6/437 [36:15<47:36:37, 397.67s/it]
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:25<05:41, 85.32s/it][A[2024-04-02 05:00:59,210] [INFO] [logging.py:96:log_dist] [Rank 0] step=2206, skipped=0, lr=[4.444860655012045e-07], mom=[(0.9, 0.999)]
steps: 2206 loss: 2.5780 iter time (s): 84.473 samples/sec: 1.515

 20%|██        | 1/5 [01:24<05:39, 84.88s/it][A
 20%|██        | 1/5 [01:24<05:39, 84.92s/it][A
 20%|██        | 1/5 [01:25<05:40, 85.21s/it][A
 20%|██        | 1/5 [01:24<05:39, 84.94s/it][A
 20%|██        | 1/5 [01:24<05:38, 84.53s/it][A
 20%|██        | 1/5 [01:25<05:40, 85.22s/it][A
 20%|██        | 1/5 [01:25<05:41, 85.34s/it][A
 40%|████      | 2/5 [02:50<04:15, 85.03s/it][A[2024-04-02 05:02:24,043] [INFO] [logging.py:96:log_dist] [Rank 0] step=2207, skipped=0, lr=[4.725926363951966e-07], mom=[(0.9, 0.999)]
steps: 2207 loss: 2.6139 iter time (s): 84.159 samples/sec: 1.521

 40%|████      | 2/5 [02:49<04:14, 84.85s/it][A
 40%|████      | 2/5 [02:49<04:14, 84.90s/it][A
 40%|████      | 2/5 [02:50<04:14, 84.98s/it][A
 40%|████      | 2/5 [02:49<04:14, 84.87s/it][A
 40%|████      | 2/5 [02:49<04:14, 84.70s/it][A
 40%|████      | 2/5 [02:50<04:14, 84.99s/it][A
 40%|████      | 2/5 [02:50<04:15, 85.04s/it][A
 60%|██████    | 3/5 [04:17<02:52, 86.01s/it][A[2024-04-02 05:03:51,209] [INFO] [logging.py:96:log_dist] [Rank 0] step=2208, skipped=0, lr=[5.018008674788149e-07], mom=[(0.9, 0.999)]
steps: 2208 loss: 2.4125 iter time (s): 86.494 samples/sec: 1.480

 60%|██████    | 3/5 [04:16<02:51, 85.93s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.92s/it][A
 60%|██████    | 3/5 [04:17<02:51, 85.97s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.90s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.84s/it][A
 60%|██████    | 3/5 [04:17<02:52, 86.01s/it][A
 60%|██████    | 3/5 [04:17<02:51, 86.00s/it][A
 80%|████████  | 4/5 [05:43<01:25, 85.97s/it][A[2024-04-02 05:05:17,123] [INFO] [logging.py:96:log_dist] [Rank 0] step=2209, skipped=0, lr=[5.321106943424727e-07], mom=[(0.9, 0.999)]
steps: 2209 loss: 2.5042 iter time (s): 85.238 samples/sec: 1.502

 80%|████████  | 4/5 [05:42<01:25, 85.93s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.92s/it][A
 80%|████████  | 4/5 [05:43<01:25, 85.97s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.89s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.85s/it][A
 80%|████████  | 4/5 [05:43<01:25, 85.96s/it][A
 80%|████████  | 4/5 [05:43<01:25, 85.95s/it][A
100%|██████████| 5/5 [07:08<00:00, 85.67s/it][A100%|██████████| 5/5 [07:08<00:00, 85.68s/it]
  2%|▏         | 7/437 [43:05<48:39:20, 407.35s/it][2024-04-02 05:06:42,272] [INFO] [logging.py:96:log_dist] [Rank 0] step=2210, skipped=0, lr=[5.635220501473808e-07], mom=[(0.9, 0.999)]
steps: 2210 loss: 2.4923 iter time (s): 84.499 samples/sec: 1.515

100%|██████████| 5/5 [07:07<00:00, 85.62s/it][A100%|██████████| 5/5 [07:07<00:00, 85.59s/it]
  2%|▏         | 7/437 [43:21<48:45:47, 408.25s/it]
100%|██████████| 5/5 [07:08<00:00, 85.66s/it][A100%|██████████| 5/5 [07:08<00:00, 85.61s/it]
  2%|▏         | 7/437 [43:13<48:42:40, 407.81s/it]
100%|██████████| 5/5 [07:08<00:00, 85.66s/it][A100%|██████████| 5/5 [07:08<00:00, 85.65s/it]
  2%|▏         | 7/437 [43:54<48:58:25, 410.01s/it]
100%|██████████| 5/5 [07:07<00:00, 85.62s/it][A100%|██████████| 5/5 [07:07<00:00, 85.58s/it]
  2%|▏         | 7/437 [43:26<48:47:44, 408.52s/it]
100%|██████████| 5/5 [07:07<00:00, 85.59s/it][A100%|██████████| 5/5 [07:07<00:00, 85.51s/it]
  2%|▏         | 7/437 [43:37<48:51:52, 409.10s/it]
100%|██████████| 5/5 [07:08<00:00, 85.65s/it][A100%|██████████| 5/5 [07:08<00:00, 85.67s/it]
  2%|▏         | 7/437 [43:52<48:57:33, 409.89s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_7

100%|██████████| 5/5 [07:08<00:00, 85.65s/it][A100%|██████████| 5/5 [07:08<00:00, 85.65s/it]
  2%|▏         | 7/437 [43:27<48:47:51, 408.54s/it]
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:25<05:42, 85.55s/it][A[2024-04-02 05:08:10,916] [INFO] [logging.py:96:log_dist] [Rank 0] step=2211, skipped=0, lr=[5.960348656258257e-07], mom=[(0.9, 0.999)]
steps: 2211 loss: 2.4711 iter time (s): 84.774 samples/sec: 1.510

 20%|██        | 1/5 [01:25<05:41, 85.47s/it][A
 20%|██        | 1/5 [01:25<05:41, 85.32s/it][A
 20%|██        | 1/5 [01:25<05:42, 85.56s/it][A
 20%|██        | 1/5 [01:25<05:41, 85.43s/it][A
 20%|██        | 1/5 [01:25<05:41, 85.42s/it][A
 20%|██        | 1/5 [01:25<05:41, 85.44s/it][A
 20%|██        | 1/5 [01:25<05:42, 85.58s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.94s/it][A[2024-04-02 05:09:37,152] [INFO] [logging.py:96:log_dist] [Rank 0] step=2212, skipped=0, lr=[6.296490690809455e-07], mom=[(0.9, 0.999)]
steps: 2212 loss: 2.4795 iter time (s): 85.570 samples/sec: 1.496

 40%|████      | 2/5 [02:51<04:17, 85.93s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.82s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.95s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.88s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.89s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.90s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.95s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.61s/it][A[2024-04-02 05:11:02,372] [INFO] [logging.py:96:log_dist] [Rank 0] step=2213, skipped=0, lr=[6.643645863872873e-07], mom=[(0.9, 0.999)]
steps: 2213 loss: 2.4348 iter time (s): 84.617 samples/sec: 1.513

 60%|██████    | 3/5 [04:16<02:51, 85.62s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.60s/it][A
 60%|██████    | 3/5 [04:17<02:51, 85.63s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.60s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.63s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.63s/it][A
 60%|██████    | 3/5 [04:17<02:51, 85.66s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.74s/it][A[2024-04-02 05:12:28,299] [INFO] [logging.py:96:log_dist] [Rank 0] step=2214, skipped=0, lr=[7.001813409907505e-07], mom=[(0.9, 0.999)]
steps: 2214 loss: 2.5689 iter time (s): 85.187 samples/sec: 1.503

 80%|████████  | 4/5 [05:42<01:25, 85.73s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.71s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.76s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.73s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.74s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.73s/it][A
 80%|████████  | 4/5 [05:43<01:25, 85.76s/it][A
100%|██████████| 5/5 [07:08<00:00, 85.60s/it][A100%|██████████| 5/5 [07:08<00:00, 85.66s/it]
  2%|▏         | 8/437 [50:17<49:26:40, 414.92s/it][2024-04-02 05:13:53,668] [INFO] [logging.py:96:log_dist] [Rank 0] step=2215, skipped=0, lr=[7.37099253908753e-07], mom=[(0.9, 0.999)]
steps: 2215 loss: 2.4942 iter time (s): 84.654 samples/sec: 1.512

100%|██████████| 5/5 [07:08<00:00, 85.60s/it][A100%|██████████| 5/5 [07:08<00:00, 85.65s/it]
  2%|▏         | 8/437 [50:33<49:31:11, 415.55s/it]
100%|██████████| 5/5 [07:08<00:00, 85.58s/it][A100%|██████████| 5/5 [07:08<00:00, 85.61s/it]
  2%|▏         | 8/437 [50:24<49:28:51, 415.22s/it]
100%|██████████| 5/5 [07:08<00:00, 85.60s/it][A100%|██████████| 5/5 [07:08<00:00, 85.66s/it]
  2%|▏         | 8/437 [51:05<49:39:50, 416.76s/it]
100%|██████████| 5/5 [07:08<00:00, 85.60s/it][A100%|██████████| 5/5 [07:08<00:00, 85.64s/it]
  2%|▏         | 8/437 [50:38<49:32:35, 415.75s/it]
100%|██████████| 5/5 [07:08<00:00, 85.59s/it][A100%|██████████| 5/5 [07:08<00:00, 85.64s/it]
  2%|▏         | 8/437 [50:48<49:35:22, 416.14s/it]
100%|██████████| 5/5 [07:08<00:00, 85.59s/it][A100%|██████████| 5/5 [07:08<00:00, 85.64s/it]
  2%|▏         | 8/437 [50:38<49:32:35, 415.75s/it]
100%|██████████| 5/5 [07:08<00:00, 85.60s/it][A100%|██████████| 5/5 [07:08<00:00, 85.67s/it]
  2%|▏         | 8/437 [51:03<49:39:16, 416.68s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_8

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:26<05:45, 86.44s/it][A[2024-04-02 05:15:23,513] [INFO] [logging.py:96:log_dist] [Rank 0] step=2216, skipped=0, lr=[7.751182437305653e-07], mom=[(0.9, 0.999)]
steps: 2216 loss: 2.4438 iter time (s): 85.978 samples/sec: 1.489

 20%|██        | 1/5 [01:26<05:45, 86.28s/it][A
 20%|██        | 1/5 [01:24<05:39, 84.86s/it][A
 20%|██        | 1/5 [01:26<05:46, 86.70s/it][A
 20%|██        | 1/5 [01:26<05:44, 86.21s/it][A
 20%|██        | 1/5 [01:26<05:45, 86.35s/it][A
 20%|██        | 1/5 [01:26<05:45, 86.44s/it][A
 20%|██        | 1/5 [01:26<05:47, 86.78s/it][A
 40%|████      | 2/5 [02:53<04:19, 86.56s/it][A[2024-04-02 05:16:50,192] [INFO] [logging.py:96:log_dist] [Rank 0] step=2217, skipped=0, lr=[8.142382266172538e-07], mom=[(0.9, 0.999)]
steps: 2217 loss: 2.5997 iter time (s): 86.032 samples/sec: 1.488

 40%|████      | 2/5 [02:52<04:19, 86.54s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.95s/it][A
 40%|████      | 2/5 [02:53<04:20, 86.71s/it][A
 40%|████      | 2/5 [02:52<04:19, 86.51s/it][A
 40%|████      | 2/5 [02:53<04:19, 86.60s/it][A
 40%|████      | 2/5 [02:53<04:19, 86.61s/it][A
 40%|████      | 2/5 [02:53<04:20, 86.75s/it][A
 60%|██████    | 3/5 [04:18<02:52, 86.01s/it][A[2024-04-02 05:18:15,533] [INFO] [logging.py:96:log_dist] [Rank 0] step=2218, skipped=0, lr=[8.544591163020708e-07], mom=[(0.9, 0.999)]
steps: 2218 loss: 2.4593 iter time (s): 84.616 samples/sec: 1.513

 60%|██████    | 3/5 [04:18<02:51, 85.99s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.66s/it][A
 60%|██████    | 3/5 [04:18<02:52, 86.06s/it][A
 60%|██████    | 3/5 [04:18<02:51, 85.95s/it][A
 60%|██████    | 3/5 [04:18<02:51, 85.99s/it][A
 60%|██████    | 3/5 [04:18<02:52, 86.00s/it][A
 60%|██████    | 3/5 [04:18<02:52, 86.08s/it][A
 80%|████████  | 4/5 [05:43<01:25, 85.66s/it][A[2024-04-02 05:19:40,677] [INFO] [logging.py:96:log_dist] [Rank 0] step=2219, skipped=0, lr=[8.957808240905638e-07], mom=[(0.9, 0.999)]
steps: 2219 loss: 2.5219 iter time (s): 84.485 samples/sec: 1.515

 80%|████████  | 4/5 [05:43<01:25, 85.65s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.48s/it][A
 80%|████████  | 4/5 [05:43<01:25, 85.70s/it][A
 80%|████████  | 4/5 [05:43<01:25, 85.63s/it][A
 80%|████████  | 4/5 [05:43<01:25, 85.65s/it][A
 80%|████████  | 4/5 [05:43<01:25, 85.66s/it][A
 80%|████████  | 4/5 [05:43<01:25, 85.71s/it][A
100%|██████████| 5/5 [07:09<00:00, 85.59s/it][A100%|██████████| 5/5 [07:09<00:00, 85.81s/it]
  2%|▏         | 9/437 [57:29<49:58:36, 420.36s/it][2024-04-02 05:21:06,148] [INFO] [logging.py:96:log_dist] [Rank 0] step=2220, skipped=0, lr=[9.38203258860688e-07], mom=[(0.9, 0.999)]
steps: 2220 loss: 2.4324 iter time (s): 84.834 samples/sec: 1.509

100%|██████████| 5/5 [07:08<00:00, 85.58s/it][A100%|██████████| 5/5 [07:08<00:00, 85.79s/it]
  2%|▏         | 9/437 [57:45<50:01:36, 420.79s/it]
100%|██████████| 5/5 [07:07<00:00, 85.47s/it][A100%|██████████| 5/5 [07:07<00:00, 85.51s/it]
  2%|▏         | 9/437 [57:37<50:00:12, 420.59s/it]
100%|██████████| 5/5 [07:09<00:00, 85.63s/it][A100%|██████████| 5/5 [07:09<00:00, 85.87s/it]
  2%|▏         | 9/437 [58:18<50:07:43, 421.64s/it]
100%|██████████| 5/5 [07:08<00:00, 85.58s/it][A100%|██████████| 5/5 [07:08<00:00, 85.77s/it]
  2%|▏         | 9/437 [57:50<50:02:38, 420.93s/it]
100%|██████████| 5/5 [07:09<00:00, 85.60s/it][A100%|██████████| 5/5 [07:09<00:00, 85.81s/it]
  2%|▏         | 9/437 [57:51<50:02:40, 420.94s/it]
100%|██████████| 5/5 [07:09<00:00, 85.60s/it][A100%|██████████| 5/5 [07:09<00:00, 85.81s/it]
  2%|▏         | 9/437 [58:01<50:04:38, 421.21s/it]
100%|██████████| 5/5 [07:09<00:00, 85.63s/it][A100%|██████████| 5/5 [07:09<00:00, 85.88s/it]
  2%|▏         | 9/437 [58:16<50:07:17, 421.58s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_9

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:25<05:42, 85.55s/it][A[2024-04-02 05:22:34,826] [INFO] [logging.py:96:log_dist] [Rank 0] step=2221, skipped=0, lr=[9.817263270632492e-07], mom=[(0.9, 0.999)]
steps: 2221 loss: 2.5068 iter time (s): 84.795 samples/sec: 1.510

 20%|██        | 1/5 [01:25<05:41, 85.36s/it][A
 20%|██        | 1/5 [01:25<05:41, 85.31s/it][A
 20%|██        | 1/5 [01:25<05:42, 85.53s/it][A
 20%|██        | 1/5 [01:25<05:40, 85.24s/it][A
 20%|██        | 1/5 [01:25<05:41, 85.36s/it][A
 20%|██        | 1/5 [01:25<05:42, 85.56s/it][A
 20%|██        | 1/5 [01:25<05:42, 85.55s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.71s/it][A[2024-04-02 05:24:00,637] [INFO] [logging.py:96:log_dist] [Rank 0] step=2222, skipped=0, lr=[1.0263499327218492e-06], mom=[(0.9, 0.999)]
steps: 2222 loss: 2.4162 iter time (s): 85.201 samples/sec: 1.502

 40%|████      | 2/5 [02:51<04:16, 85.63s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.62s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.67s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.55s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.62s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.69s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.71s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.57s/it][A[2024-04-02 05:25:26,038] [INFO] [logging.py:96:log_dist] [Rank 0] step=2223, skipped=0, lr=[1.0720739774331627e-06], mom=[(0.9, 0.999)]
steps: 2223 loss: 2.5155 iter time (s): 84.750 samples/sec: 1.510

 60%|██████    | 3/5 [04:16<02:51, 85.53s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.54s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.55s/it][A
 60%|██████    | 3/5 [04:16<02:50, 85.50s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.54s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.58s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.58s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.21s/it][A[2024-04-02 05:26:50,708] [INFO] [logging.py:96:log_dist] [Rank 0] step=2224, skipped=0, lr=[1.118898360367271e-06], mom=[(0.9, 0.999)]
steps: 2224 loss: 2.4773 iter time (s): 83.983 samples/sec: 1.524

 80%|████████  | 4/5 [05:41<01:25, 85.19s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.22s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.24s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.17s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.22s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.22s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.23s/it][A
100%|██████████| 5/5 [07:06<00:00, 85.01s/it][A100%|██████████| 5/5 [07:06<00:00, 85.22s/it]
  2%|▏         | 10/437 [1:04:38<50:10:58, 423.09s/it][2024-04-02 05:28:15,379] [INFO] [logging.py:96:log_dist] [Rank 0] step=2225, skipped=0, lr=[1.1668229782678828e-06], mom=[(0.9, 0.999)]
steps: 2225 loss: 2.4736 iter time (s): 83.964 samples/sec: 1.524

100%|██████████| 5/5 [07:05<00:00, 85.00s/it][A100%|██████████| 5/5 [07:05<00:00, 85.18s/it]
  2%|▏         | 10/437 [1:04:54<50:13:06, 423.39s/it]
100%|██████████| 5/5 [07:06<00:00, 84.99s/it][A100%|██████████| 5/5 [07:06<00:00, 85.20s/it]
  2%|▏         | 10/437 [1:05:27<50:17:05, 423.95s/it]
100%|██████████| 5/5 [07:05<00:00, 85.01s/it][A100%|██████████| 5/5 [07:05<00:00, 85.19s/it]
  2%|▏         | 10/437 [1:04:46<50:12:09, 423.25s/it]
100%|██████████| 5/5 [07:05<00:00, 85.00s/it][A100%|██████████| 5/5 [07:05<00:00, 85.16s/it]
  2%|▏         | 10/437 [1:05:00<50:13:47, 423.48s/it]
100%|██████████| 5/5 [07:05<00:00, 85.01s/it][A100%|██████████| 5/5 [07:05<00:00, 85.19s/it]
  2%|▏         | 10/437 [1:05:10<50:15:07, 423.67s/it]
100%|██████████| 5/5 [07:06<00:00, 85.04s/it][A100%|██████████| 5/5 [07:06<00:00, 85.24s/it]
  2%|▏         | 10/437 [1:05:25<50:17:06, 423.95s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_10

100%|██████████| 5/5 [07:06<00:00, 85.05s/it][A100%|██████████| 5/5 [07:06<00:00, 85.24s/it]
  2%|▏         | 10/437 [1:05:00<50:14:00, 423.51s/it]
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:29<05:58, 89.52s/it][A[2024-04-02 05:29:47,922] [INFO] [logging.py:96:log_dist] [Rank 0] step=2226, skipped=0, lr=[1.2158477254522805e-06], mom=[(0.9, 0.999)]
steps: 2226 loss: 2.4226 iter time (s): 88.150 samples/sec: 1.452

 20%|██        | 1/5 [01:28<05:52, 88.22s/it][A
 20%|██        | 1/5 [01:29<05:56, 89.21s/it][A
 20%|██        | 1/5 [01:29<05:58, 89.55s/it][A
 20%|██        | 1/5 [01:29<05:56, 89.23s/it][A
 20%|██        | 1/5 [01:29<05:57, 89.33s/it][A
 20%|██        | 1/5 [01:29<05:56, 89.08s/it][A
 20%|██        | 1/5 [01:28<05:55, 88.98s/it][A
 40%|████      | 2/5 [02:57<04:25, 88.52s/it][A[2024-04-02 05:31:16,033] [INFO] [logging.py:96:log_dist] [Rank 0] step=2227, skipped=0, lr=[1.2659724938118179e-06], mom=[(0.9, 0.999)]
steps: 2227 loss: 2.4235 iter time (s): 87.460 samples/sec: 1.464

 40%|████      | 2/5 [02:56<04:24, 88.21s/it][A
 40%|████      | 2/5 [02:57<04:25, 88.58s/it][A
 40%|████      | 2/5 [02:57<04:25, 88.65s/it][A
 40%|████      | 2/5 [02:57<04:25, 88.57s/it][A
 40%|████      | 2/5 [02:57<04:25, 88.62s/it][A
 40%|████      | 2/5 [02:57<04:25, 88.52s/it][A
 40%|████      | 2/5 [02:57<04:25, 88.49s/it][A
 60%|██████    | 3/5 [04:26<02:57, 88.84s/it][A[2024-04-02 05:32:45,238] [INFO] [logging.py:96:log_dist] [Rank 0] step=2228, skipped=0, lr=[1.3171971728123099e-06], mom=[(0.9, 0.999)]
steps: 2228 loss: 2.3795 iter time (s): 88.476 samples/sec: 1.447

 60%|██████    | 3/5 [04:25<02:57, 88.59s/it][A
 60%|██████    | 3/5 [04:26<02:57, 88.86s/it][A
 60%|██████    | 3/5 [04:26<02:57, 88.92s/it][A
 60%|██████    | 3/5 [04:26<02:57, 88.88s/it][A
 60%|██████    | 3/5 [04:26<02:57, 88.88s/it][A
 60%|██████    | 3/5 [04:26<02:57, 88.80s/it][A
 60%|██████    | 3/5 [04:26<02:57, 88.83s/it][A
 80%|████████  | 4/5 [05:56<01:29, 89.31s/it][A[2024-04-02 05:34:15,267] [INFO] [logging.py:96:log_dist] [Rank 0] step=2229, skipped=0, lr=[1.3695216494938099e-06], mom=[(0.9, 0.999)]
steps: 2229 loss: 2.4317 iter time (s): 89.323 samples/sec: 1.433

 80%|████████  | 4/5 [05:55<01:29, 89.17s/it][A
 80%|████████  | 4/5 [05:56<01:29, 89.30s/it][A
 80%|████████  | 4/5 [05:56<01:29, 89.37s/it][A
 80%|████████  | 4/5 [05:56<01:29, 89.30s/it][A
 80%|████████  | 4/5 [05:56<01:29, 89.33s/it][A
 80%|████████  | 4/5 [05:56<01:29, 89.28s/it][A
 80%|████████  | 4/5 [05:56<01:29, 89.28s/it][A
100%|██████████| 5/5 [07:25<00:00, 89.29s/it][A100%|██████████| 5/5 [07:25<00:00, 89.17s/it]
  3%|▎         | 11/437 [1:12:07<51:00:12, 431.02s/it][2024-04-02 05:35:44,549] [INFO] [logging.py:96:log_dist] [Rank 0] step=2230, skipped=0, lr=[1.4229458084712215e-06], mom=[(0.9, 0.999)]
steps: 2230 loss: 2.3550 iter time (s): 88.590 samples/sec: 1.445

100%|██████████| 5/5 [07:24<00:00, 89.22s/it][A100%|██████████| 5/5 [07:24<00:00, 88.96s/it]
  3%|▎         | 11/437 [1:12:24<51:01:53, 431.25s/it]
100%|██████████| 5/5 [07:25<00:00, 89.30s/it][A100%|██████████| 5/5 [07:25<00:00, 89.16s/it]
  3%|▎         | 11/437 [1:12:15<51:01:03, 431.13s/it]
100%|██████████| 5/5 [07:26<00:00, 89.31s/it][A100%|██████████| 5/5 [07:26<00:00, 89.22s/it]
  3%|▎         | 11/437 [1:12:56<51:04:43, 431.65s/it]
100%|██████████| 5/5 [07:25<00:00, 89.27s/it][A100%|██████████| 5/5 [07:25<00:00, 89.15s/it]
  3%|▎         | 11/437 [1:12:29<51:02:09, 431.29s/it]
100%|██████████| 5/5 [07:25<00:00, 89.29s/it][A100%|██████████| 5/5 [07:25<00:00, 89.17s/it]
  3%|▎         | 11/437 [1:12:39<51:03:09, 431.43s/it]
100%|██████████| 5/5 [07:25<00:00, 89.26s/it][A100%|██████████| 5/5 [07:25<00:00, 89.10s/it]
  3%|▎         | 11/437 [1:12:54<51:04:24, 431.61s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_11

100%|██████████| 5/5 [07:25<00:00, 89.27s/it][A100%|██████████| 5/5 [07:25<00:00, 89.13s/it]
  3%|▎         | 11/437 [1:12:29<51:02:12, 431.30s/it]
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:24<05:39, 84.91s/it][A[2024-04-02 05:37:12,577] [INFO] [logging.py:96:log_dist] [Rank 0] step=2231, skipped=0, lr=[1.4774695319344632e-06], mom=[(0.9, 0.999)]
steps: 2231 loss: 2.4092 iter time (s): 84.013 samples/sec: 1.524

 20%|██        | 1/5 [01:23<05:35, 83.81s/it][A
 20%|██        | 1/5 [01:24<05:38, 84.70s/it][A
 20%|██        | 1/5 [01:24<05:39, 84.97s/it][A
 20%|██        | 1/5 [01:24<05:38, 84.57s/it][A
 20%|██        | 1/5 [01:24<05:38, 84.73s/it][A
 20%|██        | 1/5 [01:24<05:39, 84.81s/it][A
 20%|██        | 1/5 [01:24<05:39, 84.97s/it][A
 40%|████      | 2/5 [02:50<04:15, 85.06s/it][A[2024-04-02 05:38:37,740] [INFO] [logging.py:96:log_dist] [Rank 0] step=2232, skipped=0, lr=[1.533092699648636e-06], mom=[(0.9, 0.999)]
steps: 2232 loss: 2.3043 iter time (s): 84.478 samples/sec: 1.515

 40%|████      | 2/5 [02:49<04:13, 84.63s/it][A
 40%|████      | 2/5 [02:49<04:14, 84.98s/it][A
 40%|████      | 2/5 [02:50<04:15, 85.05s/it][A
 40%|████      | 2/5 [02:49<04:14, 84.91s/it][A
 40%|████      | 2/5 [02:49<04:14, 84.99s/it][A
 40%|████      | 2/5 [02:49<04:15, 85.01s/it][A
 40%|████      | 2/5 [02:50<04:15, 85.08s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.50s/it][A[2024-04-02 05:40:03,771] [INFO] [logging.py:96:log_dist] [Rank 0] step=2233, skipped=0, lr=[1.5898151889544124e-06], mom=[(0.9, 0.999)]
steps: 2233 loss: 2.3637 iter time (s): 85.362 samples/sec: 1.499

 60%|██████    | 3/5 [04:15<02:50, 85.26s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.45s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.51s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.42s/it][A
 60%|██████    | 3/5 [04:15<02:50, 85.47s/it][A
 60%|██████    | 3/5 [04:16<02:51, 85.51s/it][A
 60%|██████    | 3/5 [04:16<02:50, 85.48s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.71s/it][A[2024-04-02 05:41:29,801] [INFO] [logging.py:96:log_dist] [Rank 0] step=2234, skipped=0, lr=[1.6476368747683123e-06], mom=[(0.9, 0.999)]
steps: 2234 loss: 2.5090 iter time (s): 85.375 samples/sec: 1.499

 80%|████████  | 4/5 [05:41<01:25, 85.68s/it][A
 80%|████████  | 4/5 [05:41<01:25, 85.62s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.82s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.77s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.79s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.81s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.81s/it][A
100%|██████████| 5/5 [07:08<00:00, 85.91s/it][A100%|██████████| 5/5 [07:08<00:00, 85.68s/it]
  3%|▎         | 12/437 [1:19:19<50:54:18, 431.20s/it][2024-04-02 05:42:56,064] [INFO] [logging.py:96:log_dist] [Rank 0] step=2235, skipped=0, lr=[1.7065576295827604e-06], mom=[(0.9, 0.999)]
steps: 2235 loss: 2.3375 iter time (s): 85.302 samples/sec: 1.501

100%|██████████| 5/5 [07:07<00:00, 85.79s/it][A100%|██████████| 5/5 [07:07<00:00, 85.46s/it]
  3%|▎         | 12/437 [1:19:35<50:55:10, 431.32s/it]
100%|██████████| 5/5 [07:08<00:00, 85.89s/it][A100%|██████████| 5/5 [07:08<00:00, 85.64s/it]
  3%|▎         | 12/437 [1:19:27<50:54:44, 431.26s/it]
100%|██████████| 5/5 [07:08<00:00, 85.87s/it][A100%|██████████| 5/5 [07:08<00:00, 85.68s/it]
  3%|▎         | 12/437 [1:20:08<50:57:16, 431.61s/it]
100%|██████████| 5/5 [07:08<00:00, 85.84s/it][A100%|██████████| 5/5 [07:08<00:00, 85.60s/it]
  3%|▎         | 12/437 [1:19:40<50:55:31, 431.37s/it]
100%|██████████| 5/5 [07:08<00:00, 85.85s/it][A100%|██████████| 5/5 [07:08<00:00, 85.63s/it]
  3%|▎         | 12/437 [1:19:51<50:56:07, 431.45s/it]
100%|██████████| 5/5 [07:08<00:00, 85.87s/it][A100%|██████████| 5/5 [07:08<00:00, 85.68s/it]
  3%|▎         | 12/437 [1:19:40<50:55:29, 431.36s/it]
100%|██████████| 5/5 [07:08<00:00, 85.86s/it][A100%|██████████| 5/5 [07:08<00:00, 85.65s/it]
  3%|▎         | 12/437 [1:20:06<50:57:02, 431.58s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_12

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:26<05:46, 86.58s/it][A[2024-04-02 05:44:25,804] [INFO] [logging.py:96:log_dist] [Rank 0] step=2236, skipped=0, lr=[1.7665773234668066e-06], mom=[(0.9, 0.999)]
steps: 2236 loss: 2.3587 iter time (s): 85.937 samples/sec: 1.489

 20%|██        | 1/5 [01:25<05:42, 85.58s/it][A
 20%|██        | 1/5 [01:26<05:45, 86.35s/it][A
 20%|██        | 1/5 [01:26<05:46, 86.61s/it][A
 20%|██        | 1/5 [01:26<05:46, 86.51s/it][A
 20%|██        | 1/5 [01:26<05:46, 86.62s/it][A
 20%|██        | 1/5 [01:26<05:46, 86.58s/it][A
 20%|██        | 1/5 [01:26<05:46, 86.74s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.69s/it][A[2024-04-02 05:45:50,873] [INFO] [logging.py:96:log_dist] [Rank 0] step=2237, skipped=0, lr=[1.827695824065849e-06], mom=[(0.9, 0.999)]
steps: 2237 loss: 2.3703 iter time (s): 84.369 samples/sec: 1.517

 40%|████      | 2/5 [02:50<04:15, 85.21s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.58s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.65s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.62s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.65s/it][A
 40%|████      | 2/5 [02:51<04:17, 85.70s/it][A
 40%|████      | 2/5 [02:51<04:16, 85.65s/it][A
 60%|██████    | 3/5 [04:16<02:50, 85.45s/it][A[2024-04-02 05:47:16,053] [INFO] [logging.py:96:log_dist] [Rank 0] step=2238, skipped=0, lr=[1.8899129966023544e-06], mom=[(0.9, 0.999)]
steps: 2238 loss: 2.3874 iter time (s): 84.577 samples/sec: 1.513

 60%|██████    | 3/5 [04:15<02:50, 85.25s/it][A
 60%|██████    | 3/5 [04:16<02:50, 85.44s/it][A
 60%|██████    | 3/5 [04:16<02:50, 85.45s/it][A
 60%|██████    | 3/5 [04:16<02:50, 85.44s/it][A
 60%|██████    | 3/5 [04:16<02:50, 85.47s/it][A
 60%|██████    | 3/5 [04:16<02:50, 85.45s/it][A
 60%|██████    | 3/5 [04:16<02:50, 85.49s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.51s/it][A[2024-04-02 05:48:41,645] [INFO] [logging.py:96:log_dist] [Rank 0] step=2239, skipped=0, lr=[1.9532287038760267e-06], mom=[(0.9, 0.999)]
steps: 2239 loss: 2.3740 iter time (s): 84.928 samples/sec: 1.507

 80%|████████  | 4/5 [05:41<01:25, 85.39s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.49s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.52s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.51s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.53s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.53s/it][A
 80%|████████  | 4/5 [05:42<01:25, 85.55s/it][A
100%|██████████| 5/5 [07:07<00:00, 85.34s/it][A100%|██████████| 5/5 [07:07<00:00, 85.49s/it]
  3%|▎         | 13/437 [1:26:30<50:45:50, 431.02s/it][2024-04-02 05:50:06,671] [INFO] [logging.py:96:log_dist] [Rank 0] step=2240, skipped=0, lr=[2.017642806264083e-06], mom=[(0.9, 0.999)]
steps: 2240 loss: 2.3025 iter time (s): 84.339 samples/sec: 1.518

100%|██████████| 5/5 [07:06<00:00, 85.24s/it][A100%|██████████| 5/5 [07:06<00:00, 85.28s/it]
  3%|▎         | 13/437 [1:26:46<50:46:33, 431.12s/it]
100%|██████████| 5/5 [07:07<00:00, 85.33s/it][A100%|██████████| 5/5 [07:07<00:00, 85.46s/it]
  3%|▎         | 13/437 [1:26:37<50:46:07, 431.06s/it]
100%|██████████| 5/5 [07:07<00:00, 85.33s/it][A100%|██████████| 5/5 [07:07<00:00, 85.48s/it]
  3%|▎         | 13/437 [1:27:18<50:47:52, 431.30s/it]
100%|██████████| 5/5 [07:07<00:00, 85.32s/it][A100%|██████████| 5/5 [07:07<00:00, 85.48s/it]
  3%|▎         | 13/437 [1:27:01<50:47:07, 431.20s/it]
100%|██████████| 5/5 [07:07<00:00, 85.34s/it][A100%|██████████| 5/5 [07:07<00:00, 85.48s/it]
  3%|▎         | 13/437 [1:26:51<50:46:48, 431.15s/it]
100%|██████████| 5/5 [07:07<00:00, 85.34s/it][A100%|██████████| 5/5 [07:07<00:00, 85.51s/it]
  3%|▎         | 13/437 [1:27:16<50:47:45, 431.29s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_13

100%|██████████| 5/5 [07:07<00:00, 85.33s/it][A100%|██████████| 5/5 [07:07<00:00, 85.48s/it]
  3%|▎         | 13/437 [1:26:51<50:46:43, 431.14s/it]
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:26<05:47, 86.83s/it][A[2024-04-02 05:51:36,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=2241, skipped=0, lr=[2.0831551617214757e-06], mom=[(0.9, 0.999)]
steps: 2241 loss: 2.2523 iter time (s): 86.244 samples/sec: 1.484

 20%|██        | 1/5 [01:25<05:42, 85.56s/it][A
 20%|██        | 1/5 [01:26<05:47, 86.88s/it][A
 20%|██        | 1/5 [01:27<05:48, 87.03s/it][A
 20%|██        | 1/5 [01:26<05:47, 86.90s/it][A
 20%|██        | 1/5 [01:27<05:48, 87.04s/it][A
 20%|██        | 1/5 [01:27<05:48, 87.00s/it][A
 20%|██        | 1/5 [01:27<05:48, 87.07s/it][A
 40%|████      | 2/5 [02:53<04:20, 87.00s/it][A[2024-04-02 05:53:03,909] [INFO] [logging.py:96:log_dist] [Rank 0] step=2242, skipped=0, lr=[2.149765625781504e-06], mom=[(0.9, 0.999)]
steps: 2242 loss: 2.2451 iter time (s): 86.394 samples/sec: 1.482

 40%|████      | 2/5 [02:52<04:19, 86.43s/it][A
 40%|████      | 2/5 [02:53<04:20, 87.00s/it][A
 40%|████      | 2/5 [02:54<04:21, 87.07s/it][A
 40%|████      | 2/5 [02:53<04:20, 86.99s/it][A
 40%|████      | 2/5 [02:54<04:21, 87.07s/it][A
 40%|████      | 2/5 [02:54<04:21, 87.15s/it][A
 40%|████      | 2/5 [02:54<04:21, 87.19s/it][A
 60%|██████    | 3/5 [04:22<02:55, 87.74s/it][A[2024-04-02 05:54:32,526] [INFO] [logging.py:96:log_dist] [Rank 0] step=2243, skipped=0, lr=[2.217474051555813e-06], mom=[(0.9, 0.999)]
steps: 2243 loss: 2.3625 iter time (s): 87.738 samples/sec: 1.459

 60%|██████    | 3/5 [04:21<02:54, 87.46s/it][A
 60%|██████    | 3/5 [04:22<02:55, 87.73s/it][A
 60%|██████    | 3/5 [04:22<02:55, 87.77s/it][A
 60%|██████    | 3/5 [04:22<02:55, 87.74s/it][A
 60%|██████    | 3/5 [04:22<02:55, 87.76s/it][A
 60%|██████    | 3/5 [04:22<02:55, 87.75s/it][A
 60%|██████    | 3/5 [04:22<02:55, 87.74s/it][A
 80%|████████  | 4/5 [05:50<01:28, 88.00s/it][A[2024-04-02 05:56:00,932] [INFO] [logging.py:96:log_dist] [Rank 0] step=2244, skipped=0, lr=[2.2862802897347816e-06], mom=[(0.9, 0.999)]
steps: 2244 loss: 2.3155 iter time (s): 87.730 samples/sec: 1.459

 80%|████████  | 4/5 [05:49<01:27, 87.83s/it][A
 80%|████████  | 4/5 [05:50<01:28, 88.00s/it][A
 80%|████████  | 4/5 [05:51<01:28, 88.03s/it][A
 80%|████████  | 4/5 [05:50<01:28, 88.01s/it][A
 80%|████████  | 4/5 [05:51<01:28, 88.00s/it][A
 80%|████████  | 4/5 [05:51<01:27, 87.99s/it][A
 80%|████████  | 4/5 [05:51<01:28, 88.01s/it][A
100%|██████████| 5/5 [07:17<00:00, 87.42s/it][A100%|██████████| 5/5 [07:17<00:00, 87.47s/it]
  3%|▎         | 14/437 [1:33:50<50:59:06, 433.92s/it][2024-04-02 05:57:27,334] [INFO] [logging.py:96:log_dist] [Rank 0] step=2245, skipped=0, lr=[2.356184188588025e-06], mom=[(0.9, 0.999)]
steps: 2245 loss: 2.2991 iter time (s): 85.758 samples/sec: 1.493

100%|██████████| 5/5 [07:16<00:00, 87.32s/it][A100%|██████████| 5/5 [07:16<00:00, 87.22s/it]
  3%|▎         | 14/437 [1:34:06<50:59:43, 434.00s/it]
100%|██████████| 5/5 [07:17<00:00, 87.44s/it][A100%|██████████| 5/5 [07:17<00:00, 87.48s/it]
  3%|▎         | 14/437 [1:33:58<50:59:25, 433.96s/it]
100%|██████████| 5/5 [07:17<00:00, 87.44s/it][A100%|██████████| 5/5 [07:17<00:00, 87.51s/it]
  3%|▎         | 14/437 [1:34:39<51:00:42, 434.14s/it]
100%|██████████| 5/5 [07:17<00:00, 87.43s/it][A100%|██████████| 5/5 [07:17<00:00, 87.48s/it]
  3%|▎         | 14/437 [1:34:11<50:59:52, 434.02s/it]
100%|██████████| 5/5 [07:17<00:00, 87.44s/it][A100%|██████████| 5/5 [07:17<00:00, 87.50s/it]
  3%|▎         | 14/437 [1:34:22<51:00:11, 434.07s/it]
100%|██████████| 5/5 [07:17<00:00, 87.43s/it][A100%|██████████| 5/5 [07:17<00:00, 87.51s/it]
  3%|▎         | 14/437 [1:34:37<51:00:35, 434.13s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_14

100%|██████████| 5/5 [07:17<00:00, 87.43s/it][A100%|██████████| 5/5 [07:17<00:00, 87.50s/it]
  3%|▎         | 14/437 [1:34:12<50:59:52, 434.02s/it]
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:24<05:38, 84.69s/it][A[2024-04-02 05:58:55,237] [INFO] [logging.py:96:log_dist] [Rank 0] step=2246, skipped=0, lr=[2.427185593964557e-06], mom=[(0.9, 0.999)]
steps: 2246 loss: 2.2692 iter time (s): 84.070 samples/sec: 1.523

 20%|██        | 1/5 [01:23<05:32, 83.09s/it][A
 20%|██        | 1/5 [01:24<05:37, 84.48s/it][A
 20%|██        | 1/5 [01:24<05:38, 84.73s/it][A
 20%|██        | 1/5 [01:24<05:37, 84.46s/it][A
 20%|██        | 1/5 [01:24<05:38, 84.50s/it][A
 20%|██        | 1/5 [01:24<05:39, 84.81s/it][A
 20%|██        | 1/5 [01:24<05:38, 84.71s/it][A
 40%|████      | 2/5 [02:52<04:18, 86.29s/it][A[2024-04-02 06:00:22,641] [INFO] [logging.py:96:log_dist] [Rank 0] step=2247, skipped=0, lr=[2.4992843492932375e-06], mom=[(0.9, 0.999)]
steps: 2247 loss: 2.2669 iter time (s): 86.773 samples/sec: 1.475

 40%|████      | 2/5 [02:50<04:16, 85.62s/it][A
 40%|████      | 2/5 [02:51<04:18, 86.24s/it][A
 40%|████      | 2/5 [02:52<04:18, 86.29s/it][A
 40%|████      | 2/5 [02:51<04:18, 86.23s/it][A
 40%|████      | 2/5 [02:52<04:18, 86.32s/it][A
 40%|████      | 2/5 [02:52<04:19, 86.36s/it][A
 40%|████      | 2/5 [02:51<04:18, 86.26s/it][A
 60%|██████    | 3/5 [04:19<02:53, 87.00s/it][A[2024-04-02 06:01:50,485] [INFO] [logging.py:96:log_dist] [Rank 0] step=2248, skipped=0, lr=[2.572480295583049e-06], mom=[(0.9, 0.999)]
steps: 2248 loss: 2.2584 iter time (s): 87.165 samples/sec: 1.468

 60%|██████    | 3/5 [04:18<02:53, 86.67s/it][A
 60%|██████    | 3/5 [04:19<02:53, 86.99s/it][A
 60%|██████    | 3/5 [04:19<02:54, 87.01s/it][A
 60%|██████    | 3/5 [04:19<02:53, 86.97s/it][A
 60%|██████    | 3/5 [04:19<02:53, 86.95s/it][A
 60%|██████    | 3/5 [04:19<02:54, 87.01s/it][A
 60%|██████    | 3/5 [04:20<02:54, 87.03s/it][A
 80%|████████  | 4/5 [05:47<01:27, 87.05s/it][A[2024-04-02 06:03:17,607] [INFO] [logging.py:96:log_dist] [Rank 0] step=2249, skipped=0, lr=[2.6467732714233724e-06], mom=[(0.9, 0.999)]
steps: 2249 loss: 2.2867 iter time (s): 86.461 samples/sec: 1.480

 80%|████████  | 4/5 [05:45<01:26, 86.84s/it][A
 80%|████████  | 4/5 [05:46<01:27, 87.02s/it][A
 80%|████████  | 4/5 [05:47<01:27, 87.03s/it][A
 80%|████████  | 4/5 [05:46<01:27, 87.00s/it][A
 80%|████████  | 4/5 [05:46<01:27, 87.00s/it][A
 80%|████████  | 4/5 [05:47<01:27, 87.05s/it][A
 80%|████████  | 4/5 [05:47<01:27, 87.06s/it][A
100%|██████████| 5/5 [07:12<00:00, 86.53s/it][A100%|██████████| 5/5 [07:12<00:00, 86.54s/it]
  3%|▎         | 15/437 [1:41:06<50:56:07, 434.52s/it][2024-04-02 06:04:43,214] [INFO] [logging.py:96:log_dist] [Rank 0] step=2250, skipped=0, lr=[2.722163112984545e-06], mom=[(0.9, 0.999)]
steps: 2250 loss: 2.1556 iter time (s): 84.954 samples/sec: 1.507

100%|██████████| 5/5 [07:11<00:00, 86.37s/it][A100%|██████████| 5/5 [07:11<00:00, 86.21s/it]
  3%|▎         | 15/437 [1:41:22<50:56:21, 434.55s/it]
100%|██████████| 5/5 [07:12<00:00, 86.49s/it][A100%|██████████| 5/5 [07:12<00:00, 86.49s/it]
  3%|▎         | 15/437 [1:41:14<50:56:00, 434.50s/it]
100%|██████████| 5/5 [07:12<00:00, 86.52s/it][A100%|██████████| 5/5 [07:12<00:00, 86.53s/it]
  3%|▎         | 15/437 [1:41:55<50:56:53, 434.63s/it]
100%|██████████| 5/5 [07:12<00:00, 86.49s/it][A100%|██████████| 5/5 [07:12<00:00, 86.48s/it]
  3%|▎         | 15/437 [1:41:27<50:56:19, 434.55s/it]
100%|██████████| 5/5 [07:12<00:00, 86.50s/it][A100%|██████████| 5/5 [07:12<00:00, 86.49s/it]
  3%|▎         | 15/437 [1:41:38<50:56:37, 434.59s/it]
100%|██████████| 5/5 [07:12<00:00, 86.50s/it][A100%|██████████| 5/5 [07:12<00:00, 86.53s/it]
  3%|▎         | 15/437 [1:41:28<50:56:20, 434.55s/it]
100%|██████████| 5/5 [07:12<00:00, 86.52s/it][A100%|██████████| 5/5 [07:12<00:00, 86.55s/it]
  3%|▎         | 15/437 [1:41:53<50:56:53, 434.63s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_15

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:27<05:48, 87.16s/it][A[2024-04-02 06:06:15,141] [INFO] [logging.py:96:log_dist] [Rank 0] step=2251, skipped=0, lr=[2.798649654018136e-06], mom=[(0.9, 0.999)]
steps: 2251 loss: 2.1786 iter time (s): 87.899 samples/sec: 1.456

 20%|██        | 1/5 [01:28<05:54, 88.69s/it][A
 20%|██        | 1/5 [01:28<05:54, 88.73s/it][A
 20%|██        | 1/5 [01:28<05:55, 88.92s/it][A
 20%|██        | 1/5 [01:28<05:55, 88.76s/it][A
 20%|██        | 1/5 [01:28<05:55, 88.82s/it][A
 20%|██        | 1/5 [01:28<05:55, 88.81s/it][A
 20%|██        | 1/5 [01:28<05:54, 88.66s/it][A
 40%|████      | 2/5 [02:55<04:24, 88.09s/it][A[2024-04-02 06:07:43,880] [INFO] [logging.py:96:log_dist] [Rank 0] step=2252, skipped=0, lr=[2.876232725857169e-06], mom=[(0.9, 0.999)]
steps: 2252 loss: 2.2452 iter time (s): 88.108 samples/sec: 1.453

 40%|████      | 2/5 [02:57<04:26, 88.72s/it][A
 40%|████      | 2/5 [02:57<04:26, 88.79s/it][A
 40%|████      | 2/5 [02:57<04:26, 88.83s/it][A
 40%|████      | 2/5 [02:57<04:26, 88.77s/it][A
 40%|████      | 2/5 [02:57<04:26, 88.79s/it][A
 40%|████      | 2/5 [02:57<04:26, 88.78s/it][A
 40%|████      | 2/5 [02:57<04:26, 88.72s/it][A
 60%|██████    | 3/5 [04:24<02:56, 88.11s/it][A[2024-04-02 06:09:12,016] [INFO] [logging.py:96:log_dist] [Rank 0] step=2253, skipped=0, lr=[2.954912157416677e-06], mom=[(0.9, 0.999)]
steps: 2253 loss: 2.1104 iter time (s): 87.480 samples/sec: 1.463

 60%|██████    | 3/5 [04:25<02:56, 88.44s/it][A
 60%|██████    | 3/5 [04:25<02:56, 88.45s/it][A
 60%|██████    | 3/5 [04:25<02:57, 88.52s/it][A
 60%|██████    | 3/5 [04:25<02:56, 88.50s/it][A
 60%|██████    | 3/5 [04:25<02:56, 88.49s/it][A
 60%|██████    | 3/5 [04:25<02:56, 88.48s/it][A
 60%|██████    | 3/5 [04:25<02:56, 88.46s/it][A
 80%|████████  | 4/5 [05:51<01:27, 87.85s/it][A[2024-04-02 06:10:39,473] [INFO] [logging.py:96:log_dist] [Rank 0] step=2254, skipped=0, lr=[3.034687775194092e-06], mom=[(0.9, 0.999)]
steps: 2254 loss: 2.1713 iter time (s): 86.850 samples/sec: 1.474

 80%|████████  | 4/5 [05:53<01:28, 88.09s/it][A
 80%|████████  | 4/5 [05:53<01:28, 88.10s/it][A
 80%|████████  | 4/5 [05:53<01:28, 88.11s/it][A
 80%|████████  | 4/5 [05:53<01:28, 88.10s/it][A
 80%|████████  | 4/5 [05:53<01:28, 88.11s/it][A
 80%|████████  | 4/5 [05:53<01:28, 88.10s/it][A
 80%|████████  | 4/5 [05:53<01:28, 88.09s/it][A
100%|██████████| 5/5 [07:17<00:00, 87.21s/it][A100%|██████████| 5/5 [07:17<00:00, 87.51s/it]
  4%|▎         | 16/437 [1:48:29<51:05:21, 436.87s/it][2024-04-02 06:12:05,565] [INFO] [logging.py:96:log_dist] [Rank 0] step=2255, skipped=0, lr=[3.1155594032694095e-06], mom=[(0.9, 0.999)]
steps: 2255 loss: 2.0751 iter time (s): 85.381 samples/sec: 1.499

100%|██████████| 5/5 [07:19<00:00, 87.32s/it][A100%|██████████| 5/5 [07:19<00:00, 87.81s/it]
  4%|▎         | 16/437 [1:48:45<51:05:28, 436.89s/it]
100%|██████████| 5/5 [07:19<00:00, 87.33s/it][A100%|██████████| 5/5 [07:19<00:00, 87.83s/it]
  4%|▎         | 16/437 [1:48:36<51:05:22, 436.87s/it]
100%|██████████| 5/5 [07:19<00:00, 87.33s/it][A100%|██████████| 5/5 [07:19<00:00, 87.85s/it]
  4%|▎         | 16/437 [1:49:17<51:05:55, 436.95s/it]
100%|██████████| 5/5 [07:19<00:00, 87.33s/it][A100%|██████████| 5/5 [07:19<00:00, 87.84s/it]
  4%|▎         | 16/437 [1:49:00<51:05:42, 436.92s/it]
100%|██████████| 5/5 [07:19<00:00, 87.34s/it][A100%|██████████| 5/5 [07:19<00:00, 87.84s/it]
  4%|▎         | 16/437 [1:48:50<51:05:38, 436.91s/it]
100%|██████████| 5/5 [07:19<00:00, 87.33s/it][A100%|██████████| 5/5 [07:19<00:00, 87.84s/it]
  4%|▎         | 16/437 [1:48:50<51:05:33, 436.90s/it]
100%|██████████| 5/5 [07:19<00:00, 87.32s/it][A100%|██████████| 5/5 [07:19<00:00, 87.81s/it]
  4%|▎         | 16/437 [1:49:15<51:05:56, 436.95s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_16

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:29<05:57, 89.47s/it][A[2024-04-02 06:13:38,538] [INFO] [logging.py:96:log_dist] [Rank 0] step=2256, skipped=0, lr=[3.197526863305856e-06], mom=[(0.9, 0.999)]
steps: 2256 loss: 2.0679 iter time (s): 88.214 samples/sec: 1.451

 20%|██        | 1/5 [01:28<05:55, 88.89s/it][A

 20%|██        | 1/5 [01:29<05:59, 89.89s/it][A 20%|██        | 1/5 [01:29<05:59, 89.81s/it][A
 20%|██        | 1/5 [01:29<05:59, 89.78s/it][A
 20%|██        | 1/5 [01:29<05:59, 89.76s/it][A
 20%|██        | 1/5 [01:29<05:59, 89.88s/it][A
 20%|██        | 1/5 [01:29<05:56, 89.01s/it][A
 40%|████      | 2/5 [02:56<04:24, 88.25s/it][A[2024-04-02 06:15:05,931] [INFO] [logging.py:96:log_dist] [Rank 0] step=2257, skipped=0, lr=[3.280589974550056e-06], mom=[(0.9, 0.999)]
steps: 2257 loss: 2.0750 iter time (s): 86.731 samples/sec: 1.476

 40%|████      | 2/5 [02:56<04:24, 88.02s/it][A
 40%|████      | 2/5 [02:57<04:25, 88.37s/it][A
 40%|████      | 2/5 [02:57<04:25, 88.49s/it][A
 40%|████      | 2/5 [02:57<04:25, 88.37s/it][A
 40%|████      | 2/5 [02:57<04:25, 88.37s/it][A
 40%|████      | 2/5 [02:57<04:25, 88.45s/it][A
 40%|████      | 2/5 [02:56<04:24, 88.08s/it][A
 60%|██████    | 3/5 [04:24<02:55, 88.00s/it][A[2024-04-02 06:16:33,639] [INFO] [logging.py:96:log_dist] [Rank 0] step=2258, skipped=0, lr=[3.3647485538325288e-06], mom=[(0.9, 0.999)]
steps: 2258 loss: 2.1454 iter time (s): 87.016 samples/sec: 1.471

 60%|██████    | 3/5 [04:24<02:55, 87.91s/it][A
 60%|██████    | 3/5 [04:25<02:56, 88.16s/it][A
 60%|██████    | 3/5 [04:25<02:56, 88.23s/it][A
 60%|██████    | 3/5 [04:25<02:56, 88.15s/it][A
 60%|██████    | 3/5 [04:25<02:56, 88.16s/it][A
 60%|██████    | 3/5 [04:25<02:56, 88.19s/it][A
 60%|██████    | 3/5 [04:24<02:55, 88.00s/it][A
 80%|████████  | 4/5 [05:52<01:28, 88.08s/it][A[2024-04-02 06:18:01,840] [INFO] [logging.py:96:log_dist] [Rank 0] step=2259, skipped=0, lr=[3.4500024155681922e-06], mom=[(0.9, 0.999)]
steps: 2259 loss: 2.1563 iter time (s): 87.315 samples/sec: 1.466

 80%|████████  | 4/5 [05:52<01:27, 87.99s/it][A
 80%|████████  | 4/5 [05:53<01:28, 88.09s/it][A
 80%|████████  | 4/5 [05:53<01:28, 88.11s/it][A
 80%|████████  | 4/5 [05:53<01:28, 88.09s/it][A
 80%|████████  | 4/5 [05:53<01:28, 88.11s/it][A
 80%|████████  | 4/5 [05:52<01:27, 87.98s/it][A
 80%|████████  | 4/5 [05:53<01:28, 88.11s/it][A
100%|██████████| 5/5 [07:20<00:00, 88.08s/it][A100%|██████████| 5/5 [07:20<00:00, 88.17s/it]
  4%|▍         | 17/437 [1:55:53<51:13:50, 439.12s/it][2024-04-02 06:19:29,908] [INFO] [logging.py:96:log_dist] [Rank 0] step=2260, skipped=0, lr=[3.5363513717564695e-06], mom=[(0.9, 0.999)]
steps: 2260 loss: 2.0424 iter time (s): 87.425 samples/sec: 1.464

100%|██████████| 5/5 [07:20<00:00, 88.01s/it][A100%|██████████| 5/5 [07:20<00:00, 88.05s/it]
  4%|▍         | 17/437 [1:56:09<51:14:01, 439.15s/it]
100%|██████████| 5/5 [07:21<00:00, 88.07s/it][A100%|██████████| 5/5 [07:21<00:00, 88.22s/it]
  4%|▍         | 17/437 [1:56:01<51:13:48, 439.12s/it]
100%|██████████| 5/5 [07:21<00:00, 88.08s/it][A100%|██████████| 5/5 [07:21<00:00, 88.26s/it]
  4%|▍         | 17/437 [1:56:42<51:14:17, 439.18s/it]
100%|██████████| 5/5 [07:21<00:00, 88.05s/it][A100%|██████████| 5/5 [07:21<00:00, 88.21s/it]
  4%|▍         | 17/437 [1:56:14<51:13:55, 439.13s/it]
100%|██████████| 5/5 [07:21<00:00, 88.06s/it][A100%|██████████| 5/5 [07:21<00:00, 88.21s/it]
  4%|▍         | 17/437 [1:56:25<51:14:04, 439.15s/it]
100%|██████████| 5/5 [07:20<00:00, 88.00s/it][A100%|██████████| 5/5 [07:20<00:00, 88.06s/it]
  4%|▍         | 17/437 [1:56:39<51:14:13, 439.18s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_17

100%|██████████| 5/5 [07:21<00:00, 88.08s/it][A100%|██████████| 5/5 [07:21<00:00, 88.24s/it]
  4%|▍         | 17/437 [1:56:14<51:13:59, 439.14s/it]
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:31<06:07, 91.83s/it][A[2024-04-02 06:21:06,494] [INFO] [logging.py:96:log_dist] [Rank 0] step=2261, skipped=0, lr=[3.62379523198207e-06], mom=[(0.9, 0.999)]
steps: 2261 loss: 2.0860 iter time (s): 91.725 samples/sec: 1.395

 20%|██        | 1/5 [01:32<06:10, 92.59s/it][A
 20%|██        | 1/5 [01:33<06:13, 93.40s/it][A
 20%|██        | 1/5 [01:33<06:14, 93.53s/it][A
 20%|██        | 1/5 [01:33<06:13, 93.41s/it][A
 20%|██        | 1/5 [01:33<06:13, 93.44s/it][A
 20%|██        | 1/5 [01:33<06:14, 93.52s/it][A
 20%|██        | 1/5 [01:32<06:10, 92.64s/it][A
 40%|████      | 2/5 [03:00<04:30, 90.08s/it][A[2024-04-02 06:22:35,352] [INFO] [logging.py:96:log_dist] [Rank 0] step=2262, skipped=0, lr=[3.7123338034152083e-06], mom=[(0.9, 0.999)]
steps: 2262 loss: 2.0038 iter time (s): 88.170 samples/sec: 1.452

 40%|████      | 2/5 [03:01<04:31, 90.36s/it][A
 40%|████      | 2/5 [03:02<04:32, 90.76s/it][A
 40%|████      | 2/5 [03:02<04:32, 90.79s/it][A
 40%|████      | 2/5 [03:02<04:32, 90.74s/it][A
 40%|████      | 2/5 [03:02<04:32, 90.76s/it][A
 40%|████      | 2/5 [03:01<04:31, 90.47s/it][A
 40%|████      | 2/5 [03:02<04:32, 90.84s/it][A
 60%|██████    | 3/5 [04:30<02:59, 89.78s/it][A[2024-04-02 06:24:04,765] [INFO] [logging.py:96:log_dist] [Rank 0] step=2263, skipped=0, lr=[3.8019668908118825e-06], mom=[(0.9, 0.999)]
steps: 2263 loss: 2.0603 iter time (s): 88.648 samples/sec: 1.444

 60%|██████    | 3/5 [04:30<02:59, 89.95s/it][A
 60%|██████    | 3/5 [04:31<03:00, 90.15s/it][A
 60%|██████    | 3/5 [04:31<03:00, 90.18s/it][A
 60%|██████    | 3/5 [04:31<03:00, 90.15s/it][A
 60%|██████    | 3/5 [04:31<03:00, 90.12s/it][A
 60%|██████    | 3/5 [04:31<03:00, 90.14s/it][A
 60%|██████    | 3/5 [04:30<02:59, 89.95s/it][A
 80%|████████  | 4/5 [06:00<01:30, 90.01s/it][A[2024-04-02 06:25:35,143] [INFO] [logging.py:96:log_dist] [Rank 0] step=2264, skipped=0, lr=[3.892694296514875e-06], mom=[(0.9, 0.999)]
steps: 2264 loss: 2.1889 iter time (s): 89.680 samples/sec: 1.427

 80%|████████  | 4/5 [06:01<01:30, 90.10s/it][A
 80%|████████  | 4/5 [06:02<01:30, 90.24s/it][A
 80%|████████  | 4/5 [06:02<01:30, 90.24s/it][A
 80%|████████  | 4/5 [06:02<01:30, 90.23s/it][A
 80%|████████  | 4/5 [06:02<01:30, 90.23s/it][A
 80%|████████  | 4/5 [06:02<01:30, 90.23s/it][A
 80%|████████  | 4/5 [06:01<01:30, 90.12s/it][A
100%|██████████| 5/5 [07:33<00:00, 91.17s/it][A100%|██████████| 5/5 [07:33<00:00, 90.74s/it]
  4%|▍         | 18/437 [2:03:31<51:47:03, 444.92s/it][2024-04-02 06:27:08,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=2265, skipped=0, lr=[3.984515820453308e-06], mom=[(0.9, 0.999)]
steps: 2265 loss: 2.0877 iter time (s): 92.568 samples/sec: 1.383

100%|██████████| 5/5 [07:34<00:00, 91.23s/it][A100%|██████████| 5/5 [07:34<00:00, 90.88s/it]
  4%|▍         | 18/437 [2:03:47<51:47:12, 444.95s/it]
100%|██████████| 5/5 [07:35<00:00, 91.31s/it][A100%|██████████| 5/5 [07:35<00:00, 91.08s/it]
  4%|▍         | 18/437 [2:04:20<51:47:28, 444.98s/it]
100%|██████████| 5/5 [07:35<00:00, 91.34s/it][A100%|██████████| 5/5 [07:35<00:00, 91.08s/it]
  4%|▍         | 18/437 [2:03:39<51:47:24, 444.98s/it]
100%|██████████| 5/5 [07:35<00:00, 91.30s/it][A100%|██████████| 5/5 [07:35<00:00, 91.06s/it]
  4%|▍         | 18/437 [2:03:53<51:47:20, 444.97s/it]
100%|██████████| 5/5 [07:35<00:00, 91.29s/it][A100%|██████████| 5/5 [07:35<00:00, 91.05s/it]
  4%|▍         | 18/437 [2:04:03<51:47:24, 444.97s/it]
100%|██████████| 5/5 [07:35<00:00, 91.30s/it][A100%|██████████| 5/5 [07:35<00:00, 91.07s/it]
  4%|▍         | 18/437 [2:03:53<51:47:17, 444.96s/it]
100%|██████████| 5/5 [07:34<00:00, 91.23s/it][A100%|██████████| 5/5 [07:34<00:00, 90.90s/it]
  4%|▍         | 18/437 [2:04:18<51:47:31, 444.99s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_18

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:26<05:47, 86.91s/it][A[2024-04-02 06:28:40,125] [INFO] [logging.py:96:log_dist] [Rank 0] step=2266, skipped=0, lr=[4.077431260143971e-06], mom=[(0.9, 0.999)]
steps: 2266 loss: 2.0578 iter time (s): 87.655 samples/sec: 1.460

 20%|██        | 1/5 [01:28<05:52, 88.14s/it][A
 20%|██        | 1/5 [01:27<05:51, 87.95s/it][A
 20%|██        | 1/5 [01:28<05:54, 88.59s/it][A
 20%|██        | 1/5 [01:28<05:52, 88.11s/it][A
 20%|██        | 1/5 [01:28<05:52, 88.15s/it][A
 20%|██        | 1/5 [01:28<05:54, 88.64s/it][A
 20%|██        | 1/5 [01:28<05:53, 88.43s/it][A
 40%|████      | 2/5 [02:56<04:25, 88.53s/it][A[2024-04-02 06:30:09,805] [INFO] [logging.py:96:log_dist] [Rank 0] step=2267, skipped=0, lr=[4.1714404106911054e-06], mom=[(0.9, 0.999)]
steps: 2267 loss: 2.1646 iter time (s): 89.040 samples/sec: 1.438

 40%|████      | 2/5 [02:57<04:27, 89.10s/it][A
 40%|████      | 2/5 [02:57<04:26, 88.95s/it][A
 40%|████      | 2/5 [02:58<04:27, 89.24s/it][A
 40%|████      | 2/5 [02:57<04:27, 89.02s/it][A
 40%|████      | 2/5 [02:57<04:27, 89.04s/it][A
 40%|████      | 2/5 [02:58<04:27, 89.25s/it][A
 40%|████      | 2/5 [02:58<04:27, 89.16s/it][A
 60%|██████    | 3/5 [04:25<02:57, 88.90s/it][A[2024-04-02 06:31:39,152] [INFO] [logging.py:96:log_dist] [Rank 0] step=2268, skipped=0, lr=[4.266543064787291e-06], mom=[(0.9, 0.999)]
steps: 2268 loss: 2.1690 iter time (s): 88.692 samples/sec: 1.443

 60%|██████    | 3/5 [04:27<02:58, 89.19s/it][A
 60%|██████    | 3/5 [04:26<02:58, 89.13s/it][A
 60%|██████    | 3/5 [04:27<02:58, 89.29s/it][A
 60%|██████    | 3/5 [04:27<02:58, 89.17s/it][A
 60%|██████    | 3/5 [04:27<02:58, 89.18s/it][A
 60%|██████    | 3/5 [04:27<02:58, 89.29s/it][A
 60%|██████    | 3/5 [04:27<02:58, 89.25s/it][A
 80%|████████  | 4/5 [05:55<01:28, 88.98s/it][A[2024-04-02 06:33:08,261] [INFO] [logging.py:96:log_dist] [Rank 0] step=2269, skipped=0, lr=[4.362739012713608e-06], mom=[(0.9, 0.999)]
steps: 2269 loss: 1.9638 iter time (s): 88.455 samples/sec: 1.447

 80%|████████  | 4/5 [05:56<01:29, 89.15s/it][A
 80%|████████  | 4/5 [05:56<01:29, 89.13s/it][A
 80%|████████  | 4/5 [05:56<01:29, 89.23s/it][A
 80%|████████  | 4/5 [05:56<01:29, 89.16s/it][A
 80%|████████  | 4/5 [05:56<01:29, 89.22s/it][A
 80%|████████  | 4/5 [05:56<01:29, 89.17s/it][A
 80%|████████  | 4/5 [05:56<01:29, 89.20s/it][A
100%|██████████| 5/5 [07:23<00:00, 88.77s/it][A100%|██████████| 5/5 [07:23<00:00, 88.69s/it]
  4%|▍         | 19/437 [2:11:00<51:46:42, 445.94s/it][2024-04-02 06:34:36,654] [INFO] [logging.py:96:log_dist] [Rank 0] step=2270, skipped=0, lr=[4.4600280423403086e-06], mom=[(0.9, 0.999)]
steps: 2270 loss: 1.9613 iter time (s): 87.713 samples/sec: 1.459

100%|██████████| 5/5 [07:24<00:00, 88.86s/it][A100%|██████████| 5/5 [07:24<00:00, 88.93s/it]
  4%|▍         | 19/437 [2:11:16<51:46:40, 445.93s/it]
100%|██████████| 5/5 [07:24<00:00, 88.85s/it][A100%|██████████| 5/5 [07:24<00:00, 88.89s/it]
  4%|▍         | 19/437 [2:11:07<51:46:39, 445.93s/it]
100%|██████████| 5/5 [07:25<00:00, 88.91s/it][A100%|██████████| 5/5 [07:25<00:00, 89.02s/it]
  4%|▍         | 19/437 [2:11:48<51:46:54, 445.97s/it]
100%|██████████| 5/5 [07:24<00:00, 88.85s/it][A100%|██████████| 5/5 [07:24<00:00, 88.91s/it]
  4%|▍         | 19/437 [2:11:21<51:46:44, 445.94s/it]
100%|██████████| 5/5 [07:24<00:00, 88.85s/it][A100%|██████████| 5/5 [07:24<00:00, 88.92s/it]
  4%|▍         | 19/437 [2:11:31<51:46:44, 445.94s/it]
100%|██████████| 5/5 [07:25<00:00, 88.90s/it][A100%|██████████| 5/5 [07:25<00:00, 89.02s/it]
  4%|▍         | 19/437 [2:11:21<51:46:43, 445.94s/it]
100%|██████████| 5/5 [07:24<00:00, 88.88s/it][A100%|██████████| 5/5 [07:24<00:00, 88.98s/it]
  4%|▍         | 19/437 [2:11:46<51:46:51, 445.96s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_19

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:26<05:44, 86.21s/it][A[2024-04-02 06:36:07,461] [INFO] [logging.py:96:log_dist] [Rank 0] step=2271, skipped=0, lr=[4.558409939127147e-06], mom=[(0.9, 0.999)]
steps: 2271 loss: 2.0708 iter time (s): 87.017 samples/sec: 1.471

 20%|██        | 1/5 [01:27<05:50, 87.51s/it][A
 20%|██        | 1/5 [01:27<05:50, 87.51s/it][A
 20%|██        | 1/5 [01:27<05:50, 87.68s/it][A
 20%|██        | 1/5 [01:27<05:50, 87.53s/it][A
 20%|██        | 1/5 [01:27<05:50, 87.68s/it][A
 20%|██        | 1/5 [01:27<05:51, 87.79s/it][A
 20%|██        | 1/5 [01:27<05:51, 87.79s/it][A
 40%|████      | 2/5 [02:52<04:19, 86.34s/it][A[2024-04-02 06:37:33,897] [INFO] [logging.py:96:log_dist] [Rank 0] step=2272, skipped=0, lr=[4.657884486123937e-06], mom=[(0.9, 0.999)]
steps: 2272 loss: 2.0156 iter time (s): 85.767 samples/sec: 1.492

 40%|████      | 2/5 [02:53<04:20, 86.83s/it][A
 40%|████      | 2/5 [02:53<04:20, 86.85s/it][A
 40%|████      | 2/5 [02:54<04:20, 86.98s/it][A
 40%|████      | 2/5 [02:53<04:20, 86.86s/it][A
 40%|████      | 2/5 [02:54<04:20, 86.92s/it][A
 40%|████      | 2/5 [02:54<04:20, 86.97s/it][A
 40%|████      | 2/5 [02:54<04:20, 86.98s/it][A
 60%|██████    | 3/5 [04:19<02:53, 86.78s/it][A[2024-04-02 06:39:01,197] [INFO] [logging.py:96:log_dist] [Rank 0] step=2273, skipped=0, lr=[4.7584514639709895e-06], mom=[(0.9, 0.999)]
steps: 2273 loss: 2.0319 iter time (s): 86.696 samples/sec: 1.476

 60%|██████    | 3/5 [04:21<02:54, 87.09s/it][A
 60%|██████    | 3/5 [04:21<02:54, 87.07s/it][A
 60%|██████    | 3/5 [04:21<02:54, 87.11s/it][A
 60%|██████    | 3/5 [04:21<02:54, 87.08s/it][A
 60%|██████    | 3/5 [04:21<02:54, 87.10s/it][A
 60%|██████    | 3/5 [04:21<02:54, 87.13s/it][A
 60%|██████    | 3/5 [04:21<02:54, 87.14s/it][A
 80%|████████  | 4/5 [05:47<01:27, 87.16s/it][A[2024-04-02 06:40:28,953] [INFO] [logging.py:96:log_dist] [Rank 0] step=2274, skipped=0, lr=[4.860110650899512e-06], mom=[(0.9, 0.999)]
steps: 2274 loss: 2.0896 iter time (s): 87.091 samples/sec: 1.470

 80%|████████  | 4/5 [05:48<01:27, 87.33s/it][A
 80%|████████  | 4/5 [05:49<01:27, 87.37s/it][A
 80%|████████  | 4/5 [05:49<01:27, 87.39s/it][A
 80%|████████  | 4/5 [05:49<01:27, 87.37s/it][A
 80%|████████  | 4/5 [05:49<01:27, 87.38s/it][A
 80%|████████  | 4/5 [05:49<01:27, 87.39s/it][A
 80%|████████  | 4/5 [05:49<01:27, 87.39s/it][A
100%|██████████| 5/5 [07:16<00:00, 87.77s/it][A100%|██████████| 5/5 [07:16<00:00, 87.31s/it]
[2024-04-02 06:41:57,788] [INFO] [logging.py:96:log_dist] [Rank 0] step=2275, skipped=0, lr=[4.962861822732431e-06], mom=[(0.9, 0.999)]
steps: 2275 loss: 2.1081 iter time (s): 88.135 samples/sec: 1.452

100%|██████████| 5/5 [07:17<00:00, 87.86s/it][A100%|██████████| 5/5 [07:17<00:00, 87.55s/it]

100%|██████████| 5/5 [07:17<00:00, 87.85s/it][A100%|██████████| 5/5 [07:17<00:00, 87.56s/it]

100%|██████████| 5/5 [07:18<00:00, 87.91s/it][A100%|██████████| 5/5 [07:18<00:00, 87.62s/it]

100%|██████████| 5/5 [07:17<00:00, 87.88s/it][A100%|██████████| 5/5 [07:17<00:00, 87.59s/it]

100%|██████████| 5/5 [07:17<00:00, 87.90s/it][A100%|██████████| 5/5 [07:17<00:00, 87.59s/it]

100%|██████████| 5/5 [07:18<00:00, 87.91s/it][A100%|██████████| 5/5 [07:18<00:00, 87.63s/it]

100%|██████████| 5/5 [07:18<00:00, 87.91s/it][A100%|██████████| 5/5 [07:18<00:00, 87.63s/it]
Checkpointing at shard 20
[2024-04-02 06:42:02,950] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step2275 is about to be saved!
[2024-04-02 06:42:03,402] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_00-model_states.pt...
[2024-04-02 06:42:05,971] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_00-model_states.pt.
[2024-04-02 06:42:11,446] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_08-model_states.pt...
[2024-04-02 06:42:13,190] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_05-model_states.pt...
[2024-04-02 06:42:14,313] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_02-model_states.pt...
[2024-04-02 06:42:15,283] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_06-model_states.pt...
[2024-04-02 06:42:15,478] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_07-model_states.pt...
[2024-04-02 06:42:15,844] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_03-model_states.pt...
[2024-04-02 06:42:16,134] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_04-model_states.pt...
[2024-04-02 06:42:16,461] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_01-model_states.pt...
[2024-04-02 06:48:05,493] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_04-model_states.pt.
[2024-04-02 06:48:06,491] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_03_model_states.pt...
[2024-04-02 06:48:06,576] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_03_model_states.pt.
[2024-04-02 06:48:06,576] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step2275 is ready now!
[2024-04-02 06:48:22,163] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_06-model_states.pt.
[2024-04-02 06:48:22,924] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_05_model_states.pt...
[2024-04-02 06:48:22,939] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_05_model_states.pt.
[2024-04-02 06:48:22,939] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step2275 is ready now!
[2024-04-02 06:48:52,764] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_02-model_states.pt.
[2024-04-02 06:48:52,764] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_01-model_states.pt.
[2024-04-02 06:48:52,766] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_03-model_states.pt.
[2024-04-02 06:48:52,766] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_05-model_states.pt.
[2024-04-02 06:48:52,781] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_07-model_states.pt.
[2024-04-02 06:48:52,789] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_08-model_states.pt.
[2024-04-02 06:48:53,810] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_09-model_states.pt...
[2024-04-02 06:48:54,149] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_00_model_states.pt
[2024-04-02 06:48:54,149] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_00_model_states.pt...
[2024-04-02 06:48:54,396] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_04_model_states.pt...
[2024-04-02 06:48:54,466] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_04_model_states.pt.
[2024-04-02 06:48:54,466] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step2275 is ready now!
[2024-04-02 06:48:54,727] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_01_model_states.pt
[2024-04-02 06:48:54,727] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_01_model_states.pt...
[2024-04-02 06:48:54,735] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_00_model_states.pt.
[2024-04-02 06:48:54,735] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step2275 is ready now!
[2024-04-02 06:48:54,739] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_01_model_states.pt.
[2024-04-02 06:48:54,739] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step2275 is ready now!
[2024-04-02 06:48:54,798] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_02_model_states.pt...
[2024-04-02 06:48:54,809] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_02_model_states.pt.
[2024-04-02 06:48:54,809] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step2275 is ready now!
[2024-04-02 06:48:54,868] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/layer_09-model_states.pt.
[2024-04-02 06:48:54,875] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_07_model_states.pt...
[2024-04-02 06:48:54,876] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_07_model_states.pt.
[2024-04-02 06:48:54,876] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step2275 is ready now!
[2024-04-02 06:48:55,184] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_06_model_states.pt...
[2024-04-02 06:48:55,189] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/checkpoint/global_step2275/mp_rank_06_model_states.pt.
[2024-04-02 06:48:55,189] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step2275 is ready now!
Checkpoint saved using --- 416.6969380378723 seconds ---
  5%|▍         | 20/437 [2:25:20<66:03:49, 570.33s/it]  5%|▍         | 20/437 [2:25:49<65:58:58, 569.64s/it]  5%|▍         | 20/437 [2:26:04<65:58:54, 569.63s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_20
  5%|▍         | 20/437 [2:26:06<65:59:16, 569.68s/it]  5%|▍         | 20/437 [2:25:39<65:58:51, 569.62s/it]  5%|▍         | 20/437 [2:25:39<65:58:58, 569.64s/it]  5%|▍         | 20/437 [2:25:34<65:59:33, 569.72s/it]  5%|▍         | 20/437 [2:25:25<65:59:16, 569.68s/it]Training on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:26<05:44, 86.09s/it][A[2024-04-02 06:50:26,673] [INFO] [logging.py:96:log_dist] [Rank 0] step=2276, skipped=0, lr=[5.066704752884399e-06], mom=[(0.9, 0.999)]
steps: 2276 loss: 2.0706 iter time (s): 87.597 samples/sec: 1.461

 20%|██        | 1/5 [01:26<05:46, 86.68s/it][A
 20%|██        | 1/5 [01:27<05:48, 87.00s/it][A
 20%|██        | 1/5 [01:28<05:52, 88.08s/it][A
 20%|██        | 1/5 [01:28<05:52, 88.15s/it][A
 20%|██        | 1/5 [01:28<05:52, 88.24s/it][A
 20%|██        | 1/5 [01:28<05:53, 88.31s/it][A
 20%|██        | 1/5 [01:28<05:53, 88.36s/it][A
 40%|████      | 2/5 [02:54<04:22, 87.51s/it][A[2024-04-02 06:51:55,545] [INFO] [logging.py:96:log_dist] [Rank 0] step=2277, skipped=0, lr=[5.171639212362564e-06], mom=[(0.9, 0.999)]
steps: 2277 loss: 2.0478 iter time (s): 88.127 samples/sec: 1.452

 40%|████      | 2/5 [02:55<04:23, 87.95s/it][A
 40%|████      | 2/5 [02:55<04:24, 88.09s/it][A
 40%|████      | 2/5 [02:56<04:25, 88.52s/it][A
 40%|████      | 2/5 [02:57<04:25, 88.59s/it][A
 40%|████      | 2/5 [02:57<04:25, 88.59s/it][A
 40%|████      | 2/5 [02:57<04:26, 88.68s/it][A
 40%|████      | 2/5 [02:57<04:26, 88.68s/it][A
 60%|██████    | 3/5 [04:23<02:56, 88.34s/it][A[2024-04-02 06:53:24,877] [INFO] [logging.py:96:log_dist] [Rank 0] step=2278, skipped=0, lr=[5.277664969767245e-06], mom=[(0.9, 0.999)]
steps: 2278 loss: 2.0724 iter time (s): 88.558 samples/sec: 1.445

 60%|██████    | 3/5 [04:24<02:57, 88.57s/it][A
 60%|██████    | 3/5 [04:25<02:57, 88.67s/it][A
 60%|██████    | 3/5 [04:26<02:57, 88.92s/it][A
 60%|██████    | 3/5 [04:26<02:57, 88.92s/it][A
 60%|██████    | 3/5 [04:26<02:57, 88.93s/it][A
 60%|██████    | 3/5 [04:26<02:57, 88.94s/it][A
 60%|██████    | 3/5 [04:26<02:57, 88.95s/it][A
 80%|████████  | 4/5 [05:51<01:28, 88.17s/it][A[2024-04-02 06:54:52,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=2279, skipped=0, lr=[5.3847817912920335e-06], mom=[(0.9, 0.999)]
steps: 2279 loss: 2.0795 iter time (s): 87.202 samples/sec: 1.468

 80%|████████  | 4/5 [05:52<01:28, 88.31s/it][A
 80%|████████  | 4/5 [05:53<01:28, 88.36s/it][A
 80%|████████  | 4/5 [05:54<01:28, 88.50s/it][A
 80%|████████  | 4/5 [05:54<01:28, 88.52s/it][A
 80%|████████  | 4/5 [05:54<01:28, 88.53s/it][A
 80%|████████  | 4/5 [05:54<01:28, 88.52s/it][A
 80%|████████  | 4/5 [05:54<01:28, 88.53s/it][A
100%|██████████| 5/5 [07:19<00:00, 87.96s/it][A100%|██████████| 5/5 [07:19<00:00, 87.89s/it]
  5%|▍         | 21/437 [2:32:43<61:30:10, 532.24s/it][2024-04-02 06:56:20,375] [INFO] [logging.py:96:log_dist] [Rank 0] step=2280, skipped=0, lr=[5.492989440724637e-06], mom=[(0.9, 0.999)]
steps: 2280 loss: 2.1122 iter time (s): 86.885 samples/sec: 1.473

100%|██████████| 5/5 [07:20<00:00, 88.08s/it][A100%|██████████| 5/5 [07:20<00:00, 88.14s/it]
  5%|▍         | 21/437 [2:32:51<61:31:36, 532.44s/it]
100%|██████████| 5/5 [07:20<00:00, 88.13s/it][A100%|██████████| 5/5 [07:20<00:00, 88.11s/it]
  5%|▍         | 21/437 [2:33:00<61:32:04, 532.51s/it]
100%|██████████| 5/5 [07:21<00:00, 88.21s/it][A100%|██████████| 5/5 [07:21<00:00, 88.37s/it]
  5%|▍         | 21/437 [2:33:32<61:31:56, 532.49s/it]
100%|██████████| 5/5 [07:21<00:00, 88.22s/it][A100%|██████████| 5/5 [07:21<00:00, 88.39s/it]
  5%|▍         | 21/437 [2:33:05<61:32:04, 532.51s/it]
100%|██████████| 5/5 [07:21<00:00, 88.22s/it][A100%|██████████| 5/5 [07:21<00:00, 88.40s/it]
  5%|▍         | 21/437 [2:33:15<61:32:05, 532.51s/it]
100%|██████████| 5/5 [07:22<00:00, 88.22s/it][A100%|██████████| 5/5 [07:22<00:00, 88.41s/it]
  5%|▍         | 21/437 [2:33:05<61:32:04, 532.51s/it]
100%|██████████| 5/5 [07:22<00:00, 88.23s/it][A100%|██████████| 5/5 [07:22<00:00, 88.43s/it]
  5%|▍         | 21/437 [2:33:30<61:32:11, 532.53s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_21

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:27<05:48, 87.21s/it][A[2024-04-02 06:57:52,096] [INFO] [logging.py:96:log_dist] [Rank 0] step=2281, skipped=0, lr=[5.60228767944731e-06], mom=[(0.9, 0.999)]
steps: 2281 loss: 1.9569 iter time (s): 86.360 samples/sec: 1.482

 20%|██        | 1/5 [01:27<05:51, 87.95s/it][A
 20%|██        | 1/5 [01:28<05:52, 88.03s/it][A
 20%|██        | 1/5 [01:28<05:54, 88.52s/it][A
 20%|██        | 1/5 [01:28<05:52, 88.12s/it][A
 20%|██        | 1/5 [01:28<05:52, 88.22s/it][A
 20%|██        | 1/5 [01:27<05:49, 87.29s/it][A
 20%|██        | 1/5 [01:28<05:54, 88.54s/it][A
 40%|████      | 2/5 [02:54<04:21, 87.32s/it][A[2024-04-02 06:59:19,499] [INFO] [logging.py:96:log_dist] [Rank 0] step=2282, skipped=0, lr=[5.7126762664372e-06], mom=[(0.9, 0.999)]
steps: 2282 loss: 2.0990 iter time (s): 86.799 samples/sec: 1.475

 40%|████      | 2/5 [02:55<04:23, 87.77s/it][A
 40%|████      | 2/5 [02:55<04:23, 87.79s/it][A
 40%|████      | 2/5 [02:56<04:24, 88.02s/it][A
 40%|████      | 2/5 [02:55<04:23, 87.88s/it][A
 40%|████      | 2/5 [02:55<04:23, 87.90s/it][A
 40%|████      | 2/5 [02:55<04:22, 87.59s/it][A
 40%|████      | 2/5 [02:56<04:24, 88.16s/it][A
 60%|██████    | 3/5 [04:22<02:55, 87.60s/it][A[2024-04-02 07:00:47,417] [INFO] [logging.py:96:log_dist] [Rank 0] step=2283, skipped=0, lr=[5.824154958267223e-06], mom=[(0.9, 0.999)]
steps: 2283 loss: 2.1452 iter time (s): 86.850 samples/sec: 1.474

 60%|██████    | 3/5 [04:23<02:55, 87.73s/it][A
 60%|██████    | 3/5 [04:23<02:55, 87.77s/it][A
 60%|██████    | 3/5 [04:23<02:55, 87.86s/it][A
 60%|██████    | 3/5 [04:23<02:55, 87.77s/it][A
 60%|██████    | 3/5 [04:23<02:55, 87.77s/it][A
 60%|██████    | 3/5 [04:22<02:55, 87.55s/it][A
 60%|██████    | 3/5 [04:23<02:55, 87.82s/it][A
 80%|████████  | 4/5 [05:50<01:27, 87.64s/it][A[2024-04-02 07:02:15,078] [INFO] [logging.py:96:log_dist] [Rank 0] step=2284, skipped=0, lr=[5.936723509106353e-06], mom=[(0.9, 0.999)]
steps: 2284 loss: 2.1958 iter time (s): 86.992 samples/sec: 1.471

 80%|████████  | 4/5 [05:50<01:27, 87.71s/it][A
 80%|████████  | 4/5 [05:50<01:27, 87.70s/it][A
 80%|████████  | 4/5 [05:51<01:27, 87.81s/it][A
 80%|████████  | 4/5 [05:51<01:27, 87.73s/it][A
 80%|████████  | 4/5 [05:51<01:27, 87.71s/it][A
 80%|████████  | 4/5 [05:51<01:27, 87.75s/it][A
 80%|████████  | 4/5 [05:50<01:27, 87.60s/it][A
100%|██████████| 5/5 [07:17<00:00, 87.61s/it][A100%|██████████| 5/5 [07:17<00:00, 87.56s/it]
  5%|▌         | 22/437 [2:40:06<58:14:39, 505.25s/it][2024-04-02 07:03:42,693] [INFO] [logging.py:96:log_dist] [Rank 0] step=2285, skipped=0, lr=[6.050381670720115e-06], mom=[(0.9, 0.999)]
steps: 2285 loss: 2.1013 iter time (s): 86.948 samples/sec: 1.472

100%|██████████| 5/5 [07:18<00:00, 87.69s/it][A100%|██████████| 5/5 [07:18<00:00, 87.72s/it]
  5%|▌         | 22/437 [2:40:22<58:15:33, 505.38s/it]
100%|██████████| 5/5 [07:18<00:00, 87.70s/it][A100%|██████████| 5/5 [07:18<00:00, 87.74s/it]
  5%|▌         | 22/437 [2:40:13<58:15:38, 505.39s/it]
100%|██████████| 5/5 [07:19<00:00, 87.70s/it][A100%|██████████| 5/5 [07:19<00:00, 87.82s/it]
  5%|▌         | 22/437 [2:40:54<58:15:39, 505.40s/it]
100%|██████████| 5/5 [07:18<00:00, 87.68s/it][A100%|██████████| 5/5 [07:18<00:00, 87.75s/it]
  5%|▌         | 22/437 [2:40:37<58:15:42, 505.40s/it]
100%|██████████| 5/5 [07:18<00:00, 87.71s/it][A100%|██████████| 5/5 [07:18<00:00, 87.76s/it]
  5%|▌         | 22/437 [2:40:27<58:15:46, 505.41s/it]
100%|██████████| 5/5 [07:17<00:00, 87.60s/it][A100%|██████████| 5/5 [07:17<00:00, 87.57s/it]
  5%|▌         | 22/437 [2:40:52<58:15:43, 505.41s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_22

100%|██████████| 5/5 [07:19<00:00, 87.70s/it][A100%|██████████| 5/5 [07:19<00:00, 87.82s/it]
  5%|▌         | 22/437 [2:40:27<58:15:44, 505.41s/it]
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:26<05:47, 86.77s/it][A[2024-04-02 07:05:14,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=2286, skipped=0, lr=[6.165129192471415e-06], mom=[(0.9, 0.999)]
steps: 2286 loss: 1.9568 iter time (s): 87.285 samples/sec: 1.466

 20%|██        | 1/5 [01:28<05:53, 88.28s/it][A
 20%|██        | 1/5 [01:28<05:52, 88.14s/it][A
 20%|██        | 1/5 [01:28<05:54, 88.54s/it][A
 20%|██        | 1/5 [01:28<05:53, 88.44s/it][A
 20%|██        | 1/5 [01:27<05:50, 87.73s/it][A
 20%|██        | 1/5 [01:28<05:53, 88.50s/it][A
 20%|██        | 1/5 [01:28<05:53, 88.38s/it][A
 40%|████      | 2/5 [02:54<04:22, 87.52s/it][A[2024-04-02 07:06:42,060] [INFO] [logging.py:96:log_dist] [Rank 0] step=2287, skipped=0, lr=[6.28096582132077e-06], mom=[(0.9, 0.999)]
steps: 2287 loss: 2.1595 iter time (s): 87.074 samples/sec: 1.470

 40%|████      | 2/5 [02:56<04:24, 88.02s/it][A
 40%|████      | 2/5 [02:55<04:23, 87.92s/it][A
 40%|████      | 2/5 [02:56<04:24, 88.11s/it][A
 40%|████      | 2/5 [02:55<04:23, 87.74s/it][A
 40%|████      | 2/5 [02:56<04:24, 88.06s/it][A
 40%|████      | 2/5 [02:56<04:24, 88.08s/it][A
 40%|████      | 2/5 [02:56<04:24, 88.02s/it][A
 60%|██████    | 3/5 [04:23<02:55, 87.92s/it][A[2024-04-02 07:08:10,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=2288, skipped=0, lr=[6.397891301827133e-06], mom=[(0.9, 0.999)]
steps: 2288 loss: 2.0217 iter time (s): 87.675 samples/sec: 1.460

 60%|██████    | 3/5 [04:24<02:56, 88.18s/it][A
 60%|██████    | 3/5 [04:24<02:56, 88.10s/it][A
 60%|██████    | 3/5 [04:24<02:56, 88.19s/it][A
 60%|██████    | 3/5 [04:23<02:56, 88.02s/it][A
 60%|██████    | 3/5 [04:24<02:56, 88.19s/it][A
 60%|██████    | 3/5 [04:24<02:56, 88.20s/it][A
 60%|██████    | 3/5 [04:24<02:56, 88.18s/it][A
 80%|████████  | 4/5 [05:51<01:27, 87.89s/it][A[2024-04-02 07:09:38,287] [INFO] [logging.py:96:log_dist] [Rank 0] step=2289, skipped=0, lr=[6.515905376148231e-06], mom=[(0.9, 0.999)]
steps: 2289 loss: 1.9511 iter time (s): 87.156 samples/sec: 1.469

 80%|████████  | 4/5 [05:52<01:28, 88.05s/it][A
 80%|████████  | 4/5 [05:52<01:27, 87.99s/it][A
 80%|████████  | 4/5 [05:52<01:28, 88.07s/it][A
 80%|████████  | 4/5 [05:51<01:27, 87.95s/it][A
 80%|████████  | 4/5 [05:52<01:28, 88.06s/it][A
 80%|████████  | 4/5 [05:52<01:28, 88.06s/it][A
 80%|████████  | 4/5 [05:52<01:28, 88.04s/it][A
100%|██████████| 5/5 [07:18<00:00, 87.73s/it][A100%|██████████| 5/5 [07:18<00:00, 87.70s/it]
  5%|▌         | 23/437 [2:47:29<55:57:27, 486.59s/it][2024-04-02 07:11:05,745] [INFO] [logging.py:96:log_dist] [Rank 0] step=2290, skipped=0, lr=[6.6350077840413406e-06], mom=[(0.9, 0.999)]
steps: 2290 loss: 1.9826 iter time (s): 86.784 samples/sec: 1.475

100%|██████████| 5/5 [07:19<00:00, 87.81s/it][A100%|██████████| 5/5 [07:19<00:00, 87.94s/it]
  5%|▌         | 23/437 [2:47:45<55:57:50, 486.64s/it]
100%|██████████| 5/5 [07:19<00:00, 87.78s/it][A100%|██████████| 5/5 [07:19<00:00, 87.89s/it]
  5%|▌         | 23/437 [2:47:36<55:57:58, 486.66s/it]
100%|██████████| 5/5 [07:19<00:00, 87.82s/it][A100%|██████████| 5/5 [07:19<00:00, 87.98s/it]
  5%|▌         | 23/437 [2:48:17<55:58:03, 486.67s/it]
100%|██████████| 5/5 [07:19<00:00, 87.74s/it][A100%|██████████| 5/5 [07:19<00:00, 87.81s/it]
  5%|▌         | 23/437 [2:47:50<55:57:56, 486.66s/it]
100%|██████████| 5/5 [07:19<00:00, 87.82s/it][A100%|██████████| 5/5 [07:19<00:00, 87.96s/it]
  5%|▌         | 23/437 [2:48:00<55:58:05, 486.68s/it]
100%|██████████| 5/5 [07:19<00:00, 87.81s/it][A100%|██████████| 5/5 [07:19<00:00, 87.97s/it]
  5%|▌         | 23/437 [2:47:50<55:58:03, 486.67s/it]
100%|██████████| 5/5 [07:19<00:00, 87.80s/it][A100%|██████████| 5/5 [07:19<00:00, 87.94s/it]
  5%|▌         | 23/437 [2:48:15<55:58:04, 486.68s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-Pretrain_processed_dataset/shard_23

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/5 [00:00<?, ?it/s][A
  0%|          | 0/5 [00:00<?, ?it/s][A
 20%|██        | 1/5 [01:26<05:47, 86.97s/it][A[2024-04-02 07:12:37,321] [INFO] [logging.py:96:log_dist] [Rank 0] step=2291, skipped=0, lr=[6.755198262863731e-06], mom=[(0.9, 0.999)]
steps: 2291 loss: 1.9880 iter time (s): 86.743 samples/sec: 1.476

 20%|██        | 1/5 [01:28<05:52, 88.24s/it][A
 20%|██        | 1/5 [01:28<05:52, 88.17s/it][A
 20%|██        | 1/5 [01:28<05:54, 88.53s/it][A
 20%|██        | 1/5 [01:27<05:49, 87.40s/it][A
 20%|██        | 1/5 [01:28<05:53, 88.35s/it][A
 20%|██        | 1/5 [01:28<05:54, 88.53s/it][A
 20%|██        | 1/5 [01:27<05:50, 87.60s/it][A
 40%|████      | 2/5 [02:54<04:21, 87.20s/it][A[2024-04-02 07:14:04,670] [INFO] [logging.py:96:log_dist] [Rank 0] step=2292, skipped=0, lr=[6.876476547573163e-06], mom=[(0.9, 0.999)]
steps: 2292 loss: 2.0315 iter time (s): 86.648 samples/sec: 1.477

 40%|████      | 2/5 [02:55<04:23, 87.78s/it][A
 40%|████      | 2/5 [02:55<04:23, 87.70s/it][A
 40%|████      | 2/5 [02:55<04:23, 87.85s/it][A
 40%|████      | 2/5 [02:54<04:22, 87.41s/it][A
 40%|████      | 2/5 [02:55<04:23, 87.80s/it][A
 40%|████      | 2/5 [02:55<04:23, 87.85s/it][A
 40%|████      | 2/5 [02:54<04:22, 87.48s/it][A
 60%|██████    | 3/5 [04:22<02:55, 87.63s/it][A[2024-04-02 07:15:32,811] [INFO] [logging.py:96:log_dist] [Rank 0] step=2293, skipped=0, lr=[6.998842370728782e-06], mom=[(0.9, 0.999)]
steps: 2293 loss: 2.1465 iter time (s): 87.429 samples/sec: 1.464

 60%|██████    | 3/5 [04:23<02:55, 87.94s/it][A
 60%|██████    | 3/5 [04:23<02:55, 87.92s/it][A
 60%|██████    | 3/5 [04:24<02:55, 87.98s/it][A
 60%|██████    | 3/5 [04:22<02:55, 87.76s/it][A
 60%|██████    | 3/5 [04:23<02:55, 87.95s/it][A
 60%|██████    | 3/5 [04:23<02:55, 87.78s/it][A
 60%|██████    | 3/5 [04:24<02:56, 88.01s/it][A
 80%|████████  | 4/5 [05:49<01:27, 87.50s/it][A[2024-04-02 07:17:00,134] [INFO] [logging.py:96:log_dist] [Rank 0] step=2294, skipped=0, lr=[7.122295462491387e-06], mom=[(0.9, 0.999)]
steps: 2294 loss: 1.9881 iter time (s): 86.569 samples/sec: 1.479

 80%|████████  | 4/5 [05:51<01:27, 87.67s/it][A
 80%|████████  | 4/5 [05:50<01:27, 87.66s/it][A
 80%|████████  | 4/5 [05:51<01:27, 87.70s/it][A
 80%|████████  | 4/5 [05:50<01:27, 87.54s/it][A
 80%|████████  | 4/5 [05:51<01:27, 87.68s/it][A
 80%|████████  | 4/5 [05:50<01:27, 87.57s/it][A
 80%|████████  | 4/5 [05:51<01:27, 87.70s/it][A