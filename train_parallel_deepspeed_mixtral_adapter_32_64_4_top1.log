[2024-07-15 06:49:33,452] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-15 06:49:37,352] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-07-15 06:49:37,352] [INFO] [runner.py:568:main] cmd = /home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgMywgNCwgNSwgNiwgN119 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None llava/train_parallel_deepspeed_mixtral_adapter_r.py --num_stages=8 --shared_routing_adapter_num_experts=4 --shared_routing_adapter_num_experts_per_tok=1 --shared_routing_adapter_type=Parallel_Adapter --hidden_dim=32 --save_model_shard=10 --skip_shard=0 --checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint
[2024-07-15 06:49:40,816] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-15 06:49:42,425] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]}
[2024-07-15 06:49:42,425] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=8, node_rank=0
[2024-07-15 06:49:42,425] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]})
[2024-07-15 06:49:42,425] [INFO] [launch.py:163:main] dist_world_size=8
[2024-07-15 06:49:42,425] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
[2024-07-15 06:49:42,435] [INFO] [launch.py:253:main] process 1112168 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_adapter_r.py', '--local_rank=0', '--num_stages=8', '--shared_routing_adapter_num_experts=4', '--shared_routing_adapter_num_experts_per_tok=1', '--shared_routing_adapter_type=Parallel_Adapter', '--hidden_dim=32', '--save_model_shard=10', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint']
[2024-07-15 06:49:42,444] [INFO] [launch.py:253:main] process 1112170 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_adapter_r.py', '--local_rank=1', '--num_stages=8', '--shared_routing_adapter_num_experts=4', '--shared_routing_adapter_num_experts_per_tok=1', '--shared_routing_adapter_type=Parallel_Adapter', '--hidden_dim=32', '--save_model_shard=10', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint']
[2024-07-15 06:49:42,454] [INFO] [launch.py:253:main] process 1112171 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_adapter_r.py', '--local_rank=2', '--num_stages=8', '--shared_routing_adapter_num_experts=4', '--shared_routing_adapter_num_experts_per_tok=1', '--shared_routing_adapter_type=Parallel_Adapter', '--hidden_dim=32', '--save_model_shard=10', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint']
[2024-07-15 06:49:42,473] [INFO] [launch.py:253:main] process 1112172 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_adapter_r.py', '--local_rank=3', '--num_stages=8', '--shared_routing_adapter_num_experts=4', '--shared_routing_adapter_num_experts_per_tok=1', '--shared_routing_adapter_type=Parallel_Adapter', '--hidden_dim=32', '--save_model_shard=10', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint']
[2024-07-15 06:49:42,489] [INFO] [launch.py:253:main] process 1112173 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_adapter_r.py', '--local_rank=4', '--num_stages=8', '--shared_routing_adapter_num_experts=4', '--shared_routing_adapter_num_experts_per_tok=1', '--shared_routing_adapter_type=Parallel_Adapter', '--hidden_dim=32', '--save_model_shard=10', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint']
[2024-07-15 06:49:42,504] [INFO] [launch.py:253:main] process 1112174 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_adapter_r.py', '--local_rank=5', '--num_stages=8', '--shared_routing_adapter_num_experts=4', '--shared_routing_adapter_num_experts_per_tok=1', '--shared_routing_adapter_type=Parallel_Adapter', '--hidden_dim=32', '--save_model_shard=10', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint']
[2024-07-15 06:49:42,520] [INFO] [launch.py:253:main] process 1112176 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_adapter_r.py', '--local_rank=6', '--num_stages=8', '--shared_routing_adapter_num_experts=4', '--shared_routing_adapter_num_experts_per_tok=1', '--shared_routing_adapter_type=Parallel_Adapter', '--hidden_dim=32', '--save_model_shard=10', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint']
[2024-07-15 06:49:42,530] [INFO] [launch.py:253:main] process 1112177 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_adapter_r.py', '--local_rank=7', '--num_stages=8', '--shared_routing_adapter_num_experts=4', '--shared_routing_adapter_num_experts_per_tok=1', '--shared_routing_adapter_type=Parallel_Adapter', '--hidden_dim=32', '--save_model_shard=10', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint']
[2024-07-15 06:49:48,183] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-15 06:49:48,536] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-15 06:49:48,567] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-15 06:49:48,907] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-07-15 06:49:49,230] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-07-15 06:49:49,322] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-07-15 06:49:54,859] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-15 06:49:54,874] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-15 06:49:55,548] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-07-15 06:49:55,603] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-07-15 06:50:00,808] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-15 06:50:00,845] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-07-15 06:50:01,502] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-07-15 06:50:01,502] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-07-15 06:50:01,531] [INFO] [comm.py:637:init_distributed] cdb=None
Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:00<00:12,  1.48it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:23,  1.25s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:01<00:16,  1.11it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:22,  1.19s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:23,  1.22s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:29,  1.54s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:29,  1.53s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:03<00:19,  1.17s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:26,  1.48s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:25,  1.41s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:27,  1.52s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:27,  1.53s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:27,  1.55s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:04<00:20,  1.27s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:23,  1.36s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:27,  1.60s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:26,  1.56s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:28,  1.67s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:27,  1.63s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:06<00:19,  1.33s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:05<00:22,  1.39s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:06<00:25,  1.62s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:06<00:25,  1.58s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:06<00:26,  1.65s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:07<00:19,  1.41s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:07<00:21,  1.45s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:06<00:27,  1.70s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:07<00:21,  1.43s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:08<00:25,  1.67s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:09<00:18,  1.40s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:08<00:20,  1.45s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:08<00:27,  1.83s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:08<00:24,  1.67s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:09<00:22,  1.62s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:09<00:24,  1.73s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:10<00:17,  1.42s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:10<00:19,  1.53s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:10<00:24,  1.79s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:09<00:23,  1.65s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:11<00:22,  1.69s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:11<00:21,  1.66s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:11<00:15,  1.44s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:11<00:17,  1.45s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:11<00:21,  1.67s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:11<00:21,  1.66s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:12<00:15,  1.38s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:13<00:19,  1.66s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:13<00:14,  1.46s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:12<00:18,  1.52s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:13<00:21,  1.83s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:13<00:21,  1.75s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:14<00:14,  1.42s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:14<00:17,  1.59s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:14<00:13,  1.45s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:14<00:17,  1.60s/it][2024-07-15 06:50:21,079] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Loading checkpoint shards:  45%|████▌     | 9/20 [00:15<00:19,  1.77s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:16<00:11,  1.41s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:15<00:12,  1.40s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:15<00:19,  1.74s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:15<00:15,  1.56s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:16<00:17,  1.75s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:16<00:17,  1.70s/it][2024-07-15 06:50:23,332] [INFO] [comm.py:637:init_distributed] cdb=None
Loading checkpoint shards:  65%|██████▌   | 13/20 [00:17<00:09,  1.40s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:17<00:11,  1.42s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:16<00:17,  1.71s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:17<00:14,  1.56s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:18<00:16,  1.78s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:18<00:15,  1.74s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:18<00:09,  1.43s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:18<00:12,  1.50s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:18<00:14,  1.63s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:19<00:09,  1.58s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:20<00:09,  1.59s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:20<00:14,  1.86s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:20<00:11,  1.61s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:20<00:15,  1.93s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:21<00:08,  1.77s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:21<00:16,  2.00s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:22<00:12,  1.86s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:22<00:12,  1.85s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:22<00:08,  1.72s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:22<00:10,  1.72s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:23<00:07,  1.84s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:23<00:14,  2.13s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:24<00:10,  1.83s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:24<00:06,  1.69s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:24<00:08,  1.70s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:24<00:11,  1.90s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:25<00:04,  1.66s/it]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:25<00:04,  1.66s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:26<00:09,  1.82s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:25<00:12,  2.05s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:26<00:03,  1.72s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:30,  1.61s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:26<00:10,  2.01s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:26<00:07,  1.93s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:02<00:45,  2.41s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:27<00:10,  2.11s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:28<00:03,  1.91s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:28<00:05,  1.84s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:28<00:01,  1.80s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:28<00:07,  1.99s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:28<00:08,  2.04s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:29<00:00,  1.57s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:29<00:00,  1.50s/it]
Some weights of LlavaForConditionalGeneration were not initialized from the model checkpoint at /home/vault/b207dd/b207dd11/llava-mixtral/llava-mixtral-pretrained-2/ and are newly initialized: ['language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter_gate.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Loading checkpoint shards:  10%|█         | 2/20 [00:04<00:41,  2.32s/it] ######################### trying init params ######################### 
Loading checkpoint shards:  10%|█         | 2/20 [00:04<00:37,  2.11s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:29<00:05,  1.80s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:30<00:03,  1.81s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:30<00:01,  1.95s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:30<00:08,  2.20s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:30<00:00,  1.58s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:30<00:00,  1.55s/it]
Some weights of LlavaForConditionalGeneration were not initialized from the model checkpoint at /home/vault/b207dd/b207dd11/llava-mixtral/llava-mixtral-pretrained-2/ and are newly initialized: ['language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter_gate.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
 ######################### trying init params ######################### 
Loading checkpoint shards:  85%|████████▌ | 17/20 [00:31<00:06,  2.15s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:06<00:32,  1.94s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:31<00:03,  1.90s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:06<00:40,  2.40s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:31<00:05,  2.00s/it]Convert trainable params: 34078720 || all params: 47061374976 || trainable%: 0.07
Print trainable params: 55058432 || all params: 47061374976 || trainable%: 0.12
Loading checkpoint shards:  95%|█████████▌| 19/20 [00:32<00:02,  2.09s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:28,  1.79s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:33<00:04,  2.21s/it]Convert trainable params: 34078720 || all params: 47061374976 || trainable%: 0.07
Print trainable params: 55058432 || all params: 47061374976 || trainable%: 0.12
Loading checkpoint shards:  95%|█████████▌| 19/20 [00:33<00:01,  1.90s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:08<00:34,  2.18s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:34<00:00,  1.81s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:34<00:00,  1.71s/it]
Some weights of LlavaForConditionalGeneration were not initialized from the model checkpoint at /home/vault/b207dd/b207dd11/llava-mixtral/llava-mixtral-pretrained-2/ and are newly initialized: ['language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter_gate.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:24,  1.66s/it] ######################### trying init params ######################### 
Loading checkpoint shards:  90%|█████████ | 18/20 [00:33<00:04,  2.07s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:34<00:00,  1.66s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:34<00:00,  1.75s/it]
Some weights of LlavaForConditionalGeneration were not initialized from the model checkpoint at /home/vault/b207dd/b207dd11/llava-mixtral/llava-mixtral-pretrained-2/ and are newly initialized: ['language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter_gate.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
 ######################### trying init params ######################### 
Loading checkpoint shards:  25%|██▌       | 5/20 [00:10<00:30,  2.04s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:10<00:21,  1.54s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:35<00:01,  1.87s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:35<00:02,  2.25s/it]Convert trainable params: 34078720 || all params: 47061374976 || trainable%: 0.07
Print trainable params: 55058432 || all params: 47061374976 || trainable%: 0.12
Loading checkpoint shards: 100%|██████████| 20/20 [00:36<00:00,  1.72s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:36<00:00,  1.82s/it]
Some weights of LlavaForConditionalGeneration were not initialized from the model checkpoint at /home/vault/b207dd/b207dd11/llava-mixtral/llava-mixtral-pretrained-2/ and are newly initialized: ['language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter_gate.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
 ######################### trying init params ######################### 
Loading checkpoint shards: 100%|██████████| 20/20 [00:36<00:00,  1.55s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:36<00:00,  1.80s/it]
Some weights of LlavaForConditionalGeneration were not initialized from the model checkpoint at /home/vault/b207dd/b207dd11/llava-mixtral/llava-mixtral-pretrained-2/ and are newly initialized: ['language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter_gate.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
 ######################### trying init params ######################### 
Loading checkpoint shards:  35%|███▌      | 7/20 [00:11<00:18,  1.44s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:25,  1.84s/it]Convert trainable params: 34078720 || all params: 47061374976 || trainable%: 0.07
Print trainable params: 55058432 || all params: 47061374976 || trainable%: 0.12
Loading checkpoint shards:  40%|████      | 8/20 [00:12<00:16,  1.34s/it]Convert trainable params: 34078720 || all params: 47061374976 || trainable%: 0.07
Print trainable params: 55058432 || all params: 47061374976 || trainable%: 0.12
Loading checkpoint shards:  35%|███▌      | 7/20 [00:13<00:24,  1.87s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:13<00:13,  1.25s/it]Convert trainable params: 34078720 || all params: 47061374976 || trainable%: 0.07
Print trainable params: 55058432 || all params: 47061374976 || trainable%: 0.12
Loading checkpoint shards:  50%|█████     | 10/20 [00:14<00:11,  1.13s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:15<00:20,  1.68s/it]Rank 5 initialized with CUDA_MEM (60881108992, 85100068864)
Deepspeed engine initializing at --- RANK 5 --- ...
Loading checkpoint shards:  55%|█████▌    | 11/20 [00:15<00:09,  1.03s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:16<00:16,  1.49s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:16<00:07,  1.11it/s]Rank 1 initialized with CUDA_MEM (60881108992, 85100068864)
Deepspeed engine initializing at --- RANK 1 --- ...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Loading checkpoint shards:  65%|██████▌   | 13/20 [00:16<00:05,  1.18it/s]Loading checkpoint shards:  50%|█████     | 10/20 [00:17<00:13,  1.38s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:17<00:04,  1.38it/s]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:17<00:03,  1.39it/s]Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Loading checkpoint shards:  80%|████████  | 16/20 [00:18<00:02,  1.63it/s]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:18<00:11,  1.32s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:18<00:01,  1.62it/s]Loading checkpoint shards:  60%|██████    | 12/20 [00:19<00:09,  1.23s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:19<00:01,  1.74it/s]ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 3.1449975967407227 seconds
[2024-07-15 06:50:51,434] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 1.8124535083770752 seconds
[2024-07-15 06:50:51,477] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading checkpoint shards:  95%|█████████▌| 19/20 [00:20<00:00,  1.68it/s]Rank 4 initialized with CUDA_MEM (60881108992, 85100068864)
Deepspeed engine initializing at --- RANK 4 --- ...
Loading checkpoint shards: 100%|██████████| 20/20 [00:20<00:00,  2.07it/s]Loading checkpoint shards: 100%|██████████| 20/20 [00:20<00:00,  1.01s/it]
Some weights of LlavaForConditionalGeneration were not initialized from the model checkpoint at /home/vault/b207dd/b207dd11/llava-mixtral/llava-mixtral-pretrained-2/ and are newly initialized: ['language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter_gate.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
 ######################### trying init params ######################### 
Loading checkpoint shards:  65%|██████▌   | 13/20 [00:20<00:08,  1.18s/it]Convert trainable params: 34078720 || all params: 47061374976 || trainable%: 0.07
Print trainable params: 55058432 || all params: 47061374976 || trainable%: 0.12
Rank 6 initialized with CUDA_MEM (60881108992, 85100068864)
Deepspeed engine initializing at --- RANK 6 --- ...
Loading checkpoint shards:  70%|███████   | 14/20 [00:21<00:06,  1.05s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:21<00:04,  1.14it/s]Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Rank 7 initialized with CUDA_MEM (60354723840, 85100068864)
Deepspeed engine initializing at --- RANK 7 --- ...
Loading checkpoint shards:  80%|████████  | 16/20 [00:22<00:03,  1.28it/s]Rank 2 initialized with CUDA_MEM (60881108992, 85100068864)
Deepspeed engine initializing at --- RANK 2 --- ...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Loading checkpoint shards:  85%|████████▌ | 17/20 [00:22<00:02,  1.43it/s]ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 1.3690545558929443 seconds
[2024-07-15 06:50:54,630] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 0.505246639251709 seconds
[2024-07-15 06:50:54,707] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading checkpoint shards:  90%|█████████ | 18/20 [00:23<00:01,  1.58it/s]Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Loading checkpoint shards:  95%|█████████▌| 19/20 [00:23<00:00,  1.81it/s]Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Loading checkpoint shards: 100%|██████████| 20/20 [00:23<00:00,  2.34it/s]Loading checkpoint shards: 100%|██████████| 20/20 [00:23<00:00,  1.20s/it]
Some weights of LlavaForConditionalGeneration were not initialized from the model checkpoint at /home/vault/b207dd/b207dd11/llava-mixtral/llava-mixtral-pretrained-2/ and are newly initialized: ['language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.0.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.1.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.10.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.11.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.12.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.13.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.14.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.15.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.16.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.17.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.18.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.19.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.2.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.20.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.21.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.22.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.23.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.24.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.25.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.26.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.27.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.28.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.29.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.3.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.30.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.31.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.4.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.5.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.6.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.7.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.8.block_sparse_moe.shared_routing_adapter_gate.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.0.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.1.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.2.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w1.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter.3.unit.adapter_w2.weight', 'language_model.model.layers.9.block_sparse_moe.shared_routing_adapter_gate.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
 ######################### trying init params ######################### 
Detected CUDA files, patching ldflags
Emitting ninja build file /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Loading extension module fused_adam...
Time to load fused_adam op: 0.8115401268005371 seconds
[2024-07-15 06:50:55,848] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Time to load fused_adam op: 0.6129708290100098 seconds
[2024-07-15 06:50:55,854] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Convert trainable params: 34078720 || all params: 47061374976 || trainable%: 0.07
Print trainable params: 55058432 || all params: 47061374976 || trainable%: 0.12
SEED_LAYERS=False BASE_SEED=1234 SEED_FN=None
Using topology: {ProcessCoord(pipe=0, data=0): 0, ProcessCoord(pipe=1, data=0): 1, ProcessCoord(pipe=2, data=0): 2, ProcessCoord(pipe=3, data=0): 3, ProcessCoord(pipe=4, data=0): 4, ProcessCoord(pipe=5, data=0): 5, ProcessCoord(pipe=6, data=0): 6, ProcessCoord(pipe=7, data=0): 7}
[2024-07-15 06:50:55,911] [INFO] [module.py:375:_partition_layers] Partitioning pipeline stages with method type:LanguageModelLayerWrapper
stage=0 layers=2
     0: LlavaMultiModalModuleWrapper
     1: LanguageModelLayerWrapper
stage=1 layers=1
     2: LanguageModelLayerWrapper
stage=2 layers=1
     3: LanguageModelLayerWrapper
stage=3 layers=1
     4: LanguageModelLayerWrapper
stage=4 layers=1
     5: LanguageModelLayerWrapper
stage=5 layers=1
     6: LanguageModelLayerWrapper
stage=6 layers=1
     7: LanguageModelLayerWrapper
stage=7 layers=2
     8: LanguageModelLayerWrapper
     9: LanguageModelFinalWrapper
  loss: loss_fn
Rank 3 initialized with CUDA_MEM (60881108992, 85100068864)
Deepspeed engine initializing at --- RANK 3 --- ...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.7238707542419434 seconds
[2024-07-15 06:50:57,845] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Rank 0 initialized with CUDA_MEM (59039809536, 85100068864)
Deepspeed engine initializing at --- RANK 0 --- ...
[2024-07-15 06:50:59,650] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
[2024-07-15 06:50:59,933] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.9153683185577393 seconds
[2024-07-15 06:51:01,305] [INFO] [logging.py:96:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adam as basic optimizer
[2024-07-15 06:51:01,305] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-07-15 06:51:01,316] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-07-15 06:51:01,316] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2024-07-15 06:51:01,317] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = WarmupCosineLR
[2024-07-15 06:51:01,317] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupCosineLR object at 0x149b709b4610>
[2024-07-15 06:51:01,317] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[2e-05], mom=[(0.9, 0.999)]
[2024-07-15 06:51:01,317] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-07-15 06:51:01,318] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-07-15 06:51:01,318] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-07-15 06:51:01,318] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-07-15 06:51:01,318] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-07-15 06:51:01,318] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-07-15 06:51:01,318] [INFO] [config.py:1000:print]   bfloat16_enabled ............. False
[2024-07-15 06:51:01,318] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-07-15 06:51:01,318] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-07-15 06:51:01,318] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-07-15 06:51:01,318] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-07-15 06:51:01,318] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x149b709ff460>
[2024-07-15 06:51:01,318] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 128
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 65536
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   loss_scale ................... 0
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=True, output_path='/home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint', job_name='deepspeed_monitor_logs') enabled=True
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   optimizer_name ............... adam
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   optimizer_params ............. {'lr': 2e-05}
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True, 'use_reentrant': False}
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   scheduler_name ............... WarmupCosineLR
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   scheduler_params ............. {'total_num_steps': 5718, 'warmup_min_ratio': 0.1, 'warmup_num_steps': 171.54}
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   steps_per_print .............. 1
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   train_batch_size ............. 128
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  1
[2024-07-15 06:51:01,319] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-07-15 06:51:01,320] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-07-15 06:51:01,320] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-07-15 06:51:01,320] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-07-15 06:51:01,320] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-07-15 06:51:01,320] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  False
[2024-07-15 06:51:01,320] [INFO] [config.py:1000:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-07-15 06:51:01,320] [INFO] [config.py:1000:print]   zero_enabled ................. False
[2024-07-15 06:51:01,320] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-07-15 06:51:01,320] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 0
[2024-07-15 06:51:01,320] [INFO] [config.py:986:print_user_config]   json = {
    "train_batch_size": 128, 
    "train_micro_batch_size_per_gpu": 1, 
    "gradient_accumulation_steps": 128, 
    "steps_per_print": 1, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 2e-05
        }
    }, 
    "scheduler": {
        "type": "WarmupCosineLR", 
        "params": {
            "total_num_steps": 5.718000e+03, 
            "warmup_min_ratio": 0.1, 
            "warmup_num_steps": 171.54
        }
    }, 
    "pipeline": {
        "use_reentrant": false
    }, 
    "csv_monitor": {
        "enabled": true, 
        "output_path": "/home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint", 
        "job_name": "deepspeed_monitor_logs"
    }
}
[2024-07-15 06:51:01,320] [INFO] [engine.py:101:__init__] CONFIG: micro_batches=128 micro_batch_size=1
[2024-07-15 06:51:01,320] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
[2024-07-15 06:51:05,535] [INFO] [engine.py:160:__init__] RANK=2 STAGE=2 LAYERS=1 [3, 4) STAGE_PARAMS=4259840 (4.260M) TOTAL_PARAMS=55058432 (55.058M) UNIQUE_PARAMS=55058432 (55.058M)
[2024-07-15 06:51:05,535] [INFO] [engine.py:160:__init__] RANK=6 STAGE=6 LAYERS=1 [7, 8) STAGE_PARAMS=4259840 (4.260M) TOTAL_PARAMS=55058432 (55.058M) UNIQUE_PARAMS=55058432 (55.058M)
[2024-07-15 06:51:05,535] [INFO] [engine.py:160:__init__] RANK=7 STAGE=7 LAYERS=2 [8, 10) STAGE_PARAMS=4259840 (4.260M) TOTAL_PARAMS=55058432 (55.058M) UNIQUE_PARAMS=55058432 (55.058M)
[2024-07-15 06:51:05,535] [INFO] [engine.py:160:__init__] RANK=0 STAGE=0 LAYERS=2 [0, 2) STAGE_PARAMS=25239552 (25.240M) TOTAL_PARAMS=55058432 (55.058M) UNIQUE_PARAMS=55058432 (55.058M)
[2024-07-15 06:51:05,535] [INFO] [engine.py:160:__init__] RANK=1 STAGE=1 LAYERS=1 [2, 3) STAGE_PARAMS=4259840 (4.260M) TOTAL_PARAMS=55058432 (55.058M) UNIQUE_PARAMS=55058432 (55.058M)
[2024-07-15 06:51:05,535] [INFO] [engine.py:160:__init__] RANK=5 STAGE=5 LAYERS=1 [6, 7) STAGE_PARAMS=4259840 (4.260M) TOTAL_PARAMS=55058432 (55.058M) UNIQUE_PARAMS=55058432 (55.058M)
[2024-07-15 06:51:05,535] [INFO] [engine.py:160:__init__] RANK=4 STAGE=4 LAYERS=1 [5, 6) STAGE_PARAMS=4259840 (4.260M) TOTAL_PARAMS=55058432 (55.058M) UNIQUE_PARAMS=55058432 (55.058M)
[2024-07-15 06:51:05,535] [INFO] [engine.py:160:__init__] RANK=3 STAGE=3 LAYERS=1 [4, 5) STAGE_PARAMS=4259840 (4.260M) TOTAL_PARAMS=55058432 (55.058M) UNIQUE_PARAMS=55058432 (55.058M)
Deepspeed engine successfully initialized at --- RANK 0 --- hosting 40 of 292 trainable parameters
  0%|          | 0/5198 [00:00<?, ?it/s]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_0
Training on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][ADeepspeed engine successfully initialized at --- RANK 7 --- hosting 36 of 292 trainable parameters
  0%|          | 0/5198 [00:00<?, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][ADeepspeed engine successfully initialized at --- RANK 2 --- hosting 36 of 292 trainable parameters
Deepspeed engine successfully initialized at --- RANK 1 --- hosting 36 of 292 trainable parameters
  0%|          | 0/5198 [00:00<?, ?it/s]  0%|          | 0/5198 [00:00<?, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A
  0%|          | 0/1 [00:00<?, ?it/s][ADeepspeed engine successfully initialized at --- RANK 3 --- hosting 36 of 292 trainable parameters
Deepspeed engine successfully initialized at --- RANK 4 --- hosting 36 of 292 trainable parameters
  0%|          | 0/5198 [00:00<?, ?it/s]  0%|          | 0/5198 [00:00<?, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A
  0%|          | 0/1 [00:00<?, ?it/s][ADeepspeed engine successfully initialized at --- RANK 6 --- hosting 36 of 292 trainable parameters
Deepspeed engine successfully initialized at --- RANK 5 --- hosting 36 of 292 trainable parameters
  0%|          | 0/5198 [00:00<?, ?it/s]  0%|          | 0/5198 [00:00<?, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A
  0%|          | 0/1 [00:00<?, ?it/s][A[2024-07-15 06:53:15,231] [INFO] [logging.py:96:log_dist] [Rank 0] step=1, skipped=0, lr=[2.0000000000000003e-06], mom=[(0.9, 0.999)]
steps: 1 loss: 2.6361 iter time (s): 132.092 samples/sec: 0.969

100%|██████████| 1/1 [02:11<00:00, 131.73s/it][A100%|██████████| 1/1 [02:11<00:00, 131.73s/it]
  0%|          | 1/5198 [02:11<190:10:39, 131.74s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:09<00:00, 129.78s/it][A100%|██████████| 1/1 [02:09<00:00, 129.78s/it]
  0%|          | 1/5198 [02:09<187:23:07, 129.80s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:09<00:00, 129.89s/it][A100%|██████████| 1/1 [02:09<00:00, 129.89s/it]
  0%|          | 1/5198 [02:09<187:32:05, 129.91s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:10<00:00, 130.06s/it][A100%|██████████| 1/1 [02:10<00:00, 130.06s/it]
  0%|          | 1/5198 [02:10<187:46:51, 130.08s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:10<00:00, 130.18s/it][A100%|██████████| 1/1 [02:10<00:00, 130.18s/it]
  0%|          | 1/5198 [02:10<187:57:10, 130.20s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:10<00:00, 130.39s/it][A100%|██████████| 1/1 [02:10<00:00, 130.39s/it]
  0%|          | 1/5198 [02:10<188:14:58, 130.40s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:10<00:00, 130.42s/it][A100%|██████████| 1/1 [02:10<00:00, 130.42s/it]
  0%|          | 1/5198 [02:10<188:17:02, 130.43s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:12<00:00, 132.97s/it][A100%|██████████| 1/1 [02:12<00:00, 132.97s/it]
  0%|          | 1/5198 [02:12<191:58:22, 132.98s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_1
Training on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:01<00:00, 121.66s/it][A100%|██████████| 1/1 [02:01<00:00, 121.66s/it]
  0%|          | 2/5198 [04:13<181:35:39, 125.82s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A[2024-07-15 06:55:24,965] [INFO] [logging.py:96:log_dist] [Rank 0] step=2, skipped=0, lr=[4.425091217411297e-06], mom=[(0.9, 0.999)]
steps: 2 loss: 2.6066 iter time (s): 123.872 samples/sec: 1.033

100%|██████████| 1/1 [02:04<00:00, 124.99s/it][A100%|██████████| 1/1 [02:04<00:00, 124.99s/it]
  0%|          | 2/5198 [04:14<183:16:25, 126.98s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:05<00:00, 125.07s/it][A100%|██████████| 1/1 [02:05<00:00, 125.07s/it]
  0%|          | 2/5198 [04:14<183:23:58, 127.07s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:04<00:00, 124.99s/it][A100%|██████████| 1/1 [02:04<00:00, 124.99s/it]
  0%|          | 2/5198 [04:15<183:26:08, 127.09s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:04<00:00, 124.97s/it][A100%|██████████| 1/1 [02:04<00:00, 124.97s/it]
  0%|          | 2/5198 [04:15<183:36:20, 127.21s/it]
100%|██████████| 1/1 [02:05<00:00, 125.02s/it][A100%|██████████| 1/1 [02:05<00:00, 125.02s/it]
  0%|          | 2/5198 [04:15<183:31:57, 127.16s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:05<00:00, 125.06s/it][A100%|██████████| 1/1 [02:05<00:00, 125.06s/it]
  0%|          | 2/5198 [04:15<183:42:10, 127.28s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:05<00:00, 125.03s/it][A100%|██████████| 1/1 [02:05<00:00, 125.03s/it]
  0%|          | 2/5198 [04:18<185:11:12, 128.30s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_2
Training on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:07<00:00, 127.35s/it][A100%|██████████| 1/1 [02:07<00:00, 127.35s/it]
  0%|          | 3/5198 [06:20<182:34:34, 126.52s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A[2024-07-15 06:57:32,441] [INFO] [logging.py:96:log_dist] [Rank 0] step=3, skipped=0, lr=[5.843678640425123e-06], mom=[(0.9, 0.999)]
steps: 3 loss: 2.4883 iter time (s): 126.315 samples/sec: 1.013

100%|██████████| 1/1 [02:07<00:00, 127.26s/it][A100%|██████████| 1/1 [02:07<00:00, 127.26s/it]
  0%|          | 3/5198 [06:22<183:26:02, 127.12s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:07<00:00, 127.29s/it][A100%|██████████| 1/1 [02:07<00:00, 127.29s/it]
  0%|          | 3/5198 [06:22<183:31:06, 127.17s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:07<00:00, 127.37s/it][A100%|██████████| 1/1 [02:07<00:00, 127.37s/it]
  0%|          | 3/5198 [06:22<183:35:31, 127.22s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:07<00:00, 127.33s/it][A100%|██████████| 1/1 [02:07<00:00, 127.33s/it]
  0%|          | 3/5198 [06:22<183:36:45, 127.24s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:07<00:00, 127.40s/it][A100%|██████████| 1/1 [02:07<00:00, 127.40s/it]
  0%|          | 3/5198 [06:22<183:42:13, 127.30s/it]
100%|██████████| 1/1 [02:07<00:00, 127.29s/it][A100%|██████████| 1/1 [02:07<00:00, 127.29s/it]
  0%|          | 3/5198 [06:22<183:40:48, 127.29s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:07<00:00, 127.32s/it][A100%|██████████| 1/1 [02:07<00:00, 127.32s/it]
  0%|          | 3/5198 [06:25<184:30:13, 127.86s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_3
Training on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [01:59<00:00, 119.27s/it][A100%|██████████| 1/1 [01:59<00:00, 119.27s/it]
  0%|          | 4/5198 [08:20<178:24:51, 123.66s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A[2024-07-15 06:59:31,468] [INFO] [logging.py:96:log_dist] [Rank 0] step=4, skipped=0, lr=[6.850182434822594e-06], mom=[(0.9, 0.999)]
steps: 4 loss: 2.6077 iter time (s): 118.017 samples/sec: 1.085

100%|██████████| 1/1 [01:59<00:00, 119.15s/it][A100%|██████████| 1/1 [01:59<00:00, 119.15s/it]
  0%|          | 4/5198 [08:21<178:52:00, 123.97s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [01:59<00:00, 119.04s/it][A100%|██████████| 1/1 [01:59<00:00, 119.04s/it]
  0%|          | 4/5198 [08:21<178:51:16, 123.97s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [01:59<00:00, 119.10s/it][A100%|██████████| 1/1 [01:59<00:00, 119.10s/it]
  0%|          | 4/5198 [08:21<178:56:11, 124.02s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [01:59<00:00, 119.15s/it][A100%|██████████| 1/1 [01:59<00:00, 119.15s/it]
  0%|          | 4/5198 [08:21<178:58:34, 124.05s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [01:59<00:00, 119.18s/it][A100%|██████████| 1/1 [01:59<00:00, 119.18s/it]
  0%|          | 4/5198 [08:21<179:02:14, 124.09s/it]
100%|██████████| 1/1 [01:59<00:00, 119.19s/it][A100%|██████████| 1/1 [01:59<00:00, 119.19s/it]
  0%|          | 4/5198 [08:21<179:03:23, 124.11s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [01:59<00:00, 119.18s/it][A100%|██████████| 1/1 [01:59<00:00, 119.18s/it]
  0%|          | 4/5198 [08:24<179:31:49, 124.43s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_4
Training on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:17<00:00, 137.38s/it][A100%|██████████| 1/1 [02:17<00:00, 137.38s/it]
  0%|          | 5/5198 [10:37<185:31:10, 128.61s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A[2024-07-15 07:01:49,329] [INFO] [logging.py:96:log_dist] [Rank 0] step=5, skipped=0, lr=[7.630887430371887e-06], mom=[(0.9, 0.999)]
steps: 5 loss: 2.4910 iter time (s): 136.695 samples/sec: 0.936

100%|██████████| 1/1 [02:17<00:00, 137.71s/it][A100%|██████████| 1/1 [02:17<00:00, 137.71s/it]
  0%|          | 5/5198 [10:38<185:59:01, 128.93s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:17<00:00, 137.83s/it][A100%|██████████| 1/1 [02:17<00:00, 137.83s/it]
  0%|          | 5/5198 [10:39<186:02:22, 128.97s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:17<00:00, 137.74s/it][A100%|██████████| 1/1 [02:17<00:00, 137.75s/it]
  0%|          | 5/5198 [10:39<186:02:44, 128.97s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:17<00:00, 137.69s/it][A100%|██████████| 1/1 [02:17<00:00, 137.69s/it]
  0%|          | 5/5198 [10:39<186:02:28, 128.97s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:17<00:00, 137.62s/it][A100%|██████████| 1/1 [02:17<00:00, 137.62s/it]
  0%|          | 5/5198 [10:39<186:03:35, 128.98s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:17<00:00, 137.71s/it][A100%|██████████| 1/1 [02:17<00:00, 137.71s/it]
  0%|          | 5/5198 [10:39<186:05:29, 129.01s/it]
100%|██████████| 1/1 [02:17<00:00, 137.68s/it][A100%|██████████| 1/1 [02:17<00:00, 137.68s/it]
  0%|          | 5/5198 [10:42<186:23:27, 129.21s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_5

  0%|          | 0/1 [00:00<?, ?it/s][ATraining on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:26<00:00, 146.96s/it][A100%|██████████| 1/1 [02:26<00:00, 146.96s/it]
  0%|          | 6/5198 [13:04<194:29:14, 134.85s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A[2024-07-15 07:04:16,521] [INFO] [logging.py:96:log_dist] [Rank 0] step=6, skipped=0, lr=[8.26876985783642e-06], mom=[(0.9, 0.999)]
steps: 6 loss: 2.4933 iter time (s): 146.199 samples/sec: 0.876

100%|██████████| 1/1 [02:27<00:00, 147.26s/it][A100%|██████████| 1/1 [02:27<00:00, 147.26s/it]
  0%|          | 6/5198 [13:06<194:56:26, 135.17s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:27<00:00, 147.08s/it][A100%|██████████| 1/1 [02:27<00:00, 147.08s/it]
  0%|          | 6/5198 [13:06<194:53:20, 135.13s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:27<00:00, 147.24s/it][A100%|██████████| 1/1 [02:27<00:00, 147.24s/it]
  0%|          | 6/5198 [13:06<194:58:23, 135.19s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:27<00:00, 147.16s/it][A100%|██████████| 1/1 [02:27<00:00, 147.16s/it]
  0%|          | 6/5198 [13:06<194:55:51, 135.16s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:27<00:00, 147.23s/it][A100%|██████████| 1/1 [02:27<00:00, 147.23s/it]
  0%|          | 6/5198 [13:06<194:58:37, 135.19s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:27<00:00, 147.19s/it][A100%|██████████| 1/1 [02:27<00:00, 147.19s/it]
  0%|          | 6/5198 [13:06<194:58:37, 135.19s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:27<00:00, 147.22s/it][A100%|██████████| 1/1 [02:27<00:00, 147.23s/it]
  0%|          | 6/5198 [13:09<195:11:22, 135.34s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_6
Training on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:39<00:00, 159.81s/it][A100%|██████████| 1/1 [02:39<00:00, 159.81s/it]
  0%|          | 7/5198 [15:44<206:13:16, 143.02s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A[2024-07-15 07:06:56,173] [INFO] [logging.py:96:log_dist] [Rank 0] step=7, skipped=0, lr=[8.808091765638272e-06], mom=[(0.9, 0.999)]
steps: 7 loss: 2.4625 iter time (s): 158.620 samples/sec: 0.807

100%|██████████| 1/1 [02:39<00:00, 159.59s/it][A100%|██████████| 1/1 [02:39<00:00, 159.59s/it]
  0%|          | 7/5198 [15:45<206:25:12, 143.15s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:39<00:00, 159.81s/it][A100%|██████████| 1/1 [02:39<00:00, 159.81s/it]
  0%|          | 7/5198 [15:46<206:29:26, 143.20s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:39<00:00, 159.68s/it][A100%|██████████| 1/1 [02:39<00:00, 159.68s/it]
  0%|          | 7/5198 [15:46<206:29:06, 143.20s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:39<00:00, 159.72s/it][A100%|██████████| 1/1 [02:39<00:00, 159.72s/it]
  0%|          | 7/5198 [15:46<206:28:34, 143.19s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:39<00:00, 159.69s/it][A100%|██████████| 1/1 [02:39<00:00, 159.69s/it]
  0%|          | 7/5198 [15:46<206:29:33, 143.20s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:39<00:00, 159.69s/it][A100%|██████████| 1/1 [02:39<00:00, 159.69s/it]
  0%|          | 7/5198 [15:46<206:29:34, 143.20s/it]

100%|██████████| 1/1 [02:39<00:00, 159.66s/it][A  0%|          | 0/1 [00:00<?, ?it/s][A100%|██████████| 1/1 [02:39<00:00, 159.67s/it]
  0%|          | 7/5198 [15:49<206:37:21, 143.29s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_7
Training on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:30<00:00, 150.42s/it][A100%|██████████| 1/1 [02:30<00:00, 150.42s/it]
  0%|          | 8/5198 [18:14<209:34:54, 145.37s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A[2024-07-15 07:09:26,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=8, skipped=0, lr=[9.27527365223389e-06], mom=[(0.9, 0.999)]
steps: 8 loss: 2.4256 iter time (s): 149.681 samples/sec: 0.855

100%|██████████| 1/1 [02:30<00:00, 150.62s/it][A100%|██████████| 1/1 [02:30<00:00, 150.62s/it]
  0%|          | 8/5198 [18:16<209:50:00, 145.55s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:30<00:00, 150.57s/it][A100%|██████████| 1/1 [02:30<00:00, 150.57s/it]
  0%|          | 8/5198 [18:16<209:50:19, 145.55s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:30<00:00, 150.61s/it][A100%|██████████| 1/1 [02:30<00:00, 150.61s/it]
  0%|          | 8/5198 [18:16<209:51:14, 145.56s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:30<00:00, 150.63s/it][A100%|██████████| 1/1 [02:30<00:00, 150.63s/it]
  0%|          | 8/5198 [18:16<209:51:32, 145.57s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:30<00:00, 150.60s/it][A100%|██████████| 1/1 [02:30<00:00, 150.60s/it]
  0%|          | 8/5198 [18:17<209:51:04, 145.56s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:30<00:00, 150.60s/it][A100%|██████████| 1/1 [02:30<00:00, 150.60s/it]
  0%|          | 8/5198 [18:17<209:51:09, 145.56s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:30<00:00, 150.62s/it][A100%|██████████| 1/1 [02:30<00:00, 150.62s/it]
  0%|          | 8/5198 [18:19<209:56:57, 145.63s/it]Shard 8 in [8, 76, 158, 182, 242, 293, 363, 418, 421, 664, 752, 814, 842, 991, 1266, 1366, 1425, 1464, 1574, 1728, 2166, 2441, 2563, 2739, 2854, 2894, 3089, 3181, 3395, 3576, 3831, 4300, 4589, 4947, 4950]: file /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_8 skipped to avoid exceeding cuda memory
Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_9
Training on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:14<00:00, 134.76s/it][A100%|██████████| 1/1 [02:14<00:00, 134.76s/it]
[2024-07-15 07:11:41,247] [INFO] [logging.py:96:log_dist] [Rank 0] step=9, skipped=0, lr=[9.687357280850246e-06], mom=[(0.9, 0.999)]
steps: 9 loss: 2.5131 iter time (s): 133.392 samples/sec: 0.960

100%|██████████| 1/1 [02:14<00:00, 134.39s/it][A100%|██████████| 1/1 [02:14<00:00, 134.39s/it]

100%|██████████| 1/1 [02:14<00:00, 134.46s/it][A100%|██████████| 1/1 [02:14<00:00, 134.46s/it]

100%|██████████| 1/1 [02:14<00:00, 134.53s/it][A100%|██████████| 1/1 [02:14<00:00, 134.53s/it]

100%|██████████| 1/1 [02:14<00:00, 134.52s/it][A100%|██████████| 1/1 [02:14<00:00, 134.53s/it]

100%|██████████| 1/1 [02:14<00:00, 134.51s/it][A100%|██████████| 1/1 [02:14<00:00, 134.51s/it]

100%|██████████| 1/1 [02:14<00:00, 134.51s/it][A100%|██████████| 1/1 [02:14<00:00, 134.51s/it]

100%|██████████| 1/1 [02:14<00:00, 134.51s/it][A100%|██████████| 1/1 [02:14<00:00, 134.51s/it]
Checkpointing at shard 9
[2024-07-15 07:11:46,904] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step9 is about to be saved!
[2024-07-15 07:11:47,870] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_00-model_states.pt...
[2024-07-15 07:11:50,973] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_08-model_states.pt...
[2024-07-15 07:11:51,684] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_02-model_states.pt...
[2024-07-15 07:11:51,802] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_07-model_states.pt...
[2024-07-15 07:11:54,718] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_00-model_states.pt.
[2024-07-15 07:11:58,700] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_01-model_states.pt...
[2024-07-15 07:12:02,896] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_03-model_states.pt...
[2024-07-15 07:12:03,345] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_04-model_states.pt...
[2024-07-15 07:12:06,777] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_06-model_states.pt...
[2024-07-15 07:12:06,777] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_05-model_states.pt...
[2024-07-15 07:18:04,323] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_04-model_states.pt.
[2024-07-15 07:18:04,324] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_03-model_states.pt.
[2024-07-15 07:18:04,353] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_06-model_states.pt.
[2024-07-15 07:18:04,383] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_01-model_states.pt.
[2024-07-15 07:18:04,396] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_05_model_states.pt...
[2024-07-15 07:18:04,396] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_03_model_states.pt...
[2024-07-15 07:18:04,396] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_02_model_states.pt...
[2024-07-15 07:18:04,402] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_05-model_states.pt.
[2024-07-15 07:18:04,413] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_08-model_states.pt.
[2024-07-15 07:18:04,430] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_00_model_states.pt
[2024-07-15 07:18:04,430] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_00_model_states.pt...
[2024-07-15 07:18:04,445] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_04_model_states.pt...
[2024-07-15 07:18:04,524] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_07-model_states.pt.
[2024-07-15 07:18:04,528] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_09-model_states.pt...
[2024-07-15 07:18:04,561] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_02-model_states.pt.
[2024-07-15 07:18:04,563] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_06_model_states.pt...
[2024-07-15 07:18:04,578] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_05_model_states.pt.
[2024-07-15 07:18:04,578] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step9 is ready now!
[2024-07-15 07:18:04,600] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_01_model_states.pt
[2024-07-15 07:18:04,600] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_01_model_states.pt...
[2024-07-15 07:18:04,605] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_03_model_states.pt.
[2024-07-15 07:18:04,605] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_02_model_states.pt.
[2024-07-15 07:18:04,605] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step9 is ready now!
[2024-07-15 07:18:04,605] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step9 is ready now!
[2024-07-15 07:18:04,624] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_04_model_states.pt.
[2024-07-15 07:18:04,624] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step9 is ready now!
[2024-07-15 07:18:04,655] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_06_model_states.pt.
[2024-07-15 07:18:04,655] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step9 is ready now!
[2024-07-15 07:18:04,681] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_01_model_states.pt.
[2024-07-15 07:18:04,681] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step9 is ready now!
[2024-07-15 07:18:04,736] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_00_model_states.pt.
[2024-07-15 07:18:04,737] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step9 is ready now!
[2024-07-15 07:18:05,078] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/layer_09-model_states.pt.
[2024-07-15 07:18:05,080] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_07_model_states.pt...
[2024-07-15 07:18:05,125] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint/global_step9/mp_rank_07_model_states.pt.
[2024-07-15 07:18:05,125] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step9 is ready now!
Checkpoint saved using --- 382.7575216293335 seconds ---
  0%|          | 10/5198 [26:57<287:26:31, 199.46s/it]  0%|          | 10/5198 [26:54<287:24:01, 199.43s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_10
  0%|          | 10/5198 [26:54<287:34:23, 199.55s/it]  0%|          | 10/5198 [26:54<287:31:08, 199.51s/it]  0%|          | 10/5198 [26:54<287:27:39, 199.47s/it]  0%|          | 10/5198 [26:56<288:48:37, 200.41s/it]  0%|          | 10/5198 [26:54<287:26:11, 199.45s/it]  0%|          | 10/5198 [26:54<287:24:50, 199.44s/it]Training on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][A
  0%|          | 0/1 [00:00<?, ?it/s]
[A  0%|          | 0/1 [00:00<?, ?it/s][A
  0%|          | 0/1 [00:00<?, ?it/s][A
  0%|          | 0/1 [00:00<?, ?it/s][A
  0%|          | 0/1 [00:00<?, ?it/s][A
  0%|          | 0/1 [00:00<?, ?it/s][A
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:00<00:00, 120.45s/it][A100%|██████████| 1/1 [02:00<00:00, 120.45s/it]
  0%|          | 11/5198 [28:57<259:34:57, 180.16s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A[2024-07-15 07:20:08,618] [INFO] [logging.py:96:log_dist] [Rank 0] step=10, skipped=0, lr=[1.0055978647783185e-05], mom=[(0.9, 0.999)]
steps: 10 loss: 2.5657 iter time (s): 123.289 samples/sec: 1.038

100%|██████████| 1/1 [02:03<00:00, 123.72s/it][A100%|██████████| 1/1 [02:03<00:00, 123.72s/it]
  0%|          | 11/5198 [28:58<259:51:16, 180.35s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:03<00:00, 123.96s/it][A100%|██████████| 1/1 [02:03<00:00, 123.96s/it]
  0%|          | 11/5198 [28:58<259:54:12, 180.38s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:04<00:00, 124.17s/it][A100%|██████████| 1/1 [02:04<00:00, 124.17s/it]
  0%|          | 11/5198 [28:58<259:56:17, 180.41s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:04<00:00, 124.30s/it][A100%|██████████| 1/1 [02:04<00:00, 124.31s/it]
  0%|          | 11/5198 [28:58<259:58:06, 180.43s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:04<00:00, 124.38s/it][A100%|██████████| 1/1 [02:04<00:00, 124.38s/it]
  0%|          | 11/5198 [28:59<259:58:49, 180.44s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:04<00:00, 124.45s/it][A100%|██████████| 1/1 [02:04<00:00, 124.45s/it]
  0%|          | 11/5198 [28:59<259:59:43, 180.45s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:04<00:00, 124.50s/it][A100%|██████████| 1/1 [02:04<00:00, 124.50s/it]
  0%|          | 11/5198 [29:01<260:02:43, 180.48s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_11
Training on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:16<00:00, 136.24s/it][A100%|██████████| 1/1 [02:16<00:00, 136.24s/it]
  0%|          | 12/5198 [31:14<242:57:09, 168.65s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A[2024-07-15 07:22:25,926] [INFO] [logging.py:96:log_dist] [Rank 0] step=11, skipped=0, lr=[1.0389437235592257e-05], mom=[(0.9, 0.999)]
steps: 11 loss: 2.5371 iter time (s): 136.078 samples/sec: 0.941

100%|██████████| 1/1 [02:17<00:00, 137.29s/it][A100%|██████████| 1/1 [02:17<00:00, 137.29s/it]
  0%|          | 12/5198 [31:15<243:18:05, 168.89s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:17<00:00, 137.25s/it][A100%|██████████| 1/1 [02:17<00:00, 137.25s/it]
  0%|          | 12/5198 [31:15<243:19:24, 168.91s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:17<00:00, 137.20s/it][A100%|██████████| 1/1 [02:17<00:00, 137.20s/it]
  0%|          | 12/5198 [31:15<243:19:34, 168.91s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:17<00:00, 137.17s/it][A100%|██████████| 1/1 [02:17<00:00, 137.17s/it]
  0%|          | 12/5198 [31:16<243:20:12, 168.92s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:17<00:00, 137.12s/it][A100%|██████████| 1/1 [02:17<00:00, 137.12s/it]
  0%|          | 12/5198 [31:16<243:19:52, 168.91s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:17<00:00, 137.10s/it][A100%|██████████| 1/1 [02:17<00:00, 137.10s/it]
  0%|          | 12/5198 [31:16<243:19:43, 168.91s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:17<00:00, 137.08s/it][A100%|██████████| 1/1 [02:17<00:00, 137.08s/it]
  0%|          | 12/5198 [31:18<243:21:27, 168.93s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_12
Training on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:17<00:00, 137.98s/it][A100%|██████████| 1/1 [02:17<00:00, 137.98s/it]
  0%|          | 13/5198 [33:33<231:29:24, 160.73s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A[2024-07-15 07:24:45,901] [INFO] [logging.py:96:log_dist] [Rank 0] step=12, skipped=0, lr=[1.0693861075247718e-05], mom=[(0.9, 0.999)]
steps: 12 loss: 2.3941 iter time (s): 138.969 samples/sec: 0.921

100%|██████████| 1/1 [02:19<00:00, 139.96s/it][A100%|██████████| 1/1 [02:19<00:00, 139.96s/it]
  0%|          | 13/5198 [33:35<231:46:40, 160.93s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:20<00:00, 140.02s/it][A100%|██████████| 1/1 [02:20<00:00, 140.02s/it]
  0%|          | 13/5198 [33:35<231:49:13, 160.96s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:20<00:00, 140.04s/it][A100%|██████████| 1/1 [02:20<00:00, 140.04s/it]
  0%|          | 13/5198 [33:36<231:49:36, 160.96s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:20<00:00, 140.06s/it][A100%|██████████| 1/1 [02:20<00:00, 140.06s/it]
  0%|          | 13/5198 [33:36<231:50:43, 160.97s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:20<00:00, 140.05s/it][A100%|██████████| 1/1 [02:20<00:00, 140.05s/it]
  0%|          | 13/5198 [33:36<231:50:09, 160.97s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:20<00:00, 140.08s/it][A100%|██████████| 1/1 [02:20<00:00, 140.09s/it]
  0%|          | 13/5198 [33:36<231:50:49, 160.97s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:20<00:00, 140.06s/it][A100%|██████████| 1/1 [02:20<00:00, 140.06s/it]
  0%|          | 13/5198 [33:38<231:51:33, 160.98s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_13
Training on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:15<00:00, 135.92s/it][A100%|██████████| 1/1 [02:15<00:00, 135.92s/it]
  0%|          | 14/5198 [35:50<221:29:16, 153.81s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A[2024-07-15 07:27:02,063] [INFO] [logging.py:96:log_dist] [Rank 0] step=13, skipped=0, lr=[1.0973903861023899e-05], mom=[(0.9, 0.999)]
steps: 13 loss: 2.4756 iter time (s): 135.061 samples/sec: 0.948

100%|██████████| 1/1 [02:16<00:00, 136.22s/it][A100%|██████████| 1/1 [02:16<00:00, 136.22s/it]
  0%|          | 14/5198 [35:51<221:41:30, 153.95s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:16<00:00, 136.10s/it][A100%|██████████| 1/1 [02:16<00:00, 136.11s/it]
  0%|          | 14/5198 [35:51<221:40:29, 153.94s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:16<00:00, 136.10s/it][A100%|██████████| 1/1 [02:16<00:00, 136.10s/it]
  0%|          | 14/5198 [35:52<221:40:30, 153.94s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:16<00:00, 136.10s/it][A100%|██████████| 1/1 [02:16<00:00, 136.10s/it]
  0%|          | 14/5198 [35:52<221:41:19, 153.95s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:16<00:00, 136.12s/it][A100%|██████████| 1/1 [02:16<00:00, 136.12s/it]
  0%|          | 14/5198 [35:52<221:41:22, 153.95s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:16<00:00, 136.12s/it][A100%|██████████| 1/1 [02:16<00:00, 136.12s/it]
  0%|          | 14/5198 [35:52<221:42:00, 153.96s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:16<00:00, 136.14s/it][A100%|██████████| 1/1 [02:16<00:00, 136.14s/it]
  0%|          | 14/5198 [35:55<221:42:52, 153.97s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_14
Training on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:08<00:00, 128.99s/it][A100%|██████████| 1/1 [02:08<00:00, 128.99s/it]
  0%|          | 15/5198 [37:59<211:20:44, 146.80s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A[2024-07-15 07:29:11,255] [INFO] [logging.py:96:log_dist] [Rank 0] step=14, skipped=0, lr=[1.123318298304957e-05], mom=[(0.9, 0.999)]
steps: 14 loss: 2.4746 iter time (s): 128.107 samples/sec: 0.999

100%|██████████| 1/1 [02:09<00:00, 129.11s/it][A100%|██████████| 1/1 [02:09<00:00, 129.11s/it]
  0%|          | 15/5198 [38:00<211:22:32, 146.82s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:09<00:00, 129.19s/it][A100%|██████████| 1/1 [02:09<00:00, 129.19s/it]
  0%|          | 15/5198 [38:01<211:23:40, 146.83s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:09<00:00, 129.16s/it][A100%|██████████| 1/1 [02:09<00:00, 129.16s/it]
  0%|          | 15/5198 [38:01<211:22:45, 146.82s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:09<00:00, 129.21s/it][A100%|██████████| 1/1 [02:09<00:00, 129.21s/it]
  0%|          | 15/5198 [38:01<211:24:49, 146.84s/it]
100%|██████████| 1/1 [02:09<00:00, 129.18s/it][A100%|██████████| 1/1 [02:09<00:00, 129.18s/it]
  0%|          | 15/5198 [38:01<211:23:56, 146.83s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:09<00:00, 129.18s/it][A100%|██████████| 1/1 [02:09<00:00, 129.18s/it]
  0%|          | 15/5198 [38:01<211:24:24, 146.84s/it]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [02:09<00:00, 129.23s/it][A100%|██████████| 1/1 [02:09<00:00, 129.23s/it]
  0%|          | 15/5198 [38:04<211:26:05, 146.86s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_plain_texts/shard_0
Training on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][A  0%|          | 0/1 [00:38<?, ?it/s]
--- CUDA out of memory error while processing shard 15. Skipping this shard. ---
  0%|          | 16/5198 [38:42<165:56:04, 115.28s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_15
Training on 128 of 128 sentences.

  0%|          | 0/1 [00:00<?, ?it/s][A  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 16/5198 [38:42<208:58:34, 145.18s/it]
Traceback (most recent call last):
  File "llava/train_parallel_deepspeed_mixtral_adapter_r.py", line 427, in <module>
    except RuntimeError as e:
  File "llava/train_parallel_deepspeed_mixtral_adapter_r.py", line 397, in main
    
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/pipe/engine.py", line 369, in train_batch
    self.timers(TRAIN_BATCH_TIMER).start()
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/utils/timer.py", line 61, in start
    assert not self.started_, f"{self.name_} timer has already been started"
AssertionError: train_batch timer has already been started
[2024-07-15 07:30:13,075] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1112168
[2024-07-15 07:30:13,075] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1112170
[2024-07-15 07:30:14,078] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1112171
[2024-07-15 07:30:14,993] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1112172
[2024-07-15 07:30:15,867] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1112173
[2024-07-15 07:30:16,784] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1112174
[2024-07-15 07:30:17,740] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1112176
[2024-07-15 07:30:18,659] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1112177
[2024-07-15 07:30:19,540] [ERROR] [launch.py:322:sigkill_handler] ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_adapter_r.py', '--local_rank=7', '--num_stages=8', '--shared_routing_adapter_num_experts=4', '--shared_routing_adapter_num_experts_per_tok=1', '--shared_routing_adapter_type=Parallel_Adapter', '--hidden_dim=32', '--save_model_shard=10', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_adapter_32_64_4_top1_checkpoint'] exits with return code = 1
