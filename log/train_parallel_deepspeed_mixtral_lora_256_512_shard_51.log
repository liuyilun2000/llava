[2024-05-29 21:49:12,237] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:18,758] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-05-29 21:49:18,758] [INFO] [runner.py:568:main] cmd = /home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgMywgNCwgNSwgNiwgN119 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None llava/train_parallel_deepspeed_mixtral_lora.py --num_stages=8 --lora_r=256 --lora_alpha=512 --save_model_shard=5 --skip_shard=51 --checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint
[2024-05-29 21:49:22,130] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:23,778] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]}
[2024-05-29 21:49:23,778] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=8, node_rank=0
[2024-05-29 21:49:23,778] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]})
[2024-05-29 21:49:23,778] [INFO] [launch.py:163:main] dist_world_size=8
[2024-05-29 21:49:23,778] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
[2024-05-29 21:49:23,792] [INFO] [launch.py:253:main] process 1792685 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=0', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:49:23,802] [INFO] [launch.py:253:main] process 1792686 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=1', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:49:23,820] [INFO] [launch.py:253:main] process 1792687 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=2', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:49:23,836] [INFO] [launch.py:253:main] process 1792688 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=3', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:49:23,854] [INFO] [launch.py:253:main] process 1792689 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=4', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:49:23,871] [INFO] [launch.py:253:main] process 1792690 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=5', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:49:23,887] [INFO] [launch.py:253:main] process 1792694 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=6', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:49:23,903] [INFO] [launch.py:253:main] process 1792695 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=7', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:49:31,235] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:33,128] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:49:37,055] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:37,471] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:37,737] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:49:38,138] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:49:40,760] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:41,154] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:41,464] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:49:41,464] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-05-29 21:49:41,851] [INFO] [comm.py:637:init_distributed] cdb=None
Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:00<00:17,  1.11it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:00<00:16,  1.14it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:00<00:17,  1.11it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:00<00:15,  1.24it/s]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:24,  1.38s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:22,  1.26s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:22,  1.26s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:22,  1.23s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:24,  1.44s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:26,  1.53s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:26,  1.54s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:26,  1.58s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:05<00:22,  1.40s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:05<00:25,  1.56s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:05<00:23,  1.49s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:05<00:23,  1.46s/it][2024-05-29 21:49:51,916] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:54,233] [INFO] [comm.py:637:init_distributed] cdb=None
Loading checkpoint shards:  25%|██▌       | 5/20 [00:08<00:31,  2.13s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:10<00:38,  2.55s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:10<00:38,  2.55s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:10<00:40,  2.70s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:10<00:29,  2.08s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:29,  2.13s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:29,  2.11s/it][2024-05-29 21:49:57,020] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:32,  2.31s/it]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:  35%|███▌      | 7/20 [00:12<00:24,  1.92s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:12<00:25,  1.93s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:13<00:25,  1.99s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:13<00:25,  1.96s/it][2024-05-29 21:49:58,920] [INFO] [comm.py:637:init_distributed] cdb=None
Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:29,  1.57s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:16<00:29,  2.48s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:36,  2.05s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:17<00:32,  2.71s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:17<00:32,  2.68s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:17<00:33,  2.80s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:31,  1.84s/it]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:  45%|████▌     | 9/20 [00:18<00:25,  2.28s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:19<00:26,  2.38s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:23,  1.24s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:19<00:26,  2.38s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:19<00:27,  2.46s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:30,  1.88s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:20<00:22,  2.28s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:20<00:21,  2.11s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:20<00:20,  2.09s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:20<00:21,  2.12s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:25,  1.40s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:31,  2.08s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:29,  1.74s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:23<00:21,  2.34s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:23<00:23,  2.58s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:23<00:22,  2.47s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:24<00:23,  2.60s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:28,  2.00s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:06<00:29,  1.83s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:25<00:17,  2.15s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:25<00:18,  2.31s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:25<00:17,  2.18s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:25<00:17,  2.21s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:13<00:25,  1.93s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:08<00:29,  1.94s/it]