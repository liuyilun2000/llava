[2024-05-29 21:49:00,800] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:05,346] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-05-29 21:49:05,346] [INFO] [runner.py:568:main] cmd = /home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgMywgNCwgNSwgNiwgN119 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None llava/train_parallel_deepspeed_mixtral_lora.py --num_stages=8 --lora_r=128 --lora_alpha=256 --save_model_shard=5 --skip_shard=51 --checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint
[2024-05-29 21:49:08,974] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:10,831] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]}
[2024-05-29 21:49:10,831] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=8, node_rank=0
[2024-05-29 21:49:10,831] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]})
[2024-05-29 21:49:10,831] [INFO] [launch.py:163:main] dist_world_size=8
[2024-05-29 21:49:10,831] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
[2024-05-29 21:49:10,843] [INFO] [launch.py:253:main] process 745044 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=0', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-29 21:49:10,854] [INFO] [launch.py:253:main] process 745045 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=1', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-29 21:49:10,864] [INFO] [launch.py:253:main] process 745046 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=2', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-29 21:49:10,881] [INFO] [launch.py:253:main] process 745047 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=3', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-29 21:49:10,898] [INFO] [launch.py:253:main] process 745048 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=4', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-29 21:49:10,920] [INFO] [launch.py:253:main] process 745051 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=5', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-29 21:49:10,938] [INFO] [launch.py:253:main] process 745053 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=6', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-29 21:49:10,956] [INFO] [launch.py:253:main] process 745055 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=7', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=51', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-29 21:49:17,108] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:17,863] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:49:21,683] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:22,515] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:49:27,075] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:27,805] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:49:37,353] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:37,632] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:38,115] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:49:38,406] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:49:42,818] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:43,548] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:49:47,928] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:48,648] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:49:51,444] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:49:52,184] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:49:52,184] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:19,  1.01s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:20,  1.11s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:00<00:17,  1.08it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:33,  1.75s/it]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:24,  1.36s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:26,  1.49s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:02<00:48,  2.53s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:02<00:48,  2.53s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:35,  1.98s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:24,  1.28s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:02<00:42,  2.23s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:28,  1.65s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:04<00:44,  2.47s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:30,  1.77s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:04<00:37,  2.09s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:04<00:35,  1.97s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:30,  1.72s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:04<00:42,  2.39s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:06<00:37,  2.19s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:31,  1.95s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:06<00:40,  2.36s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:32,  2.04s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:06<00:34,  2.02s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:06<00:37,  2.22s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:32,  1.91s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:08<00:34,  2.13s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:07<00:46,  2.72s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:28,  1.91s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:30,  2.03s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:06<00:27,  1.73s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:09<00:36,  2.29s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:10<00:31,  2.09s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:09<00:37,  2.35s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:09<00:38,  2.38s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:26,  1.93s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:10<00:40,  2.52s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:08<00:27,  1.84s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:11<00:33,  2.21s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:29,  2.11s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:11<00:33,  2.23s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:30,  2.18s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:12<00:23,  1.80s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:11<00:35,  2.38s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:13<00:29,  2.11s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:12<00:37,  2.48s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:13<00:28,  2.16s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:29,  2.09s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:14<00:28,  2.17s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:13<00:31,  2.28s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:14<00:22,  1.89s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:13<00:31,  2.27s/it]