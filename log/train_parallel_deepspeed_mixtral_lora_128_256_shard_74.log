[2024-05-30 14:08:14,480] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-30 14:08:22,075] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-05-30 14:08:22,076] [INFO] [runner.py:568:main] cmd = /home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgMywgNCwgNSwgNiwgN119 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None llava/train_parallel_deepspeed_mixtral_lora.py --num_stages=8 --lora_r=128 --lora_alpha=256 --save_model_shard=5 --skip_shard=74 --checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint
[2024-05-30 14:08:25,368] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-30 14:08:27,144] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]}
[2024-05-30 14:08:27,144] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=8, node_rank=0
[2024-05-30 14:08:27,145] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]})
[2024-05-30 14:08:27,145] [INFO] [launch.py:163:main] dist_world_size=8
[2024-05-30 14:08:27,145] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
[2024-05-30 14:08:27,152] [INFO] [launch.py:253:main] process 3640369 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=0', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=74', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-30 14:08:27,160] [INFO] [launch.py:253:main] process 3640370 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=1', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=74', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-30 14:08:27,166] [INFO] [launch.py:253:main] process 3640371 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=2', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=74', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-30 14:08:27,177] [INFO] [launch.py:253:main] process 3640372 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=3', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=74', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-30 14:08:27,188] [INFO] [launch.py:253:main] process 3640373 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=4', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=74', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-30 14:08:27,198] [INFO] [launch.py:253:main] process 3640375 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=5', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=74', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-30 14:08:27,209] [INFO] [launch.py:253:main] process 3640378 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=6', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=74', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-30 14:08:27,220] [INFO] [launch.py:253:main] process 3640379 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=7', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=74', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint']
[2024-05-30 14:08:37,639] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-30 14:08:38,398] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-30 14:08:38,466] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-30 14:08:39,237] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-30 14:08:39,238] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-30 14:08:39,243] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-30 14:08:42,827] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-30 14:08:43,040] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-30 14:08:43,525] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-30 14:08:43,562] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-30 14:08:43,708] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-30 14:08:44,246] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-30 14:08:48,988] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-30 14:08:49,126] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-30 14:08:49,752] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-30 14:08:49,753] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-05-30 14:08:49,783] [INFO] [comm.py:637:init_distributed] cdb=None
Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:22,  1.18s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:19,  1.04s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:31,  1.65s/it]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:26,  1.38s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:37,  2.00s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:32,  1.69s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:35,  1.88s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:32,  1.69s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:35,  1.99s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:25,  1.44s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:34,  1.92s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:33,  1.85s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:30,  1.72s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:31,  1.76s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:04<00:41,  2.30s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:34,  1.93s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:28,  1.70s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:34,  2.02s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:32,  1.88s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:27,  1.59s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:28,  1.68s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:34,  2.05s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:31,  1.86s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:33,  1.98s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:31,  1.98s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:33,  2.09s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:08<00:34,  2.18s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:29,  1.85s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:30,  1.89s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:31,  1.95s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:08<00:35,  2.19s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:32,  2.01s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:28,  1.89s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:29,  1.99s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:27,  1.83s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:10<00:32,  2.14s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:29,  2.00s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:31,  2.08s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:10<00:32,  2.20s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:30,  2.03s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:28,  2.05s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:27,  1.97s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:29,  2.11s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:29,  2.12s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:28,  2.04s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:28,  2.05s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:28,  2.06s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:27,  1.95s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:13<00:25,  1.99s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:13<00:25,  1.93s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:13<00:25,  1.97s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:14<00:26,  2.02s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:14<00:26,  2.05s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:13<00:25,  1.98s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:14<00:26,  2.07s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:13<00:25,  2.00s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:15<00:24,  2.03s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:16<00:24,  2.05s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:15<00:23,  1.97s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:15<00:24,  2.01s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:16<00:24,  2.06s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:16<00:24,  2.04s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:15<00:23,  1.97s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:15<00:23,  1.92s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:17<00:23,  2.11s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:18<00:23,  2.12s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:17<00:22,  2.08s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:17<00:22,  2.07s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:18<00:22,  2.04s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:18<00:23,  2.11s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:16<00:18,  1.68s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:18<00:23,  2.17s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:20<00:21,  2.19s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:20<00:21,  2.14s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:18<00:18,  1.85s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:20<00:21,  2.18s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:20<00:21,  2.18s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:20<00:22,  2.21s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:20<00:21,  2.18s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:20<00:22,  2.29s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:21<00:17,  1.90s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:22<00:19,  2.16s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:22<00:19,  2.12s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:22<00:19,  2.14s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:22<00:19,  2.15s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:22<00:19,  2.17s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:22<00:19,  2.16s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:23<00:20,  2.32s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:23<00:15,  1.98s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:24<00:17,  2.15s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:24<00:16,  2.10s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:24<00:17,  2.14s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:24<00:17,  2.13s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:24<00:17,  2.14s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:25<00:18,  2.28s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:25<00:18,  2.26s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:26<00:15,  2.19s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:25<00:14,  2.07s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:27<00:15,  2.18s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:27<00:14,  2.11s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:27<00:15,  2.18s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:27<00:15,  2.22s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:26<00:16,  2.29s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:27<00:17,  2.45s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:28<00:12,  2.11s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:27<00:12,  2.03s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:29<00:12,  2.05s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:28<00:12,  2.07s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:28<00:12,  2.06s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:29<00:13,  2.21s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:29<00:13,  2.28s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:29<00:14,  2.39s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:29<00:09,  1.99s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:30<00:10,  2.03s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:31<00:10,  2.02s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:30<00:10,  2.02s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:30<00:10,  2.13s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:31<00:10,  2.06s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:30<00:09,  1.97s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:31<00:10,  2.18s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:32<00:08,  2.12s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:31<00:08,  2.10s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:33<00:08,  2.09s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:33<00:08,  2.11s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:32<00:07,  1.98s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:32<00:08,  2.13s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:33<00:08,  2.18s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:34<00:08,  2.21s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:33<00:06,  2.12s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:35<00:06,  2.05s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:35<00:06,  2.12s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:34<00:06,  2.14s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:35<00:06,  2.03s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:35<00:06,  2.08s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:35<00:06,  2.17s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:35<00:06,  2.19s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:35<00:04,  2.11s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:37<00:04,  2.08s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:37<00:04,  2.14s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:37<00:04,  2.15s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:37<00:04,  2.11s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:37<00:04,  2.19s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:38<00:04,  2.22s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:38<00:04,  2.21s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:39<00:02,  2.13s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:38<00:02,  2.16s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:39<00:02,  2.13s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:39<00:02,  2.15s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:39<00:02,  2.10s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:39<00:02,  2.20s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:40<00:02,  2.21s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:40<00:02,  2.19s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:38<00:00,  1.65s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:38<00:00,  1.93s/it]
Loading checkpoint shards: 100%|██████████| 20/20 [00:40<00:00,  1.63s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:40<00:00,  2.02s/it]
Loading checkpoint shards: 100%|██████████| 20/20 [00:39<00:00,  1.63s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:39<00:00,  1.99s/it]
Loading checkpoint shards: 100%|██████████| 20/20 [00:39<00:00,  1.69s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:39<00:00,  1.99s/it]
Loading checkpoint shards: 100%|██████████| 20/20 [00:40<00:00,  1.65s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:40<00:00,  2.00s/it]
Loading checkpoint shards: 100%|██████████| 20/20 [00:40<00:00,  1.68s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:40<00:00,  2.01s/it]
Loading checkpoint shards: 100%|██████████| 20/20 [00:40<00:00,  1.66s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:40<00:00,  2.03s/it]
Loading checkpoint shards: 100%|██████████| 20/20 [00:40<00:00,  1.66s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:40<00:00,  2.05s/it]
Print trainable params: 96485376 || all params: 47115384832 || trainable%: 0.20
Print trainable params: 96485376 || all params: 47115384832 || trainable%: 0.20
Print trainable params: 96485376 || all params: 47115384832 || trainable%: 0.20
Print trainable params: 96485376 || all params: 47115384832 || trainable%: 0.20
SEED_LAYERS=False BASE_SEED=1234 SEED_FN=None
Using topology: {ProcessCoord(pipe=0, data=0): 0, ProcessCoord(pipe=1, data=0): 1, ProcessCoord(pipe=2, data=0): 2, ProcessCoord(pipe=3, data=0): 3, ProcessCoord(pipe=4, data=0): 4, ProcessCoord(pipe=5, data=0): 5, ProcessCoord(pipe=6, data=0): 6, ProcessCoord(pipe=7, data=0): 7}
[2024-05-30 14:09:41,577] [INFO] [module.py:375:_partition_layers] Partitioning pipeline stages with method type:LanguageModelLayerWrapper
stage=0 layers=2
     0: LlavaMultiModalModuleWrapper
     1: LanguageModelLayerWrapper
stage=1 layers=1
     2: LanguageModelLayerWrapper
stage=2 layers=1
     3: LanguageModelLayerWrapper
stage=3 layers=1
     4: LanguageModelLayerWrapper
stage=4 layers=1
     5: LanguageModelLayerWrapper
stage=5 layers=1
     6: LanguageModelLayerWrapper
stage=6 layers=1
     7: LanguageModelLayerWrapper
stage=7 layers=2
     8: LanguageModelLayerWrapper
     9: LanguageModelFinalWrapper
  loss: loss_fn
Print trainable params: 96485376 || all params: 47115384832 || trainable%: 0.20
Print trainable params: 96485376 || all params: 47115384832 || trainable%: 0.20
Print trainable params: 96485376 || all params: 47115384832 || trainable%: 0.20
Print trainable params: 96485376 || all params: 47115384832 || trainable%: 0.20
Rank 2 initialized with CUDA_MEM (60744794112, 84974239744)
Deepspeed engine initializing at --- RANK 2 --- ...
Rank 6 initialized with CUDA_MEM (60744794112, 84974239744)
Deepspeed engine initializing at --- RANK 6 --- ...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Rank 0 initialized with CUDA_MEM (58783956992, 84974239744)
Deepspeed engine initializing at --- RANK 0 --- ...
[2024-05-30 14:09:48,947] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Rank 4 initialized with CUDA_MEM (60744794112, 84974239744)
Deepspeed engine initializing at --- RANK 4 --- ...
[2024-05-30 14:09:49,240] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Rank 3 initialized with CUDA_MEM (60744794112, 84974239744)
Rank 5 initialized with CUDA_MEM (60744794112, 84974239744)
Deepspeed engine initializing at --- RANK 3 --- ...
Deepspeed engine initializing at --- RANK 5 --- ...
Rank 1 initialized with CUDA_MEM (60744794112, 84974239744)
Deepspeed engine initializing at --- RANK 1 --- ...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Rank 7 initialized with CUDA_MEM (60218408960, 84974239744)
Deepspeed engine initializing at --- RANK 7 --- ...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
ninja: no work to do.
Loading extension module fused_adam...
Loading extension module fused_adam...
Loading extension module fused_adam...
Time to load fused_adam op: 1.834458589553833 seconds
Time to load fused_adam op: 1.8263905048370361 seconds
Time to load fused_adam op: 3.5661461353302 seconds
[2024-05-30 14:09:52,356] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
[2024-05-30 14:09:52,358] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
[2024-05-30 14:09:52,360] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 2.609112024307251 seconds
[2024-05-30 14:09:52,372] [INFO] [logging.py:96:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adam as basic optimizer
[2024-05-30 14:09:52,372] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
Loading extension module fused_adam...
Time to load fused_adam op: 0.3036770820617676 seconds
[2024-05-30 14:09:52,378] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
[2024-05-30 14:09:52,379] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-05-30 14:09:52,379] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2024-05-30 14:09:52,380] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = WarmupCosineLR
[2024-05-30 14:09:52,380] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupCosineLR object at 0x152c6066beb0>
[2024-05-30 14:09:52,380] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[2e-05], mom=[(0.9, 0.999)]
[2024-05-30 14:09:52,381] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
Loading extension module fused_adam...
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   bfloat16_enabled ............. False
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x152c6066ba00>
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-05-30 14:09:52,381] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 128
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 65536
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   loss_scale ................... 0
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=True, output_path='/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint', job_name='deepspeed_monitor_logs') enabled=True
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   optimizer_name ............... adam
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   optimizer_params ............. {'lr': 2e-05}
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True, 'use_reentrant': False}
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   scheduler_name ............... WarmupCosineLR
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   scheduler_params ............. {'total_num_steps': 5718, 'warmup_min_ratio': 0.1, 'warmup_num_steps': 171.54}
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   steps_per_print .............. 1
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   train_batch_size ............. 128
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  1
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
Time to load fused_adam op: 3.3104665279388428 seconds[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   use_node_local_storage ....... False

[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   zero_enabled ................. False
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-05-30 14:09:52,382] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 0
[2024-05-30 14:09:52,382] [INFO] [config.py:986:print_user_config]   json = {
    "train_batch_size": 128, 
    "train_micro_batch_size_per_gpu": 1, 
    "gradient_accumulation_steps": 128, 
    "steps_per_print": 1, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 2e-05
        }
    }, 
    "scheduler": {
        "type": "WarmupCosineLR", 
        "params": {
            "total_num_steps": 5.718000e+03, 
            "warmup_min_ratio": 0.1, 
            "warmup_num_steps": 171.54
        }
    }, 
    "pipeline": {
        "use_reentrant": false
    }, 
    "csv_monitor": {
        "enabled": true, 
        "output_path": "/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint", 
        "job_name": "deepspeed_monitor_logs"
    }
}
[2024-05-30 14:09:52,383] [INFO] [engine.py:101:__init__] CONFIG: micro_batches=128 micro_batch_size=1
[2024-05-30 14:09:52,383] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
[2024-05-30 14:09:52,386] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 2.4094879627227783 seconds
[2024-05-30 14:09:52,392] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 1.8063511848449707 seconds
[2024-05-30 14:09:52,415] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
[2024-05-30 14:09:56,926] [INFO] [engine.py:160:__init__] RANK=6 STAGE=6 LAYERS=1 [7, 8) STAGE_PARAMS=6815744 (6.816M) TOTAL_PARAMS=96485376 (96.485M) UNIQUE_PARAMS=96485376 (96.485M)
[2024-05-30 14:09:56,926] [INFO] [engine.py:160:__init__] RANK=3 STAGE=3 LAYERS=1 [4, 5) STAGE_PARAMS=6815744 (6.816M) TOTAL_PARAMS=96485376 (96.485M) UNIQUE_PARAMS=96485376 (96.485M)
[2024-05-30 14:09:56,926] [INFO] [engine.py:160:__init__] RANK=5 STAGE=5 LAYERS=1 [6, 7) STAGE_PARAMS=6815744 (6.816M) TOTAL_PARAMS=96485376 (96.485M) UNIQUE_PARAMS=96485376 (96.485M)
[2024-05-30 14:09:56,926] [INFO] [engine.py:160:__init__] RANK=7 STAGE=7 LAYERS=2 [8, 10) STAGE_PARAMS=6815744 (6.816M) TOTAL_PARAMS=96485376 (96.485M) UNIQUE_PARAMS=96485376 (96.485M)
[2024-05-30 14:09:56,926] [INFO] [engine.py:160:__init__] RANK=4 STAGE=4 LAYERS=1 [5, 6) STAGE_PARAMS=6815744 (6.816M) TOTAL_PARAMS=96485376 (96.485M) UNIQUE_PARAMS=96485376 (96.485M)
[2024-05-30 14:09:56,926] [INFO] [engine.py:160:__init__] RANK=0 STAGE=0 LAYERS=2 [0, 2) STAGE_PARAMS=48775168 (48.775M) TOTAL_PARAMS=96485376 (96.485M) UNIQUE_PARAMS=96485376 (96.485M)
[2024-05-30 14:09:56,926] [INFO] [engine.py:160:__init__] RANK=2 STAGE=2 LAYERS=1 [3, 4) STAGE_PARAMS=6815744 (6.816M) TOTAL_PARAMS=96485376 (96.485M) UNIQUE_PARAMS=96485376 (96.485M)
[2024-05-30 14:09:56,926] [INFO] [engine.py:160:__init__] RANK=1 STAGE=1 LAYERS=1 [2, 3) STAGE_PARAMS=6815744 (6.816M) TOTAL_PARAMS=96485376 (96.485M) UNIQUE_PARAMS=96485376 (96.485M)
Deepspeed engine successfully initialized at --- RANK 0 --- hosting 24 of 136 trainable parameters
Loading latest model checkpoint at shard 74
[2024-05-30 14:09:59,752] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt...
Deepspeed engine successfully initialized at --- RANK 7 --- hosting 16 of 136 trainable parameters
[2024-05-30 14:10:00,346] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt...
Deepspeed engine successfully initialized at --- RANK 2 --- hosting 16 of 136 trainable parameters
Deepspeed engine successfully initialized at --- RANK 1 --- hosting 16 of 136 trainable parameters
[2024-05-30 14:10:01,904] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt...
[2024-05-30 14:10:01,904] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt...
Deepspeed engine successfully initialized at --- RANK 4 --- hosting 16 of 136 trainable parameters
Deepspeed engine successfully initialized at --- RANK 3 --- hosting 16 of 136 trainable parameters
[2024-05-30 14:10:02,082] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt...
[2024-05-30 14:10:02,082] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt...
Deepspeed engine successfully initialized at --- RANK 5 --- hosting 16 of 136 trainable parameters
Deepspeed engine successfully initialized at --- RANK 6 --- hosting 16 of 136 trainable parameters
[2024-05-30 14:10:02,174] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt...
[2024-05-30 14:10:02,174] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt...
[2024-05-30 14:10:06,599] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt.
[2024-05-30 14:10:06,599] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt.
[2024-05-30 14:10:06,599] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt.
[2024-05-30 14:10:06,599] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt.
[2024-05-30 14:10:06,599] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt.
[2024-05-30 14:10:06,599] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_01_model_states.pt...
[2024-05-30 14:10:06,599] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt.
[2024-05-30 14:10:06,600] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt...
[2024-05-30 14:10:06,600] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt.
[2024-05-30 14:10:06,600] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_05_model_states.pt...
[2024-05-30 14:10:06,600] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_07_model_states.pt...
[2024-05-30 14:10:06,600] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_04_model_states.pt...
[2024-05-30 14:10:06,600] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_03_model_states.pt...
[2024-05-30 14:10:06,600] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_02_model_states.pt...
[2024-05-30 14:10:06,600] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt.
[2024-05-30 14:10:06,600] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_06_model_states.pt...
[2024-05-30 14:10:06,665] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_00_model_states.pt.
[2024-05-30 14:10:06,666] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_00-model_states.pt...
[2024-05-30 14:10:07,535] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_03_model_states.pt.
[2024-05-30 14:10:07,535] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_04-model_states.pt...
[2024-05-30 14:10:07,757] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_06_model_states.pt.
[2024-05-30 14:10:07,758] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_07-model_states.pt...
[2024-05-30 14:10:07,771] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_07_model_states.pt.
[2024-05-30 14:10:07,772] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_08-model_states.pt...
[2024-05-30 14:10:07,828] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_01_model_states.pt.
[2024-05-30 14:10:07,828] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_02-model_states.pt...
[2024-05-30 14:10:07,836] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_02_model_states.pt.
[2024-05-30 14:10:07,836] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_03-model_states.pt...
[2024-05-30 14:10:07,868] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_05_model_states.pt.
[2024-05-30 14:10:07,869] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_06-model_states.pt...
[2024-05-30 14:10:08,242] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/mp_rank_04_model_states.pt.
[2024-05-30 14:10:08,242] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_05-model_states.pt...
[2024-05-30 14:10:45,761] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_00-model_states.pt.
[2024-05-30 14:10:45,763] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_00-model_states.pt...
[2024-05-30 14:10:46,027] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_00-model_states.pt.
[2024-05-30 14:10:46,196] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_01-model_states.pt...
[2024-05-30 14:17:48,005] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_05-model_states.pt.
[2024-05-30 14:17:48,071] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_05-model_states.pt...
[2024-05-30 14:17:54,489] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_05-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 14:18:24,401] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_04-model_states.pt.
[2024-05-30 14:18:24,532] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_04-model_states.pt...
[2024-05-30 14:18:26,772] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_06-model_states.pt.
[2024-05-30 14:18:26,891] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_06-model_states.pt...
[2024-05-30 14:18:34,841] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_06-model_states.pt.
[2024-05-30 14:18:35,459] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_04-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 14:18:39,434] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_03-model_states.pt.
[2024-05-30 14:18:39,612] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_03-model_states.pt...
[2024-05-30 14:18:40,213] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_07-model_states.pt.
[2024-05-30 14:18:40,424] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_07-model_states.pt...
[2024-05-30 14:18:43,077] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_02-model_states.pt.
[2024-05-30 14:18:43,296] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_02-model_states.pt...
[2024-05-30 14:18:48,052] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_01-model_states.pt.
[2024-05-30 14:18:48,198] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_01-model_states.pt...
[2024-05-30 14:18:49,891] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_08-model_states.pt.
[2024-05-30 14:18:50,051] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_08-model_states.pt...
[2024-05-30 14:18:51,697] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_03-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 14:18:54,005] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_07-model_states.pt.
[2024-05-30 14:18:54,313] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_02-model_states.pt.
[2024-05-30 14:18:55,152] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_01-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/520 [00:00<?, ?it/s]Shard 0 / 74 skipped
Shard 1 / 74 skipped
Shard 2 / 74 skipped
Shard 3 / 74 skipped
Shard 4 / 74 skipped
Shard 5 / 74 skipped
Shard 6 / 74 skipped
Shard 7 / 74 skipped
Shard 8 / 74 skipped
Shard 9 / 74 skipped
Shard 10 / 74 skipped
Shard 11 / 74 skipped
Shard 12 / 74 skipped
Shard 13 / 74 skipped
Shard 14 / 74 skipped
Shard 15 / 74 skipped
Shard 16 / 74 skipped
Shard 17 / 74 skipped
Shard 18 / 74 skipped
Shard 19 / 74 skipped
Shard 20 / 74 skipped
Shard 21 / 74 skipped
Shard 22 / 74 skipped
Shard 23 / 74 skipped
Shard 24 / 74 skipped
Shard 25 / 74 skipped
Shard 26 / 74 skipped
Shard 27 / 74 skipped
Shard 28 / 74 skipped
Shard 29 / 74 skipped
Shard 30 / 74 skipped
Shard 31 / 74 skipped
Shard 32 / 74 skipped
Shard 33 / 74 skipped
Shard 34 / 74 skipped
Shard 35 / 74 skipped
Shard 36 / 74 skipped
Shard 37 / 74 skipped
Shard 38 / 74 skipped
Shard 39 / 74 skipped
Shard 40 / 74 skipped
Shard 41 / 74 skipped
Shard 42 / 74 skipped
Shard 43 / 74 skipped
Shard 44 / 74 skipped
Shard 45 / 74 skipped
Shard 46 / 74 skipped
Shard 47 / 74 skipped
Shard 48 / 74 skipped
Shard 49 / 74 skipped
Shard 50 / 74 skipped
Shard 51 / 74 skipped
Shard 52 / 74 skipped
Shard 53 / 74 skipped
Shard 54 / 74 skipped
Shard 55 / 74 skipped
Shard 56 / 74 skipped
Shard 57 / 74 skipped
Shard 58 / 74 skipped
Shard 59 / 74 skipped
Shard 60 / 74 skipped
Shard 61 / 74 skipped
Shard 62 / 74 skipped
Shard 63 / 74 skipped
Shard 64 / 74 skipped
Shard 65 / 74 skipped
Shard 66 / 74 skipped
Shard 67 / 74 skipped
Shard 68 / 74 skipped
Shard 69 / 74 skipped
Shard 70 / 74 skipped
Shard 71 / 74 skipped
Shard 72 / 74 skipped
Shard 73 / 74 skipped
Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_201
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 14:18:58,222] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_08-model_states.pt.
[2024-05-30 14:18:59,717] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_09-model_states.pt...
[2024-05-30 14:19:05,800] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_09-model_states.pt.
[2024-05-30 14:19:05,802] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_09-model_states.pt...
[2024-05-30 14:19:05,915] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step740/layer_09-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 14:20:07,777] [INFO] [logging.py:96:log_dist] [Rank 0] step=741, skipped=0, lr=[1.948435306172383e-05], mom=[(0.9, 0.999)]
steps: 741 loss: 0.6011 iter time (s): 75.278 samples/sec: 1.700

 10%|█         | 1/10 [01:06<10:00, 66.69s/it][A
 10%|█         | 1/10 [01:16<11:31, 76.79s/it][A
 10%|█         | 1/10 [01:35<14:20, 95.66s/it][A
 10%|█         | 1/10 [02:16<20:29, 136.65s/it][A
 10%|█         | 1/10 [01:35<14:18, 95.35s/it][A
 10%|█         | 1/10 [01:19<11:55, 79.47s/it][A
 10%|█         | 1/10 [01:16<11:29, 76.58s/it][A
 10%|█         | 1/10 [01:15<11:22, 75.87s/it][A
 20%|██        | 2/10 [02:02<08:00, 60.10s/it][A[2024-05-30 14:21:09,347] [INFO] [logging.py:96:log_dist] [Rank 0] step=742, skipped=0, lr=[1.948255626585902e-05], mom=[(0.9, 0.999)]
steps: 742 loss: 0.5922 iter time (s): 56.164 samples/sec: 2.279

 20%|██        | 2/10 [02:13<08:39, 64.96s/it][A
 20%|██        | 2/10 [02:32<09:42, 72.75s/it][A
 20%|██        | 2/10 [03:13<11:57, 89.63s/it] [A
 20%|██        | 2/10 [02:32<09:40, 72.61s/it][A
 20%|██        | 2/10 [02:16<08:48, 66.10s/it][A
 20%|██        | 2/10 [02:13<08:39, 64.91s/it][A
 20%|██        | 2/10 [02:12<08:36, 64.61s/it][A
 30%|███       | 3/10 [02:59<06:50, 58.68s/it][A[2024-05-30 14:22:06,329] [INFO] [logging.py:96:log_dist] [Rank 0] step=743, skipped=0, lr=[1.94807564280756e-05], mom=[(0.9, 0.999)]
steps: 743 loss: 0.6040 iter time (s): 56.418 samples/sec: 2.269

 30%|███       | 3/10 [03:10<07:09, 61.33s/it][A
 30%|███       | 3/10 [03:29<07:38, 65.56s/it][A
 30%|███       | 3/10 [04:10<08:43, 74.73s/it][A
 30%|███       | 3/10 [03:29<07:38, 65.48s/it][A
 30%|███       | 3/10 [03:13<07:13, 61.96s/it][A
 30%|███       | 3/10 [03:10<07:09, 61.31s/it][A
 30%|███       | 3/10 [03:09<07:08, 61.14s/it][A
 40%|████      | 4/10 [04:00<05:58, 59.69s/it][A[2024-05-30 14:23:07,576] [INFO] [logging.py:96:log_dist] [Rank 0] step=744, skipped=0, lr=[1.9478953548951004e-05], mom=[(0.9, 0.999)]
steps: 744 loss: 0.6424 iter time (s): 60.668 samples/sec: 2.110

 40%|████      | 4/10 [04:11<06:07, 61.29s/it][A
 40%|████      | 4/10 [04:30<06:23, 63.88s/it][A
 40%|████      | 4/10 [05:11<06:56, 69.42s/it][A
 40%|████      | 4/10 [04:30<06:22, 63.82s/it][A
 40%|████      | 4/10 [04:14<06:10, 61.68s/it][A
 40%|████      | 4/10 [04:10<06:07, 61.19s/it][A
 40%|████      | 4/10 [04:11<06:07, 61.29s/it][A
 50%|█████     | 5/10 [04:58<04:56, 59.22s/it][A[2024-05-30 14:24:05,966] [INFO] [logging.py:96:log_dist] [Rank 0] step=745, skipped=0, lr=[1.9477147629063637e-05], mom=[(0.9, 0.999)]
steps: 745 loss: 0.6028 iter time (s): 57.789 samples/sec: 2.215

 50%|█████     | 5/10 [05:10<05:01, 60.24s/it][A
 50%|█████     | 5/10 [05:29<05:09, 61.88s/it][A
 50%|█████     | 5/10 [06:10<05:27, 65.44s/it][A
 50%|█████     | 5/10 [05:28<05:09, 61.89s/it][A
 50%|█████     | 5/10 [05:10<05:01, 60.25s/it][A
 50%|█████     | 5/10 [05:12<05:02, 60.53s/it][A
 50%|█████     | 5/10 [05:09<05:01, 60.22s/it][A
 60%|██████    | 6/10 [05:56<03:54, 58.58s/it][A[2024-05-30 14:25:03,297] [INFO] [logging.py:96:log_dist] [Rank 0] step=746, skipped=0, lr=[1.9475338668992883e-05], mom=[(0.9, 0.999)]
steps: 746 loss: 0.5623 iter time (s): 56.610 samples/sec: 2.261

 60%|██████    | 6/10 [06:07<03:57, 59.25s/it][A
 60%|██████    | 6/10 [06:26<04:01, 60.35s/it][A
 60%|██████    | 6/10 [07:07<04:10, 62.67s/it][A
 60%|██████    | 6/10 [06:26<04:01, 60.31s/it][A
 60%|██████    | 6/10 [06:07<03:56, 59.23s/it][A
 60%|██████    | 6/10 [06:10<03:57, 59.40s/it][A
 60%|██████    | 6/10 [06:06<03:56, 59.19s/it][A
 70%|███████   | 7/10 [06:52<02:53, 57.80s/it][A[2024-05-30 14:25:59,489] [INFO] [logging.py:96:log_dist] [Rank 0] step=747, skipped=0, lr=[1.947352666931911e-05], mom=[(0.9, 0.999)]
steps: 747 loss: 0.5924 iter time (s): 55.606 samples/sec: 2.302

 70%|███████   | 7/10 [07:03<02:54, 58.26s/it][A
 70%|███████   | 7/10 [07:22<02:56, 58.97s/it][A
 70%|███████   | 7/10 [08:03<03:01, 60.57s/it][A
 70%|███████   | 7/10 [07:22<02:56, 58.97s/it][A
 70%|███████   | 7/10 [07:06<02:55, 58.36s/it][A
 70%|███████   | 7/10 [07:02<02:54, 58.22s/it][A
 70%|███████   | 7/10 [07:03<02:54, 58.26s/it][A
 80%|████████  | 8/10 [07:49<01:55, 57.51s/it][A[2024-05-30 14:26:56,374] [INFO] [logging.py:96:log_dist] [Rank 0] step=748, skipped=0, lr=[1.947171163062364e-05], mom=[(0.9, 0.999)]
steps: 748 loss: 0.6435 iter time (s): 56.271 samples/sec: 2.275

 80%|████████  | 8/10 [08:00<01:55, 57.81s/it][A
 80%|████████  | 8/10 [08:19<01:56, 58.30s/it][A
 80%|████████  | 8/10 [09:00<01:58, 59.40s/it][A
 80%|████████  | 8/10 [08:19<01:56, 58.32s/it][A
 80%|████████  | 8/10 [08:03<01:55, 57.88s/it][A
 80%|████████  | 8/10 [08:00<01:55, 57.81s/it][A
 80%|████████  | 8/10 [07:59<01:55, 57.79s/it][A
 90%|█████████ | 9/10 [09:02<01:02, 62.44s/it][A[2024-05-30 14:28:09,645] [INFO] [logging.py:96:log_dist] [Rank 0] step=749, skipped=0, lr=[1.9469893553488793e-05], mom=[(0.9, 0.999)]
steps: 749 loss: 0.5687 iter time (s): 72.729 samples/sec: 1.760

 90%|█████████ | 9/10 [09:13<01:02, 62.67s/it][A
 90%|█████████ | 9/10 [09:32<01:03, 63.03s/it][A
 90%|█████████ | 9/10 [10:13<01:03, 63.75s/it][A
 90%|█████████ | 9/10 [09:32<01:03, 63.01s/it][A

 90%|█████████ | 9/10 [09:16<01:02, 62.72s/it][A 90%|█████████ | 9/10 [09:13<01:02, 62.67s/it][A
 90%|█████████ | 9/10 [09:13<01:02, 62.66s/it][A
100%|██████████| 10/10 [10:01<00:00, 61.27s/it][A100%|██████████| 10/10 [10:01<00:00, 60.11s/it]
[2024-05-30 14:29:08,294] [INFO] [logging.py:96:log_dist] [Rank 0] step=750, skipped=0, lr=[1.946807243849784e-05], mom=[(0.9, 0.999)]
steps: 750 loss: 0.6204 iter time (s): 57.950 samples/sec: 2.209

100%|██████████| 10/10 [10:12<00:00, 61.42s/it][A100%|██████████| 10/10 [10:12<00:00, 61.25s/it]

100%|██████████| 10/10 [10:31<00:00, 61.65s/it][A100%|██████████| 10/10 [10:31<00:00, 63.14s/it]

100%|██████████| 10/10 [11:12<00:00, 62.16s/it][A100%|██████████| 10/10 [11:12<00:00, 67.24s/it]

100%|██████████| 10/10 [10:31<00:00, 61.65s/it][A100%|██████████| 10/10 [10:31<00:00, 63.11s/it]

100%|██████████| 10/10 [10:15<00:00, 61.44s/it][A100%|██████████| 10/10 [10:15<00:00, 61.52s/it]

100%|██████████| 10/10 [10:12<00:00, 61.41s/it][A100%|██████████| 10/10 [10:12<00:00, 61.23s/it]

100%|██████████| 10/10 [10:11<00:00, 61.40s/it][A100%|██████████| 10/10 [10:11<00:00, 61.16s/it]
Checkpointing at shard 75
[2024-05-30 14:29:13,475] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step750 is about to be saved!
[2024-05-30 14:29:15,129] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_00-model_states.pt...
[2024-05-30 14:29:18,710] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_05-model_states.pt...
[2024-05-30 14:29:20,011] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_06-model_states.pt...
[2024-05-30 14:29:20,164] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_02-model_states.pt...
[2024-05-30 14:29:20,834] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_00-model_states.pt.
[2024-05-30 14:29:20,912] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_07-model_states.pt...
[2024-05-30 14:29:21,264] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_08-model_states.pt...
[2024-05-30 14:29:24,289] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_01-model_states.pt...
[2024-05-30 14:29:26,348] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_04-model_states.pt...
[2024-05-30 14:29:27,297] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_03-model_states.pt...
[2024-05-30 14:35:52,684] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_02-model_states.pt.
[2024-05-30 14:35:52,729] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_01_model_states.pt
[2024-05-30 14:35:52,729] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_01_model_states.pt...
[2024-05-30 14:35:53,057] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_06-model_states.pt.
[2024-05-30 14:35:53,086] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_01_model_states.pt.
[2024-05-30 14:35:53,086] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step750 is ready now!
[2024-05-30 14:35:53,114] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_05_model_states.pt...
[2024-05-30 14:35:53,666] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_05_model_states.pt.
[2024-05-30 14:35:53,666] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step750 is ready now!
[2024-05-30 14:36:03,250] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_05-model_states.pt.
[2024-05-30 14:36:03,250] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_07-model_states.pt.
[2024-05-30 14:36:03,251] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_08-model_states.pt.
[2024-05-30 14:36:03,290] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_04_model_states.pt...
[2024-05-30 14:36:03,308] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_06_model_states.pt...
[2024-05-30 14:36:03,345] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_01-model_states.pt.
[2024-05-30 14:36:03,378] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_04-model_states.pt.
[2024-05-30 14:36:03,385] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_00_model_states.pt
[2024-05-30 14:36:03,385] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_00_model_states.pt...
[2024-05-30 14:36:03,399] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_09-model_states.pt...
[2024-05-30 14:36:03,430] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_03_model_states.pt...
[2024-05-30 14:36:03,466] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_03-model_states.pt.
[2024-05-30 14:36:03,491] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_04_model_states.pt.
[2024-05-30 14:36:03,491] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step750 is ready now!
[2024-05-30 14:36:03,497] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_06_model_states.pt.
[2024-05-30 14:36:03,498] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step750 is ready now!
[2024-05-30 14:36:03,591] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_03_model_states.pt.
[2024-05-30 14:36:03,591] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step750 is ready now!
[2024-05-30 14:36:03,981] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_02_model_states.pt...
[2024-05-30 14:36:04,120] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_02_model_states.pt.
[2024-05-30 14:36:04,120] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step750 is ready now!
[2024-05-30 14:36:04,147] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_00_model_states.pt.
[2024-05-30 14:36:04,148] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step750 is ready now!
[2024-05-30 14:36:04,245] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/layer_09-model_states.pt.
[2024-05-30 14:36:04,267] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_07_model_states.pt...
[2024-05-30 14:36:04,355] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step750/mp_rank_07_model_states.pt.
[2024-05-30 14:36:04,356] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step750 is ready now!
Checkpoint saved using --- 415.4488980770111 seconds ---
 14%|█▍        | 75/520 [18:08<1:47:37, 14.51s/it] 14%|█▍        | 75/520 [17:26<1:43:29, 13.95s/it] 14%|█▍        | 75/520 [17:07<1:41:33, 13.69s/it] 14%|█▍        | 75/520 [17:10<1:41:55, 13.74s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_182
 14%|█▍        | 75/520 [16:58<1:40:42, 13.58s/it] 14%|█▍        | 75/520 [17:08<1:41:40, 13.71s/it] 14%|█▍        | 75/520 [17:07<1:41:38, 13.70s/it] 14%|█▍        | 75/520 [17:27<1:43:32, 13.96s/it]Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:42<15:23, 102.66s/it][A[2024-05-30 14:37:49,871] [INFO] [logging.py:96:log_dist] [Rank 0] step=751, skipped=0, lr=[1.946624828623506e-05], mom=[(0.9, 0.999)]
steps: 751 loss: 0.6134 iter time (s): 105.084 samples/sec: 1.218

 10%|█         | 1/10 [01:45<15:48, 105.35s/it][A
 10%|█         | 1/10 [01:45<15:49, 105.51s/it][A
 10%|█         | 1/10 [01:45<15:50, 105.64s/it][A
 10%|█         | 1/10 [01:45<15:51, 105.76s/it][A
 10%|█         | 1/10 [01:45<15:52, 105.82s/it][A
 10%|█         | 1/10 [01:45<15:52, 105.84s/it][A
 10%|█         | 1/10 [01:45<15:52, 105.88s/it][A
 20%|██        | 2/10 [03:27<13:49, 103.74s/it][A[2024-05-30 14:39:34,355] [INFO] [logging.py:96:log_dist] [Rank 0] step=752, skipped=0, lr=[1.9464421097285668e-05], mom=[(0.9, 0.999)]
steps: 752 loss: 0.6211 iter time (s): 103.714 samples/sec: 1.234

 20%|██        | 2/10 [03:29<13:58, 104.86s/it][A
 20%|██        | 2/10 [03:30<13:59, 104.93s/it][A
 20%|██        | 2/10 [03:30<13:59, 105.00s/it][A
 20%|██        | 2/10 [03:30<14:00, 105.01s/it][A
 20%|██        | 2/10 [03:30<14:00, 105.01s/it][A
 20%|██        | 2/10 [03:30<14:00, 105.04s/it][A
 20%|██        | 2/10 [03:30<14:00, 105.05s/it][A
 30%|███       | 3/10 [05:11<12:07, 103.99s/it][A[2024-05-30 14:41:18,665] [INFO] [logging.py:96:log_dist] [Rank 0] step=753, skipped=0, lr=[1.946259087223588e-05], mom=[(0.9, 0.999)]
steps: 753 loss: 0.6145 iter time (s): 103.548 samples/sec: 1.236

 30%|███       | 3/10 [05:14<12:12, 104.61s/it][A
 30%|███       | 3/10 [05:14<12:12, 104.65s/it][A
 30%|███       | 3/10 [05:14<12:12, 104.67s/it][A
 30%|███       | 3/10 [05:14<12:12, 104.70s/it][A
 30%|███       | 3/10 [05:14<12:13, 104.72s/it][A
 30%|███       | 3/10 [05:14<12:12, 104.71s/it][A
 30%|███       | 3/10 [05:14<12:13, 104.73s/it][A
 40%|████      | 4/10 [06:59<10:34, 105.69s/it][A[2024-05-30 14:43:06,937] [INFO] [logging.py:96:log_dist] [Rank 0] step=754, skipped=0, lr=[1.9460757611672877e-05], mom=[(0.9, 0.999)]
steps: 754 loss: 0.5941 iter time (s): 107.501 samples/sec: 1.191

 40%|████      | 4/10 [07:02<10:36, 106.06s/it][A
 40%|████      | 4/10 [07:02<10:36, 106.07s/it][A
 40%|████      | 4/10 [07:02<10:36, 106.10s/it][A
 40%|████      | 4/10 [07:02<10:36, 106.09s/it][A
 40%|████      | 4/10 [07:02<10:36, 106.10s/it][A
 40%|████      | 4/10 [07:02<10:36, 106.11s/it][A
 40%|████      | 4/10 [07:02<10:36, 106.11s/it][A
 50%|█████     | 5/10 [08:54<09:05, 109.04s/it][A[2024-05-30 14:45:01,927] [INFO] [logging.py:96:log_dist] [Rank 0] step=755, skipped=0, lr=[1.945892131618481e-05], mom=[(0.9, 0.999)]
steps: 755 loss: 0.5986 iter time (s): 114.229 samples/sec: 1.121

 50%|█████     | 5/10 [08:57<09:06, 109.29s/it][A
 50%|█████     | 5/10 [08:57<09:06, 109.28s/it][A
 50%|█████     | 5/10 [08:57<09:06, 109.30s/it][A
 50%|█████     | 5/10 [08:57<09:06, 109.31s/it][A
 50%|█████     | 5/10 [08:57<09:06, 109.31s/it][A
 50%|█████     | 5/10 [08:57<09:06, 109.32s/it][A
 50%|█████     | 5/10 [08:57<09:06, 109.32s/it][A
 60%|██████    | 6/10 [10:39<07:10, 107.53s/it][A[2024-05-30 14:46:46,516] [INFO] [logging.py:96:log_dist] [Rank 0] step=756, skipped=0, lr=[1.9457081986360816e-05], mom=[(0.9, 0.999)]
steps: 756 loss: 0.5951 iter time (s): 103.808 samples/sec: 1.233

 60%|██████    | 6/10 [10:42<07:10, 107.70s/it][A
 60%|██████    | 6/10 [10:42<07:10, 107.70s/it][A
 60%|██████    | 6/10 [10:42<07:10, 107.71s/it][A
 60%|██████    | 6/10 [10:42<07:10, 107.71s/it][A
 60%|██████    | 6/10 [10:42<07:10, 107.71s/it][A
 60%|██████    | 6/10 [10:42<07:10, 107.72s/it][A
 60%|██████    | 6/10 [10:42<07:10, 107.72s/it][A
 70%|███████   | 7/10 [12:24<05:20, 106.71s/it][A[2024-05-30 14:48:31,547] [INFO] [logging.py:96:log_dist] [Rank 0] step=757, skipped=0, lr=[1.945523962279099e-05], mom=[(0.9, 0.999)]
steps: 757 loss: 0.5549 iter time (s): 104.236 samples/sec: 1.228

 70%|███████   | 7/10 [12:27<05:20, 106.83s/it][A
 70%|███████   | 7/10 [12:27<05:20, 106.80s/it][A
 70%|███████   | 7/10 [12:27<05:20, 106.83s/it][A
 70%|███████   | 7/10 [12:27<05:20, 106.81s/it][A
 70%|███████   | 7/10 [12:27<05:20, 106.83s/it][A
 70%|███████   | 7/10 [12:27<05:20, 106.82s/it][A
 70%|███████   | 7/10 [12:27<05:20, 106.83s/it][A
 80%|████████  | 8/10 [14:08<03:31, 105.74s/it][A[2024-05-30 14:50:15,210] [INFO] [logging.py:96:log_dist] [Rank 0] step=758, skipped=0, lr=[1.945339422606641e-05], mom=[(0.9, 0.999)]
steps: 758 loss: 0.5464 iter time (s): 102.909 samples/sec: 1.244

 80%|████████  | 8/10 [14:10<03:31, 105.80s/it][A
 80%|████████  | 8/10 [14:10<03:31, 105.81s/it][A
 80%|████████  | 8/10 [14:10<03:31, 105.81s/it][A
 80%|████████  | 8/10 [14:11<03:31, 105.81s/it][A
 80%|████████  | 8/10 [14:11<03:31, 105.82s/it][A
 80%|████████  | 8/10 [14:11<03:31, 105.81s/it][A
 80%|████████  | 8/10 [14:11<03:31, 105.82s/it][A
 90%|█████████ | 9/10 [15:51<01:45, 105.19s/it][A[2024-05-30 14:51:59,197] [INFO] [logging.py:96:log_dist] [Rank 0] step=759, skipped=0, lr=[1.9451545796779134e-05], mom=[(0.9, 0.999)]
steps: 759 loss: 0.5805 iter time (s): 103.237 samples/sec: 1.240

 90%|█████████ | 9/10 [15:54<01:45, 105.24s/it][A
 90%|█████████ | 9/10 [15:54<01:45, 105.22s/it][A
 90%|█████████ | 9/10 [15:54<01:45, 105.23s/it][A
 90%|█████████ | 9/10 [15:55<01:45, 105.25s/it][A
 90%|█████████ | 9/10 [15:55<01:45, 105.25s/it][A
 90%|█████████ | 9/10 [15:55<01:45, 105.24s/it][A
 90%|█████████ | 9/10 [15:55<01:45, 105.26s/it][A
100%|██████████| 10/10 [17:36<00:00, 104.91s/it][A100%|██████████| 10/10 [17:36<00:00, 105.63s/it]
 15%|█▍        | 76/520 [34:35<4:04:45, 33.08s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 14:53:43,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=760, skipped=0, lr=[1.9449694335522173e-05], mom=[(0.9, 0.999)]
steps: 760 loss: 0.5695 iter time (s): 103.531 samples/sec: 1.236

100%|██████████| 10/10 [17:38<00:00, 104.93s/it][A100%|██████████| 10/10 [17:38<00:00, 105.90s/it]
 15%|█▍        | 76/520 [34:47<4:06:05, 33.26s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:39<00:00, 104.95s/it][A100%|██████████| 10/10 [17:39<00:00, 105.91s/it]
 15%|█▍        | 76/520 [35:06<4:07:56, 33.51s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:39<00:00, 104.94s/it][A100%|██████████| 10/10 [17:39<00:00, 105.92s/it]
 15%|█▍        | 76/520 [35:48<4:11:57, 34.05s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:39<00:00, 104.94s/it][A100%|██████████| 10/10 [17:39<00:00, 105.93s/it]
 15%|█▍        | 76/520 [35:06<4:07:55, 33.50s/it]
100%|██████████| 10/10 [17:39<00:00, 104.93s/it][A100%|██████████| 10/10 [17:39<00:00, 105.93s/it]
 15%|█▍        | 76/520 [34:50<4:06:22, 33.29s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:39<00:00, 104.94s/it][A100%|██████████| 10/10 [17:39<00:00, 105.94s/it]
 15%|█▍        | 76/520 [34:47<4:06:06, 33.26s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:39<00:00, 104.94s/it][A100%|██████████| 10/10 [17:39<00:00, 105.95s/it]
 15%|█▍        | 76/520 [34:46<4:06:02, 33.25s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_180
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:34<23:13, 154.85s/it][A[2024-05-30 14:56:19,970] [INFO] [logging.py:96:log_dist] [Rank 0] step=761, skipped=0, lr=[1.9447839842889523e-05], mom=[(0.9, 0.999)]
steps: 761 loss: 0.5833 iter time (s): 155.678 samples/sec: 0.822

 10%|█         | 1/10 [02:36<23:29, 156.57s/it][A
 10%|█         | 1/10 [02:36<23:28, 156.49s/it][A
 10%|█         | 1/10 [02:36<23:28, 156.53s/it][A
 10%|█         | 1/10 [02:36<23:28, 156.47s/it][A
 10%|█         | 1/10 [02:36<23:28, 156.52s/it][A
 10%|█         | 1/10 [02:36<23:28, 156.50s/it][A
 10%|█         | 1/10 [02:36<23:28, 156.49s/it][A
 20%|██        | 2/10 [05:11<20:45, 155.66s/it][A[2024-05-30 14:58:56,193] [INFO] [logging.py:96:log_dist] [Rank 0] step=762, skipped=0, lr=[1.9445982319476153e-05], mom=[(0.9, 0.999)]
steps: 762 loss: 0.5566 iter time (s): 155.479 samples/sec: 0.823

 20%|██        | 2/10 [05:12<20:50, 156.32s/it][A
 20%|██        | 2/10 [05:12<20:50, 156.30s/it][A
 20%|██        | 2/10 [05:12<20:50, 156.34s/it][A
 20%|██        | 2/10 [05:12<20:50, 156.31s/it][A
 20%|██        | 2/10 [05:12<20:50, 156.34s/it][A
 20%|██        | 2/10 [05:12<20:50, 156.31s/it][A
 20%|██        | 2/10 [05:12<20:50, 156.31s/it][A
 30%|███       | 3/10 [07:47<18:11, 155.87s/it][A[2024-05-30 15:01:32,321] [INFO] [logging.py:96:log_dist] [Rank 0] step=763, skipped=0, lr=[1.9444121765878002e-05], mom=[(0.9, 0.999)]
steps: 763 loss: 0.5754 iter time (s): 155.442 samples/sec: 0.823

 30%|███       | 3/10 [07:48<18:13, 156.25s/it][A
 30%|███       | 3/10 [07:48<18:13, 156.23s/it][A
 30%|███       | 3/10 [07:48<18:13, 156.24s/it][A
 30%|███       | 3/10 [07:48<18:13, 156.23s/it][A
 30%|███       | 3/10 [07:48<18:13, 156.23s/it][A
 30%|███       | 3/10 [07:48<18:13, 156.23s/it][A
 30%|███       | 3/10 [07:48<18:13, 156.23s/it][A
 40%|████      | 4/10 [10:23<15:35, 155.99s/it][A[2024-05-30 15:04:08,491] [INFO] [logging.py:96:log_dist] [Rank 0] step=764, skipped=0, lr=[1.944225818269199e-05], mom=[(0.9, 0.999)]
steps: 764 loss: 0.5660 iter time (s): 155.490 samples/sec: 0.823

 40%|████      | 4/10 [10:25<15:37, 156.20s/it][A
 40%|████      | 4/10 [10:25<15:37, 156.22s/it][A
 40%|████      | 4/10 [10:24<15:36, 156.16s/it][A
 40%|████      | 4/10 [10:25<15:37, 156.24s/it][A
 40%|████      | 4/10 [10:24<15:37, 156.20s/it][A
 40%|████      | 4/10 [10:24<15:37, 156.21s/it][A
 40%|████      | 4/10 [10:24<15:37, 156.20s/it][A
 50%|█████     | 5/10 [12:59<12:59, 155.95s/it][A[2024-05-30 15:06:44,359] [INFO] [logging.py:96:log_dist] [Rank 0] step=765, skipped=0, lr=[1.9440391570515985e-05], mom=[(0.9, 0.999)]
steps: 765 loss: 0.5571 iter time (s): 155.189 samples/sec: 0.825

 50%|█████     | 5/10 [13:00<13:00, 156.09s/it][A
 50%|█████     | 5/10 [13:00<13:00, 156.07s/it][A
 50%|█████     | 5/10 [13:00<13:00, 156.07s/it][A
 50%|█████     | 5/10 [13:00<13:00, 156.08s/it][A
 50%|█████     | 5/10 [13:00<13:00, 156.09s/it][A
 50%|█████     | 5/10 [13:00<13:00, 156.08s/it][A
 50%|█████     | 5/10 [13:00<13:00, 156.08s/it][A
 60%|██████    | 6/10 [15:40<10:30, 157.59s/it][A[2024-05-30 15:09:25,141] [INFO] [logging.py:96:log_dist] [Rank 0] step=766, skipped=0, lr=[1.9438521929948858e-05], mom=[(0.9, 0.999)]
steps: 766 loss: 0.5489 iter time (s): 160.108 samples/sec: 0.799

 60%|██████    | 6/10 [15:41<10:30, 157.66s/it][A
 60%|██████    | 6/10 [15:41<10:30, 157.65s/it][A
 60%|██████    | 6/10 [15:41<10:30, 157.66s/it][A
 60%|██████    | 6/10 [15:41<10:30, 157.67s/it][A
 60%|██████    | 6/10 [15:41<10:30, 157.68s/it][A
 60%|██████    | 6/10 [15:41<10:30, 157.67s/it][A
 60%|██████    | 6/10 [15:41<10:30, 157.67s/it][A
 70%|███████   | 7/10 [18:16<07:51, 157.31s/it][A[2024-05-30 15:12:01,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=767, skipped=0, lr=[1.9436649261590425e-05], mom=[(0.9, 0.999)]
steps: 767 loss: 0.5765 iter time (s): 156.089 samples/sec: 0.820

 70%|███████   | 7/10 [18:18<07:52, 157.38s/it][A
 70%|███████   | 7/10 [18:18<07:52, 157.38s/it][A
 70%|███████   | 7/10 [18:18<07:52, 157.38s/it][A
 70%|███████   | 7/10 [18:18<07:52, 157.40s/it][A
 70%|███████   | 7/10 [18:18<07:52, 157.38s/it][A
 70%|███████   | 7/10 [18:18<07:52, 157.38s/it][A
 70%|███████   | 7/10 [18:18<07:52, 157.38s/it][A
 80%|████████  | 8/10 [20:52<05:13, 156.91s/it][A[2024-05-30 15:14:37,944] [INFO] [logging.py:96:log_dist] [Rank 0] step=768, skipped=0, lr=[1.9434773566041492e-05], mom=[(0.9, 0.999)]
steps: 768 loss: 0.5622 iter time (s): 155.365 samples/sec: 0.824

 80%|████████  | 8/10 [20:54<05:13, 156.99s/it][A
 80%|████████  | 8/10 [20:54<05:13, 156.98s/it][A
 80%|████████  | 8/10 [20:54<05:13, 156.99s/it][A
 80%|████████  | 8/10 [20:54<05:14, 157.01s/it][A
 80%|████████  | 8/10 [20:54<05:14, 157.04s/it][A
 80%|████████  | 8/10 [20:54<05:14, 157.08s/it][A
 80%|████████  | 8/10 [20:55<05:14, 157.18s/it][A
 90%|█████████ | 9/10 [23:29<02:36, 156.75s/it][A[2024-05-30 15:17:14,447] [INFO] [logging.py:96:log_dist] [Rank 0] step=769, skipped=0, lr=[1.9432894843903823e-05], mom=[(0.9, 0.999)]
steps: 769 loss: 0.5767 iter time (s): 155.423 samples/sec: 0.824

 90%|█████████ | 9/10 [23:30<02:36, 156.57s/it][A
 90%|█████████ | 9/10 [23:30<02:36, 156.80s/it][A
 90%|█████████ | 9/10 [23:30<02:36, 156.79s/it][A
 90%|█████████ | 9/10 [23:30<02:36, 156.78s/it][A
 90%|█████████ | 9/10 [23:30<02:36, 156.78s/it][A
 90%|█████████ | 9/10 [23:30<02:36, 156.77s/it][A
 90%|█████████ | 9/10 [23:30<02:36, 156.72s/it][A
100%|██████████| 10/10 [26:04<00:00, 156.32s/it][A100%|██████████| 10/10 [26:04<00:00, 156.46s/it]
 15%|█▍        | 77/520 [1:00:39<8:58:19, 72.91s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 15:19:49,666] [INFO] [logging.py:96:log_dist] [Rank 0] step=770, skipped=0, lr=[1.943101309578016e-05], mom=[(0.9, 0.999)]
steps: 770 loss: 0.5904 iter time (s): 155.188 samples/sec: 0.825

100%|██████████| 10/10 [26:06<00:00, 156.31s/it][A100%|██████████| 10/10 [26:06<00:00, 156.62s/it]
 15%|█▍        | 77/520 [1:00:53<8:59:53, 73.12s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [26:06<00:00, 156.33s/it][A100%|██████████| 10/10 [26:06<00:00, 156.62s/it]
 15%|█▍        | 77/520 [1:01:12<9:01:41, 73.37s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [26:06<00:00, 156.34s/it][A100%|██████████| 10/10 [26:06<00:00, 156.63s/it]
 15%|█▍        | 77/520 [1:01:54<9:05:36, 73.90s/it]
100%|██████████| 10/10 [26:06<00:00, 156.33s/it][A100%|██████████| 10/10 [26:06<00:00, 156.62s/it]
 15%|█▍        | 77/520 [1:01:12<9:01:40, 73.36s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [26:06<00:00, 156.33s/it][A100%|██████████| 10/10 [26:06<00:00, 156.62s/it]
 15%|█▍        | 77/520 [1:00:56<9:00:11, 73.16s/it]
100%|██████████| 10/10 [26:06<00:00, 156.36s/it][A100%|██████████| 10/10 [26:06<00:00, 156.61s/it]
 15%|█▍        | 77/520 [1:00:53<8:59:50, 73.12s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_448

100%|██████████| 10/10 [26:06<00:00, 156.29s/it][A100%|██████████| 10/10 [26:06<00:00, 156.62s/it]
 15%|█▍        | 77/520 [1:00:53<8:59:54, 73.13s/it]
  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:03<09:33, 63.76s/it][A[2024-05-30 15:20:51,003] [INFO] [logging.py:96:log_dist] [Rank 0] step=771, skipped=0, lr=[1.9429128322274217e-05], mom=[(0.9, 0.999)]
steps: 771 loss: 0.3166 iter time (s): 60.537 samples/sec: 2.114

 10%|█         | 1/10 [01:01<09:11, 61.33s/it][A
 10%|█         | 1/10 [01:01<09:11, 61.29s/it][A
 10%|█         | 1/10 [01:01<09:10, 61.14s/it][A
 10%|█         | 1/10 [01:01<09:10, 61.20s/it][A
 10%|█         | 1/10 [01:01<09:11, 61.25s/it][A
 10%|█         | 1/10 [01:01<09:11, 61.27s/it][A
 10%|█         | 1/10 [01:01<09:11, 61.27s/it][A
 20%|██        | 2/10 [02:02<08:08, 61.09s/it][A[2024-05-30 15:21:50,242] [INFO] [logging.py:96:log_dist] [Rank 0] step=772, skipped=0, lr=[1.9427240523990677e-05], mom=[(0.9, 0.999)]
steps: 772 loss: 0.2939 iter time (s): 58.609 samples/sec: 2.184

 20%|██        | 2/10 [02:00<08:00, 60.05s/it][A
 20%|██        | 2/10 [02:00<08:00, 60.09s/it][A
 20%|██        | 2/10 [02:00<08:00, 60.05s/it][A
 20%|██        | 2/10 [02:00<08:00, 60.05s/it][A
 20%|██        | 2/10 [02:00<08:00, 60.07s/it][A
 20%|██        | 2/10 [02:00<08:00, 60.08s/it][A
 20%|██        | 2/10 [02:00<08:00, 60.08s/it][A
 30%|███       | 3/10 [03:02<07:03, 60.47s/it][A[2024-05-30 15:22:49,961] [INFO] [logging.py:96:log_dist] [Rank 0] step=773, skipped=0, lr=[1.9425349701535187e-05], mom=[(0.9, 0.999)]
steps: 773 loss: 0.2979 iter time (s): 59.073 samples/sec: 2.167

 30%|███       | 3/10 [03:00<06:59, 59.94s/it][A
 30%|███       | 3/10 [03:00<06:59, 59.89s/it][A
 30%|███       | 3/10 [03:00<06:59, 59.89s/it][A
 30%|███       | 3/10 [03:00<06:59, 59.91s/it][A
 30%|███       | 3/10 [03:00<06:59, 59.89s/it][A
 30%|███       | 3/10 [03:00<06:59, 59.91s/it][A
 30%|███       | 3/10 [03:00<06:59, 59.91s/it][A
 40%|████      | 4/10 [04:04<06:06, 61.08s/it][A[2024-05-30 15:23:51,981] [INFO] [logging.py:96:log_dist] [Rank 0] step=774, skipped=0, lr=[1.942345585551437e-05], mom=[(0.9, 0.999)]
steps: 774 loss: 0.3225 iter time (s): 61.382 samples/sec: 2.085

 40%|████      | 4/10 [04:02<06:04, 60.74s/it][A
 40%|████      | 4/10 [04:02<06:04, 60.76s/it][A
 40%|████      | 4/10 [04:02<06:04, 60.76s/it][A
 40%|████      | 4/10 [04:02<06:04, 60.75s/it][A
 40%|████      | 4/10 [04:02<06:04, 60.75s/it][A
 40%|████      | 4/10 [04:02<06:04, 60.75s/it][A
 40%|████      | 4/10 [04:02<06:04, 60.76s/it][A
 50%|█████     | 5/10 [05:04<05:03, 60.64s/it][A[2024-05-30 15:24:51,840] [INFO] [logging.py:96:log_dist] [Rank 0] step=775, skipped=0, lr=[1.942155898653583e-05], mom=[(0.9, 0.999)]
steps: 775 loss: 0.2919 iter time (s): 59.208 samples/sec: 2.162

 50%|█████     | 5/10 [05:02<05:02, 60.43s/it][A
 50%|█████     | 5/10 [05:02<05:02, 60.44s/it][A
 50%|█████     | 5/10 [05:02<05:02, 60.41s/it][A
 50%|█████     | 5/10 [05:02<05:02, 60.43s/it][A
 50%|█████     | 5/10 [05:02<05:02, 60.43s/it][A
 50%|█████     | 5/10 [05:02<05:02, 60.44s/it][A
 50%|█████     | 5/10 [05:02<05:02, 60.44s/it][A
 60%|██████    | 6/10 [06:04<04:02, 60.54s/it][A[2024-05-30 15:25:52,181] [INFO] [logging.py:96:log_dist] [Rank 0] step=776, skipped=0, lr=[1.9419659095208117e-05], mom=[(0.9, 0.999)]
steps: 776 loss: 0.2887 iter time (s): 59.657 samples/sec: 2.146

 60%|██████    | 6/10 [06:02<04:01, 60.42s/it][A
 60%|██████    | 6/10 [06:02<04:01, 60.40s/it][A
 60%|██████    | 6/10 [06:02<04:01, 60.38s/it][A
 60%|██████    | 6/10 [06:02<04:01, 60.39s/it][A
 60%|██████    | 6/10 [06:02<04:01, 60.39s/it][A
 60%|██████    | 6/10 [06:02<04:01, 60.39s/it][A
 60%|██████    | 6/10 [06:02<04:01, 60.39s/it][A
 70%|███████   | 7/10 [07:04<03:01, 60.34s/it][A[2024-05-30 15:26:52,119] [INFO] [logging.py:96:log_dist] [Rank 0] step=777, skipped=0, lr=[1.941775618214077e-05], mom=[(0.9, 0.999)]
steps: 777 loss: 0.2840 iter time (s): 59.287 samples/sec: 2.159

 70%|███████   | 7/10 [07:02<03:00, 60.25s/it][A
 70%|███████   | 7/10 [07:02<03:00, 60.26s/it][A
 70%|███████   | 7/10 [07:02<03:00, 60.25s/it][A
 70%|███████   | 7/10 [07:02<03:00, 60.25s/it][A
 70%|███████   | 7/10 [07:02<03:00, 60.25s/it][A
 70%|███████   | 7/10 [07:02<03:00, 60.25s/it][A
 70%|███████   | 7/10 [07:02<03:00, 60.25s/it][A
 80%|████████  | 8/10 [08:04<02:00, 60.05s/it][A[2024-05-30 15:27:51,554] [INFO] [logging.py:96:log_dist] [Rank 0] step=778, skipped=0, lr=[1.9415850247944285e-05], mom=[(0.9, 0.999)]
steps: 778 loss: 0.2987 iter time (s): 58.766 samples/sec: 2.178

 80%|████████  | 8/10 [08:01<01:59, 60.00s/it][A
 80%|████████  | 8/10 [08:01<01:59, 59.98s/it][A
 80%|████████  | 8/10 [08:01<01:59, 59.99s/it][A
 80%|████████  | 8/10 [08:01<02:00, 60.01s/it][A
 80%|████████  | 8/10 [08:01<01:59, 59.98s/it][A
 80%|████████  | 8/10 [08:01<01:59, 59.99s/it][A
 80%|████████  | 8/10 [08:01<01:59, 59.99s/it][A
 90%|█████████ | 9/10 [09:05<01:00, 60.26s/it][A[2024-05-30 15:28:52,258] [INFO] [logging.py:96:log_dist] [Rank 0] step=779, skipped=0, lr=[1.941394129323014e-05], mom=[(0.9, 0.999)]
steps: 779 loss: 0.3017 iter time (s): 60.042 samples/sec: 2.132

 90%|█████████ | 9/10 [09:02<01:00, 60.22s/it][A
 90%|█████████ | 9/10 [09:02<01:00, 60.21s/it][A
 90%|█████████ | 9/10 [09:02<01:00, 60.21s/it][A
 90%|█████████ | 9/10 [09:02<01:00, 60.20s/it][A
 90%|█████████ | 9/10 [09:02<01:00, 60.21s/it][A
 90%|█████████ | 9/10 [09:02<01:00, 60.21s/it][A
 90%|█████████ | 9/10 [09:02<01:00, 60.21s/it][A
100%|██████████| 10/10 [10:06<00:00, 60.61s/it][A100%|██████████| 10/10 [10:06<00:00, 60.64s/it]
 15%|█▌        | 78/520 [1:10:46<11:17:57, 92.03s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 15:29:53,663] [INFO] [logging.py:96:log_dist] [Rank 0] step=780, skipped=0, lr=[1.9412029318610768e-05], mom=[(0.9, 0.999)]
steps: 780 loss: 0.2849 iter time (s): 60.737 samples/sec: 2.107

100%|██████████| 10/10 [10:04<00:00, 60.58s/it][A100%|██████████| 10/10 [10:04<00:00, 60.40s/it]
 15%|█▌        | 78/520 [1:10:57<11:18:46, 92.14s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:03<00:00, 60.57s/it][A100%|██████████| 10/10 [10:03<00:00, 60.39s/it]
 15%|█▌        | 78/520 [1:11:16<11:20:28, 92.37s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:03<00:00, 60.57s/it][A100%|██████████| 10/10 [10:03<00:00, 60.38s/it]
 15%|█▌        | 78/520 [1:11:58<11:24:13, 92.88s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:03<00:00, 60.56s/it][A100%|██████████| 10/10 [10:03<00:00, 60.39s/it]
 15%|█▌        | 78/520 [1:11:16<11:20:26, 92.37s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:03<00:00, 60.57s/it][A100%|██████████| 10/10 [10:03<00:00, 60.39s/it]
 15%|█▌        | 78/520 [1:11:00<11:19:01, 92.18s/it]
100%|██████████| 10/10 [10:03<00:00, 60.57s/it][A100%|██████████| 10/10 [10:03<00:00, 60.39s/it]
 15%|█▌        | 78/520 [1:10:57<11:18:46, 92.14s/it]
100%|██████████| 10/10 [10:03<00:00, 60.57s/it][A100%|██████████| 10/10 [10:03<00:00, 60.39s/it]
 15%|█▌        | 78/520 [1:10:56<11:18:42, 92.13s/it]Shard 78 in [40, 78]: file /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_369 skipped to avoid exceeding cuda memory
Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_plain_texts/shard_7

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:09<19:28, 129.81s/it][A[2024-05-30 15:32:05,300] [INFO] [logging.py:96:log_dist] [Rank 0] step=781, skipped=0, lr=[1.9410114324699585e-05], mom=[(0.9, 0.999)]
steps: 781 loss: 0.8684 iter time (s): 131.218 samples/sec: 0.975

 10%|█         | 1/10 [02:11<19:47, 131.99s/it][A
 10%|█         | 1/10 [02:12<19:48, 132.09s/it][A
 10%|█         | 1/10 [02:12<19:49, 132.18s/it][A
 10%|█         | 1/10 [02:12<19:50, 132.25s/it][A
 10%|█         | 1/10 [02:12<19:49, 132.17s/it][A
 10%|█         | 1/10 [02:12<19:49, 132.19s/it][A
 10%|█         | 1/10 [02:12<19:49, 132.21s/it][A
 20%|██        | 2/10 [04:22<17:30, 131.32s/it][A[2024-05-30 15:34:17,697] [INFO] [logging.py:96:log_dist] [Rank 0] step=782, skipped=0, lr=[1.9408196312110964e-05], mom=[(0.9, 0.999)]
steps: 782 loss: 0.7905 iter time (s): 131.509 samples/sec: 0.973

 20%|██        | 2/10 [04:24<17:37, 132.23s/it][A
 20%|██        | 2/10 [04:24<17:38, 132.30s/it][A
 20%|██        | 2/10 [04:24<17:38, 132.31s/it][A
 20%|██        | 2/10 [04:24<17:38, 132.32s/it][A
 20%|██        | 2/10 [04:24<17:39, 132.38s/it][A
 20%|██        | 2/10 [04:24<17:38, 132.34s/it][A
 20%|██        | 2/10 [04:24<17:38, 132.36s/it][A
 30%|███       | 3/10 [06:34<15:22, 131.72s/it][A[2024-05-30 15:36:29,906] [INFO] [logging.py:96:log_dist] [Rank 0] step=783, skipped=0, lr=[1.9406275281460255e-05], mom=[(0.9, 0.999)]
steps: 783 loss: 0.8297 iter time (s): 131.224 samples/sec: 0.975

 30%|███       | 3/10 [06:36<15:25, 132.23s/it][A
 30%|███       | 3/10 [06:36<15:25, 132.26s/it][A
 30%|███       | 3/10 [06:36<15:26, 132.29s/it][A
 30%|███       | 3/10 [06:36<15:25, 132.26s/it][A
 30%|███       | 3/10 [06:36<15:26, 132.29s/it][A
 30%|███       | 3/10 [06:36<15:25, 132.26s/it][A
 30%|███       | 3/10 [06:36<15:25, 132.28s/it][A
 40%|████      | 4/10 [08:46<13:11, 131.94s/it][A[2024-05-30 15:38:42,189] [INFO] [logging.py:96:log_dist] [Rank 0] step=784, skipped=0, lr=[1.9404351233363766e-05], mom=[(0.9, 0.999)]
steps: 784 loss: 0.8221 iter time (s): 131.351 samples/sec: 0.974

 40%|████      | 4/10 [08:48<13:13, 132.24s/it][A
 40%|████      | 4/10 [08:49<13:13, 132.30s/it][A
 40%|████      | 4/10 [08:49<13:13, 132.29s/it][A
 40%|████      | 4/10 [08:49<13:13, 132.25s/it][A
 40%|████      | 4/10 [08:49<13:13, 132.27s/it][A
 40%|████      | 4/10 [08:49<13:13, 132.29s/it][A
 40%|████      | 4/10 [08:49<13:13, 132.28s/it][A
 50%|█████     | 5/10 [10:58<10:59, 131.95s/it][A[2024-05-30 15:40:54,635] [INFO] [logging.py:96:log_dist] [Rank 0] step=785, skipped=0, lr=[1.940242416843878e-05], mom=[(0.9, 0.999)]
steps: 785 loss: 0.8249 iter time (s): 131.314 samples/sec: 0.975

 50%|█████     | 5/10 [11:00<10:59, 131.93s/it][A
 50%|█████     | 5/10 [11:00<11:00, 132.17s/it][A
 50%|█████     | 5/10 [11:01<11:00, 132.17s/it][A
 50%|█████     | 5/10 [11:01<11:00, 132.14s/it][A
 50%|█████     | 5/10 [11:01<11:00, 132.13s/it][A
 50%|█████     | 5/10 [11:00<11:00, 132.13s/it][A
 50%|█████     | 5/10 [11:00<11:00, 132.13s/it][A
 60%|██████    | 6/10 [13:10<08:47, 131.79s/it][A[2024-05-30 15:43:05,642] [INFO] [logging.py:96:log_dist] [Rank 0] step=786, skipped=0, lr=[1.9400494087303556e-05], mom=[(0.9, 0.999)]
steps: 786 loss: 0.8548 iter time (s): 131.250 samples/sec: 0.975

 60%|██████    | 6/10 [13:12<08:47, 131.94s/it][A
 60%|██████    | 6/10 [13:12<08:47, 131.94s/it][A
 60%|██████    | 6/10 [13:12<08:47, 131.95s/it][A
 60%|██████    | 6/10 [13:12<08:47, 131.93s/it][A
 60%|██████    | 6/10 [13:12<08:47, 131.98s/it][A
 60%|██████    | 6/10 [13:12<08:47, 131.94s/it][A
 60%|██████    | 6/10 [13:12<08:47, 131.94s/it][A
 70%|███████   | 7/10 [15:22<06:35, 131.91s/it][A[2024-05-30 15:45:17,718] [INFO] [logging.py:96:log_dist] [Rank 0] step=787, skipped=0, lr=[1.9398560990577305e-05], mom=[(0.9, 0.999)]
steps: 787 loss: 0.8671 iter time (s): 131.213 samples/sec: 0.976

 70%|███████   | 7/10 [15:24<06:35, 131.97s/it][A
 70%|███████   | 7/10 [15:24<06:35, 131.99s/it][A
 70%|███████   | 7/10 [15:24<06:35, 131.98s/it][A
 70%|███████   | 7/10 [15:24<06:35, 131.96s/it][A
 70%|███████   | 7/10 [15:24<06:35, 131.96s/it][A
 70%|███████   | 7/10 [15:24<06:36, 132.00s/it][A
 70%|███████   | 7/10 [15:24<06:35, 131.96s/it][A
 80%|████████  | 8/10 [17:34<04:24, 132.02s/it][A[2024-05-30 15:47:30,036] [INFO] [logging.py:96:log_dist] [Rank 0] step=788, skipped=0, lr=[1.939662487888021e-05], mom=[(0.9, 0.999)]
steps: 788 loss: 0.7992 iter time (s): 131.503 samples/sec: 0.973

 80%|████████  | 8/10 [17:36<04:24, 132.06s/it][A
 80%|████████  | 8/10 [17:36<04:24, 132.07s/it][A
 80%|████████  | 8/10 [17:36<04:24, 132.08s/it][A
 80%|████████  | 8/10 [17:37<04:24, 132.11s/it][A
 80%|████████  | 8/10 [17:37<04:24, 132.16s/it][A
 80%|████████  | 8/10 [17:37<04:24, 132.13s/it][A
 80%|████████  | 8/10 [17:37<04:24, 132.13s/it][A
 90%|█████████ | 9/10 [19:46<02:12, 132.12s/it][A[2024-05-30 15:49:42,361] [INFO] [logging.py:96:log_dist] [Rank 0] step=789, skipped=0, lr=[1.939468575283343e-05], mom=[(0.9, 0.999)]
steps: 789 loss: 0.7826 iter time (s): 131.307 samples/sec: 0.975

 90%|█████████ | 9/10 [19:49<02:12, 132.18s/it][A
 90%|█████████ | 9/10 [19:49<02:12, 132.18s/it][A
 90%|█████████ | 9/10 [19:49<02:12, 132.15s/it][A
 90%|█████████ | 9/10 [19:49<02:12, 132.17s/it][A
 90%|█████████ | 9/10 [19:49<02:12, 132.15s/it][A
 90%|█████████ | 9/10 [19:49<02:12, 132.19s/it][A
 90%|█████████ | 9/10 [19:49<02:12, 132.16s/it][A
100%|██████████| 10/10 [21:58<00:00, 132.11s/it][A100%|██████████| 10/10 [21:58<00:00, 131.90s/it]
[2024-05-30 15:51:54,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=790, skipped=0, lr=[1.9392743613059082e-05], mom=[(0.9, 0.999)]
steps: 790 loss: 0.8024 iter time (s): 131.205 samples/sec: 0.976

100%|██████████| 10/10 [22:01<00:00, 132.15s/it][A100%|██████████| 10/10 [22:01<00:00, 132.12s/it]

100%|██████████| 10/10 [22:01<00:00, 132.14s/it][A100%|██████████| 10/10 [22:01<00:00, 132.13s/it]

100%|██████████| 10/10 [22:01<00:00, 132.14s/it][A100%|██████████| 10/10 [22:01<00:00, 132.14s/it]

100%|██████████| 10/10 [22:01<00:00, 132.11s/it][A100%|██████████| 10/10 [22:01<00:00, 132.13s/it]

100%|██████████| 10/10 [22:01<00:00, 132.14s/it][A100%|██████████| 10/10 [22:01<00:00, 132.14s/it]

100%|██████████| 10/10 [22:01<00:00, 132.15s/it][A100%|██████████| 10/10 [22:01<00:00, 132.13s/it]
Checkpointing at shard 80

100%|██████████| 10/10 [22:01<00:00, 132.13s/it][A100%|██████████| 10/10 [22:01<00:00, 132.13s/it]
[2024-05-30 15:51:55,650] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step790 is about to be saved!
[2024-05-30 15:51:57,235] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_00-model_states.pt...
[2024-05-30 15:52:02,051] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_05-model_states.pt...
[2024-05-30 15:52:02,727] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_02-model_states.pt...
[2024-05-30 15:52:03,760] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_08-model_states.pt...
[2024-05-30 15:52:04,908] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_06-model_states.pt...
[2024-05-30 15:52:05,557] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_07-model_states.pt...
[2024-05-30 15:52:06,007] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_00-model_states.pt.
[2024-05-30 15:52:10,579] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_04-model_states.pt...
[2024-05-30 15:52:10,929] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_03-model_states.pt...
[2024-05-30 15:52:12,762] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_01-model_states.pt...
[2024-05-30 15:56:59,842] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_06-model_states.pt.
[2024-05-30 15:57:00,118] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_05_model_states.pt...
[2024-05-30 15:57:00,296] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_05_model_states.pt.
[2024-05-30 15:57:00,297] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step790 is ready now!
[2024-05-30 15:57:05,894] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_07-model_states.pt.
[2024-05-30 15:57:05,894] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_03-model_states.pt.
[2024-05-30 15:57:05,916] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_04-model_states.pt.
[2024-05-30 15:57:05,954] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_03_model_states.pt...
[2024-05-30 15:57:05,973] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_01-model_states.pt.
[2024-05-30 15:57:06,053] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_03_model_states.pt.
[2024-05-30 15:57:06,053] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step790 is ready now!
[2024-05-30 15:57:06,215] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_02_model_states.pt...
[2024-05-30 15:57:06,229] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_06_model_states.pt...
[2024-05-30 15:57:06,340] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_02_model_states.pt.
[2024-05-30 15:57:06,340] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step790 is ready now!
[2024-05-30 15:57:06,347] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_06_model_states.pt.
[2024-05-30 15:57:06,347] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step790 is ready now!
[2024-05-30 15:57:06,442] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_00_model_states.pt
[2024-05-30 15:57:06,442] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_00_model_states.pt...
[2024-05-30 15:57:09,835] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_00_model_states.pt.
[2024-05-30 15:57:09,835] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step790 is ready now!
[2024-05-30 15:57:23,531] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_08-model_states.pt.
[2024-05-30 15:57:23,729] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_09-model_states.pt...
[2024-05-30 15:57:26,342] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_02-model_states.pt.
[2024-05-30 15:57:26,344] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_05-model_states.pt.
[2024-05-30 15:57:26,387] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_01_model_states.pt
[2024-05-30 15:57:26,387] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_01_model_states.pt...
[2024-05-30 15:57:26,389] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/layer_09-model_states.pt.
[2024-05-30 15:57:26,392] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_07_model_states.pt...
[2024-05-30 15:57:26,404] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_04_model_states.pt...
[2024-05-30 15:57:26,492] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_01_model_states.pt.
[2024-05-30 15:57:26,492] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step790 is ready now!
[2024-05-30 15:57:26,504] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_07_model_states.pt.
[2024-05-30 15:57:26,504] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step790 is ready now!
[2024-05-30 15:57:26,506] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step790/mp_rank_04_model_states.pt.
[2024-05-30 15:57:26,506] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step790 is ready now!
Checkpoint saved using --- 330.8597822189331 seconds ---
 15%|█▌        | 80/520 [1:38:48<19:37:00, 160.50s/it] 15%|█▌        | 80/520 [1:38:29<19:35:26, 160.29s/it] 15%|█▌        | 80/520 [1:38:20<19:35:20, 160.27s/it] 15%|█▌        | 80/520 [1:38:29<19:35:23, 160.28s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_326
 15%|█▌        | 80/520 [1:38:32<19:35:41, 160.32s/it] 15%|█▌        | 80/520 [1:38:30<19:35:33, 160.30s/it] 15%|█▌        | 80/520 [1:38:49<19:37:04, 160.51s/it] 15%|█▌        | 80/520 [1:39:30<19:40:25, 160.97s/it]Training on 1280 of 1280 sentences.


  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A

  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [00:00<?, ?it/s][A[A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:23<12:27, 83.09s/it][A[2024-05-30 15:58:51,600] [INFO] [logging.py:96:log_dist] [Rank 0] step=791, skipped=0, lr=[1.939079846018025e-05], mom=[(0.9, 0.999)]
steps: 791 loss: 0.5801 iter time (s): 84.877 samples/sec: 1.508

 10%|█         | 1/10 [01:25<12:47, 85.22s/it][A
 10%|█         | 1/10 [01:25<12:48, 85.38s/it][A
 10%|█         | 1/10 [01:25<12:48, 85.44s/it][A
 10%|█         | 1/10 [01:25<12:50, 85.58s/it][A
 10%|█         | 1/10 [01:25<12:51, 85.67s/it][A
 10%|█         | 1/10 [01:25<12:51, 85.67s/it][A
 10%|█         | 1/10 [01:25<12:51, 85.72s/it][A
 20%|██        | 2/10 [02:46<11:07, 83.43s/it][A[2024-05-30 16:00:15,057] [INFO] [logging.py:96:log_dist] [Rank 0] step=792, skipped=0, lr=[1.9388850294820995e-05], mom=[(0.9, 0.999)]
steps: 792 loss: 0.5821 iter time (s): 82.600 samples/sec: 1.550

 20%|██        | 2/10 [02:48<11:13, 84.20s/it][A
 20%|██        | 2/10 [02:48<11:14, 84.27s/it][A
 20%|██        | 2/10 [02:48<11:14, 84.28s/it][A
 20%|██        | 2/10 [02:48<11:14, 84.29s/it][A
 20%|██        | 2/10 [02:49<11:14, 84.35s/it][A
 20%|██        | 2/10 [02:49<11:14, 84.36s/it][A
 20%|██        | 2/10 [02:49<11:14, 84.36s/it][A
 30%|███       | 3/10 [04:10<09:44, 83.49s/it][A[2024-05-30 16:01:38,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=793, skipped=0, lr=[1.9386899117606326e-05], mom=[(0.9, 0.999)]
steps: 793 loss: 0.5765 iter time (s): 82.966 samples/sec: 1.543

 30%|███       | 3/10 [04:12<09:47, 84.00s/it][A
 30%|███       | 3/10 [04:12<09:48, 84.02s/it][A
 30%|███       | 3/10 [04:12<09:48, 84.10s/it][A
 30%|███       | 3/10 [04:12<09:48, 84.14s/it][A
 30%|███       | 3/10 [04:13<09:49, 84.16s/it][A
 30%|███       | 3/10 [04:13<09:49, 84.17s/it][A
 30%|███       | 3/10 [04:13<09:49, 84.17s/it][A
 40%|████      | 4/10 [05:32<08:17, 82.98s/it][A[2024-05-30 16:03:01,031] [INFO] [logging.py:96:log_dist] [Rank 0] step=794, skipped=0, lr=[1.9384944929162236e-05], mom=[(0.9, 0.999)]
steps: 794 loss: 0.5780 iter time (s): 81.221 samples/sec: 1.576

 40%|████      | 4/10 [05:34<08:19, 83.29s/it][A
 40%|████      | 4/10 [05:34<08:19, 83.31s/it][A
 40%|████      | 4/10 [05:34<08:19, 83.32s/it][A
 40%|████      | 4/10 [05:35<08:20, 83.34s/it][A
 40%|████      | 4/10 [05:35<08:19, 83.32s/it][A
 40%|████      | 4/10 [05:35<08:20, 83.34s/it][A
 40%|████      | 4/10 [05:35<08:20, 83.34s/it][A
 50%|█████     | 5/10 [06:58<06:59, 83.90s/it][A[2024-05-30 16:04:26,553] [INFO] [logging.py:96:log_dist] [Rank 0] step=795, skipped=0, lr=[1.938298773011568e-05], mom=[(0.9, 0.999)]
steps: 795 loss: 0.5754 iter time (s): 84.670 samples/sec: 1.512

 50%|█████     | 5/10 [07:00<07:00, 84.11s/it][A
 50%|█████     | 5/10 [07:00<07:00, 84.09s/it][A
 50%|█████     | 5/10 [07:00<07:00, 84.12s/it][A
 50%|█████     | 5/10 [07:00<07:00, 84.10s/it][A
 50%|█████     | 5/10 [07:00<07:00, 84.12s/it][A
 50%|█████     | 5/10 [07:00<07:00, 84.12s/it][A
 50%|█████     | 5/10 [07:00<07:00, 84.13s/it][A
 60%|██████    | 6/10 [08:20<05:34, 83.51s/it][A[2024-05-30 16:05:49,308] [INFO] [logging.py:96:log_dist] [Rank 0] step=796, skipped=0, lr=[1.938102752109457e-05], mom=[(0.9, 0.999)]
steps: 796 loss: 0.5812 iter time (s): 81.907 samples/sec: 1.563

 60%|██████    | 6/10 [08:22<05:34, 83.62s/it][A
 60%|██████    | 6/10 [08:23<05:34, 83.65s/it][A
 60%|██████    | 6/10 [08:23<05:34, 83.63s/it][A
 60%|██████    | 6/10 [08:23<05:34, 83.65s/it][A
 60%|██████    | 6/10 [08:23<05:34, 83.65s/it][A
 60%|██████    | 6/10 [08:23<05:34, 83.65s/it][A
 60%|██████    | 6/10 [08:23<05:34, 83.65s/it][A
 70%|███████   | 7/10 [09:42<04:08, 82.94s/it][A[2024-05-30 16:07:11,076] [INFO] [logging.py:96:log_dist] [Rank 0] step=797, skipped=0, lr=[1.9379064302727794e-05], mom=[(0.9, 0.999)]
steps: 797 loss: 0.5665 iter time (s): 80.946 samples/sec: 1.581

 70%|███████   | 7/10 [09:44<04:09, 83.02s/it][A
 70%|███████   | 7/10 [09:44<04:09, 83.02s/it][A
 70%|███████   | 7/10 [09:44<04:09, 83.02s/it][A
 70%|███████   | 7/10 [09:45<04:09, 83.03s/it][A
 70%|███████   | 7/10 [09:45<04:09, 83.04s/it][A
 70%|███████   | 7/10 [09:45<04:09, 83.04s/it][A
 70%|███████   | 7/10 [09:45<04:09, 83.04s/it][A
 80%|████████  | 8/10 [11:05<02:45, 82.93s/it][A[2024-05-30 16:08:33,978] [INFO] [logging.py:96:log_dist] [Rank 0] step=798, skipped=0, lr=[1.9377098075645195e-05], mom=[(0.9, 0.999)]
steps: 798 loss: 0.5838 iter time (s): 82.073 samples/sec: 1.560

 80%|████████  | 8/10 [11:07<02:45, 82.97s/it][A
 80%|████████  | 8/10 [11:07<02:45, 82.98s/it][A
 80%|████████  | 8/10 [11:07<02:45, 82.99s/it][A
 80%|████████  | 8/10 [11:07<02:45, 82.99s/it][A
 80%|████████  | 8/10 [11:08<02:46, 83.00s/it][A
 80%|████████  | 8/10 [11:08<02:45, 82.99s/it][A
 80%|████████  | 8/10 [11:08<02:45, 83.00s/it][A
 90%|█████████ | 9/10 [12:27<01:22, 82.66s/it][A[2024-05-30 16:09:56,049] [INFO] [logging.py:96:log_dist] [Rank 0] step=799, skipped=0, lr=[1.9375128840477593e-05], mom=[(0.9, 0.999)]
steps: 799 loss: 0.5827 iter time (s): 81.259 samples/sec: 1.575

 90%|█████████ | 9/10 [12:29<01:22, 82.69s/it][A
 90%|█████████ | 9/10 [12:29<01:22, 82.69s/it][A
 90%|█████████ | 9/10 [12:29<01:22, 82.71s/it][A
 90%|█████████ | 9/10 [12:30<01:22, 82.71s/it][A
 90%|█████████ | 9/10 [12:30<01:22, 82.74s/it][A
 90%|█████████ | 9/10 [12:30<01:22, 82.74s/it][A
 90%|█████████ | 9/10 [12:30<01:22, 82.74s/it][A
100%|██████████| 10/10 [13:49<00:00, 82.42s/it][A100%|██████████| 10/10 [13:49<00:00, 82.94s/it]
 16%|█▌        | 81/520 [1:52:10<24:37:16, 201.91s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 16:11:17,949] [INFO] [logging.py:96:log_dist] [Rank 0] step=800, skipped=0, lr=[1.9373156597856765e-05], mom=[(0.9, 0.999)]
steps: 800 loss: 0.5971 iter time (s): 80.976 samples/sec: 1.581

100%|██████████| 10/10 [13:51<00:00, 82.44s/it][A100%|██████████| 10/10 [13:51<00:00, 83.15s/it]
 16%|█▌        | 81/520 [1:52:22<24:38:26, 202.06s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:51<00:00, 82.46s/it][A100%|██████████| 10/10 [13:51<00:00, 83.17s/it]
 16%|█▌        | 81/520 [1:52:41<24:39:56, 202.27s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:51<00:00, 82.44s/it][A100%|██████████| 10/10 [13:51<00:00, 83.18s/it]
 16%|█▌        | 81/520 [1:53:22<24:43:06, 202.70s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:51<00:00, 82.45s/it][A100%|██████████| 10/10 [13:51<00:00, 83.19s/it]
 16%|█▌        | 81/520 [1:52:40<24:39:57, 202.27s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:51<00:00, 82.43s/it][A100%|██████████| 10/10 [13:51<00:00, 83.20s/it]
 16%|█▌        | 81/520 [1:52:25<24:38:45, 202.11s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:52<00:00, 82.44s/it][A100%|██████████| 10/10 [13:52<00:00, 83.20s/it]
 16%|█▌        | 81/520 [1:52:22<24:38:33, 202.08s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:52<00:00, 82.45s/it][A100%|██████████| 10/10 [13:52<00:00, 83.20s/it]
 16%|█▌        | 81/520 [1:52:21<24:38:30, 202.07s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_11
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:41<15:17, 101.94s/it][A[2024-05-30 16:13:00,758] [INFO] [logging.py:96:log_dist] [Rank 0] step=801, skipped=0, lr=[1.9371181348415456e-05], mom=[(0.9, 0.999)]
steps: 801 loss: 0.8811 iter time (s): 101.904 samples/sec: 1.256

 10%|█         | 1/10 [01:43<15:27, 103.01s/it][A
 10%|█         | 1/10 [01:42<15:26, 102.91s/it][A
 10%|█         | 1/10 [01:43<15:27, 103.01s/it][A
 10%|█         | 1/10 [01:43<15:27, 103.01s/it][A
 10%|█         | 1/10 [01:42<15:26, 102.97s/it][A
 10%|█         | 1/10 [01:42<15:26, 102.95s/it][A
 10%|█         | 1/10 [01:42<15:26, 102.96s/it][A
 20%|██        | 2/10 [03:26<13:49, 103.65s/it][A[2024-05-30 16:14:45,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=802, skipped=0, lr=[1.9369203092787376e-05], mom=[(0.9, 0.999)]
steps: 802 loss: 0.8777 iter time (s): 103.853 samples/sec: 1.233

 20%|██        | 2/10 [03:27<13:52, 104.04s/it][A
 20%|██        | 2/10 [03:27<13:52, 104.02s/it][A
 20%|██        | 2/10 [03:27<13:51, 103.99s/it][A
 20%|██        | 2/10 [03:27<13:52, 104.02s/it][A
 20%|██        | 2/10 [03:27<13:51, 104.00s/it][A
 20%|██        | 2/10 [03:27<13:52, 104.01s/it][A
 20%|██        | 2/10 [03:27<13:52, 104.01s/it][A
 30%|███       | 3/10 [05:08<12:00, 102.88s/it][A[2024-05-30 16:16:27,568] [INFO] [logging.py:96:log_dist] [Rank 0] step=803, skipped=0, lr=[1.9367221831607197e-05], mom=[(0.9, 0.999)]
steps: 803 loss: 0.8697 iter time (s): 101.088 samples/sec: 1.266

 30%|███       | 3/10 [05:09<12:01, 103.09s/it][A
 30%|███       | 3/10 [05:09<12:01, 103.07s/it][A
 30%|███       | 3/10 [05:09<12:01, 103.12s/it][A
 30%|███       | 3/10 [05:09<12:01, 103.10s/it][A
 30%|███       | 3/10 [05:09<12:01, 103.10s/it][A
 30%|███       | 3/10 [05:09<12:01, 103.09s/it][A
 30%|███       | 3/10 [05:09<12:01, 103.10s/it][A
 40%|████      | 4/10 [06:51<10:17, 102.96s/it][A[2024-05-30 16:18:10,623] [INFO] [logging.py:96:log_dist] [Rank 0] step=804, skipped=0, lr=[1.936523756551056e-05], mom=[(0.9, 0.999)]
steps: 804 loss: 0.8748 iter time (s): 102.132 samples/sec: 1.253

 40%|████      | 4/10 [06:52<10:18, 103.04s/it][A
 40%|████      | 4/10 [06:52<10:18, 103.03s/it][A
 40%|████      | 4/10 [06:52<10:18, 103.08s/it][A
 40%|████      | 4/10 [06:52<10:18, 103.06s/it][A
 40%|████      | 4/10 [06:52<10:18, 103.07s/it][A
 40%|████      | 4/10 [06:52<10:18, 103.06s/it][A
 40%|████      | 4/10 [06:52<10:18, 103.06s/it][A
 50%|█████     | 5/10 [08:33<08:32, 102.43s/it][A[2024-05-30 16:19:52,117] [INFO] [logging.py:96:log_dist] [Rank 0] step=805, skipped=0, lr=[1.9363250295134063e-05], mom=[(0.9, 0.999)]
steps: 805 loss: 0.8834 iter time (s): 100.626 samples/sec: 1.272

 50%|█████     | 5/10 [08:34<08:32, 102.50s/it][A
 50%|█████     | 5/10 [08:34<08:32, 102.49s/it][A
 50%|█████     | 5/10 [08:34<08:32, 102.49s/it][A
 50%|█████     | 5/10 [08:34<08:32, 102.51s/it][A
 50%|█████     | 5/10 [08:34<08:32, 102.50s/it][A
 50%|█████     | 5/10 [08:34<08:32, 102.50s/it][A
 50%|█████     | 5/10 [08:34<08:32, 102.50s/it][A
 60%|██████    | 6/10 [10:15<06:49, 102.28s/it][A[2024-05-30 16:21:34,105] [INFO] [logging.py:96:log_dist] [Rank 0] step=806, skipped=0, lr=[1.9361260021115272e-05], mom=[(0.9, 0.999)]
steps: 806 loss: 0.8635 iter time (s): 101.107 samples/sec: 1.266

 60%|██████    | 6/10 [10:16<06:49, 102.32s/it][A
 60%|██████    | 6/10 [10:16<06:49, 102.32s/it][A
 60%|██████    | 6/10 [10:16<06:49, 102.35s/it][A
 60%|██████    | 6/10 [10:16<06:49, 102.31s/it][A
 60%|██████    | 6/10 [10:16<06:49, 102.32s/it][A
 60%|██████    | 6/10 [10:16<06:49, 102.33s/it][A
 60%|██████    | 6/10 [10:16<06:49, 102.32s/it][A
 70%|███████   | 7/10 [11:59<05:08, 102.84s/it][A[2024-05-30 16:23:18,088] [INFO] [logging.py:96:log_dist] [Rank 0] step=807, skipped=0, lr=[1.9359266744092718e-05], mom=[(0.9, 0.999)]
steps: 807 loss: 0.8587 iter time (s): 103.112 samples/sec: 1.241

 70%|███████   | 7/10 [12:00<05:08, 102.87s/it][A
 70%|███████   | 7/10 [12:00<05:08, 102.86s/it][A
 70%|███████   | 7/10 [12:00<05:08, 102.87s/it][A
 70%|███████   | 7/10 [12:00<05:08, 102.85s/it][A
 70%|███████   | 7/10 [12:00<05:08, 102.88s/it][A
 70%|███████   | 7/10 [12:00<05:08, 102.87s/it][A
 70%|███████   | 7/10 [12:00<05:08, 102.87s/it][A
 80%|████████  | 8/10 [13:42<03:25, 102.90s/it][A[2024-05-30 16:25:01,124] [INFO] [logging.py:96:log_dist] [Rank 0] step=808, skipped=0, lr=[1.9357270464705897e-05], mom=[(0.9, 0.999)]
steps: 808 loss: 0.8524 iter time (s): 102.154 samples/sec: 1.253

 80%|████████  | 8/10 [13:43<03:25, 102.91s/it][A
 80%|████████  | 8/10 [13:43<03:25, 102.92s/it][A
 80%|████████  | 8/10 [13:43<03:25, 102.93s/it][A
 80%|████████  | 8/10 [13:43<03:25, 102.92s/it][A
 80%|████████  | 8/10 [13:43<03:25, 102.94s/it][A
 80%|████████  | 8/10 [13:43<03:25, 102.92s/it][A
 80%|████████  | 8/10 [13:43<03:25, 102.92s/it][A
 90%|█████████ | 9/10 [15:29<01:44, 104.26s/it][A[2024-05-30 16:26:48,361] [INFO] [logging.py:96:log_dist] [Rank 0] step=809, skipped=0, lr=[1.935527118359526e-05], mom=[(0.9, 0.999)]
steps: 809 loss: 0.8517 iter time (s): 106.444 samples/sec: 1.203

 90%|█████████ | 9/10 [15:30<01:44, 104.29s/it][A
 90%|█████████ | 9/10 [15:30<01:44, 104.31s/it][A
 90%|█████████ | 9/10 [15:30<01:44, 104.32s/it][A
 90%|█████████ | 9/10 [15:30<01:44, 104.31s/it][A
 90%|█████████ | 9/10 [15:30<01:44, 104.31s/it][A
 90%|█████████ | 9/10 [15:30<01:44, 104.30s/it][A
 90%|█████████ | 9/10 [15:30<01:44, 104.31s/it][A
100%|██████████| 10/10 [17:12<00:00, 103.78s/it][A100%|██████████| 10/10 [17:12<00:00, 103.23s/it]
 16%|█▌        | 82/520 [2:09:22<32:48:43, 269.69s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 16:28:31,076] [INFO] [logging.py:96:log_dist] [Rank 0] step=810, skipped=0, lr=[1.9353268901402226e-05], mom=[(0.9, 0.999)]
steps: 810 loss: 0.8699 iter time (s): 101.732 samples/sec: 1.258

100%|██████████| 10/10 [17:13<00:00, 103.80s/it][A100%|██████████| 10/10 [17:13<00:00, 103.32s/it]
 16%|█▌        | 82/520 [2:09:35<32:50:11, 269.89s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:13<00:00, 103.79s/it][A100%|██████████| 10/10 [17:13<00:00, 103.31s/it]
 16%|█▌        | 82/520 [2:09:54<32:51:31, 270.07s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:13<00:00, 103.79s/it][A100%|██████████| 10/10 [17:13<00:00, 103.33s/it]
 16%|█▌        | 82/520 [2:10:35<32:54:29, 270.48s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:13<00:00, 103.80s/it][A100%|██████████| 10/10 [17:13<00:00, 103.33s/it]
 16%|█▌        | 82/520 [2:09:54<32:51:37, 270.08s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:13<00:00, 103.81s/it][A100%|██████████| 10/10 [17:13<00:00, 103.33s/it]
 16%|█▌        | 82/520 [2:09:38<32:50:30, 269.93s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:13<00:00, 103.80s/it][A100%|██████████| 10/10 [17:13<00:00, 103.33s/it]
 16%|█▌        | 82/520 [2:09:35<32:50:18, 269.91s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:13<00:00, 103.80s/it][A100%|██████████| 10/10 [17:13<00:00, 103.33s/it]
 16%|█▌        | 82/520 [2:09:34<32:50:15, 269.90s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_6
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:38<14:49, 98.80s/it][A[2024-05-30 16:30:10,093] [INFO] [logging.py:96:log_dist] [Rank 0] step=811, skipped=0, lr=[1.9351263618769177e-05], mom=[(0.9, 0.999)]
steps: 811 loss: 0.8448 iter time (s): 97.963 samples/sec: 1.307

 10%|█         | 1/10 [01:38<14:50, 98.95s/it][A
 10%|█         | 1/10 [01:38<14:49, 98.89s/it][A
 10%|█         | 1/10 [01:38<14:50, 98.94s/it][A
 10%|█         | 1/10 [01:38<14:49, 98.82s/it][A
 10%|█         | 1/10 [01:38<14:49, 98.87s/it][A
 10%|█         | 1/10 [01:38<14:49, 98.89s/it][A
 10%|█         | 1/10 [01:38<14:50, 98.91s/it][A
 20%|██        | 2/10 [03:13<12:52, 96.57s/it][A[2024-05-30 16:31:45,094] [INFO] [logging.py:96:log_dist] [Rank 0] step=812, skipped=0, lr=[1.9349255336339455e-05], mom=[(0.9, 0.999)]
steps: 812 loss: 0.8536 iter time (s): 94.170 samples/sec: 1.359

 20%|██        | 2/10 [03:13<12:53, 96.64s/it][A
 20%|██        | 2/10 [03:14<12:53, 96.69s/it][A
 20%|██        | 2/10 [03:13<12:53, 96.63s/it][A
 20%|██        | 2/10 [03:13<12:53, 96.64s/it][A
 20%|██        | 2/10 [03:13<12:53, 96.63s/it][A

 20%|██        | 2/10 [03:13<12:53, 96.64s/it][A 20%|██        | 2/10 [03:13<12:53, 96.64s/it][A
 30%|███       | 3/10 [04:48<11:09, 95.65s/it][A[2024-05-30 16:33:19,661] [INFO] [logging.py:96:log_dist] [Rank 0] step=813, skipped=0, lr=[1.9347244054757374e-05], mom=[(0.9, 0.999)]
steps: 813 loss: 0.8435 iter time (s): 93.671 samples/sec: 1.366

 30%|███       | 3/10 [04:48<11:10, 95.72s/it][A
 30%|███       | 3/10 [04:48<11:10, 95.72s/it][A
 30%|███       | 3/10 [04:48<11:09, 95.67s/it][A
 30%|███       | 3/10 [04:48<11:09, 95.67s/it][A
 30%|███       | 3/10 [04:48<11:09, 95.69s/it][A
 30%|███       | 3/10 [04:48<11:09, 95.69s/it][A
 30%|███       | 3/10 [04:48<11:09, 95.69s/it][A
 40%|████      | 4/10 [06:22<09:31, 95.24s/it][A[2024-05-30 16:34:54,232] [INFO] [logging.py:96:log_dist] [Rank 0] step=814, skipped=0, lr=[1.93452297746682e-05], mom=[(0.9, 0.999)]
steps: 814 loss: 0.8474 iter time (s): 93.681 samples/sec: 1.366

 40%|████      | 4/10 [06:23<09:31, 95.24s/it][A
 40%|████      | 4/10 [06:23<09:31, 95.24s/it][A
 40%|████      | 4/10 [06:23<09:31, 95.27s/it][A
 40%|████      | 4/10 [06:23<09:31, 95.25s/it][A
 40%|████      | 4/10 [06:23<09:31, 95.23s/it][A
 40%|████      | 4/10 [06:23<09:31, 95.23s/it][A
 40%|████      | 4/10 [06:23<09:31, 95.24s/it][A
 50%|█████     | 5/10 [07:56<07:53, 94.71s/it][A[2024-05-30 16:36:28,010] [INFO] [logging.py:96:log_dist] [Rank 0] step=815, skipped=0, lr=[1.9343212496718163e-05], mom=[(0.9, 0.999)]
steps: 815 loss: 0.8564 iter time (s): 92.903 samples/sec: 1.378

 50%|█████     | 5/10 [07:56<07:53, 94.71s/it][A
 50%|█████     | 5/10 [07:56<07:53, 94.71s/it][A
 50%|█████     | 5/10 [07:56<07:53, 94.71s/it][A
 50%|█████     | 5/10 [07:56<07:53, 94.70s/it][A
 50%|█████     | 5/10 [07:56<07:53, 94.72s/it][A
 50%|█████     | 5/10 [07:56<07:53, 94.71s/it][A
 50%|█████     | 5/10 [07:56<07:53, 94.72s/it][A
 60%|██████    | 6/10 [09:30<06:17, 94.28s/it][A[2024-05-30 16:38:01,476] [INFO] [logging.py:96:log_dist] [Rank 0] step=816, skipped=0, lr=[1.9341192221554456e-05], mom=[(0.9, 0.999)]
steps: 816 loss: 0.8306 iter time (s): 92.580 samples/sec: 1.383

 60%|██████    | 6/10 [09:30<06:17, 94.26s/it][A
 60%|██████    | 6/10 [09:30<06:17, 94.28s/it][A
 60%|██████    | 6/10 [09:30<06:17, 94.29s/it][A
 60%|██████    | 6/10 [09:30<06:17, 94.30s/it][A
 60%|██████    | 6/10 [09:30<06:17, 94.28s/it][A
 60%|██████    | 6/10 [09:30<06:17, 94.30s/it][A
 60%|██████    | 6/10 [09:30<06:17, 94.29s/it][A
 70%|███████   | 7/10 [11:04<04:43, 94.35s/it][A[2024-05-30 16:39:35,942] [INFO] [logging.py:96:log_dist] [Rank 0] step=817, skipped=0, lr=[1.9339168949825232e-05], mom=[(0.9, 0.999)]
steps: 817 loss: 0.8489 iter time (s): 93.598 samples/sec: 1.368

 70%|███████   | 7/10 [11:04<04:43, 94.35s/it][A
 70%|███████   | 7/10 [11:04<04:43, 94.38s/it][A
 70%|███████   | 7/10 [11:04<04:43, 94.35s/it][A
 70%|███████   | 7/10 [11:04<04:43, 94.36s/it][A
 70%|███████   | 7/10 [11:04<04:43, 94.35s/it][A
 70%|███████   | 7/10 [11:04<04:43, 94.35s/it][A
 70%|███████   | 7/10 [11:04<04:43, 94.36s/it][A
 80%|████████  | 8/10 [12:40<03:09, 94.86s/it][A[2024-05-30 16:41:11,932] [INFO] [logging.py:96:log_dist] [Rank 0] step=818, skipped=0, lr=[1.9337142682179614e-05], mom=[(0.9, 0.999)]
steps: 818 loss: 0.8325 iter time (s): 95.094 samples/sec: 1.346

 80%|████████  | 8/10 [12:40<03:09, 94.88s/it][A
 80%|████████  | 8/10 [12:40<03:09, 94.85s/it][A
 80%|████████  | 8/10 [12:40<03:09, 94.85s/it][A
 80%|████████  | 8/10 [12:40<03:09, 94.89s/it][A
 80%|████████  | 8/10 [12:40<03:09, 94.87s/it][A
 80%|████████  | 8/10 [12:40<03:09, 94.87s/it][A
 80%|████████  | 8/10 [12:40<03:09, 94.87s/it][A
 90%|█████████ | 9/10 [14:15<01:34, 94.96s/it][A[2024-05-30 16:42:47,084] [INFO] [logging.py:96:log_dist] [Rank 0] step=819, skipped=0, lr=[1.933511341926767e-05], mom=[(0.9, 0.999)]
steps: 819 loss: 0.8271 iter time (s): 94.258 samples/sec: 1.358

 90%|█████████ | 9/10 [14:15<01:34, 94.96s/it][A
 90%|█████████ | 9/10 [14:15<01:34, 94.95s/it][A
 90%|█████████ | 9/10 [14:15<01:34, 94.94s/it][A
 90%|█████████ | 9/10 [14:15<01:34, 94.94s/it][A
 90%|█████████ | 9/10 [14:15<01:34, 94.94s/it][A
 90%|█████████ | 9/10 [14:15<01:34, 94.95s/it][A
 90%|█████████ | 9/10 [14:15<01:34, 94.94s/it][A
100%|██████████| 10/10 [15:50<00:00, 94.88s/it][A100%|██████████| 10/10 [15:50<00:00, 95.05s/it]
 16%|█▌        | 83/520 [2:25:13<41:22:14, 340.81s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 16:44:21,777] [INFO] [logging.py:96:log_dist] [Rank 0] step=820, skipped=0, lr=[1.9333081161740437e-05], mom=[(0.9, 0.999)]
steps: 820 loss: 0.8448 iter time (s): 93.874 samples/sec: 1.364

100%|██████████| 10/10 [15:50<00:00, 94.90s/it][A100%|██████████| 10/10 [15:50<00:00, 95.07s/it]
 16%|█▌        | 83/520 [2:25:26<41:23:22, 340.97s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:50<00:00, 94.86s/it][A100%|██████████| 10/10 [15:50<00:00, 95.06s/it]
 16%|█▌        | 83/520 [2:25:44<41:24:30, 341.12s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:50<00:00, 94.87s/it][A100%|██████████| 10/10 [15:50<00:00, 95.06s/it]
 16%|█▌        | 83/520 [2:26:26<41:27:10, 341.49s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:50<00:00, 94.88s/it][A100%|██████████| 10/10 [15:50<00:00, 95.06s/it]
 16%|█▌        | 83/520 [2:25:44<41:24:33, 341.13s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:50<00:00, 94.87s/it][A100%|██████████| 10/10 [15:50<00:00, 95.06s/it]
 16%|█▌        | 83/520 [2:25:28<41:23:34, 340.99s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:50<00:00, 94.87s/it][A100%|██████████| 10/10 [15:50<00:00, 95.06s/it]
 16%|█▌        | 83/520 [2:25:26<41:23:24, 340.97s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:50<00:00, 94.88s/it][A100%|██████████| 10/10 [15:50<00:00, 95.06s/it]
 16%|█▌        | 83/520 [2:25:25<41:23:22, 340.97s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_265
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:21<12:13, 81.49s/it][A[2024-05-30 16:45:43,094] [INFO] [logging.py:96:log_dist] [Rank 0] step=821, skipped=0, lr=[1.9331045910249925e-05], mom=[(0.9, 0.999)]
steps: 821 loss: 0.4842 iter time (s): 80.344 samples/sec: 1.593

 10%|█         | 1/10 [01:21<12:11, 81.23s/it][A
 10%|█         | 1/10 [01:21<12:12, 81.37s/it][A
 10%|█         | 1/10 [01:21<12:11, 81.29s/it][A
 10%|█         | 1/10 [01:21<12:11, 81.31s/it][A
 10%|█         | 1/10 [01:21<12:12, 81.35s/it][A
 10%|█         | 1/10 [01:21<12:12, 81.34s/it][A
 10%|█         | 1/10 [01:21<12:11, 81.31s/it][A
 20%|██        | 2/10 [02:43<10:54, 81.80s/it][A[2024-05-30 16:47:05,100] [INFO] [logging.py:96:log_dist] [Rank 0] step=822, skipped=0, lr=[1.9329007665449083e-05], mom=[(0.9, 0.999)]
steps: 822 loss: 0.5237 iter time (s): 81.146 samples/sec: 1.577

 20%|██        | 2/10 [02:43<10:53, 81.69s/it][A
 20%|██        | 2/10 [02:43<10:53, 81.71s/it][A
 20%|██        | 2/10 [02:43<10:53, 81.66s/it][A
 20%|██        | 2/10 [02:43<10:53, 81.72s/it][A
 20%|██        | 2/10 [02:43<10:53, 81.67s/it][A
 20%|██        | 2/10 [02:43<10:53, 81.68s/it][A
 20%|██        | 2/10 [02:43<10:53, 81.69s/it][A
 30%|███       | 3/10 [04:04<09:31, 81.63s/it][A[2024-05-30 16:48:26,524] [INFO] [logging.py:96:log_dist] [Rank 0] step=823, skipped=0, lr=[1.9326966427991833e-05], mom=[(0.9, 0.999)]
steps: 823 loss: 0.4869 iter time (s): 80.620 samples/sec: 1.588

 30%|███       | 3/10 [04:04<09:31, 81.58s/it][A
 30%|███       | 3/10 [04:04<09:31, 81.60s/it][A
 30%|███       | 3/10 [04:04<09:31, 81.57s/it][A
 30%|███       | 3/10 [04:04<09:31, 81.58s/it][A
 30%|███       | 3/10 [04:04<09:31, 81.59s/it][A
 30%|███       | 3/10 [04:04<09:31, 81.61s/it][A
 30%|███       | 3/10 [04:04<09:31, 81.59s/it][A
 40%|████      | 4/10 [05:26<08:09, 81.52s/it][A[2024-05-30 16:49:47,874] [INFO] [logging.py:96:log_dist] [Rank 0] step=824, skipped=0, lr=[1.932492219853306e-05], mom=[(0.9, 0.999)]
steps: 824 loss: 0.5251 iter time (s): 80.498 samples/sec: 1.590

 40%|████      | 4/10 [05:26<08:08, 81.50s/it][A
 40%|████      | 4/10 [05:26<08:09, 81.52s/it][A
 40%|████      | 4/10 [05:26<08:09, 81.50s/it][A
 40%|████      | 4/10 [05:26<08:08, 81.49s/it][A
 40%|████      | 4/10 [05:26<08:08, 81.48s/it][A
 40%|████      | 4/10 [05:26<08:08, 81.50s/it][A
 40%|████      | 4/10 [05:26<08:09, 81.50s/it][A
 50%|█████     | 5/10 [06:47<06:46, 81.23s/it][A[2024-05-30 16:51:08,612] [INFO] [logging.py:96:log_dist] [Rank 0] step=825, skipped=0, lr=[1.9322874977728593e-05], mom=[(0.9, 0.999)]
steps: 825 loss: 0.4872 iter time (s): 79.866 samples/sec: 1.603

 50%|█████     | 5/10 [06:46<06:46, 81.20s/it][A
 50%|█████     | 5/10 [06:46<06:46, 81.20s/it][A
 50%|█████     | 5/10 [06:46<06:46, 81.23s/it][A
 50%|█████     | 5/10 [06:46<06:45, 81.20s/it][A
 50%|█████     | 5/10 [06:46<06:45, 81.19s/it][A
 50%|█████     | 5/10 [06:46<06:46, 81.21s/it][A
 50%|█████     | 5/10 [06:46<06:46, 81.21s/it][A
 60%|██████    | 6/10 [08:07<05:24, 81.10s/it][A[2024-05-30 16:52:29,451] [INFO] [logging.py:96:log_dist] [Rank 0] step=826, skipped=0, lr=[1.932082476623524e-05], mom=[(0.9, 0.999)]
steps: 826 loss: 0.4842 iter time (s): 80.025 samples/sec: 1.600

 60%|██████    | 6/10 [08:07<05:24, 81.06s/it][A
 60%|██████    | 6/10 [08:07<05:24, 81.08s/it][A
 60%|██████    | 6/10 [08:07<05:24, 81.10s/it][A
 60%|██████    | 6/10 [08:07<05:24, 81.07s/it][A
 60%|██████    | 6/10 [08:07<05:24, 81.09s/it][A
 60%|██████    | 6/10 [08:07<05:24, 81.08s/it][A
 60%|██████    | 6/10 [08:07<05:24, 81.08s/it][A
 70%|███████   | 7/10 [09:29<04:03, 81.12s/it][A[2024-05-30 16:53:50,615] [INFO] [logging.py:96:log_dist] [Rank 0] step=827, skipped=0, lr=[1.9318771564710753e-05], mom=[(0.9, 0.999)]
steps: 827 loss: 0.4919 iter time (s): 80.358 samples/sec: 1.593

 70%|███████   | 7/10 [09:28<04:03, 81.13s/it][A
 70%|███████   | 7/10 [09:28<04:03, 81.14s/it][A
 70%|███████   | 7/10 [09:28<04:03, 81.11s/it][A
 70%|███████   | 7/10 [09:28<04:03, 81.14s/it][A
 70%|███████   | 7/10 [09:28<04:03, 81.13s/it][A
 70%|███████   | 7/10 [09:28<04:03, 81.13s/it][A
 70%|███████   | 7/10 [09:28<04:03, 81.13s/it][A
 80%|████████  | 8/10 [10:50<02:42, 81.30s/it][A[2024-05-30 16:55:12,313] [INFO] [logging.py:96:log_dist] [Rank 0] step=828, skipped=0, lr=[1.931671537381386e-05], mom=[(0.9, 0.999)]
steps: 828 loss: 0.4474 iter time (s): 80.804 samples/sec: 1.584

 80%|████████  | 8/10 [10:50<02:42, 81.30s/it][A
 80%|████████  | 8/10 [10:50<02:42, 81.29s/it][A
 80%|████████  | 8/10 [10:50<02:42, 81.32s/it][A
 80%|████████  | 8/10 [10:50<02:42, 81.30s/it][A
 80%|████████  | 8/10 [10:50<02:42, 81.31s/it][A
 80%|████████  | 8/10 [10:50<02:42, 81.34s/it][A
 80%|████████  | 8/10 [10:50<02:42, 81.35s/it][A
 90%|█████████ | 9/10 [12:11<01:20, 80.99s/it][A[2024-05-30 16:56:32,599] [INFO] [logging.py:96:log_dist] [Rank 0] step=829, skipped=0, lr=[1.9314656194204227e-05], mom=[(0.9, 0.999)]
steps: 829 loss: 0.4839 iter time (s): 79.289 samples/sec: 1.614

 90%|█████████ | 9/10 [12:10<01:20, 80.98s/it][A
 90%|█████████ | 9/10 [12:10<01:20, 80.98s/it][A
 90%|█████████ | 9/10 [12:10<01:20, 80.97s/it][A
 90%|█████████ | 9/10 [12:10<01:20, 80.99s/it][A
 90%|█████████ | 9/10 [12:10<01:21, 81.00s/it][A
 90%|█████████ | 9/10 [12:10<01:21, 81.01s/it][A
 90%|█████████ | 9/10 [12:10<01:21, 81.01s/it][A
100%|██████████| 10/10 [13:31<00:00, 80.94s/it][A100%|██████████| 10/10 [13:31<00:00, 81.18s/it]
 16%|█▌        | 84/520 [2:38:45<48:40:57, 401.97s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 16:57:53,448] [INFO] [logging.py:96:log_dist] [Rank 0] step=830, skipped=0, lr=[1.9312594026542498e-05], mom=[(0.9, 0.999)]
steps: 830 loss: 0.4772 iter time (s): 79.868 samples/sec: 1.603

100%|██████████| 10/10 [13:31<00:00, 80.96s/it][A100%|██████████| 10/10 [13:31<00:00, 81.17s/it]
 16%|█▌        | 84/520 [2:38:57<48:41:38, 402.06s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:31<00:00, 80.96s/it][A100%|██████████| 10/10 [13:31<00:00, 81.18s/it]
 16%|█▌        | 84/520 [2:39:16<48:42:42, 402.21s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:31<00:00, 80.97s/it][A100%|██████████| 10/10 [13:31<00:00, 81.17s/it]
 16%|█▌        | 84/520 [2:39:58<48:44:58, 402.52s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:31<00:00, 81.00s/it][A100%|██████████| 10/10 [13:31<00:00, 81.18s/it]
 16%|█▌        | 84/520 [2:39:16<48:42:48, 402.22s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:31<00:00, 80.98s/it][A100%|██████████| 10/10 [13:31<00:00, 81.18s/it]
 16%|█▌        | 84/520 [2:39:00<48:41:55, 402.10s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:31<00:00, 80.97s/it][A100%|██████████| 10/10 [13:31<00:00, 81.18s/it]
 16%|█▌        | 84/520 [2:38:57<48:41:48, 402.08s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:31<00:00, 80.97s/it][A100%|██████████| 10/10 [13:31<00:00, 81.18s/it]
 16%|█▌        | 84/520 [2:38:57<48:41:46, 402.08s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_237
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [00:55<08:23, 55.90s/it][A[2024-05-30 16:58:48,924] [INFO] [logging.py:96:log_dist] [Rank 0] step=831, skipped=0, lr=[1.9310528871490265e-05], mom=[(0.9, 0.999)]
steps: 831 loss: 0.5691 iter time (s): 54.350 samples/sec: 2.355

 10%|█         | 1/10 [00:55<08:17, 55.27s/it][A
 10%|█         | 1/10 [00:55<08:17, 55.29s/it][A
 10%|█         | 1/10 [00:55<08:17, 55.23s/it][A
 10%|█         | 1/10 [00:55<08:15, 55.10s/it][A
 10%|█         | 1/10 [00:55<08:16, 55.13s/it][A
 10%|█         | 1/10 [00:55<08:15, 55.09s/it][A
 10%|█         | 1/10 [00:55<08:15, 55.06s/it][A
 20%|██        | 2/10 [01:50<07:23, 55.39s/it][A[2024-05-30 16:59:43,972] [INFO] [logging.py:96:log_dist] [Rank 0] step=832, skipped=0, lr=[1.9308460729710075e-05], mom=[(0.9, 0.999)]
steps: 832 loss: 0.6865 iter time (s): 54.427 samples/sec: 2.352

 20%|██        | 2/10 [01:50<07:22, 55.31s/it][A
 20%|██        | 2/10 [01:50<07:22, 55.26s/it][A
 20%|██        | 2/10 [01:50<07:22, 55.26s/it][A
 20%|██        | 2/10 [01:50<07:21, 55.21s/it][A
 20%|██        | 2/10 [01:50<07:21, 55.21s/it][A
 20%|██        | 2/10 [01:50<07:21, 55.18s/it][A
 20%|██        | 2/10 [01:50<07:21, 55.20s/it][A
 30%|███       | 3/10 [02:47<06:30, 55.80s/it][A[2024-05-30 17:00:40,261] [INFO] [logging.py:96:log_dist] [Rank 0] step=833, skipped=0, lr=[1.9306389601865453e-05], mom=[(0.9, 0.999)]
steps: 833 loss: 0.6378 iter time (s): 55.451 samples/sec: 2.308

 30%|███       | 3/10 [02:46<06:29, 55.62s/it][A
 30%|███       | 3/10 [02:46<06:29, 55.63s/it][A
 30%|███       | 3/10 [02:46<06:29, 55.60s/it][A
 30%|███       | 3/10 [02:46<06:29, 55.60s/it][A
 30%|███       | 3/10 [02:46<06:29, 55.62s/it][A
 30%|███       | 3/10 [02:46<06:29, 55.59s/it][A
 30%|███       | 3/10 [02:46<06:29, 55.59s/it][A
 40%|████      | 4/10 [03:42<05:33, 55.66s/it][A[2024-05-30 17:01:35,692] [INFO] [logging.py:96:log_dist] [Rank 0] step=834, skipped=0, lr=[1.9304315488620854e-05], mom=[(0.9, 0.999)]
steps: 834 loss: 0.6320 iter time (s): 54.810 samples/sec: 2.335

 40%|████      | 4/10 [03:42<05:33, 55.57s/it][A
 40%|████      | 4/10 [03:42<05:33, 55.58s/it][A
 40%|████      | 4/10 [03:42<05:33, 55.55s/it][A
 40%|████      | 4/10 [03:41<05:33, 55.53s/it][A
 40%|████      | 4/10 [03:41<05:33, 55.52s/it][A
 40%|████      | 4/10 [03:41<05:33, 55.53s/it][A
 40%|████      | 4/10 [03:41<05:33, 55.53s/it][A
 50%|█████     | 5/10 [04:37<04:36, 55.30s/it][A[2024-05-30 17:02:30,357] [INFO] [logging.py:96:log_dist] [Rank 0] step=835, skipped=0, lr=[1.9302238390641716e-05], mom=[(0.9, 0.999)]
steps: 835 loss: 0.6531 iter time (s): 54.037 samples/sec: 2.369

 50%|█████     | 5/10 [04:36<04:36, 55.24s/it][A
 50%|█████     | 5/10 [04:36<04:36, 55.23s/it][A
 50%|█████     | 5/10 [04:36<04:36, 55.22s/it][A
 50%|█████     | 5/10 [04:36<04:36, 55.21s/it][A
 50%|█████     | 5/10 [04:36<04:36, 55.21s/it][A
 50%|█████     | 5/10 [04:36<04:36, 55.21s/it][A
 50%|█████     | 5/10 [04:36<04:36, 55.21s/it][A
 60%|██████    | 6/10 [05:32<03:41, 55.34s/it][A[2024-05-30 17:03:25,784] [INFO] [logging.py:96:log_dist] [Rank 0] step=836, skipped=0, lr=[1.930015830859441e-05], mom=[(0.9, 0.999)]
steps: 836 loss: 0.6375 iter time (s): 54.830 samples/sec: 2.335

 60%|██████    | 6/10 [05:32<03:41, 55.29s/it][A
 60%|██████    | 6/10 [05:32<03:41, 55.30s/it][A
 60%|██████    | 6/10 [05:32<03:41, 55.30s/it][A
 60%|██████    | 6/10 [05:31<03:41, 55.29s/it][A
 60%|██████    | 6/10 [05:31<03:41, 55.29s/it][A
 60%|██████    | 6/10 [05:31<03:41, 55.29s/it][A
 60%|██████    | 6/10 [05:31<03:41, 55.29s/it][A
 70%|███████   | 7/10 [06:27<02:45, 55.26s/it][A[2024-05-30 17:04:20,866] [INFO] [logging.py:96:log_dist] [Rank 0] step=837, skipped=0, lr=[1.9298075243146295e-05], mom=[(0.9, 0.999)]
steps: 837 loss: 0.6722 iter time (s): 54.446 samples/sec: 2.351

 70%|███████   | 7/10 [06:27<02:45, 55.24s/it][A
 70%|███████   | 7/10 [06:27<02:45, 55.23s/it][A
 70%|███████   | 7/10 [06:27<02:45, 55.22s/it][A
 70%|███████   | 7/10 [06:27<02:45, 55.23s/it][A
 70%|███████   | 7/10 [06:27<02:45, 55.23s/it][A
 70%|███████   | 7/10 [06:27<02:45, 55.22s/it][A
 70%|███████   | 7/10 [06:27<02:45, 55.22s/it][A
 80%|████████  | 8/10 [07:23<01:51, 55.54s/it][A[2024-05-30 17:05:17,010] [INFO] [logging.py:96:log_dist] [Rank 0] step=838, skipped=0, lr=[1.9295989194965662e-05], mom=[(0.9, 0.999)]
steps: 838 loss: 0.6304 iter time (s): 55.510 samples/sec: 2.306

 80%|████████  | 8/10 [07:23<01:51, 55.51s/it][A
 80%|████████  | 8/10 [07:23<01:50, 55.50s/it][A
 80%|████████  | 8/10 [07:23<01:51, 55.53s/it][A
 80%|████████  | 8/10 [07:23<01:51, 55.52s/it][A
 80%|████████  | 8/10 [07:23<01:50, 55.50s/it][A
 80%|████████  | 8/10 [07:23<01:51, 55.52s/it][A
 80%|████████  | 8/10 [07:23<01:51, 55.50s/it][A
 90%|█████████ | 9/10 [08:18<00:55, 55.29s/it][A[2024-05-30 17:06:11,762] [INFO] [logging.py:96:log_dist] [Rank 0] step=839, skipped=0, lr=[1.929390016472176e-05], mom=[(0.9, 0.999)]
steps: 839 loss: 0.6158 iter time (s): 54.187 samples/sec: 2.362

 90%|█████████ | 9/10 [08:18<00:55, 55.29s/it][A
 90%|█████████ | 9/10 [08:18<00:55, 55.30s/it][A
 90%|█████████ | 9/10 [08:18<00:55, 55.28s/it][A
 90%|█████████ | 9/10 [08:17<00:55, 55.28s/it][A
 90%|█████████ | 9/10 [08:17<00:55, 55.28s/it][A
 90%|█████████ | 9/10 [08:17<00:55, 55.28s/it][A
 90%|█████████ | 9/10 [08:17<00:55, 55.28s/it][A
100%|██████████| 10/10 [09:12<00:00, 54.77s/it][A100%|██████████| 10/10 [09:12<00:00, 55.23s/it]
[2024-05-30 17:07:05,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=840, skipped=0, lr=[1.9291808153084812e-05], mom=[(0.9, 0.999)]
steps: 840 loss: 0.6718 iter time (s): 52.975 samples/sec: 2.416

100%|██████████| 10/10 [09:11<00:00, 54.74s/it][A100%|██████████| 10/10 [09:11<00:00, 55.17s/it]

100%|██████████| 10/10 [09:11<00:00, 54.77s/it][A100%|██████████| 10/10 [09:11<00:00, 55.17s/it]

100%|██████████| 10/10 [09:11<00:00, 54.76s/it][A100%|██████████| 10/10 [09:11<00:00, 55.17s/it]

100%|██████████| 10/10 [09:11<00:00, 54.77s/it][A100%|██████████| 10/10 [09:11<00:00, 55.16s/it]

100%|██████████| 10/10 [09:11<00:00, 54.76s/it][A100%|██████████| 10/10 [09:11<00:00, 55.16s/it]

100%|██████████| 10/10 [09:11<00:00, 54.80s/it][A100%|██████████| 10/10 [09:11<00:00, 55.17s/it]

100%|██████████| 10/10 [09:11<00:00, 54.80s/it][A100%|██████████| 10/10 [09:11<00:00, 55.16s/it]
Checkpointing at shard 85
[2024-05-30 17:07:06,120] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step840 is about to be saved!
[2024-05-30 17:07:07,940] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_00-model_states.pt...
[2024-05-30 17:07:12,259] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_02-model_states.pt...
[2024-05-30 17:07:13,202] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_05-model_states.pt...
[2024-05-30 17:07:14,722] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_08-model_states.pt...
[2024-05-30 17:07:14,762] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_06-model_states.pt...
[2024-05-30 17:07:15,273] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_07-model_states.pt...
[2024-05-30 17:07:15,389] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_00-model_states.pt.
[2024-05-30 17:07:20,015] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_04-model_states.pt...
[2024-05-30 17:07:20,055] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_03-model_states.pt...
[2024-05-30 17:07:24,429] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_01-model_states.pt...
[2024-05-30 17:08:31,868] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_02-model_states.pt.
[2024-05-30 17:08:31,923] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_01_model_states.pt
[2024-05-30 17:08:31,923] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_01_model_states.pt...
[2024-05-30 17:08:32,279] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_01_model_states.pt.
[2024-05-30 17:08:32,279] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step840 is ready now!
[2024-05-30 17:08:41,648] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_01-model_states.pt.
[2024-05-30 17:08:42,522] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_00_model_states.pt
[2024-05-30 17:08:42,522] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_00_model_states.pt...
[2024-05-30 17:08:43,265] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_00_model_states.pt.
[2024-05-30 17:08:43,266] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step840 is ready now!
[2024-05-30 17:09:00,918] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_03-model_states.pt.
[2024-05-30 17:09:01,171] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_02_model_states.pt...
[2024-05-30 17:09:01,340] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_02_model_states.pt.
[2024-05-30 17:09:01,341] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step840 is ready now!
[2024-05-30 17:09:17,264] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_04-model_states.pt.
[2024-05-30 17:09:17,303] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_03_model_states.pt...
[2024-05-30 17:09:17,426] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_03_model_states.pt.
[2024-05-30 17:09:17,426] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step840 is ready now!
[2024-05-30 17:09:28,726] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_05-model_states.pt.
[2024-05-30 17:09:29,080] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_04_model_states.pt...
[2024-05-30 17:09:29,209] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_04_model_states.pt.
[2024-05-30 17:09:29,210] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step840 is ready now!
[2024-05-30 17:09:41,195] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_06-model_states.pt.
[2024-05-30 17:09:41,672] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_05_model_states.pt...
[2024-05-30 17:09:42,907] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_05_model_states.pt.
[2024-05-30 17:09:42,908] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step840 is ready now!
[2024-05-30 17:09:43,642] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_07-model_states.pt.
[2024-05-30 17:09:44,283] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_08-model_states.pt.
[2024-05-30 17:09:44,465] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_06_model_states.pt...
[2024-05-30 17:09:44,532] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_06_model_states.pt.
[2024-05-30 17:09:44,533] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step840 is ready now!
[2024-05-30 17:09:44,810] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_09-model_states.pt...
[2024-05-30 17:09:46,302] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/layer_09-model_states.pt.
[2024-05-30 17:09:46,306] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_07_model_states.pt...
[2024-05-30 17:09:46,418] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step840/mp_rank_07_model_states.pt.
[2024-05-30 17:09:46,418] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step840 is ready now!
 16%|█▋        | 85/520 [2:50:50<54:27:01, 450.62s/it] 16%|█▋        | 85/520 [2:51:08<54:27:28, 450.69s/it] 16%|█▋        | 85/520 [2:50:40<54:28:57, 450.89s/it] 16%|█▋        | 85/520 [2:51:09<54:27:46, 450.73s/it] 16%|█▋        | 85/520 [2:51:50<54:29:31, 450.97s/it] 16%|█▋        | 85/520 [2:50:49<54:26:30, 450.55s/it] 16%|█▋        | 85/520 [2:50:52<54:26:41, 450.58s/it]Checkpoint saved using --- 160.30135822296143 seconds ---
 16%|█▋        | 85/520 [2:50:49<54:26:27, 450.55s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_120

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:14<11:10, 74.46s/it][A[2024-05-30 17:11:02,788] [INFO] [logging.py:96:log_dist] [Rank 0] step=841, skipped=0, lr=[1.9289713160725984e-05], mom=[(0.9, 0.999)]
steps: 841 loss: 1.1090 iter time (s): 76.026 samples/sec: 1.684

 10%|█         | 1/10 [01:16<11:27, 76.43s/it][A
 10%|█         | 1/10 [01:16<11:28, 76.50s/it][A
 10%|█         | 1/10 [01:16<11:30, 76.69s/it][A
 10%|█         | 1/10 [01:16<11:31, 76.82s/it][A
 10%|█         | 1/10 [01:16<11:31, 76.83s/it][A
 10%|█         | 1/10 [01:16<11:31, 76.87s/it][A
 10%|█         | 1/10 [01:16<11:31, 76.88s/it][A
 20%|██        | 2/10 [02:30<10:04, 75.54s/it][A[2024-05-30 17:12:19,056] [INFO] [logging.py:96:log_dist] [Rank 0] step=842, skipped=0, lr=[1.92876151883174e-05], mom=[(0.9, 0.999)]
steps: 842 loss: 1.0969 iter time (s): 75.466 samples/sec: 1.696

 20%|██        | 2/10 [02:32<10:10, 76.33s/it][A
 20%|██        | 2/10 [02:32<10:11, 76.38s/it][A
 20%|██        | 2/10 [02:32<10:11, 76.42s/it][A
 20%|██        | 2/10 [02:33<10:11, 76.46s/it][A
 20%|██        | 2/10 [02:33<10:11, 76.46s/it][A
 20%|██        | 2/10 [02:33<10:11, 76.49s/it][A
 20%|██        | 2/10 [02:33<10:11, 76.49s/it][A
 30%|███       | 3/10 [03:47<08:52, 76.11s/it][A[2024-05-30 17:13:35,878] [INFO] [logging.py:96:log_dist] [Rank 0] step=843, skipped=0, lr=[1.9285514236532143e-05], mom=[(0.9, 0.999)]
steps: 843 loss: 1.1209 iter time (s): 76.070 samples/sec: 1.683

 30%|███       | 3/10 [03:49<08:55, 76.53s/it][A
 30%|███       | 3/10 [03:49<08:55, 76.55s/it][A
 30%|███       | 3/10 [03:49<08:56, 76.59s/it][A
 30%|███       | 3/10 [03:49<08:56, 76.63s/it][A
 30%|███       | 3/10 [03:49<08:56, 76.64s/it][A
 30%|███       | 3/10 [03:49<08:56, 76.65s/it][A
 30%|███       | 3/10 [03:49<08:56, 76.64s/it][A
 40%|████      | 4/10 [05:02<07:35, 75.85s/it][A[2024-05-30 17:14:51,311] [INFO] [logging.py:96:log_dist] [Rank 0] step=844, skipped=0, lr=[1.9283410306044252e-05], mom=[(0.9, 0.999)]
steps: 844 loss: 1.0971 iter time (s): 74.676 samples/sec: 1.714

 40%|████      | 4/10 [05:04<07:36, 76.11s/it][A
 40%|████      | 4/10 [05:05<07:36, 76.12s/it][A
 40%|████      | 4/10 [05:05<07:36, 76.14s/it][A
 40%|████      | 4/10 [05:05<07:36, 76.13s/it][A
 40%|████      | 4/10 [05:05<07:36, 76.15s/it][A
 40%|████      | 4/10 [05:05<07:36, 76.15s/it][A
 40%|████      | 4/10 [05:05<07:36, 76.16s/it][A
 50%|█████     | 5/10 [06:17<06:17, 75.45s/it][A[2024-05-30 17:16:06,054] [INFO] [logging.py:96:log_dist] [Rank 0] step=845, skipped=0, lr=[1.9281303397528716e-05], mom=[(0.9, 0.999)]
steps: 845 loss: 1.0923 iter time (s): 73.994 samples/sec: 1.730

 50%|█████     | 5/10 [06:19<06:18, 75.62s/it][A
 50%|█████     | 5/10 [06:19<06:18, 75.63s/it][A
 50%|█████     | 5/10 [06:19<06:18, 75.64s/it][A
 50%|█████     | 5/10 [06:20<06:18, 75.65s/it][A
 50%|█████     | 5/10 [06:20<06:18, 75.66s/it][A
 50%|█████     | 5/10 [06:20<06:18, 75.65s/it][A
 50%|█████     | 5/10 [06:20<06:18, 75.65s/it][A
 60%|██████    | 6/10 [07:41<05:13, 78.29s/it][A[2024-05-30 17:17:29,868] [INFO] [logging.py:96:log_dist] [Rank 0] step=846, skipped=0, lr=[1.9279193511661488e-05], mom=[(0.9, 0.999)]
steps: 846 loss: 1.0896 iter time (s): 83.089 samples/sec: 1.541

 60%|██████    | 6/10 [07:43<05:13, 78.43s/it][A
 60%|██████    | 6/10 [07:43<05:13, 78.42s/it][A
 60%|██████    | 6/10 [07:43<05:13, 78.43s/it][A
 60%|██████    | 6/10 [07:43<05:13, 78.43s/it][A
 60%|██████    | 6/10 [07:43<05:13, 78.45s/it][A
 60%|██████    | 6/10 [07:43<05:13, 78.44s/it][A
 60%|██████    | 6/10 [07:43<05:13, 78.44s/it][A
 70%|███████   | 7/10 [09:08<04:03, 81.01s/it][A[2024-05-30 17:18:56,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=847, skipped=0, lr=[1.9277080649119468e-05], mom=[(0.9, 0.999)]
steps: 847 loss: 1.0757 iter time (s): 85.828 samples/sec: 1.491

 70%|███████   | 7/10 [09:10<04:03, 81.10s/it][A
 70%|███████   | 7/10 [09:10<04:03, 81.11s/it][A
 70%|███████   | 7/10 [09:10<04:03, 81.09s/it][A
 70%|███████   | 7/10 [09:10<04:03, 81.09s/it][A
 70%|███████   | 7/10 [09:10<04:03, 81.12s/it][A
 70%|███████   | 7/10 [09:10<04:03, 81.11s/it][A
 70%|███████   | 7/10 [09:10<04:03, 81.12s/it][A
 80%|████████  | 8/10 [10:23<02:38, 79.08s/it][A[2024-05-30 17:20:11,412] [INFO] [logging.py:96:log_dist] [Rank 0] step=848, skipped=0, lr=[1.927496481058052e-05], mom=[(0.9, 0.999)]
steps: 848 loss: 1.0740 iter time (s): 74.169 samples/sec: 1.726

 80%|████████  | 8/10 [10:25<02:38, 79.14s/it][A
 80%|████████  | 8/10 [10:25<02:38, 79.12s/it][A
 80%|████████  | 8/10 [10:25<02:38, 79.14s/it][A
 80%|████████  | 8/10 [10:25<02:38, 79.14s/it][A
 80%|████████  | 8/10 [10:25<02:38, 79.14s/it][A
 80%|████████  | 8/10 [10:25<02:38, 79.14s/it][A
 80%|████████  | 8/10 [10:25<02:38, 79.14s/it][A
 90%|█████████ | 9/10 [11:38<01:18, 78.04s/it][A[2024-05-30 17:21:27,192] [INFO] [logging.py:96:log_dist] [Rank 0] step=849, skipped=0, lr=[1.927284599672345e-05], mom=[(0.9, 0.999)]
steps: 849 loss: 1.0693 iter time (s): 75.025 samples/sec: 1.706

 90%|█████████ | 9/10 [11:40<01:18, 78.07s/it][A
 90%|█████████ | 9/10 [11:40<01:18, 78.09s/it][A
 90%|█████████ | 9/10 [11:41<01:18, 78.08s/it][A
 90%|█████████ | 9/10 [11:41<01:18, 78.09s/it][A
 90%|█████████ | 9/10 [11:41<01:18, 78.09s/it][A
 90%|█████████ | 9/10 [11:41<01:18, 78.09s/it][A
 90%|█████████ | 9/10 [11:41<01:18, 78.10s/it][A
100%|██████████| 10/10 [12:56<00:00, 77.80s/it][A100%|██████████| 10/10 [12:56<00:00, 77.61s/it]
 17%|█▋        | 86/520 [3:03:36<61:31:26, 510.34s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 17:22:44,450] [INFO] [logging.py:96:log_dist] [Rank 0] step=850, skipped=0, lr=[1.9270724208228035e-05], mom=[(0.9, 0.999)]
steps: 850 loss: 1.0668 iter time (s): 76.483 samples/sec: 1.674

100%|██████████| 10/10 [12:58<00:00, 77.83s/it][A100%|██████████| 10/10 [12:58<00:00, 77.81s/it]
 17%|█▋        | 86/520 [3:03:48<61:32:31, 510.49s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:58<00:00, 77.84s/it][A100%|██████████| 10/10 [12:58<00:00, 77.82s/it]
 17%|█▋        | 86/520 [3:04:07<61:33:16, 510.59s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:58<00:00, 77.85s/it][A100%|██████████| 10/10 [12:58<00:00, 77.84s/it]
 17%|█▋        | 86/520 [3:04:49<61:34:54, 510.82s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:58<00:00, 77.83s/it][A100%|██████████| 10/10 [12:58<00:00, 77.84s/it]
 17%|█▋        | 86/520 [3:04:07<61:33:18, 510.60s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:58<00:00, 77.83s/it][A100%|██████████| 10/10 [12:58<00:00, 77.85s/it]
 17%|█▋        | 86/520 [3:03:51<61:32:42, 510.51s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:58<00:00, 77.83s/it][A100%|██████████| 10/10 [12:58<00:00, 77.85s/it]
 17%|█▋        | 86/520 [3:03:48<61:32:37, 510.50s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:58<00:00, 77.83s/it][A100%|██████████| 10/10 [12:58<00:00, 77.85s/it]
 17%|█▋        | 86/520 [3:03:47<61:32:36, 510.50s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_93
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:17<11:38, 77.67s/it][A[2024-05-30 17:24:02,292] [INFO] [logging.py:96:log_dist] [Rank 0] step=851, skipped=0, lr=[1.9268599445774986e-05], mom=[(0.9, 0.999)]
steps: 851 loss: 1.0914 iter time (s): 76.897 samples/sec: 1.665

 10%|█         | 1/10 [01:17<11:40, 77.80s/it][A
 10%|█         | 1/10 [01:17<11:39, 77.76s/it][A
 10%|█         | 1/10 [01:17<11:39, 77.75s/it][A
 10%|█         | 1/10 [01:17<11:39, 77.78s/it][A
 10%|█         | 1/10 [01:17<11:40, 77.84s/it][A
 10%|█         | 1/10 [01:17<11:40, 77.81s/it][A
 10%|█         | 1/10 [01:17<11:40, 77.82s/it][A
 20%|██        | 2/10 [02:33<10:11, 76.48s/it][A[2024-05-30 17:25:17,926] [INFO] [logging.py:96:log_dist] [Rank 0] step=852, skipped=0, lr=[1.926647171004599e-05], mom=[(0.9, 0.999)]
steps: 852 loss: 1.0663 iter time (s): 74.904 samples/sec: 1.709

 20%|██        | 2/10 [02:33<10:12, 76.52s/it][A
 20%|██        | 2/10 [02:33<10:12, 76.58s/it][A
 20%|██        | 2/10 [02:33<10:12, 76.55s/it][A
 20%|██        | 2/10 [02:33<10:12, 76.57s/it][A
 20%|██        | 2/10 [02:33<10:12, 76.56s/it][A
 20%|██        | 2/10 [02:33<10:12, 76.57s/it][A
 20%|██        | 2/10 [02:33<10:12, 76.57s/it][A
 30%|███       | 3/10 [03:49<08:55, 76.44s/it][A[2024-05-30 17:26:34,333] [INFO] [logging.py:96:log_dist] [Rank 0] step=853, skipped=0, lr=[1.9264341001723675e-05], mom=[(0.9, 0.999)]
steps: 853 loss: 1.0705 iter time (s): 75.621 samples/sec: 1.693

 30%|███       | 3/10 [03:49<08:55, 76.45s/it][A
 30%|███       | 3/10 [03:49<08:55, 76.45s/it][A
 30%|███       | 3/10 [03:49<08:55, 76.47s/it][A
 30%|███       | 3/10 [03:49<08:55, 76.49s/it][A
 30%|███       | 3/10 [03:49<08:55, 76.48s/it][A
 30%|███       | 3/10 [03:49<08:55, 76.48s/it][A
 30%|███       | 3/10 [03:49<08:55, 76.48s/it][A
 40%|████      | 4/10 [05:05<07:38, 76.34s/it][A[2024-05-30 17:27:50,520] [INFO] [logging.py:96:log_dist] [Rank 0] step=854, skipped=0, lr=[1.9262207321491622e-05], mom=[(0.9, 0.999)]
steps: 854 loss: 1.0884 iter time (s): 75.410 samples/sec: 1.697

 40%|████      | 4/10 [05:05<07:38, 76.34s/it][A
 40%|████      | 4/10 [05:06<07:38, 76.42s/it][A
 40%|████      | 4/10 [05:06<07:38, 76.38s/it][A
 40%|████      | 4/10 [05:06<07:38, 76.40s/it][A
 40%|████      | 4/10 [05:06<07:38, 76.40s/it][A
 40%|████      | 4/10 [05:06<07:38, 76.40s/it][A
 40%|████      | 4/10 [05:06<07:38, 76.40s/it][A
 50%|█████     | 5/10 [06:22<06:22, 76.49s/it][A[2024-05-30 17:29:07,259] [INFO] [logging.py:96:log_dist] [Rank 0] step=855, skipped=0, lr=[1.926007067003437e-05], mom=[(0.9, 0.999)]
steps: 855 loss: 1.0632 iter time (s): 75.865 samples/sec: 1.687

 50%|█████     | 5/10 [06:22<06:22, 76.53s/it][A
 50%|█████     | 5/10 [06:22<06:22, 76.48s/it][A
 50%|█████     | 5/10 [06:22<06:22, 76.49s/it][A
 50%|█████     | 5/10 [06:22<06:22, 76.49s/it][A
 50%|█████     | 5/10 [06:22<06:22, 76.50s/it][A
 50%|█████     | 5/10 [06:22<06:22, 76.49s/it][A
 50%|█████     | 5/10 [06:22<06:22, 76.49s/it][A
 60%|██████    | 6/10 [07:39<05:06, 76.74s/it][A[2024-05-30 17:30:24,497] [INFO] [logging.py:96:log_dist] [Rank 0] step=856, skipped=0, lr=[1.925793104803741e-05], mom=[(0.9, 0.999)]
steps: 856 loss: 1.0524 iter time (s): 76.467 samples/sec: 1.674

 60%|██████    | 6/10 [07:39<05:06, 76.74s/it][A
 60%|██████    | 6/10 [07:39<05:06, 76.72s/it][A
 60%|██████    | 6/10 [07:39<05:06, 76.72s/it][A
 60%|██████    | 6/10 [07:40<05:06, 76.75s/it][A
 60%|██████    | 6/10 [07:40<05:06, 76.75s/it][A
 60%|██████    | 6/10 [07:40<05:06, 76.74s/it][A
 60%|██████    | 6/10 [07:40<05:06, 76.73s/it][A
 70%|███████   | 7/10 [08:56<03:50, 76.73s/it][A[2024-05-30 17:31:41,188] [INFO] [logging.py:96:log_dist] [Rank 0] step=857, skipped=0, lr=[1.9255788456187185e-05], mom=[(0.9, 0.999)]
steps: 857 loss: 1.0796 iter time (s): 75.945 samples/sec: 1.685

 70%|███████   | 7/10 [08:56<03:50, 76.75s/it][A
 70%|███████   | 7/10 [08:56<03:50, 76.71s/it][A
 70%|███████   | 7/10 [08:56<03:50, 76.73s/it][A
 70%|███████   | 7/10 [08:56<03:50, 76.75s/it][A
 70%|███████   | 7/10 [08:56<03:50, 76.75s/it][A
 70%|███████   | 7/10 [08:56<03:50, 76.75s/it][A
 70%|███████   | 7/10 [08:56<03:50, 76.76s/it][A
 80%|████████  | 8/10 [10:13<02:33, 76.83s/it][A[2024-05-30 17:32:58,252] [INFO] [logging.py:96:log_dist] [Rank 0] step=858, skipped=0, lr=[1.9253642895171096e-05], mom=[(0.9, 0.999)]
steps: 858 loss: 1.0581 iter time (s): 76.220 samples/sec: 1.679

 80%|████████  | 8/10 [10:13<02:33, 76.85s/it][A
 80%|████████  | 8/10 [10:13<02:33, 76.84s/it][A
 80%|████████  | 8/10 [10:13<02:33, 76.84s/it][A
 80%|████████  | 8/10 [10:13<02:33, 76.82s/it][A
 80%|████████  | 8/10 [10:13<02:33, 76.83s/it][A
 80%|████████  | 8/10 [10:13<02:33, 76.83s/it][A
 80%|████████  | 8/10 [10:13<02:33, 76.83s/it][A
 90%|█████████ | 9/10 [11:30<01:16, 76.81s/it][A[2024-05-30 17:34:15,009] [INFO] [logging.py:96:log_dist] [Rank 0] step=859, skipped=0, lr=[1.9251494365677487e-05], mom=[(0.9, 0.999)]
steps: 859 loss: 1.0647 iter time (s): 75.969 samples/sec: 1.685

 90%|█████████ | 9/10 [11:30<01:16, 76.82s/it][A
 90%|█████████ | 9/10 [11:30<01:16, 76.82s/it][A
 90%|█████████ | 9/10 [11:30<01:16, 76.81s/it][A
 90%|█████████ | 9/10 [11:30<01:16, 76.81s/it][A
 90%|█████████ | 9/10 [11:30<01:16, 76.82s/it][A
 90%|█████████ | 9/10 [11:30<01:16, 76.80s/it][A
 90%|█████████ | 9/10 [11:30<01:16, 76.81s/it][A
100%|██████████| 10/10 [12:44<00:00, 75.95s/it][A100%|██████████| 10/10 [12:44<00:00, 76.44s/it]
 17%|█▋        | 87/520 [3:16:21<67:42:37, 562.95s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 17:35:29,046] [INFO] [logging.py:96:log_dist] [Rank 0] step=860, skipped=0, lr=[1.924934286839566e-05], mom=[(0.9, 0.999)]
steps: 860 loss: 1.0653 iter time (s): 73.262 samples/sec: 1.747

100%|██████████| 10/10 [12:44<00:00, 75.93s/it][A100%|██████████| 10/10 [12:44<00:00, 76.45s/it]
 17%|█▋        | 87/520 [3:16:33<67:43:22, 563.05s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:44<00:00, 75.96s/it][A100%|██████████| 10/10 [12:44<00:00, 76.46s/it]
 17%|█▋        | 87/520 [3:16:52<67:44:04, 563.15s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:44<00:00, 75.94s/it][A100%|██████████| 10/10 [12:44<00:00, 76.45s/it]
 17%|█▋        | 87/520 [3:17:33<67:45:11, 563.31s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:44<00:00, 75.94s/it][A100%|██████████| 10/10 [12:44<00:00, 76.46s/it]
 17%|█▋        | 87/520 [3:16:51<67:44:03, 563.15s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:44<00:00, 75.95s/it][A100%|██████████| 10/10 [12:44<00:00, 76.46s/it]
 17%|█▋        | 87/520 [3:16:36<67:43:38, 563.09s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:44<00:00, 75.94s/it][A100%|██████████| 10/10 [12:44<00:00, 76.46s/it]
 17%|█▋        | 87/520 [3:16:33<67:43:32, 563.08s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:44<00:00, 75.94s/it][A100%|██████████| 10/10 [12:44<00:00, 76.46s/it]
 17%|█▋        | 87/520 [3:16:32<67:43:30, 563.07s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_336
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:21<12:14, 81.58s/it][A[2024-05-30 17:36:50,920] [INFO] [logging.py:96:log_dist] [Rank 0] step=861, skipped=0, lr=[1.9247188404015873e-05], mom=[(0.9, 0.999)]
steps: 861 loss: 0.5869 iter time (s): 81.001 samples/sec: 1.580

 10%|█         | 1/10 [01:21<12:17, 81.98s/it][A
 10%|█         | 1/10 [01:21<12:17, 81.90s/it][A
 10%|█         | 1/10 [01:21<12:17, 81.97s/it][A
 10%|█         | 1/10 [01:21<12:17, 81.95s/it][A
 10%|█         | 1/10 [01:21<12:17, 81.92s/it][A
 10%|█         | 1/10 [01:21<12:17, 81.95s/it][A
 10%|█         | 1/10 [01:21<12:17, 81.96s/it][A
 20%|██        | 2/10 [02:42<10:49, 81.24s/it][A[2024-05-30 17:38:11,934] [INFO] [logging.py:96:log_dist] [Rank 0] step=862, skipped=0, lr=[1.9245030973229325e-05], mom=[(0.9, 0.999)]
steps: 862 loss: 0.5824 iter time (s): 80.173 samples/sec: 1.597

 20%|██        | 2/10 [02:42<10:50, 81.37s/it][A
 20%|██        | 2/10 [02:42<10:51, 81.38s/it][A
 20%|██        | 2/10 [02:42<10:51, 81.38s/it][A
 20%|██        | 2/10 [02:42<10:51, 81.39s/it][A
 20%|██        | 2/10 [02:42<10:51, 81.38s/it][A
 20%|██        | 2/10 [02:42<10:51, 81.40s/it][A
 20%|██        | 2/10 [02:42<10:51, 81.40s/it][A
 30%|███       | 3/10 [04:04<09:31, 81.61s/it][A[2024-05-30 17:39:33,973] [INFO] [logging.py:96:log_dist] [Rank 0] step=863, skipped=0, lr=[1.924287057672818e-05], mom=[(0.9, 0.999)]
steps: 863 loss: 0.5748 iter time (s): 81.193 samples/sec: 1.576

 30%|███       | 3/10 [04:05<09:31, 81.70s/it][A
 30%|███       | 3/10 [04:04<09:31, 81.66s/it][A
 30%|███       | 3/10 [04:04<09:31, 81.68s/it][A
 30%|███       | 3/10 [04:04<09:31, 81.68s/it][A
 30%|███       | 3/10 [04:04<09:31, 81.66s/it][A
 30%|███       | 3/10 [04:04<09:31, 81.68s/it][A
 30%|███       | 3/10 [04:04<09:31, 81.68s/it][A
 40%|████      | 4/10 [05:26<08:10, 81.71s/it][A[2024-05-30 17:40:55,849] [INFO] [logging.py:96:log_dist] [Rank 0] step=864, skipped=0, lr=[1.9240707215205542e-05], mom=[(0.9, 0.999)]
steps: 864 loss: 0.5718 iter time (s): 81.060 samples/sec: 1.579

 40%|████      | 4/10 [05:26<08:10, 81.77s/it][A
 40%|████      | 4/10 [05:26<08:10, 81.76s/it][A
 40%|████      | 4/10 [05:26<08:10, 81.77s/it][A
 40%|████      | 4/10 [05:26<08:10, 81.76s/it][A
 40%|████      | 4/10 [05:26<08:10, 81.77s/it][A
 40%|████      | 4/10 [05:26<08:10, 81.77s/it][A
 40%|████      | 4/10 [05:26<08:10, 81.77s/it][A
 50%|█████     | 5/10 [06:55<07:00, 84.20s/it][A[2024-05-30 17:42:24,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=865, skipped=0, lr=[1.9238540889355472e-05], mom=[(0.9, 0.999)]
steps: 865 loss: 0.5752 iter time (s): 87.776 samples/sec: 1.458

 50%|█████     | 5/10 [06:55<07:01, 84.22s/it][A
 50%|█████     | 5/10 [06:55<07:01, 84.25s/it][A
 50%|█████     | 5/10 [06:55<07:01, 84.25s/it][A
 50%|█████     | 5/10 [06:55<07:01, 84.23s/it][A
 50%|█████     | 5/10 [06:55<07:01, 84.24s/it][A
 50%|█████     | 5/10 [06:55<07:01, 84.24s/it][A
 50%|█████     | 5/10 [06:55<07:01, 84.24s/it][A
 60%|██████    | 6/10 [08:21<05:39, 84.94s/it][A[2024-05-30 17:43:50,833] [INFO] [logging.py:96:log_dist] [Rank 0] step=866, skipped=0, lr=[1.9236371599872987e-05], mom=[(0.9, 0.999)]
steps: 866 loss: 0.5791 iter time (s): 85.548 samples/sec: 1.496

 60%|██████    | 6/10 [08:21<05:39, 84.95s/it][A
 60%|██████    | 6/10 [08:21<05:39, 84.97s/it][A
 60%|██████    | 6/10 [08:21<05:39, 84.97s/it][A
 60%|██████    | 6/10 [08:21<05:39, 84.98s/it][A
 60%|██████    | 6/10 [08:21<05:39, 84.98s/it][A
 60%|██████    | 6/10 [08:21<05:39, 84.97s/it][A
 60%|██████    | 6/10 [08:21<05:39, 84.97s/it][A
 70%|███████   | 7/10 [09:43<04:11, 83.85s/it][A[2024-05-30 17:45:12,444] [INFO] [logging.py:96:log_dist] [Rank 0] step=867, skipped=0, lr=[1.923419934745404e-05], mom=[(0.9, 0.999)]
steps: 867 loss: 0.5744 iter time (s): 80.747 samples/sec: 1.585

 70%|███████   | 7/10 [09:43<04:11, 83.85s/it][A
 70%|███████   | 7/10 [09:43<04:11, 83.83s/it][A
 70%|███████   | 7/10 [09:43<04:11, 83.86s/it][A
 70%|███████   | 7/10 [09:43<04:11, 83.84s/it][A
 70%|███████   | 7/10 [09:43<04:11, 83.86s/it][A
 70%|███████   | 7/10 [09:43<04:11, 83.85s/it][A
 70%|███████   | 7/10 [09:43<04:11, 83.86s/it][A
 80%|████████  | 8/10 [11:06<02:47, 83.65s/it][A[2024-05-30 17:46:35,664] [INFO] [logging.py:96:log_dist] [Rank 0] step=868, skipped=0, lr=[1.923202413279555e-05], mom=[(0.9, 0.999)]
steps: 868 loss: 0.5738 iter time (s): 82.403 samples/sec: 1.553

 80%|████████  | 8/10 [11:06<02:47, 83.69s/it][A
 80%|████████  | 8/10 [11:06<02:47, 83.71s/it][A
 80%|████████  | 8/10 [11:06<02:47, 83.71s/it][A
 80%|████████  | 8/10 [11:06<02:47, 83.73s/it][A
 80%|████████  | 8/10 [11:06<02:47, 83.72s/it][A
 80%|████████  | 8/10 [11:06<02:47, 83.71s/it][A
 80%|████████  | 8/10 [11:06<02:47, 83.71s/it][A
 90%|█████████ | 9/10 [12:29<01:23, 83.37s/it][A[2024-05-30 17:47:58,419] [INFO] [logging.py:96:log_dist] [Rank 0] step=869, skipped=0, lr=[1.9229845956595375e-05], mom=[(0.9, 0.999)]
steps: 869 loss: 0.5674 iter time (s): 81.778 samples/sec: 1.565

 90%|█████████ | 9/10 [12:29<01:23, 83.37s/it][A
 90%|█████████ | 9/10 [12:29<01:23, 83.37s/it][A
 90%|█████████ | 9/10 [12:29<01:23, 83.36s/it][A
 90%|█████████ | 9/10 [12:29<01:23, 83.36s/it][A
 90%|█████████ | 9/10 [12:29<01:23, 83.37s/it][A
 90%|█████████ | 9/10 [12:29<01:23, 83.36s/it][A
 90%|█████████ | 9/10 [12:29<01:23, 83.37s/it][A
100%|██████████| 10/10 [13:49<00:00, 82.53s/it][A100%|██████████| 10/10 [13:49<00:00, 82.97s/it]
 17%|█▋        | 88/520 [3:30:11<74:51:44, 623.85s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 17:49:19,057] [INFO] [logging.py:96:log_dist] [Rank 0] step=870, skipped=0, lr=[1.9227664819552333e-05], mom=[(0.9, 0.999)]
steps: 870 loss: 0.5693 iter time (s): 79.790 samples/sec: 1.604

100%|██████████| 10/10 [13:50<00:00, 82.54s/it][A100%|██████████| 10/10 [13:50<00:00, 83.01s/it]
 17%|█▋        | 88/520 [3:30:23<74:52:40, 623.98s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:49<00:00, 82.51s/it][A100%|██████████| 10/10 [13:49<00:00, 83.00s/it]
 17%|█▋        | 88/520 [3:30:42<74:53:03, 624.03s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:50<00:00, 82.52s/it][A100%|██████████| 10/10 [13:50<00:00, 83.01s/it]
 17%|█▋        | 88/520 [3:31:23<74:54:05, 624.18s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:50<00:00, 82.50s/it][A100%|██████████| 10/10 [13:50<00:00, 83.00s/it]
 17%|█▋        | 88/520 [3:30:41<74:53:06, 624.04s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:50<00:00, 82.51s/it][A100%|██████████| 10/10 [13:50<00:00, 83.00s/it]
 17%|█▋        | 88/520 [3:30:26<74:52:47, 624.00s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:50<00:00, 82.51s/it][A100%|██████████| 10/10 [13:50<00:00, 83.00s/it]
 17%|█▋        | 88/520 [3:30:23<74:52:43, 623.99s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:50<00:00, 82.51s/it][A100%|██████████| 10/10 [13:50<00:00, 83.01s/it]
 17%|█▋        | 88/520 [3:30:22<74:52:44, 623.99s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_179
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:15<20:18, 135.41s/it][A[2024-05-30 17:51:36,209] [INFO] [logging.py:96:log_dist] [Rank 0] step=871, skipped=0, lr=[1.922548072236618e-05], mom=[(0.9, 0.999)]
steps: 871 loss: 0.6028 iter time (s): 136.237 samples/sec: 0.940

 10%|█         | 1/10 [02:17<20:33, 137.07s/it][A
 10%|█         | 1/10 [02:17<20:33, 137.06s/it][A
 10%|█         | 1/10 [02:17<20:33, 137.10s/it][A
 10%|█         | 1/10 [02:17<20:33, 137.07s/it][A
 10%|█         | 1/10 [02:17<20:33, 137.11s/it][A
 10%|█         | 1/10 [02:17<20:33, 137.10s/it][A
 10%|█         | 1/10 [02:17<20:33, 137.07s/it][A
 20%|██        | 2/10 [04:33<18:14, 136.77s/it][A[2024-05-30 17:53:53,926] [INFO] [logging.py:96:log_dist] [Rank 0] step=872, skipped=0, lr=[1.9223293665737637e-05], mom=[(0.9, 0.999)]
steps: 872 loss: 0.6279 iter time (s): 137.004 samples/sec: 0.934

 20%|██        | 2/10 [04:34<18:19, 137.47s/it][A
 20%|██        | 2/10 [04:34<18:19, 137.48s/it][A
 20%|██        | 2/10 [04:34<18:19, 137.46s/it][A
 20%|██        | 2/10 [04:34<18:19, 137.45s/it][A
 20%|██        | 2/10 [04:34<18:19, 137.45s/it][A
 20%|██        | 2/10 [04:34<18:19, 137.46s/it][A
 20%|██        | 2/10 [04:34<18:19, 137.44s/it][A
 30%|███       | 3/10 [06:53<16:09, 138.45s/it][A[2024-05-30 17:56:14,379] [INFO] [logging.py:96:log_dist] [Rank 0] step=873, skipped=0, lr=[1.922110365036836e-05], mom=[(0.9, 0.999)]
steps: 873 loss: 0.6098 iter time (s): 139.768 samples/sec: 0.916

 30%|███       | 3/10 [06:55<16:11, 138.82s/it][A
 30%|███       | 3/10 [06:55<16:11, 138.85s/it][A
 30%|███       | 3/10 [06:55<16:11, 138.80s/it][A
 30%|███       | 3/10 [06:55<16:11, 138.82s/it][A
 30%|███       | 3/10 [06:55<16:11, 138.82s/it][A
 30%|███       | 3/10 [06:55<16:11, 138.83s/it][A
 30%|███       | 3/10 [06:55<16:11, 138.82s/it][A
 40%|████      | 4/10 [09:24<14:20, 143.44s/it][A[2024-05-30 17:58:45,478] [INFO] [logging.py:96:log_dist] [Rank 0] step=874, skipped=0, lr=[1.9218910676960963e-05], mom=[(0.9, 0.999)]
steps: 874 loss: 0.5987 iter time (s): 150.395 samples/sec: 0.851

 40%|████      | 4/10 [09:26<14:22, 143.68s/it][A
 40%|████      | 4/10 [09:26<14:22, 143.67s/it][A
 40%|████      | 4/10 [09:26<14:22, 143.68s/it][A
 40%|████      | 4/10 [09:26<14:22, 143.67s/it][A
 40%|████      | 4/10 [09:26<14:21, 143.67s/it][A
 40%|████      | 4/10 [09:26<14:21, 143.66s/it][A
 40%|████      | 4/10 [09:26<14:21, 143.66s/it][A
 50%|█████     | 5/10 [11:41<11:45, 141.09s/it][A[2024-05-30 18:01:02,395] [INFO] [logging.py:96:log_dist] [Rank 0] step=875, skipped=0, lr=[1.9216714746219005e-05], mom=[(0.9, 0.999)]
steps: 875 loss: 0.5915 iter time (s): 136.223 samples/sec: 0.940

 50%|█████     | 5/10 [11:43<11:46, 141.24s/it][A
 50%|█████     | 5/10 [11:43<11:46, 141.24s/it][A
 50%|█████     | 5/10 [11:43<11:46, 141.24s/it][A
 50%|█████     | 5/10 [11:43<11:46, 141.27s/it][A
 50%|█████     | 5/10 [11:43<11:46, 141.26s/it][A
 50%|█████     | 5/10 [11:43<11:46, 141.28s/it][A
 50%|█████     | 5/10 [11:43<11:46, 141.28s/it][A
 60%|██████    | 6/10 [14:02<09:24, 141.15s/it][A[2024-05-30 18:03:23,677] [INFO] [logging.py:96:log_dist] [Rank 0] step=876, skipped=0, lr=[1.9214515858847e-05], mom=[(0.9, 0.999)]
steps: 876 loss: 0.5569 iter time (s): 140.415 samples/sec: 0.912

 60%|██████    | 6/10 [14:04<09:25, 141.27s/it][A
 60%|██████    | 6/10 [14:04<09:25, 141.27s/it][A
 60%|██████    | 6/10 [14:04<09:25, 141.25s/it][A
 60%|██████    | 6/10 [14:04<09:24, 141.24s/it][A
 60%|██████    | 6/10 [14:04<09:25, 141.26s/it][A
 60%|██████    | 6/10 [14:04<09:25, 141.25s/it][A
 60%|██████    | 6/10 [14:04<09:25, 141.28s/it][A
 70%|███████   | 7/10 [16:26<07:05, 141.85s/it][A[2024-05-30 18:05:46,933] [INFO] [logging.py:96:log_dist] [Rank 0] step=877, skipped=0, lr=[1.9212314015550397e-05], mom=[(0.9, 0.999)]
steps: 877 loss: 0.5605 iter time (s): 142.398 samples/sec: 0.899

 70%|███████   | 7/10 [16:27<07:05, 141.87s/it][A
 70%|███████   | 7/10 [16:27<07:05, 141.90s/it][A
 70%|███████   | 7/10 [16:27<07:05, 141.90s/it][A
 70%|███████   | 7/10 [16:27<07:05, 141.92s/it][A
 70%|███████   | 7/10 [16:27<07:05, 141.90s/it][A
 70%|███████   | 7/10 [16:27<07:05, 141.89s/it][A
 70%|███████   | 7/10 [16:27<07:05, 141.88s/it][A
 80%|████████  | 8/10 [18:50<04:45, 142.66s/it][A[2024-05-30 18:08:11,343] [INFO] [logging.py:96:log_dist] [Rank 0] step=878, skipped=0, lr=[1.9210109217035607e-05], mom=[(0.9, 0.999)]
steps: 878 loss: 0.5775 iter time (s): 143.723 samples/sec: 0.891

 80%|████████  | 8/10 [18:52<04:45, 142.73s/it][A
 80%|████████  | 8/10 [18:52<04:45, 142.70s/it][A
 80%|████████  | 8/10 [18:52<04:45, 142.70s/it][A
 80%|████████  | 8/10 [18:52<04:45, 142.70s/it][A
 80%|████████  | 8/10 [18:52<04:45, 142.69s/it][A
 80%|████████  | 8/10 [18:52<04:45, 142.70s/it][A
 80%|████████  | 8/10 [18:52<04:45, 142.69s/it][A
 90%|█████████ | 9/10 [21:14<02:22, 142.95s/it][A[2024-05-30 18:10:34,929] [INFO] [logging.py:96:log_dist] [Rank 0] step=879, skipped=0, lr=[1.920790146400998e-05], mom=[(0.9, 0.999)]
steps: 879 loss: 0.5680 iter time (s): 142.846 samples/sec: 0.896

 90%|█████████ | 9/10 [21:15<02:22, 142.96s/it][A
 90%|█████████ | 9/10 [21:15<02:22, 142.96s/it][A
 90%|█████████ | 9/10 [21:15<02:22, 142.99s/it][A
 90%|█████████ | 9/10 [21:15<02:22, 143.00s/it][A
 90%|█████████ | 9/10 [21:15<02:22, 142.99s/it][A
 90%|█████████ | 9/10 [21:15<02:22, 142.98s/it][A
 90%|█████████ | 9/10 [21:15<02:22, 142.97s/it][A
100%|██████████| 10/10 [23:31<00:00, 141.28s/it][A100%|██████████| 10/10 [23:31<00:00, 141.17s/it]
 17%|█▋        | 89/520 [3:53:43<97:52:44, 817.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 18:12:52,459] [INFO] [logging.py:96:log_dist] [Rank 0] step=880, skipped=0, lr=[1.9205690757181824e-05], mom=[(0.9, 0.999)]
steps: 880 loss: 0.5594 iter time (s): 136.786 samples/sec: 0.936

100%|██████████| 10/10 [23:33<00:00, 141.28s/it][A100%|██████████| 10/10 [23:33<00:00, 141.33s/it]
 17%|█▋        | 89/520 [3:53:56<97:56:00, 818.01s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [23:33<00:00, 141.29s/it][A100%|██████████| 10/10 [23:33<00:00, 141.33s/it]
 17%|█▋        | 89/520 [3:54:15<97:56:25, 818.06s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [23:33<00:00, 141.31s/it][A100%|██████████| 10/10 [23:33<00:00, 141.34s/it]
 17%|█▋        | 89/520 [3:54:57<97:57:16, 818.18s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [23:33<00:00, 141.30s/it][A100%|██████████| 10/10 [23:33<00:00, 141.34s/it]
 17%|█▋        | 89/520 [3:54:15<97:56:29, 818.07s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [23:33<00:00, 141.28s/it][A100%|██████████| 10/10 [23:33<00:00, 141.33s/it]
 17%|█▋        | 89/520 [3:53:59<97:56:09, 818.03s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [23:33<00:00, 141.28s/it][A100%|██████████| 10/10 [23:33<00:00, 141.33s/it]
 17%|█▋        | 89/520 [3:53:56<97:56:05, 818.02s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [23:33<00:00, 141.28s/it][A100%|██████████| 10/10 [23:33<00:00, 141.33s/it]
 17%|█▋        | 89/520 [3:53:55<97:56:05, 818.02s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_289
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:21<12:12, 81.39s/it][A[2024-05-30 18:14:12,459] [INFO] [logging.py:96:log_dist] [Rank 0] step=881, skipped=0, lr=[1.920347709726039e-05], mom=[(0.9, 0.999)]
steps: 881 loss: 0.5525 iter time (s): 79.190 samples/sec: 1.616

 10%|█         | 1/10 [01:20<12:01, 80.11s/it][A
 10%|█         | 1/10 [01:20<12:00, 80.10s/it][A
 10%|█         | 1/10 [01:20<12:00, 80.04s/it][A
 10%|█         | 1/10 [01:20<12:00, 80.05s/it][A
 10%|█         | 1/10 [01:20<12:00, 80.08s/it][A
 10%|█         | 1/10 [01:20<12:01, 80.12s/it][A
 10%|█         | 1/10 [01:20<12:01, 80.15s/it][A
 20%|██        | 2/10 [02:42<10:49, 81.22s/it][A[2024-05-30 18:15:33,564] [INFO] [logging.py:96:log_dist] [Rank 0] step=882, skipped=0, lr=[1.9201260484955865e-05], mom=[(0.9, 0.999)]
steps: 882 loss: 0.5603 iter time (s): 80.264 samples/sec: 1.595

 20%|██        | 2/10 [02:41<10:45, 80.68s/it][A
 20%|██        | 2/10 [02:41<10:45, 80.69s/it][A
 20%|██        | 2/10 [02:41<10:45, 80.64s/it][A
 20%|██        | 2/10 [02:41<10:45, 80.70s/it][A
 20%|██        | 2/10 [02:41<10:45, 80.70s/it][A
 20%|██        | 2/10 [02:41<10:45, 80.70s/it][A
 20%|██        | 2/10 [02:41<10:45, 80.70s/it][A
 30%|███       | 3/10 [04:04<09:30, 81.44s/it][A[2024-05-30 18:16:55,274] [INFO] [logging.py:96:log_dist] [Rank 0] step=883, skipped=0, lr=[1.9199040920979404e-05], mom=[(0.9, 0.999)]
steps: 883 loss: 0.5468 iter time (s): 80.868 samples/sec: 1.583

 30%|███       | 3/10 [04:02<09:28, 81.16s/it][A
 30%|███       | 3/10 [04:02<09:27, 81.14s/it][A
 30%|███       | 3/10 [04:02<09:27, 81.13s/it][A
 30%|███       | 3/10 [04:02<09:27, 81.13s/it][A
 30%|███       | 3/10 [04:02<09:28, 81.16s/it][A
 30%|███       | 3/10 [04:02<09:28, 81.15s/it][A
 30%|███       | 3/10 [04:02<09:28, 81.16s/it][A
 40%|████      | 4/10 [05:27<08:11, 81.98s/it][A[2024-05-30 18:18:18,060] [INFO] [logging.py:96:log_dist] [Rank 0] step=884, skipped=0, lr=[1.919681840604309e-05], mom=[(0.9, 0.999)]
steps: 884 loss: 0.5489 iter time (s): 81.946 samples/sec: 1.562

 40%|████      | 4/10 [05:25<08:10, 81.82s/it][A
 40%|████      | 4/10 [05:25<08:10, 81.78s/it][A
 40%|████      | 4/10 [05:25<08:10, 81.77s/it][A
 40%|████      | 4/10 [05:25<08:10, 81.78s/it][A
 40%|████      | 4/10 [05:25<08:10, 81.78s/it][A
 40%|████      | 4/10 [05:25<08:10, 81.78s/it][A
 40%|████      | 4/10 [05:25<08:10, 81.78s/it][A
 50%|█████     | 5/10 [06:50<06:51, 82.37s/it][A[2024-05-30 18:19:41,137] [INFO] [logging.py:96:log_dist] [Rank 0] step=885, skipped=0, lr=[1.9194592940859965e-05], mom=[(0.9, 0.999)]
steps: 885 loss: 0.5447 iter time (s): 82.310 samples/sec: 1.555

 50%|█████     | 5/10 [06:48<06:51, 82.27s/it][A
 50%|█████     | 5/10 [06:48<06:51, 82.27s/it][A
 50%|█████     | 5/10 [06:48<06:51, 82.25s/it][A
 50%|█████     | 5/10 [06:48<06:51, 82.26s/it][A
 50%|█████     | 5/10 [06:48<06:51, 82.26s/it][A
 50%|█████     | 5/10 [06:48<06:51, 82.25s/it][A
 50%|█████     | 5/10 [06:48<06:51, 82.26s/it][A
 60%|██████    | 6/10 [08:10<05:26, 81.57s/it][A[2024-05-30 18:21:01,152] [INFO] [logging.py:96:log_dist] [Rank 0] step=886, skipped=0, lr=[1.9192364526144013e-05], mom=[(0.9, 0.999)]
steps: 886 loss: 0.5473 iter time (s): 79.200 samples/sec: 1.616

 60%|██████    | 6/10 [08:08<05:25, 81.49s/it][A
 60%|██████    | 6/10 [08:08<05:25, 81.49s/it][A
 60%|██████    | 6/10 [08:08<05:25, 81.49s/it][A
 60%|██████    | 6/10 [08:08<05:25, 81.50s/it][A
 60%|██████    | 6/10 [08:08<05:25, 81.50s/it][A
 60%|██████    | 6/10 [08:08<05:26, 81.50s/it][A
 60%|██████    | 6/10 [08:08<05:26, 81.50s/it][A
 70%|███████   | 7/10 [09:32<04:05, 81.70s/it][A[2024-05-30 18:22:22,873] [INFO] [logging.py:96:log_dist] [Rank 0] step=887, skipped=0, lr=[1.9190133162610168e-05], mom=[(0.9, 0.999)]
steps: 887 loss: 0.5494 iter time (s): 80.893 samples/sec: 1.582

 70%|███████   | 7/10 [09:30<04:04, 81.56s/it][A
 70%|███████   | 7/10 [09:30<04:04, 81.56s/it][A
 70%|███████   | 7/10 [09:30<04:04, 81.56s/it][A
 70%|███████   | 7/10 [09:30<04:04, 81.58s/it][A
 70%|███████   | 7/10 [09:30<04:04, 81.57s/it][A
 70%|███████   | 7/10 [09:30<04:04, 81.57s/it][A
 70%|███████   | 7/10 [09:30<04:04, 81.57s/it][A
 80%|████████  | 8/10 [10:53<02:43, 81.71s/it][A[2024-05-30 18:23:44,850] [INFO] [logging.py:96:log_dist] [Rank 0] step=888, skipped=0, lr=[1.91878988509743e-05], mom=[(0.9, 0.999)]
steps: 888 loss: 0.5440 iter time (s): 81.149 samples/sec: 1.577

 80%|████████  | 8/10 [10:52<02:43, 81.67s/it][A
 80%|████████  | 8/10 [10:52<02:43, 81.69s/it][A
 80%|████████  | 8/10 [10:52<02:43, 81.70s/it][A
 80%|████████  | 8/10 [10:52<02:43, 81.67s/it][A
 80%|████████  | 8/10 [10:52<02:43, 81.69s/it][A
 80%|████████  | 8/10 [10:52<02:43, 81.69s/it][A
 80%|████████  | 8/10 [10:52<02:43, 81.69s/it][A
 90%|█████████ | 9/10 [12:15<01:21, 81.83s/it][A[2024-05-30 18:25:06,931] [INFO] [logging.py:96:log_dist] [Rank 0] step=889, skipped=0, lr=[1.9185661591953236e-05], mom=[(0.9, 0.999)]
steps: 889 loss: 0.5545 iter time (s): 81.290 samples/sec: 1.575

 90%|█████████ | 9/10 [12:14<01:21, 81.81s/it][A
 90%|█████████ | 9/10 [12:14<01:21, 81.83s/it][A
 90%|█████████ | 9/10 [12:14<01:21, 81.82s/it][A
 90%|█████████ | 9/10 [12:14<01:21, 81.80s/it][A
 90%|█████████ | 9/10 [12:14<01:21, 81.81s/it][A
 90%|█████████ | 9/10 [12:14<01:21, 81.82s/it][A
 90%|█████████ | 9/10 [12:14<01:21, 81.81s/it][A
100%|██████████| 10/10 [13:38<00:00, 81.99s/it][A100%|██████████| 10/10 [13:38<00:00, 81.82s/it]
[2024-05-30 18:26:29,286] [INFO] [logging.py:96:log_dist] [Rank 0] step=890, skipped=0, lr=[1.918342138626474e-05], mom=[(0.9, 0.999)]
steps: 890 loss: 0.5537 iter time (s): 81.553 samples/sec: 1.570

100%|██████████| 10/10 [13:36<00:00, 82.00s/it][A100%|██████████| 10/10 [13:36<00:00, 81.69s/it]

100%|██████████| 10/10 [13:36<00:00, 81.99s/it][A100%|██████████| 10/10 [13:36<00:00, 81.69s/it]

100%|██████████| 10/10 [13:36<00:00, 82.00s/it][A100%|██████████| 10/10 [13:36<00:00, 81.69s/it]

100%|██████████| 10/10 [13:36<00:00, 82.00s/it][A100%|██████████| 10/10 [13:36<00:00, 81.69s/it]

100%|██████████| 10/10 [13:36<00:00, 81.98s/it][A100%|██████████| 10/10 [13:36<00:00, 81.69s/it]

100%|██████████| 10/10 [13:36<00:00, 81.99s/it][A100%|██████████| 10/10 [13:36<00:00, 81.70s/it]

100%|██████████| 10/10 [13:36<00:00, 82.00s/it][A100%|██████████| 10/10 [13:36<00:00, 81.70s/it]
Checkpointing at shard 90
[2024-05-30 18:26:30,155] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step890 is about to be saved!
[2024-05-30 18:26:32,198] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_00-model_states.pt...
[2024-05-30 18:26:36,692] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_05-model_states.pt...
[2024-05-30 18:26:37,909] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_07-model_states.pt...
[2024-05-30 18:26:38,047] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_06-model_states.pt...
[2024-05-30 18:26:38,160] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_08-model_states.pt...
[2024-05-30 18:26:39,225] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_02-model_states.pt...
[2024-05-30 18:26:39,721] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_00-model_states.pt.
[2024-05-30 18:26:44,342] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_04-model_states.pt...
[2024-05-30 18:26:44,539] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_03-model_states.pt...
[2024-05-30 18:26:48,654] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_01-model_states.pt...
[2024-05-30 18:28:07,953] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_01-model_states.pt.
[2024-05-30 18:28:08,992] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_00_model_states.pt
[2024-05-30 18:28:08,992] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_00_model_states.pt...
[2024-05-30 18:28:09,141] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_08-model_states.pt.
[2024-05-30 18:28:09,562] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_09-model_states.pt...
[2024-05-30 18:28:09,780] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_00_model_states.pt.
[2024-05-30 18:28:09,780] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step890 is ready now!
[2024-05-30 18:28:10,519] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_09-model_states.pt.
[2024-05-30 18:28:10,552] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_07_model_states.pt...
[2024-05-30 18:28:10,670] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_07_model_states.pt.
[2024-05-30 18:28:10,670] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step890 is ready now!
[2024-05-30 18:28:18,345] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_03-model_states.pt.
[2024-05-30 18:28:18,933] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_02_model_states.pt...
[2024-05-30 18:28:19,109] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_02_model_states.pt.
[2024-05-30 18:28:19,109] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step890 is ready now!
[2024-05-30 18:28:26,637] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_04-model_states.pt.
[2024-05-30 18:28:26,705] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_03_model_states.pt...
[2024-05-30 18:28:26,853] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_03_model_states.pt.
[2024-05-30 18:28:26,853] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step890 is ready now!
[2024-05-30 18:28:46,631] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_05-model_states.pt.
[2024-05-30 18:28:46,841] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_04_model_states.pt...
[2024-05-30 18:28:47,049] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_04_model_states.pt.
[2024-05-30 18:28:47,049] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step890 is ready now!
[2024-05-30 18:28:50,700] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_07-model_states.pt.
[2024-05-30 18:28:50,814] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_06-model_states.pt.
[2024-05-30 18:28:50,957] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_06_model_states.pt...
[2024-05-30 18:28:51,075] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_06_model_states.pt.
[2024-05-30 18:28:51,076] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step890 is ready now!
[2024-05-30 18:28:51,268] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_05_model_states.pt...
[2024-05-30 18:28:51,341] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_05_model_states.pt.
[2024-05-30 18:28:51,341] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step890 is ready now!
[2024-05-30 18:28:54,619] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/layer_02-model_states.pt.
[2024-05-30 18:28:54,970] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_01_model_states.pt
[2024-05-30 18:28:54,970] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_01_model_states.pt...
[2024-05-30 18:28:55,072] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step890/mp_rank_01_model_states.pt.
[2024-05-30 18:28:55,072] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step890 is ready now!
Checkpoint saved using --- 144.91924214363098 seconds ---
 17%|█▋        | 90/520 [4:09:58<102:11:13, 855.52s/it] 17%|█▋        | 90/520 [4:10:59<102:11:31, 855.56s/it] 17%|█▋        | 90/520 [4:09:49<102:15:31, 856.12s/it] 17%|█▋        | 90/520 [4:09:58<102:10:29, 855.42s/it] 17%|█▋        | 90/520 [4:10:17<102:10:51, 855.47s/it] 17%|█▋        | 90/520 [4:10:17<102:11:14, 855.52s/it] 17%|█▋        | 90/520 [4:09:57<102:10:26, 855.41s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_26
 17%|█▋        | 90/520 [4:10:01<102:10:34, 855.43s/it]Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A

  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:35<14:17, 95.26s/it][A[2024-05-30 18:30:32,753] [INFO] [logging.py:96:log_dist] [Rank 0] step=891, skipped=0, lr=[1.9181178234627532e-05], mom=[(0.9, 0.999)]
steps: 891 loss: 0.8682 iter time (s): 97.439 samples/sec: 1.314

 10%|█         | 1/10 [01:38<14:43, 98.12s/it][A
 10%|█         | 1/10 [01:38<14:46, 98.45s/it][A
 10%|█         | 1/10 [01:38<14:47, 98.59s/it][A
 10%|█         | 1/10 [01:38<14:47, 98.66s/it][A
 10%|█         | 1/10 [01:38<14:48, 98.70s/it][A
 10%|█         | 1/10 [01:38<14:48, 98.77s/it][A
 10%|█         | 1/10 [01:38<14:49, 98.80s/it][A
 20%|██        | 2/10 [03:11<12:47, 95.98s/it][A[2024-05-30 18:32:09,271] [INFO] [logging.py:96:log_dist] [Rank 0] step=892, skipped=0, lr=[1.9178932137761274e-05], mom=[(0.9, 0.999)]
steps: 892 loss: 0.8235 iter time (s): 95.167 samples/sec: 1.345

 20%|██        | 2/10 [03:14<12:56, 97.01s/it][A
 20%|██        | 2/10 [03:14<12:56, 97.01s/it][A
 20%|██        | 2/10 [03:14<12:56, 97.07s/it][A
 20%|██        | 2/10 [03:14<12:57, 97.14s/it][A
 20%|██        | 2/10 [03:14<12:57, 97.16s/it][A
 20%|██        | 2/10 [03:14<12:57, 97.18s/it][A
 20%|██        | 2/10 [03:14<12:57, 97.19s/it][A
 30%|███       | 3/10 [04:49<11:17, 96.74s/it][A[2024-05-30 18:33:46,883] [INFO] [logging.py:96:log_dist] [Rank 0] step=893, skipped=0, lr=[1.9176683096386558e-05], mom=[(0.9, 0.999)]
steps: 893 loss: 0.8536 iter time (s): 96.719 samples/sec: 1.323

 30%|███       | 3/10 [04:51<11:20, 97.27s/it][A
 30%|███       | 3/10 [04:52<11:21, 97.31s/it][A
 30%|███       | 3/10 [04:52<11:21, 97.31s/it][A
 30%|███       | 3/10 [04:52<11:21, 97.36s/it][A
 30%|███       | 3/10 [04:52<11:21, 97.36s/it][A
 30%|███       | 3/10 [04:52<11:21, 97.37s/it][A
 30%|███       | 3/10 [04:52<11:21, 97.38s/it][A
 40%|████      | 4/10 [06:25<09:39, 96.52s/it][A[2024-05-30 18:35:23,104] [INFO] [logging.py:96:log_dist] [Rank 0] step=894, skipped=0, lr=[1.9174431111224935e-05], mom=[(0.9, 0.999)]
steps: 894 loss: 0.8403 iter time (s): 95.343 samples/sec: 1.343

 40%|████      | 4/10 [06:28<09:41, 96.89s/it][A
 40%|████      | 4/10 [06:28<09:41, 96.89s/it][A
 40%|████      | 4/10 [06:28<09:41, 96.92s/it][A
 40%|████      | 4/10 [06:28<09:41, 96.92s/it][A
 40%|████      | 4/10 [06:28<09:41, 96.92s/it][A
 40%|████      | 4/10 [06:28<09:41, 96.93s/it][A
 40%|████      | 4/10 [06:28<09:41, 96.93s/it][A
 50%|█████     | 5/10 [08:02<08:04, 96.84s/it][A[2024-05-30 18:37:00,497] [INFO] [logging.py:96:log_dist] [Rank 0] step=895, skipped=0, lr=[1.91721761829989e-05], mom=[(0.9, 0.999)]
steps: 895 loss: 0.8296 iter time (s): 96.479 samples/sec: 1.327

 50%|█████     | 5/10 [08:05<08:05, 97.06s/it][A
 50%|█████     | 5/10 [08:05<08:05, 97.06s/it][A
 50%|█████     | 5/10 [08:05<08:05, 97.08s/it][A
 50%|█████     | 5/10 [08:05<08:05, 97.09s/it][A
 50%|█████     | 5/10 [08:05<08:05, 97.08s/it][A
 50%|█████     | 5/10 [08:06<08:05, 97.10s/it][A
 50%|█████     | 5/10 [08:06<08:05, 97.09s/it][A
 60%|██████    | 6/10 [09:40<06:27, 96.99s/it][A[2024-05-30 18:38:37,772] [INFO] [logging.py:96:log_dist] [Rank 0] step=896, skipped=0, lr=[1.9169918312431894e-05], mom=[(0.9, 0.999)]
steps: 896 loss: 0.8435 iter time (s): 96.375 samples/sec: 1.328

 60%|██████    | 6/10 [09:42<06:28, 97.17s/it][A
 60%|██████    | 6/10 [09:43<06:28, 97.21s/it][A
 60%|██████    | 6/10 [09:43<06:28, 97.19s/it][A
 60%|██████    | 6/10 [09:43<06:28, 97.19s/it][A
 60%|██████    | 6/10 [09:43<06:28, 97.23s/it][A
 60%|██████    | 6/10 [09:43<06:29, 97.28s/it][A
 60%|██████    | 6/10 [09:44<06:29, 97.44s/it][A
 70%|███████   | 7/10 [11:18<04:51, 97.28s/it][A[2024-05-30 18:40:15,645] [INFO] [logging.py:96:log_dist] [Rank 0] step=897, skipped=0, lr=[1.9167657500248292e-05], mom=[(0.9, 0.999)]
steps: 897 loss: 0.8378 iter time (s): 96.148 samples/sec: 1.331

 70%|███████   | 7/10 [11:20<04:52, 97.42s/it][A
 70%|███████   | 7/10 [11:21<04:52, 97.41s/it][A
 70%|███████   | 7/10 [11:21<04:52, 97.45s/it][A
 70%|███████   | 7/10 [11:21<04:52, 97.42s/it][A
 70%|███████   | 7/10 [11:21<04:52, 97.43s/it][A
 70%|███████   | 7/10 [11:21<04:52, 97.44s/it][A
 70%|███████   | 7/10 [11:21<04:52, 97.38s/it][A
 80%|████████  | 8/10 [12:56<03:15, 97.53s/it][A[2024-05-30 18:41:53,693] [INFO] [logging.py:96:log_dist] [Rank 0] step=898, skipped=0, lr=[1.9165393747173423e-05], mom=[(0.9, 0.999)]
steps: 898 loss: 0.8218 iter time (s): 96.946 samples/sec: 1.320

 80%|████████  | 8/10 [12:58<03:15, 97.55s/it][A
 80%|████████  | 8/10 [12:58<03:15, 97.52s/it][A
 80%|████████  | 8/10 [12:58<03:15, 97.54s/it][A
 80%|████████  | 8/10 [12:59<03:15, 97.53s/it][A
 80%|████████  | 8/10 [12:59<03:15, 97.54s/it][A
 80%|████████  | 8/10 [12:59<03:15, 97.54s/it][A
 80%|████████  | 8/10 [12:59<03:15, 97.51s/it][A
 90%|█████████ | 9/10 [14:33<01:37, 97.31s/it][A[2024-05-30 18:43:30,538] [INFO] [logging.py:96:log_dist] [Rank 0] step=899, skipped=0, lr=[1.916312705393355e-05], mom=[(0.9, 0.999)]
steps: 899 loss: 0.8327 iter time (s): 96.002 samples/sec: 1.333

 90%|█████████ | 9/10 [14:35<01:37, 97.32s/it][A
 90%|█████████ | 9/10 [14:35<01:37, 97.34s/it][A
 90%|█████████ | 9/10 [14:35<01:37, 97.34s/it][A
 90%|█████████ | 9/10 [14:36<01:37, 97.34s/it][A
 90%|█████████ | 9/10 [14:36<01:37, 97.38s/it][A
 90%|█████████ | 9/10 [14:36<01:37, 97.34s/it][A
 90%|█████████ | 9/10 [14:36<01:37, 97.32s/it][A
100%|██████████| 10/10 [16:10<00:00, 97.23s/it][A100%|██████████| 10/10 [16:10<00:00, 97.01s/it]
 18%|█▊        | 91/520 [4:25:59<105:42:21, 887.04s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 18:45:07,591] [INFO] [logging.py:96:log_dist] [Rank 0] step=900, skipped=0, lr=[1.9160857421255892e-05], mom=[(0.9, 0.999)]
steps: 900 loss: 0.8407 iter time (s): 96.156 samples/sec: 1.331

100%|██████████| 10/10 [16:12<00:00, 97.27s/it][A100%|██████████| 10/10 [16:12<00:00, 97.27s/it]
 18%|█▊        | 91/520 [4:26:11<105:44:18, 887.32s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:12<00:00, 97.26s/it][A100%|██████████| 10/10 [16:12<00:00, 97.28s/it]
 18%|█▊        | 91/520 [4:26:30<105:44:31, 887.35s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:12<00:00, 97.27s/it][A100%|██████████| 10/10 [16:12<00:00, 97.30s/it]
 18%|█▊        | 91/520 [4:27:12<105:45:03, 887.42s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:13<00:00, 97.24s/it][A100%|██████████| 10/10 [16:13<00:00, 97.31s/it]
 18%|█▊        | 91/520 [4:26:14<105:44:34, 887.35s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:13<00:00, 97.28s/it][A100%|██████████| 10/10 [16:13<00:00, 97.31s/it]
 18%|█▊        | 91/520 [4:26:30<105:44:49, 887.39s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:13<00:00, 97.27s/it][A100%|██████████| 10/10 [16:13<00:00, 97.32s/it]
 18%|█▊        | 91/520 [4:26:11<105:44:43, 887.37s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:13<00:00, 97.25s/it][A100%|██████████| 10/10 [16:13<00:00, 97.32s/it]
 18%|█▊        | 91/520 [4:26:11<105:44:42, 887.37s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_77
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:15<11:16, 75.18s/it][A[2024-05-30 18:46:22,349] [INFO] [logging.py:96:log_dist] [Rank 0] step=901, skipped=0, lr=[1.9158584849868596e-05], mom=[(0.9, 0.999)]
steps: 901 loss: 1.0759 iter time (s): 73.656 samples/sec: 1.738

 10%|█         | 1/10 [01:14<11:12, 74.69s/it][A
 10%|█         | 1/10 [01:14<11:11, 74.65s/it][A
 10%|█         | 1/10 [01:14<11:11, 74.62s/it][A
 10%|█         | 1/10 [01:14<11:10, 74.54s/it][A
 10%|█         | 1/10 [01:14<11:11, 74.65s/it][A
 10%|█         | 1/10 [01:14<11:10, 74.55s/it][A
 10%|█         | 1/10 [01:14<11:11, 74.56s/it][A
 20%|██        | 2/10 [02:29<09:58, 74.81s/it][A[2024-05-30 18:47:36,916] [INFO] [logging.py:96:log_dist] [Rank 0] step=902, skipped=0, lr=[1.9156309340500763e-05], mom=[(0.9, 0.999)]
steps: 902 loss: 1.0768 iter time (s): 73.815 samples/sec: 1.734

 20%|██        | 2/10 [02:29<09:56, 74.57s/it][A
 20%|██        | 2/10 [02:29<09:57, 74.64s/it][A
 20%|██        | 2/10 [02:29<09:56, 74.57s/it][A
 20%|██        | 2/10 [02:29<09:56, 74.59s/it][A
 20%|██        | 2/10 [02:29<09:57, 74.64s/it][A
 20%|██        | 2/10 [02:29<09:57, 74.74s/it][A
 20%|██        | 2/10 [02:29<09:58, 74.75s/it][A
 30%|███       | 3/10 [03:45<08:46, 75.22s/it][A[2024-05-30 18:48:52,609] [INFO] [logging.py:96:log_dist] [Rank 0] step=903, skipped=0, lr=[1.9154030893882433e-05], mom=[(0.9, 0.999)]
steps: 903 loss: 1.0704 iter time (s): 74.631 samples/sec: 1.715

 30%|███       | 3/10 [03:44<08:45, 75.07s/it][A
 30%|███       | 3/10 [03:44<08:45, 75.07s/it][A
 30%|███       | 3/10 [03:44<08:45, 75.09s/it][A
 30%|███       | 3/10 [03:44<08:45, 75.06s/it][A
 30%|███       | 3/10 [03:44<08:45, 75.08s/it][A
 30%|███       | 3/10 [03:44<08:45, 75.03s/it][A
 30%|███       | 3/10 [03:44<08:45, 75.03s/it][A
 40%|████      | 4/10 [04:59<07:27, 74.62s/it][A[2024-05-30 18:50:06,313] [INFO] [logging.py:96:log_dist] [Rank 0] step=904, skipped=0, lr=[1.9151749510744583e-05], mom=[(0.9, 0.999)]
steps: 904 loss: 1.0902 iter time (s): 72.972 samples/sec: 1.754

 40%|████      | 4/10 [04:58<07:27, 74.56s/it][A
 40%|████      | 4/10 [04:58<07:27, 74.54s/it][A
 40%|████      | 4/10 [04:58<07:27, 74.53s/it][A
 40%|████      | 4/10 [04:58<07:27, 74.52s/it][A
 40%|████      | 4/10 [04:58<07:27, 74.55s/it][A
 40%|████      | 4/10 [04:58<07:27, 74.51s/it][A
 40%|████      | 4/10 [04:58<07:27, 74.51s/it][A
 50%|█████     | 5/10 [06:12<06:11, 74.29s/it][A[2024-05-30 18:51:20,022] [INFO] [logging.py:96:log_dist] [Rank 0] step=905, skipped=0, lr=[1.9149465191819147e-05], mom=[(0.9, 0.999)]
steps: 905 loss: 1.0690 iter time (s): 72.960 samples/sec: 1.754

 50%|█████     | 5/10 [06:12<06:11, 74.20s/it][A
 50%|█████     | 5/10 [06:12<06:11, 74.26s/it][A
 50%|█████     | 5/10 [06:12<06:11, 74.25s/it][A
 50%|█████     | 5/10 [06:12<06:11, 74.22s/it][A
 50%|█████     | 5/10 [06:12<06:11, 74.24s/it][A
 50%|█████     | 5/10 [06:12<06:11, 74.22s/it][A
 50%|█████     | 5/10 [06:12<06:11, 74.22s/it][A
 60%|██████    | 6/10 [07:27<04:57, 74.48s/it][A[2024-05-30 18:52:34,872] [INFO] [logging.py:96:log_dist] [Rank 0] step=906, skipped=0, lr=[1.9147177937838985e-05], mom=[(0.9, 0.999)]
steps: 906 loss: 1.0567 iter time (s): 74.101 samples/sec: 1.727

 60%|██████    | 6/10 [07:27<04:57, 74.46s/it][A
 60%|██████    | 6/10 [07:27<04:57, 74.45s/it][A
 60%|██████    | 6/10 [07:27<04:57, 74.45s/it][A
 60%|██████    | 6/10 [07:27<04:57, 74.45s/it][A
 60%|██████    | 6/10 [07:27<04:57, 74.43s/it][A
 60%|██████    | 6/10 [07:27<04:57, 74.46s/it][A
 60%|██████    | 6/10 [07:27<04:57, 74.44s/it][A
 70%|███████   | 7/10 [08:42<03:43, 74.46s/it][A[2024-05-30 18:53:49,313] [INFO] [logging.py:96:log_dist] [Rank 0] step=907, skipped=0, lr=[1.9144887749537905e-05], mom=[(0.9, 0.999)]
steps: 907 loss: 1.0811 iter time (s): 73.674 samples/sec: 1.737

 70%|███████   | 7/10 [08:41<03:43, 74.43s/it][A
 70%|███████   | 7/10 [08:41<03:43, 74.44s/it][A
 70%|███████   | 7/10 [08:41<03:43, 74.45s/it][A
 70%|███████   | 7/10 [08:41<03:43, 74.43s/it][A
 70%|███████   | 7/10 [08:41<03:43, 74.45s/it][A
 70%|███████   | 7/10 [08:41<03:43, 74.44s/it][A
 70%|███████   | 7/10 [08:41<03:43, 74.43s/it][A
 80%|████████  | 8/10 [09:55<02:28, 74.03s/it][A[2024-05-30 18:55:02,403] [INFO] [logging.py:96:log_dist] [Rank 0] step=908, skipped=0, lr=[1.9142594627650657e-05], mom=[(0.9, 0.999)]
steps: 908 loss: 1.0786 iter time (s): 72.346 samples/sec: 1.769

 80%|████████  | 8/10 [09:54<02:28, 74.03s/it][A
 80%|████████  | 8/10 [09:54<02:28, 74.02s/it][A
 80%|████████  | 8/10 [09:54<02:28, 74.01s/it][A
 80%|████████  | 8/10 [09:54<02:28, 74.01s/it][A
 80%|████████  | 8/10 [09:54<02:28, 74.02s/it][A
 80%|████████  | 8/10 [09:54<02:28, 74.01s/it][A
 80%|████████  | 8/10 [09:54<02:28, 74.01s/it][A
 90%|█████████ | 9/10 [11:07<01:13, 73.47s/it][A[2024-05-30 18:56:14,632] [INFO] [logging.py:96:log_dist] [Rank 0] step=909, skipped=0, lr=[1.914029857291293e-05], mom=[(0.9, 0.999)]
steps: 909 loss: 1.0559 iter time (s): 71.467 samples/sec: 1.791

 90%|█████████ | 9/10 [11:06<01:13, 73.46s/it][A
 90%|█████████ | 9/10 [11:06<01:13, 73.46s/it][A
 90%|█████████ | 9/10 [11:06<01:13, 73.44s/it][A
 90%|█████████ | 9/10 [11:06<01:13, 73.46s/it][A
 90%|█████████ | 9/10 [11:06<01:13, 73.45s/it][A
 90%|█████████ | 9/10 [11:06<01:13, 73.45s/it][A
 90%|█████████ | 9/10 [11:06<01:13, 73.45s/it][A
100%|██████████| 10/10 [12:19<00:00, 73.07s/it][A100%|██████████| 10/10 [12:19<00:00, 73.96s/it]
 18%|█▊        | 92/520 [4:38:19<100:34:41, 845.99s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 18:57:26,798] [INFO] [logging.py:96:log_dist] [Rank 0] step=910, skipped=0, lr=[1.9137999586061364e-05], mom=[(0.9, 0.999)]
steps: 910 loss: 1.0677 iter time (s): 71.416 samples/sec: 1.792

100%|██████████| 10/10 [12:19<00:00, 73.05s/it][A100%|██████████| 10/10 [12:19<00:00, 73.91s/it]
 18%|█▊        | 92/520 [4:38:31<100:34:35, 845.97s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:19<00:00, 73.04s/it][A100%|██████████| 10/10 [12:19<00:00, 73.90s/it]
 18%|█▊        | 92/520 [4:38:49<100:34:40, 845.98s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:19<00:00, 73.07s/it][A100%|██████████| 10/10 [12:19<00:00, 73.91s/it]
 18%|█▊        | 92/520 [4:39:31<100:35:08, 846.05s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:18<00:00, 73.05s/it][A100%|██████████| 10/10 [12:18<00:00, 73.90s/it]
 18%|█▊        | 92/520 [4:38:49<100:34:47, 846.00s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:19<00:00, 73.06s/it][A100%|██████████| 10/10 [12:19<00:00, 73.91s/it]
 18%|█▊        | 92/520 [4:38:33<100:34:47, 846.00s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:18<00:00, 73.05s/it][A100%|██████████| 10/10 [12:18<00:00, 73.90s/it]
 18%|█▊        | 92/520 [4:38:30<100:34:44, 845.99s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:19<00:00, 73.06s/it][A100%|██████████| 10/10 [12:19<00:00, 73.90s/it]
 18%|█▊        | 92/520 [4:38:30<100:34:46, 846.00s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_467
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:01<09:13, 61.53s/it][A[2024-05-30 18:58:28,131] [INFO] [logging.py:96:log_dist] [Rank 0] step=911, skipped=0, lr=[1.9135697667833517e-05], mom=[(0.9, 0.999)]
steps: 911 loss: 0.2994 iter time (s): 60.446 samples/sec: 2.118

 10%|█         | 1/10 [01:01<09:11, 61.29s/it][A
 10%|█         | 1/10 [01:01<09:11, 61.31s/it][A
 10%|█         | 1/10 [01:01<09:10, 61.21s/it][A
 10%|█         | 1/10 [01:01<09:11, 61.23s/it][A
 10%|█         | 1/10 [01:01<09:11, 61.23s/it][A
 10%|█         | 1/10 [01:01<09:11, 61.24s/it][A
 10%|█         | 1/10 [01:01<09:10, 61.22s/it][A
 20%|██        | 2/10 [02:01<08:06, 60.86s/it][A[2024-05-30 18:59:28,511] [INFO] [logging.py:96:log_dist] [Rank 0] step=912, skipped=0, lr=[1.913339281896791e-05], mom=[(0.9, 0.999)]
steps: 912 loss: 0.3107 iter time (s): 59.722 samples/sec: 2.143

 20%|██        | 2/10 [02:01<08:05, 60.73s/it][A
 20%|██        | 2/10 [02:01<08:06, 60.77s/it][A
 20%|██        | 2/10 [02:01<08:05, 60.70s/it][A
 20%|██        | 2/10 [02:01<08:05, 60.72s/it][A
 20%|██        | 2/10 [02:01<08:05, 60.71s/it][A
 20%|██        | 2/10 [02:01<08:05, 60.72s/it][A
 20%|██        | 2/10 [02:01<08:05, 60.71s/it][A
 30%|███       | 3/10 [03:01<07:01, 60.19s/it][A[2024-05-30 19:00:27,900] [INFO] [logging.py:96:log_dist] [Rank 0] step=913, skipped=0, lr=[1.9131085040203995e-05], mom=[(0.9, 0.999)]
steps: 913 loss: 0.3225 iter time (s): 58.758 samples/sec: 2.178

 30%|███       | 3/10 [03:01<07:00, 60.13s/it][A
 30%|███       | 3/10 [03:01<07:00, 60.14s/it][A
 30%|███       | 3/10 [03:01<07:00, 60.13s/it][A
 30%|███       | 3/10 [03:00<07:00, 60.11s/it][A
 30%|███       | 3/10 [03:00<07:00, 60.11s/it][A
 30%|███       | 3/10 [03:00<07:00, 60.12s/it][A
 30%|███       | 3/10 [03:00<07:00, 60.10s/it][A
 40%|████      | 4/10 [04:01<05:59, 60.00s/it][A[2024-05-30 19:01:27,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=914, skipped=0, lr=[1.9128774332282163e-05], mom=[(0.9, 0.999)]
steps: 914 loss: 0.3033 iter time (s): 59.064 samples/sec: 2.167

 40%|████      | 4/10 [04:00<05:59, 59.96s/it][A
 40%|████      | 4/10 [04:00<05:59, 59.96s/it][A
 40%|████      | 4/10 [04:00<05:59, 59.95s/it][A
 40%|████      | 4/10 [04:00<05:59, 59.96s/it][A
 40%|████      | 4/10 [04:00<05:59, 59.96s/it][A
 40%|████      | 4/10 [04:00<05:59, 59.96s/it][A
 40%|████      | 4/10 [04:00<05:59, 59.96s/it][A
 50%|█████     | 5/10 [05:00<04:58, 59.67s/it][A[2024-05-30 19:02:26,703] [INFO] [logging.py:96:log_dist] [Rank 0] step=915, skipped=0, lr=[1.9126460695943748e-05], mom=[(0.9, 0.999)]
steps: 915 loss: 0.2753 iter time (s): 58.443 samples/sec: 2.190

 50%|█████     | 5/10 [04:59<04:58, 59.66s/it][A
 50%|█████     | 5/10 [04:59<04:58, 59.64s/it][A
 50%|█████     | 5/10 [04:59<04:58, 59.64s/it][A
 50%|█████     | 5/10 [04:59<04:58, 59.68s/it][A

 50%|█████     | 5/10 [04:59<04:58, 59.65s/it][A 50%|█████     | 5/10 [04:59<04:58, 59.64s/it][A
 50%|█████     | 5/10 [04:59<04:58, 59.65s/it][A
 60%|██████    | 6/10 [06:00<03:59, 59.90s/it][A[2024-05-30 19:03:27,042] [INFO] [logging.py:96:log_dist] [Rank 0] step=916, skipped=0, lr=[1.912414413193102e-05], mom=[(0.9, 0.999)]
steps: 916 loss: 0.2749 iter time (s): 59.691 samples/sec: 2.144

 60%|██████    | 6/10 [06:00<03:59, 59.87s/it][A
 60%|██████    | 6/10 [06:00<03:59, 59.89s/it][A
 60%|██████    | 6/10 [06:00<03:59, 59.88s/it][A
 60%|██████    | 6/10 [06:00<03:59, 59.88s/it][A
 60%|██████    | 6/10 [06:00<03:59, 59.89s/it][A
 60%|██████    | 6/10 [06:00<03:59, 59.89s/it][A
 60%|██████    | 6/10 [06:00<03:59, 59.89s/it][A
 70%|███████   | 7/10 [07:00<02:59, 59.89s/it][A[2024-05-30 19:04:26,903] [INFO] [logging.py:96:log_dist] [Rank 0] step=917, skipped=0, lr=[1.912182464098719e-05], mom=[(0.9, 0.999)]
steps: 917 loss: 0.2810 iter time (s): 59.187 samples/sec: 2.163

 70%|███████   | 7/10 [07:00<02:59, 59.89s/it][A
 70%|███████   | 7/10 [07:00<02:59, 59.88s/it][A
 70%|███████   | 7/10 [07:00<02:59, 59.88s/it][A
 70%|███████   | 7/10 [06:59<02:59, 59.87s/it][A
 70%|███████   | 7/10 [06:59<02:59, 59.87s/it][A
 70%|███████   | 7/10 [07:00<02:59, 59.88s/it][A
 70%|███████   | 7/10 [06:59<02:59, 59.87s/it][A
 80%|████████  | 8/10 [07:59<01:59, 59.76s/it][A[2024-05-30 19:05:26,405] [INFO] [logging.py:96:log_dist] [Rank 0] step=918, skipped=0, lr=[1.9119502223856413e-05], mom=[(0.9, 0.999)]
steps: 918 loss: 0.2794 iter time (s): 58.847 samples/sec: 2.175

 80%|████████  | 8/10 [07:59<01:59, 59.75s/it][A
 80%|████████  | 8/10 [07:59<01:59, 59.79s/it][A
 80%|████████  | 8/10 [07:59<01:59, 59.76s/it][A
 80%|████████  | 8/10 [07:59<01:59, 59.76s/it][A
 80%|████████  | 8/10 [07:59<01:59, 59.76s/it][A
 80%|████████  | 8/10 [07:59<01:59, 59.76s/it][A
 80%|████████  | 8/10 [07:59<01:59, 59.75s/it][A
 90%|█████████ | 9/10 [08:59<00:59, 59.76s/it][A[2024-05-30 19:06:26,148] [INFO] [logging.py:96:log_dist] [Rank 0] step=919, skipped=0, lr=[1.9117176881283776e-05], mom=[(0.9, 0.999)]
steps: 919 loss: 0.2924 iter time (s): 59.091 samples/sec: 2.166

 90%|█████████ | 9/10 [08:59<00:59, 59.74s/it][A
 90%|█████████ | 9/10 [08:59<00:59, 59.73s/it][A
 90%|█████████ | 9/10 [08:59<00:59, 59.74s/it][A
 90%|█████████ | 9/10 [08:59<00:59, 59.74s/it][A
 90%|█████████ | 9/10 [08:59<00:59, 59.74s/it][A
 90%|█████████ | 9/10 [08:59<00:59, 59.74s/it][A
 90%|█████████ | 9/10 [08:59<00:59, 59.74s/it][A
100%|██████████| 10/10 [09:59<00:00, 59.71s/it][A100%|██████████| 10/10 [09:59<00:00, 59.91s/it]
 18%|█▊        | 93/520 [4:48:18<92:00:21, 775.69s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 19:07:25,732] [INFO] [logging.py:96:log_dist] [Rank 0] step=920, skipped=0, lr=[1.911484861401531e-05], mom=[(0.9, 0.999)]
steps: 920 loss: 0.2927 iter time (s): 58.963 samples/sec: 2.171

100%|██████████| 10/10 [09:58<00:00, 59.70s/it][A100%|██████████| 10/10 [09:58<00:00, 59.89s/it]
 18%|█▊        | 93/520 [4:48:29<91:59:32, 775.58s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:58<00:00, 59.70s/it][A100%|██████████| 10/10 [09:58<00:00, 59.89s/it]
 18%|█▊        | 93/520 [4:48:48<91:59:36, 775.59s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:58<00:00, 59.71s/it][A100%|██████████| 10/10 [09:58<00:00, 59.88s/it]
 18%|█▊        | 93/520 [4:49:30<91:59:48, 775.62s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:58<00:00, 59.70s/it][A100%|██████████| 10/10 [09:58<00:00, 59.89s/it]
 18%|█▊        | 93/520 [4:48:48<91:59:34, 775.59s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:58<00:00, 59.71s/it][A100%|██████████| 10/10 [09:58<00:00, 59.88s/it]
 18%|█▊        | 93/520 [4:48:29<91:59:31, 775.58s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:58<00:00, 59.72s/it][A100%|██████████| 10/10 [09:58<00:00, 59.89s/it]
 18%|█▊        | 93/520 [4:48:32<91:59:39, 775.60s/it] 
100%|██████████| 10/10 [09:58<00:00, 59.71s/it][A100%|██████████| 10/10 [09:58<00:00, 59.88s/it]
 18%|█▊        | 93/520 [4:48:29<91:59:30, 775.58s/it] Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_313

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:21<12:09, 81.06s/it][A[2024-05-30 19:08:47,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=921, skipped=0, lr=[1.9112517422797966e-05], mom=[(0.9, 0.999)]
steps: 921 loss: 0.5896 iter time (s): 81.025 samples/sec: 1.580

 10%|█         | 1/10 [01:21<12:16, 81.87s/it][A
 10%|█         | 1/10 [01:21<12:17, 81.89s/it][A
 10%|█         | 1/10 [01:21<12:16, 81.83s/it][A
 10%|█         | 1/10 [01:21<12:17, 81.91s/it][A
 10%|█         | 1/10 [01:21<12:17, 81.89s/it][A
 10%|█         | 1/10 [01:21<12:17, 81.94s/it][A
 10%|█         | 1/10 [01:21<12:17, 81.96s/it][A
 20%|██        | 2/10 [02:41<10:45, 80.63s/it][A[2024-05-30 19:10:07,869] [INFO] [logging.py:96:log_dist] [Rank 0] step=922, skipped=0, lr=[1.9110183308379663e-05], mom=[(0.9, 0.999)]
steps: 922 loss: 0.5901 iter time (s): 79.524 samples/sec: 1.610

 20%|██        | 2/10 [02:42<10:47, 80.92s/it][A
 20%|██        | 2/10 [02:42<10:47, 80.99s/it][A
 20%|██        | 2/10 [02:42<10:47, 80.95s/it][A
 20%|██        | 2/10 [02:42<10:47, 80.98s/it][A
 20%|██        | 2/10 [02:42<10:47, 80.96s/it][A
 20%|██        | 2/10 [02:42<10:47, 80.99s/it][A
 20%|██        | 2/10 [02:42<10:47, 80.99s/it][A
 30%|███       | 3/10 [04:02<09:25, 80.76s/it][A[2024-05-30 19:11:28,762] [INFO] [logging.py:96:log_dist] [Rank 0] step=923, skipped=0, lr=[1.910784627150924e-05], mom=[(0.9, 0.999)]
steps: 923 loss: 0.5866 iter time (s): 80.084 samples/sec: 1.598

 30%|███       | 3/10 [04:03<09:26, 80.92s/it][A
 30%|███       | 3/10 [04:03<09:26, 80.96s/it][A
 30%|███       | 3/10 [04:03<09:26, 80.95s/it][A
 30%|███       | 3/10 [04:03<09:26, 80.94s/it][A
 30%|███       | 3/10 [04:03<09:26, 80.97s/it][A
 30%|███       | 3/10 [04:03<09:26, 80.97s/it][A
 30%|███       | 3/10 [04:03<09:26, 80.97s/it][A
 40%|████      | 4/10 [05:22<08:04, 80.70s/it][A[2024-05-30 19:12:49,390] [INFO] [logging.py:96:log_dist] [Rank 0] step=924, skipped=0, lr=[1.9105506312936473e-05], mom=[(0.9, 0.999)]
steps: 924 loss: 0.5811 iter time (s): 79.781 samples/sec: 1.604

 40%|████      | 4/10 [05:23<08:04, 80.81s/it][A
 40%|████      | 4/10 [05:23<08:04, 80.82s/it][A
 40%|████      | 4/10 [05:23<08:04, 80.83s/it][A
 40%|████      | 4/10 [05:23<08:04, 80.82s/it][A
 40%|████      | 4/10 [05:23<08:04, 80.82s/it][A
 40%|████      | 4/10 [05:23<08:04, 80.82s/it][A
 40%|████      | 4/10 [05:23<08:04, 80.82s/it][A
 50%|█████     | 5/10 [06:45<06:46, 81.20s/it][A[2024-05-30 19:14:11,478] [INFO] [logging.py:96:log_dist] [Rank 0] step=925, skipped=0, lr=[1.910316343341208e-05], mom=[(0.9, 0.999)]
steps: 925 loss: 0.5780 iter time (s): 81.286 samples/sec: 1.575

 50%|█████     | 5/10 [06:45<06:46, 81.28s/it][A
 50%|█████     | 5/10 [06:45<06:46, 81.27s/it][A
 50%|█████     | 5/10 [06:45<06:46, 81.30s/it][A
 50%|█████     | 5/10 [06:45<06:46, 81.30s/it][A
 50%|█████     | 5/10 [06:45<06:46, 81.29s/it][A
 50%|█████     | 5/10 [06:45<06:46, 81.29s/it][A
 50%|█████     | 5/10 [06:45<06:46, 81.29s/it][A
 60%|██████    | 6/10 [08:05<05:24, 81.12s/it][A[2024-05-30 19:15:32,438] [INFO] [logging.py:96:log_dist] [Rank 0] step=926, skipped=0, lr=[1.9100817633687715e-05], mom=[(0.9, 0.999)]
steps: 926 loss: 0.5710 iter time (s): 80.106 samples/sec: 1.598

 60%|██████    | 6/10 [08:06<05:24, 81.17s/it][A
 60%|██████    | 6/10 [08:06<05:24, 81.17s/it][A
 60%|██████    | 6/10 [08:06<05:24, 81.16s/it][A
 60%|██████    | 6/10 [08:06<05:24, 81.18s/it][A
 60%|██████    | 6/10 [08:06<05:24, 81.17s/it][A
 60%|██████    | 6/10 [08:06<05:24, 81.17s/it][A
 60%|██████    | 6/10 [08:06<05:24, 81.17s/it][A
 70%|███████   | 7/10 [09:27<04:03, 81.09s/it][A[2024-05-30 19:16:53,473] [INFO] [logging.py:96:log_dist] [Rank 0] step=927, skipped=0, lr=[1.909846891451597e-05], mom=[(0.9, 0.999)]
steps: 927 loss: 0.5825 iter time (s): 80.197 samples/sec: 1.596

 70%|███████   | 7/10 [09:27<04:03, 81.13s/it][A
 70%|███████   | 7/10 [09:27<04:03, 81.13s/it][A
 70%|███████   | 7/10 [09:27<04:03, 81.10s/it][A
 70%|███████   | 7/10 [09:27<04:03, 81.12s/it][A
 70%|███████   | 7/10 [09:27<04:03, 81.12s/it][A
 70%|███████   | 7/10 [09:27<04:03, 81.12s/it][A
 70%|███████   | 7/10 [09:27<04:03, 81.12s/it][A
 80%|████████  | 8/10 [10:48<02:42, 81.36s/it][A[2024-05-30 19:18:15,403] [INFO] [logging.py:96:log_dist] [Rank 0] step=928, skipped=0, lr=[1.9096117276650374e-05], mom=[(0.9, 0.999)]
steps: 928 loss: 0.5850 iter time (s): 81.124 samples/sec: 1.578

 80%|████████  | 8/10 [10:49<02:42, 81.39s/it][A
 80%|████████  | 8/10 [10:49<02:42, 81.38s/it][A
 80%|████████  | 8/10 [10:49<02:42, 81.38s/it][A
 80%|████████  | 8/10 [10:49<02:42, 81.37s/it][A
 80%|████████  | 8/10 [10:49<02:42, 81.38s/it][A
 80%|████████  | 8/10 [10:49<02:42, 81.39s/it][A
 80%|████████  | 8/10 [10:49<02:42, 81.38s/it][A
 90%|█████████ | 9/10 [12:10<01:21, 81.36s/it][A[2024-05-30 19:19:36,758] [INFO] [logging.py:96:log_dist] [Rank 0] step=929, skipped=0, lr=[1.9093762720845387e-05], mom=[(0.9, 0.999)]
steps: 929 loss: 0.5732 iter time (s): 80.520 samples/sec: 1.590

 90%|█████████ | 9/10 [12:11<01:21, 81.36s/it][A
 90%|█████████ | 9/10 [12:11<01:21, 81.40s/it][A
 90%|█████████ | 9/10 [12:11<01:21, 81.40s/it][A
 90%|█████████ | 9/10 [12:11<01:21, 81.37s/it][A
 90%|█████████ | 9/10 [12:11<01:21, 81.41s/it][A
 90%|█████████ | 9/10 [12:11<01:21, 81.49s/it][A
 90%|█████████ | 9/10 [12:12<01:21, 81.73s/it][A
100%|██████████| 10/10 [13:33<00:00, 81.81s/it][A100%|██████████| 10/10 [13:33<00:00, 81.31s/it]
 18%|█▊        | 94/520 [5:01:51<93:04:37, 786.57s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 19:20:59,518] [INFO] [logging.py:96:log_dist] [Rank 0] step=930, skipped=0, lr=[1.9091405247856408e-05], mom=[(0.9, 0.999)]
steps: 930 loss: 0.5773 iter time (s): 80.782 samples/sec: 1.585

100%|██████████| 10/10 [13:33<00:00, 81.78s/it][A100%|██████████| 10/10 [13:33<00:00, 81.38s/it]
 18%|█▊        | 94/520 [5:02:03<93:05:03, 786.63s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:33<00:00, 81.80s/it][A100%|██████████| 10/10 [13:33<00:00, 81.39s/it]
 18%|█▊        | 94/520 [5:02:22<93:05:24, 786.68s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:33<00:00, 81.78s/it][A100%|██████████| 10/10 [13:33<00:00, 81.38s/it]
 18%|█▊        | 94/520 [5:03:04<93:05:21, 786.67s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:33<00:00, 81.80s/it][A100%|██████████| 10/10 [13:33<00:00, 81.39s/it]
 18%|█▊        | 94/520 [5:02:22<93:05:23, 786.68s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:33<00:00, 81.79s/it][A100%|██████████| 10/10 [13:33<00:00, 81.39s/it]
 18%|█▊        | 94/520 [5:02:06<93:05:22, 786.67s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:33<00:00, 81.76s/it][A100%|██████████| 10/10 [13:33<00:00, 81.39s/it]
 18%|█▊        | 94/520 [5:02:03<93:05:23, 786.67s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:33<00:00, 81.69s/it][A100%|██████████| 10/10 [13:33<00:00, 81.39s/it]
 18%|█▊        | 94/520 [5:02:03<93:05:23, 786.68s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_199
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [00:57<08:40, 57.79s/it][A[2024-05-30 19:21:56,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=931, skipped=0, lr=[1.9089044858439777e-05], mom=[(0.9, 0.999)]
steps: 931 loss: 0.7342 iter time (s): 56.410 samples/sec: 2.269

 10%|█         | 1/10 [00:57<08:36, 57.36s/it][A
 10%|█         | 1/10 [00:57<08:34, 57.17s/it][A
 10%|█         | 1/10 [00:57<08:34, 57.16s/it][A
 10%|█         | 1/10 [00:57<08:34, 57.19s/it][A
 10%|█         | 1/10 [00:57<08:34, 57.14s/it][A
 10%|█         | 1/10 [00:57<08:34, 57.12s/it][A
 10%|█         | 1/10 [00:57<08:34, 57.11s/it][A
 20%|██        | 2/10 [01:55<07:43, 57.95s/it][A[2024-05-30 19:22:54,915] [INFO] [logging.py:96:log_dist] [Rank 0] step=932, skipped=0, lr=[1.9086681553352766e-05], mom=[(0.9, 0.999)]
steps: 932 loss: 0.7676 iter time (s): 57.449 samples/sec: 2.228

 20%|██        | 2/10 [01:55<07:41, 57.74s/it][A
 20%|██        | 2/10 [01:55<07:41, 57.70s/it][A
 20%|██        | 2/10 [01:55<07:41, 57.74s/it][A
 20%|██        | 2/10 [01:55<07:41, 57.72s/it][A
 20%|██        | 2/10 [01:55<07:41, 57.70s/it][A
 20%|██        | 2/10 [01:55<07:41, 57.69s/it][A
 20%|██        | 2/10 [01:55<07:41, 57.68s/it][A
 30%|███       | 3/10 [02:54<06:46, 58.12s/it][A[2024-05-30 19:23:53,237] [INFO] [logging.py:96:log_dist] [Rank 0] step=933, skipped=0, lr=[1.9084315333353578e-05], mom=[(0.9, 0.999)]
steps: 933 loss: 0.6338 iter time (s): 57.692 samples/sec: 2.219

 30%|███       | 3/10 [02:53<06:45, 57.98s/it][A
 30%|███       | 3/10 [02:53<06:46, 58.06s/it][A
 30%|███       | 3/10 [02:53<06:46, 58.01s/it][A
 30%|███       | 3/10 [02:53<06:45, 57.97s/it][A
 30%|███       | 3/10 [02:53<06:45, 57.98s/it][A
 30%|███       | 3/10 [02:53<06:45, 57.98s/it][A
 30%|███       | 3/10 [02:53<06:45, 57.97s/it][A
 40%|████      | 4/10 [03:53<05:51, 58.63s/it][A[2024-05-30 19:24:52,637] [INFO] [logging.py:96:log_dist] [Rank 0] step=934, skipped=0, lr=[1.9081946199201356e-05], mom=[(0.9, 0.999)]
steps: 934 loss: 0.6383 iter time (s): 58.774 samples/sec: 2.178

 40%|████      | 4/10 [03:53<05:51, 58.55s/it][A
 40%|████      | 4/10 [03:52<05:51, 58.54s/it][A
 40%|████      | 4/10 [03:53<05:51, 58.57s/it][A
 40%|████      | 4/10 [03:52<05:51, 58.55s/it][A
 40%|████      | 4/10 [03:52<05:51, 58.54s/it][A
 40%|████      | 4/10 [03:52<05:51, 58.55s/it][A
 40%|████      | 4/10 [03:52<05:51, 58.54s/it][A
 50%|█████     | 5/10 [04:50<04:50, 58.16s/it][A[2024-05-30 19:25:49,984] [INFO] [logging.py:96:log_dist] [Rank 0] step=935, skipped=0, lr=[1.907957415165618e-05], mom=[(0.9, 0.999)]
steps: 935 loss: 0.6489 iter time (s): 56.771 samples/sec: 2.255

 50%|█████     | 5/10 [04:50<04:50, 58.13s/it][A
 50%|█████     | 5/10 [04:50<04:50, 58.15s/it][A
 50%|█████     | 5/10 [04:50<04:50, 58.15s/it][A
 50%|█████     | 5/10 [04:50<04:50, 58.12s/it][A
 50%|█████     | 5/10 [04:50<04:50, 58.13s/it][A
 50%|█████     | 5/10 [04:50<04:50, 58.13s/it][A
 50%|█████     | 5/10 [04:50<04:50, 58.13s/it][A
 60%|██████    | 6/10 [05:47<03:50, 57.53s/it][A[2024-05-30 19:26:46,291] [INFO] [logging.py:96:log_dist] [Rank 0] step=936, skipped=0, lr=[1.9077199191479057e-05], mom=[(0.9, 0.999)]
steps: 936 loss: 0.6602 iter time (s): 55.608 samples/sec: 2.302

 60%|██████    | 6/10 [05:46<03:49, 57.50s/it][A
 60%|██████    | 6/10 [05:46<03:49, 57.49s/it][A
 60%|██████    | 6/10 [05:46<03:49, 57.49s/it][A
 60%|██████    | 6/10 [05:46<03:49, 57.49s/it][A
 60%|██████    | 6/10 [05:46<03:49, 57.49s/it][A
 60%|██████    | 6/10 [05:46<03:49, 57.49s/it][A
 60%|██████    | 6/10 [05:46<03:49, 57.48s/it][A
 70%|███████   | 7/10 [06:42<02:50, 56.92s/it][A[2024-05-30 19:27:41,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=937, skipped=0, lr=[1.9074821319431937e-05], mom=[(0.9, 0.999)]
steps: 937 loss: 0.6135 iter time (s): 55.008 samples/sec: 2.327

 70%|███████   | 7/10 [06:42<02:50, 56.90s/it][A
 70%|███████   | 7/10 [06:42<02:50, 56.87s/it][A
 70%|███████   | 7/10 [06:42<02:50, 56.88s/it][A
 70%|███████   | 7/10 [06:42<02:50, 56.88s/it][A
 70%|███████   | 7/10 [06:42<02:50, 56.88s/it][A
 70%|███████   | 7/10 [06:42<02:50, 56.88s/it][A
 70%|███████   | 7/10 [06:42<02:50, 56.88s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.51s/it][A[2024-05-30 19:28:40,698] [INFO] [logging.py:96:log_dist] [Rank 0] step=938, skipped=0, lr=[1.9072440536277697e-05], mom=[(0.9, 0.999)]
steps: 938 loss: 0.5763 iter time (s): 58.158 samples/sec: 2.201

 80%|████████  | 8/10 [07:41<01:55, 57.51s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.54s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.54s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.55s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.53s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.54s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.54s/it][A
 90%|█████████ | 9/10 [08:38<00:57, 57.20s/it][A[2024-05-30 19:29:37,229] [INFO] [logging.py:96:log_dist] [Rank 0] step=939, skipped=0, lr=[1.907005684278016e-05], mom=[(0.9, 0.999)]
steps: 939 loss: 0.5844 iter time (s): 55.733 samples/sec: 2.297

 90%|█████████ | 9/10 [08:37<00:57, 57.16s/it][A
 90%|█████████ | 9/10 [08:37<00:57, 57.17s/it][A
 90%|█████████ | 9/10 [08:37<00:57, 57.17s/it][A
 90%|█████████ | 9/10 [08:37<00:57, 57.16s/it][A
 90%|█████████ | 9/10 [08:37<00:57, 57.17s/it][A
 90%|█████████ | 9/10 [08:38<00:57, 57.37s/it][A
 90%|█████████ | 9/10 [08:38<00:57, 57.50s/it][A
100%|██████████| 10/10 [09:36<00:00, 57.58s/it][A100%|██████████| 10/10 [09:36<00:00, 57.66s/it]
[2024-05-30 19:30:35,667] [INFO] [logging.py:96:log_dist] [Rank 0] step=940, skipped=0, lr=[1.906767023970406e-05], mom=[(0.9, 0.999)]
steps: 940 loss: 0.5821 iter time (s): 56.751 samples/sec: 2.255

100%|██████████| 10/10 [09:36<00:00, 57.57s/it][A100%|██████████| 10/10 [09:36<00:00, 57.61s/it]

100%|██████████| 10/10 [09:36<00:00, 57.58s/it][A100%|██████████| 10/10 [09:36<00:00, 57.60s/it]

100%|██████████| 10/10 [09:36<00:00, 57.56s/it][A100%|██████████| 10/10 [09:36<00:00, 57.60s/it]

100%|██████████| 10/10 [09:35<00:00, 57.56s/it][A100%|██████████| 10/10 [09:35<00:00, 57.60s/it]

100%|██████████| 10/10 [09:35<00:00, 57.56s/it][A100%|██████████| 10/10 [09:35<00:00, 57.60s/it]

100%|██████████| 10/10 [09:35<00:00, 57.50s/it][A100%|██████████| 10/10 [09:35<00:00, 57.60s/it]

100%|██████████| 10/10 [09:35<00:00, 57.47s/it][A100%|██████████| 10/10 [09:35<00:00, 57.60s/it]
Checkpointing at shard 95
[2024-05-30 19:30:36,311] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step940 is about to be saved!
[2024-05-30 19:30:38,401] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_00-model_states.pt...
[2024-05-30 19:30:44,482] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_02-model_states.pt...
[2024-05-30 19:30:44,812] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_07-model_states.pt...
[2024-05-30 19:30:45,241] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_05-model_states.pt...
[2024-05-30 19:30:45,319] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_06-model_states.pt...
[2024-05-30 19:30:46,092] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_08-model_states.pt...
[2024-05-30 19:30:47,388] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_00-model_states.pt.
[2024-05-30 19:30:50,772] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_04-model_states.pt...
[2024-05-30 19:30:51,716] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_03-model_states.pt...
[2024-05-30 19:30:57,072] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_01-model_states.pt...
[2024-05-30 19:34:14,708] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_01-model_states.pt.
[2024-05-30 19:34:15,542] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_03-model_states.pt.
[2024-05-30 19:34:15,758] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_00_model_states.pt
[2024-05-30 19:34:15,758] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_00_model_states.pt...
[2024-05-30 19:34:16,268] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_04-model_states.pt.
[2024-05-30 19:34:16,290] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_02_model_states.pt...
[2024-05-30 19:34:16,318] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_03_model_states.pt...
[2024-05-30 19:34:16,582] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_02_model_states.pt.
[2024-05-30 19:34:16,582] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_03_model_states.pt.
[2024-05-30 19:34:16,582] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step940 is ready now!
[2024-05-30 19:34:16,582] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step940 is ready now!
[2024-05-30 19:34:16,963] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_00_model_states.pt.
[2024-05-30 19:34:16,964] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step940 is ready now!
[2024-05-30 19:35:54,303] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_06-model_states.pt.
[2024-05-30 19:35:54,722] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_05_model_states.pt...
[2024-05-30 19:35:54,885] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_05_model_states.pt.
[2024-05-30 19:35:54,885] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step940 is ready now!
[2024-05-30 19:35:55,678] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_02-model_states.pt.
[2024-05-30 19:35:55,854] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_01_model_states.pt
[2024-05-30 19:35:55,854] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_01_model_states.pt...
[2024-05-30 19:35:57,719] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_01_model_states.pt.
[2024-05-30 19:35:57,720] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step940 is ready now!
[2024-05-30 19:36:05,627] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_05-model_states.pt.
[2024-05-30 19:36:06,245] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_04_model_states.pt...
[2024-05-30 19:36:06,491] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_04_model_states.pt.
[2024-05-30 19:36:06,491] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step940 is ready now!
[2024-05-30 19:36:06,508] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_08-model_states.pt.
[2024-05-30 19:36:07,026] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_09-model_states.pt...
[2024-05-30 19:36:07,042] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_07-model_states.pt.
[2024-05-30 19:36:07,464] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_06_model_states.pt...
[2024-05-30 19:36:07,607] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_06_model_states.pt.
[2024-05-30 19:36:07,608] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step940 is ready now!
[2024-05-30 19:36:07,773] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/layer_09-model_states.pt.
[2024-05-30 19:36:07,791] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_07_model_states.pt...
[2024-05-30 19:36:07,910] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step940/mp_rank_07_model_states.pt.
[2024-05-30 19:36:07,910] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step940 is ready now!
 18%|█▊        | 95/520 [5:17:11<97:03:34, 822.15s/it] 18%|█▊        | 95/520 [5:17:01<97:07:24, 822.69s/it] 18%|█▊        | 95/520 [5:18:11<97:03:13, 822.10s/it]Checkpoint saved using --- 331.60077571868896 seconds ---
 18%|█▊        | 95/520 [5:17:11<97:02:43, 822.03s/it] 18%|█▊        | 95/520 [5:17:30<97:02:57, 822.06s/it] 18%|█▊        | 95/520 [5:17:14<97:02:47, 822.04s/it] 18%|█▊        | 95/520 [5:17:30<97:03:22, 822.12s/it] 18%|█▊        | 95/520 [5:17:10<97:02:41, 822.03s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_plain_texts/shard_4
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A

  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:58<17:45, 118.38s/it][A[2024-05-30 19:38:09,236] [INFO] [logging.py:96:log_dist] [Rank 0] step=941, skipped=0, lr=[1.906528072781509e-05], mom=[(0.9, 0.999)]
steps: 941 loss: 0.8428 iter time (s): 121.325 samples/sec: 1.055

 10%|█         | 1/10 [02:01<18:17, 121.91s/it][A
 10%|█         | 1/10 [02:01<18:17, 121.97s/it][A
 10%|█         | 1/10 [02:02<18:18, 122.10s/it][A
 10%|█         | 1/10 [02:02<18:19, 122.13s/it][A
 10%|█         | 1/10 [02:02<18:19, 122.20s/it][A
 10%|█         | 1/10 [02:02<18:19, 122.21s/it][A
 10%|█         | 1/10 [02:02<18:20, 122.22s/it][A
 20%|██        | 2/10 [04:01<16:07, 120.97s/it][A[2024-05-30 19:40:12,065] [INFO] [logging.py:96:log_dist] [Rank 0] step=942, skipped=0, lr=[1.9062888307879858e-05], mom=[(0.9, 0.999)]
steps: 942 loss: 0.8256 iter time (s): 121.946 samples/sec: 1.050

 20%|██        | 2/10 [04:04<16:18, 122.34s/it][A
 20%|██        | 2/10 [04:04<16:18, 122.36s/it][A
 20%|██        | 2/10 [04:04<16:19, 122.39s/it][A
 20%|██        | 2/10 [04:04<16:19, 122.46s/it][A
 20%|██        | 2/10 [04:04<16:19, 122.47s/it][A
 20%|██        | 2/10 [04:04<16:20, 122.51s/it][A
 20%|██        | 2/10 [04:04<16:20, 122.52s/it][A
 30%|███       | 3/10 [06:03<14:12, 121.72s/it][A[2024-05-30 19:42:14,635] [INFO] [logging.py:96:log_dist] [Rank 0] step=943, skipped=0, lr=[1.906049298066592e-05], mom=[(0.9, 0.999)]
steps: 943 loss: 0.8624 iter time (s): 121.733 samples/sec: 1.051

 30%|███       | 3/10 [06:07<14:17, 122.45s/it][A
 30%|███       | 3/10 [06:07<14:17, 122.50s/it][A
 30%|███       | 3/10 [06:07<14:17, 122.51s/it][A
 30%|███       | 3/10 [06:07<14:17, 122.52s/it][A
 30%|███       | 3/10 [06:07<14:17, 122.53s/it][A
 30%|███       | 3/10 [06:07<14:17, 122.53s/it][A
 30%|███       | 3/10 [06:07<14:17, 122.54s/it][A
 40%|████      | 4/10 [08:06<12:12, 122.09s/it][A[2024-05-30 19:44:17,317] [INFO] [logging.py:96:log_dist] [Rank 0] step=944, skipped=0, lr=[1.9058094746941747e-05], mom=[(0.9, 0.999)]
steps: 944 loss: 0.8289 iter time (s): 121.862 samples/sec: 1.050

 40%|████      | 4/10 [08:09<12:15, 122.53s/it][A
 40%|████      | 4/10 [08:09<12:15, 122.59s/it][A
 40%|████      | 4/10 [08:10<12:15, 122.59s/it][A
 40%|████      | 4/10 [08:10<12:15, 122.57s/it][A
 40%|████      | 4/10 [08:10<12:15, 122.60s/it][A
 40%|████      | 4/10 [08:10<12:15, 122.60s/it][A
 40%|████      | 4/10 [08:10<12:15, 122.60s/it][A
 50%|█████     | 5/10 [10:09<10:11, 122.32s/it][A[2024-05-30 19:46:20,067] [INFO] [logging.py:96:log_dist] [Rank 0] step=945, skipped=0, lr=[1.905569360747675e-05], mom=[(0.9, 0.999)]
steps: 945 loss: 0.8239 iter time (s): 121.929 samples/sec: 1.050

 50%|█████     | 5/10 [10:12<10:12, 122.59s/it][A
 50%|█████     | 5/10 [10:12<10:13, 122.62s/it][A
 50%|█████     | 5/10 [10:12<10:13, 122.66s/it][A
 50%|█████     | 5/10 [10:12<10:13, 122.66s/it][A
 50%|█████     | 5/10 [10:12<10:13, 122.67s/it][A
 50%|█████     | 5/10 [10:12<10:13, 122.66s/it][A
 50%|█████     | 5/10 [10:12<10:13, 122.67s/it][A
 60%|██████    | 6/10 [12:11<08:09, 122.44s/it][A[2024-05-30 19:48:22,713] [INFO] [logging.py:96:log_dist] [Rank 0] step=946, skipped=0, lr=[1.9053289563041292e-05], mom=[(0.9, 0.999)]
steps: 946 loss: 0.8113 iter time (s): 121.787 samples/sec: 1.051

 60%|██████    | 6/10 [12:15<08:10, 122.62s/it][A
 60%|██████    | 6/10 [12:15<08:10, 122.63s/it][A
 60%|██████    | 6/10 [12:15<08:10, 122.65s/it][A
 60%|██████    | 6/10 [12:15<08:10, 122.67s/it][A
 60%|██████    | 6/10 [12:15<08:10, 122.67s/it][A
 60%|██████    | 6/10 [12:15<08:10, 122.68s/it][A
 60%|██████    | 6/10 [12:15<08:10, 122.68s/it][A
 70%|███████   | 7/10 [14:14<06:07, 122.55s/it][A[2024-05-30 19:50:25,487] [INFO] [logging.py:96:log_dist] [Rank 0] step=947, skipped=0, lr=[1.9050882614406632e-05], mom=[(0.9, 0.999)]
steps: 947 loss: 0.8334 iter time (s): 121.860 samples/sec: 1.050

 70%|███████   | 7/10 [14:18<06:08, 122.72s/it][A
 70%|███████   | 7/10 [14:18<06:08, 122.76s/it][A
 70%|███████   | 7/10 [14:18<06:08, 122.73s/it][A
 70%|███████   | 7/10 [14:18<06:08, 122.74s/it][A
 70%|███████   | 7/10 [14:18<06:08, 122.73s/it][A
 70%|███████   | 7/10 [14:18<06:08, 122.74s/it][A
 70%|███████   | 7/10 [14:18<06:08, 122.74s/it][A
 80%|████████  | 8/10 [16:17<04:05, 122.60s/it][A[2024-05-30 19:52:28,212] [INFO] [logging.py:96:log_dist] [Rank 0] step=948, skipped=0, lr=[1.9048472762344986e-05], mom=[(0.9, 0.999)]
steps: 948 loss: 0.8565 iter time (s): 121.768 samples/sec: 1.051

 80%|████████  | 8/10 [16:20<04:05, 122.66s/it][A
 80%|████████  | 8/10 [16:20<04:05, 122.69s/it][A
 80%|████████  | 8/10 [16:20<04:05, 122.66s/it][A
 80%|████████  | 8/10 [16:21<04:05, 122.69s/it][A
 80%|████████  | 8/10 [16:21<04:05, 122.69s/it][A
 80%|████████  | 8/10 [16:21<04:05, 122.69s/it][A
 80%|████████  | 8/10 [16:21<04:05, 122.69s/it][A
 90%|█████████ | 9/10 [18:19<02:02, 122.59s/it][A[2024-05-30 19:54:30,753] [INFO] [logging.py:96:log_dist] [Rank 0] step=949, skipped=0, lr=[1.904606000762949e-05], mom=[(0.9, 0.999)]
steps: 949 loss: 0.8247 iter time (s): 121.688 samples/sec: 1.052

 90%|█████████ | 9/10 [18:23<02:02, 122.66s/it][A
 90%|█████████ | 9/10 [18:23<02:02, 122.65s/it][A
 90%|█████████ | 9/10 [18:23<02:02, 122.68s/it][A
 90%|█████████ | 9/10 [18:23<02:02, 122.68s/it][A
 90%|█████████ | 9/10 [18:23<02:02, 122.68s/it][A
 90%|█████████ | 9/10 [18:23<02:02, 122.68s/it][A
 90%|█████████ | 9/10 [18:23<02:02, 122.68s/it][A
100%|██████████| 10/10 [20:22<00:00, 122.62s/it][A100%|██████████| 10/10 [20:22<00:00, 122.26s/it]
 18%|█▊        | 96/520 [5:37:24<110:46:56, 940.61s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 19:56:33,468] [INFO] [logging.py:96:log_dist] [Rank 0] step=950, skipped=0, lr=[1.9043644351034223e-05], mom=[(0.9, 0.999)]
steps: 950 loss: 0.8036 iter time (s): 121.783 samples/sec: 1.051

100%|██████████| 10/10 [20:25<00:00, 122.67s/it][A100%|██████████| 10/10 [20:25<00:00, 122.60s/it]
 18%|█▊        | 96/520 [5:37:38<110:51:17, 941.22s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [20:26<00:00, 122.66s/it][A100%|██████████| 10/10 [20:26<00:00, 122.61s/it]
 18%|█▊        | 96/520 [5:37:57<110:51:27, 941.24s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [20:26<00:00, 122.64s/it][A100%|██████████| 10/10 [20:26<00:00, 122.62s/it]
 18%|█▊        | 96/520 [5:38:38<110:51:28, 941.25s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [20:26<00:00, 122.66s/it][A100%|██████████| 10/10 [20:26<00:00, 122.63s/it]
 18%|█▊        | 96/520 [5:37:56<110:51:33, 941.26s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [20:26<00:00, 122.68s/it][A100%|██████████| 10/10 [20:26<00:00, 122.64s/it]
 18%|█▊        | 96/520 [5:37:40<110:51:41, 941.28s/it]
100%|██████████| 10/10 [20:26<00:00, 122.67s/it][A100%|██████████| 10/10 [20:26<00:00, 122.64s/it]
 18%|█▊        | 96/520 [5:37:38<110:51:39, 941.27s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [20:26<00:00, 122.67s/it][A100%|██████████| 10/10 [20:26<00:00, 122.64s/it]
 18%|█▊        | 96/520 [5:37:37<110:51:39, 941.27s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_415

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:03<09:34, 63.84s/it][A[2024-05-30 19:57:36,059] [INFO] [logging.py:96:log_dist] [Rank 0] step=951, skipped=0, lr=[1.9041225793334184e-05], mom=[(0.9, 0.999)]
steps: 951 loss: 0.2775 iter time (s): 61.401 samples/sec: 2.085

 10%|█         | 1/10 [01:02<09:19, 62.13s/it][A
 10%|█         | 1/10 [01:02<09:19, 62.20s/it][A
 10%|█         | 1/10 [01:02<09:19, 62.15s/it][A
 10%|█         | 1/10 [01:02<09:18, 62.06s/it][A
 10%|█         | 1/10 [01:02<09:18, 62.04s/it][A
 10%|█         | 1/10 [01:02<09:18, 62.04s/it][A
 10%|█         | 1/10 [01:02<09:18, 62.04s/it][A
 20%|██        | 2/10 [02:05<08:20, 62.59s/it][A[2024-05-30 19:58:37,775] [INFO] [logging.py:96:log_dist] [Rank 0] step=952, skipped=0, lr=[1.90388043353053e-05], mom=[(0.9, 0.999)]
steps: 952 loss: 0.2795 iter time (s): 61.081 samples/sec: 2.096

 20%|██        | 2/10 [02:04<08:15, 61.98s/it][A
 20%|██        | 2/10 [02:04<08:15, 61.98s/it][A
 20%|██        | 2/10 [02:04<08:16, 62.06s/it][A

 20%|██        | 2/10 [02:04<08:16, 62.02s/it][A 20%|██        | 2/10 [02:04<08:17, 62.15s/it][A
 20%|██        | 2/10 [02:04<08:16, 62.04s/it][A
 20%|██        | 2/10 [02:04<08:16, 62.06s/it][A
 30%|███       | 3/10 [03:08<07:20, 62.89s/it][A[2024-05-30 19:59:41,031] [INFO] [logging.py:96:log_dist] [Rank 0] step=953, skipped=0, lr=[1.9036379977724448e-05], mom=[(0.9, 0.999)]
steps: 953 loss: 0.2822 iter time (s): 62.291 samples/sec: 2.055

 30%|███       | 3/10 [03:07<07:17, 62.54s/it][A
 30%|███       | 3/10 [03:07<07:17, 62.49s/it][A
 30%|███       | 3/10 [03:07<07:17, 62.51s/it][A
 30%|███       | 3/10 [03:07<07:17, 62.49s/it][A
 30%|███       | 3/10 [03:07<07:17, 62.48s/it][A
 30%|███       | 3/10 [03:07<07:17, 62.47s/it][A
 30%|███       | 3/10 [03:07<07:17, 62.49s/it][A
 40%|████      | 4/10 [04:10<06:14, 62.43s/it][A[2024-05-30 20:00:42,743] [INFO] [logging.py:96:log_dist] [Rank 0] step=954, skipped=0, lr=[1.903395272136941e-05], mom=[(0.9, 0.999)]
steps: 954 loss: 0.2749 iter time (s): 61.059 samples/sec: 2.096

 40%|████      | 4/10 [04:08<06:13, 62.22s/it][A
 40%|████      | 4/10 [04:08<06:13, 62.18s/it][A
 40%|████      | 4/10 [04:08<06:13, 62.18s/it][A
 40%|████      | 4/10 [04:08<06:13, 62.17s/it][A
 40%|████      | 4/10 [04:08<06:12, 62.16s/it][A
 40%|████      | 4/10 [04:08<06:13, 62.18s/it][A
 40%|████      | 4/10 [04:08<06:13, 62.18s/it][A
 50%|█████     | 5/10 [05:14<05:14, 62.98s/it][A[2024-05-30 20:01:46,716] [INFO] [logging.py:96:log_dist] [Rank 0] step=955, skipped=0, lr=[1.9031522567018918e-05], mom=[(0.9, 0.999)]
steps: 955 loss: 0.2772 iter time (s): 63.266 samples/sec: 2.023

 50%|█████     | 5/10 [05:12<05:14, 62.82s/it][A
 50%|█████     | 5/10 [05:12<05:14, 62.84s/it][A
 50%|█████     | 5/10 [05:12<05:14, 62.80s/it][A
 50%|█████     | 5/10 [05:12<05:14, 62.82s/it][A
 50%|█████     | 5/10 [05:12<05:14, 62.81s/it][A
 50%|█████     | 5/10 [05:12<05:14, 62.81s/it][A
 50%|█████     | 5/10 [05:12<05:14, 62.82s/it][A
 60%|██████    | 6/10 [06:16<04:10, 62.59s/it][A[2024-05-30 20:02:48,528] [INFO] [logging.py:96:log_dist] [Rank 0] step=956, skipped=0, lr=[1.902908951545262e-05], mom=[(0.9, 0.999)]
steps: 956 loss: 0.2751 iter time (s): 61.137 samples/sec: 2.094

 60%|██████    | 6/10 [06:14<04:09, 62.47s/it][A
 60%|██████    | 6/10 [06:14<04:09, 62.48s/it][A
 60%|██████    | 6/10 [06:14<04:09, 62.46s/it][A
 60%|██████    | 6/10 [06:14<04:09, 62.49s/it][A
 60%|██████    | 6/10 [06:14<04:09, 62.49s/it][A
 60%|██████    | 6/10 [06:14<04:10, 62.51s/it][A
 60%|██████    | 6/10 [06:14<04:10, 62.51s/it][A
 70%|███████   | 7/10 [07:18<03:06, 62.31s/it][A[2024-05-30 20:03:50,257] [INFO] [logging.py:96:log_dist] [Rank 0] step=957, skipped=0, lr=[1.9026653567451102e-05], mom=[(0.9, 0.999)]
steps: 957 loss: 0.2686 iter time (s): 60.945 samples/sec: 2.100

 70%|███████   | 7/10 [07:16<03:06, 62.23s/it][A
 70%|███████   | 7/10 [07:16<03:06, 62.23s/it][A
 70%|███████   | 7/10 [07:16<03:06, 62.23s/it][A
 70%|███████   | 7/10 [07:16<03:06, 62.21s/it][A
 70%|███████   | 7/10 [07:16<03:06, 62.22s/it][A
 70%|███████   | 7/10 [07:16<03:06, 62.21s/it][A
 70%|███████   | 7/10 [07:16<03:06, 62.21s/it][A
 80%|████████  | 8/10 [08:19<02:04, 62.17s/it][A[2024-05-30 20:04:52,141] [INFO] [logging.py:96:log_dist] [Rank 0] step=958, skipped=0, lr=[1.902421472379588e-05], mom=[(0.9, 0.999)]
steps: 958 loss: 0.2656 iter time (s): 61.236 samples/sec: 2.090

 80%|████████  | 8/10 [08:18<02:04, 62.10s/it][A
 80%|████████  | 8/10 [08:18<02:04, 62.11s/it][A
 80%|████████  | 8/10 [08:18<02:04, 62.10s/it][A
 80%|████████  | 8/10 [08:18<02:04, 62.10s/it][A
 80%|████████  | 8/10 [08:18<02:04, 62.10s/it][A
 80%|████████  | 8/10 [08:18<02:04, 62.11s/it][A
 80%|████████  | 8/10 [08:18<02:04, 62.10s/it][A
 90%|█████████ | 9/10 [09:20<01:01, 61.74s/it][A[2024-05-30 20:05:52,918] [INFO] [logging.py:96:log_dist] [Rank 0] step=959, skipped=0, lr=[1.902177298526939e-05], mom=[(0.9, 0.999)]
steps: 959 loss: 0.2776 iter time (s): 60.138 samples/sec: 2.128

 90%|█████████ | 9/10 [09:19<01:01, 61.71s/it][A
 90%|█████████ | 9/10 [09:18<01:01, 61.70s/it][A
 90%|█████████ | 9/10 [09:18<01:01, 61.69s/it][A
 90%|█████████ | 9/10 [09:18<01:01, 61.69s/it][A
 90%|█████████ | 9/10 [09:18<01:01, 61.68s/it][A
 90%|█████████ | 9/10 [09:18<01:01, 61.69s/it][A
 90%|█████████ | 9/10 [09:18<01:01, 61.69s/it][A
100%|██████████| 10/10 [10:22<00:00, 61.82s/it][A100%|██████████| 10/10 [10:22<00:00, 62.27s/it]
 19%|█▊        | 97/520 [5:47:47<99:27:48, 846.50s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 20:06:54,911] [INFO] [logging.py:96:log_dist] [Rank 0] step=960, skipped=0, lr=[1.9019328352655004e-05], mom=[(0.9, 0.999)]
steps: 960 loss: 0.2731 iter time (s): 61.359 samples/sec: 2.086

100%|██████████| 10/10 [10:21<00:00, 61.79s/it][A100%|██████████| 10/10 [10:21<00:00, 62.10s/it]
 19%|█▊        | 97/520 [5:47:59<99:26:56, 846.37s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:20<00:00, 61.79s/it][A100%|██████████| 10/10 [10:20<00:00, 62.10s/it]
 19%|█▊        | 97/520 [5:48:18<99:26:53, 846.37s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:21<00:00, 61.80s/it][A100%|██████████| 10/10 [10:21<00:00, 62.10s/it]
 19%|█▊        | 97/520 [5:48:59<99:27:03, 846.39s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:20<00:00, 61.80s/it][A100%|██████████| 10/10 [10:20<00:00, 62.10s/it]
 19%|█▊        | 97/520 [5:48:17<99:26:57, 846.38s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:20<00:00, 61.79s/it][A100%|██████████| 10/10 [10:20<00:00, 62.09s/it]
 19%|█▊        | 97/520 [5:48:01<99:26:55, 846.37s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:20<00:00, 61.78s/it][A100%|██████████| 10/10 [10:20<00:00, 62.09s/it]
 19%|█▊        | 97/520 [5:47:58<99:26:55, 846.37s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:20<00:00, 61.79s/it][A100%|██████████| 10/10 [10:20<00:00, 62.09s/it]
 19%|█▊        | 97/520 [5:47:58<99:26:56, 846.37s/it] Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_95
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:15<11:17, 75.23s/it][A[2024-05-30 20:08:10,754] [INFO] [logging.py:96:log_dist] [Rank 0] step=961, skipped=0, lr=[1.9016880826737024e-05], mom=[(0.9, 0.999)]
steps: 961 loss: 1.0630 iter time (s): 74.988 samples/sec: 1.707

 10%|█         | 1/10 [01:15<11:22, 75.80s/it][A
 10%|█         | 1/10 [01:15<11:22, 75.84s/it][A
 10%|█         | 1/10 [01:15<11:22, 75.87s/it][A
 10%|█         | 1/10 [01:15<11:23, 75.89s/it][A
 10%|█         | 1/10 [01:15<11:23, 75.92s/it][A
 10%|█         | 1/10 [01:15<11:23, 75.94s/it][A
 10%|█         | 1/10 [01:15<11:23, 75.90s/it][A
 20%|██        | 2/10 [02:30<10:04, 75.50s/it][A[2024-05-30 20:09:26,452] [INFO] [logging.py:96:log_dist] [Rank 0] step=962, skipped=0, lr=[1.901443040830067e-05], mom=[(0.9, 0.999)]
steps: 962 loss: 1.0876 iter time (s): 74.953 samples/sec: 1.708

 20%|██        | 2/10 [02:31<10:06, 75.79s/it][A
 20%|██        | 2/10 [02:31<10:06, 75.79s/it][A
 20%|██        | 2/10 [02:31<10:06, 75.80s/it][A
 20%|██        | 2/10 [02:31<10:06, 75.80s/it][A
 20%|██        | 2/10 [02:31<10:06, 75.83s/it][A
 20%|██        | 2/10 [02:31<10:06, 75.81s/it][A
 20%|██        | 2/10 [02:31<10:06, 75.79s/it][A
 30%|███       | 3/10 [03:45<08:46, 75.20s/it][A[2024-05-30 20:10:41,293] [INFO] [logging.py:96:log_dist] [Rank 0] step=963, skipped=0, lr=[1.90119770981321e-05], mom=[(0.9, 0.999)]
steps: 963 loss: 1.0985 iter time (s): 74.097 samples/sec: 1.727

 30%|███       | 3/10 [03:46<08:47, 75.34s/it][A
 30%|███       | 3/10 [03:46<08:47, 75.36s/it][A
 30%|███       | 3/10 [03:46<08:47, 75.39s/it][A
 30%|███       | 3/10 [03:46<08:47, 75.35s/it][A
 30%|███       | 3/10 [03:46<08:47, 75.37s/it][A
 30%|███       | 3/10 [03:46<08:47, 75.38s/it][A
 30%|███       | 3/10 [03:46<08:47, 75.37s/it][A
 40%|████      | 4/10 [05:01<07:31, 75.28s/it][A[2024-05-30 20:11:56,690] [INFO] [logging.py:96:log_dist] [Rank 0] step=964, skipped=0, lr=[1.9009520897018404e-05], mom=[(0.9, 0.999)]
steps: 964 loss: 1.0855 iter time (s): 74.605 samples/sec: 1.716

 40%|████      | 4/10 [05:01<07:32, 75.34s/it][A
 40%|████      | 4/10 [05:01<07:32, 75.37s/it][A
 40%|████      | 4/10 [05:01<07:32, 75.36s/it][A
 40%|████      | 4/10 [05:01<07:32, 75.37s/it][A
 40%|████      | 4/10 [05:01<07:32, 75.36s/it][A
 40%|████      | 4/10 [05:01<07:32, 75.38s/it][A
 40%|████      | 4/10 [05:01<07:32, 75.37s/it][A
 50%|█████     | 5/10 [06:17<06:17, 75.49s/it][A[2024-05-30 20:13:12,560] [INFO] [logging.py:96:log_dist] [Rank 0] step=965, skipped=0, lr=[1.900706180574759e-05], mom=[(0.9, 0.999)]
steps: 965 loss: 1.0700 iter time (s): 75.108 samples/sec: 1.704

 50%|█████     | 5/10 [06:17<06:17, 75.57s/it][A
 50%|█████     | 5/10 [06:17<06:17, 75.56s/it][A
 50%|█████     | 5/10 [06:17<06:17, 75.53s/it][A
 50%|█████     | 5/10 [06:17<06:17, 75.55s/it][A
 50%|█████     | 5/10 [06:17<06:17, 75.55s/it][A
 50%|█████     | 5/10 [06:17<06:17, 75.56s/it][A
 50%|█████     | 5/10 [06:17<06:17, 75.55s/it][A
 60%|██████    | 6/10 [07:31<05:00, 75.11s/it][A[2024-05-30 20:14:26,936] [INFO] [logging.py:96:log_dist] [Rank 0] step=966, skipped=0, lr=[1.9004599825108585e-05], mom=[(0.9, 0.999)]
steps: 966 loss: 1.0610 iter time (s): 73.620 samples/sec: 1.739

 60%|██████    | 6/10 [07:32<05:00, 75.14s/it][A
 60%|██████    | 6/10 [07:32<05:00, 75.14s/it][A
 60%|██████    | 6/10 [07:32<05:00, 75.13s/it][A
 60%|██████    | 6/10 [07:32<05:00, 75.14s/it][A
 60%|██████    | 6/10 [07:32<05:00, 75.15s/it][A
 60%|██████    | 6/10 [07:32<05:00, 75.14s/it][A
 60%|██████    | 6/10 [07:32<05:00, 75.14s/it][A
 70%|███████   | 7/10 [09:01<04:00, 80.01s/it][A[2024-05-30 20:15:57,063] [INFO] [logging.py:96:log_dist] [Rank 0] step=967, skipped=0, lr=[1.9002134955891262e-05], mom=[(0.9, 0.999)]
steps: 967 loss: 1.0417 iter time (s): 89.464 samples/sec: 1.431

 70%|███████   | 7/10 [09:02<04:00, 80.07s/it][A
 70%|███████   | 7/10 [09:02<04:00, 80.07s/it][A
 70%|███████   | 7/10 [09:02<04:00, 80.07s/it][A
 70%|███████   | 7/10 [09:02<04:00, 80.06s/it][A
 70%|███████   | 7/10 [09:02<04:00, 80.06s/it][A
 70%|███████   | 7/10 [09:02<04:00, 80.07s/it][A
 70%|███████   | 7/10 [09:02<04:00, 80.07s/it][A
 80%|████████  | 8/10 [10:42<02:53, 86.81s/it][A[2024-05-30 20:17:38,407] [INFO] [logging.py:96:log_dist] [Rank 0] step=968, skipped=0, lr=[1.8999667198886413e-05], mom=[(0.9, 0.999)]
steps: 968 loss: 1.0707 iter time (s): 100.534 samples/sec: 1.273

 80%|████████  | 8/10 [10:43<02:53, 86.84s/it][A
 80%|████████  | 8/10 [10:43<02:53, 86.85s/it][A
 80%|████████  | 8/10 [10:43<02:53, 86.89s/it][A
 80%|████████  | 8/10 [10:43<02:53, 86.90s/it][A
 80%|████████  | 8/10 [10:43<02:53, 86.89s/it][A
 80%|████████  | 8/10 [10:44<02:54, 87.05s/it][A
 80%|████████  | 8/10 [10:44<02:54, 87.05s/it][A
 90%|█████████ | 9/10 [12:19<01:29, 89.90s/it][A[2024-05-30 20:19:14,895] [INFO] [logging.py:96:log_dist] [Rank 0] step=969, skipped=0, lr=[1.899719655488575e-05], mom=[(0.9, 0.999)]
steps: 969 loss: 1.0767 iter time (s): 95.067 samples/sec: 1.346

 90%|█████████ | 9/10 [12:20<01:29, 89.87s/it][A
 90%|█████████ | 9/10 [12:20<01:29, 89.87s/it][A
 90%|█████████ | 9/10 [12:20<01:29, 89.82s/it][A
 90%|█████████ | 9/10 [12:20<01:29, 89.85s/it][A
 90%|█████████ | 9/10 [12:20<01:29, 89.84s/it][A
 90%|█████████ | 9/10 [12:20<01:29, 89.79s/it][A
 90%|█████████ | 9/10 [12:20<01:29, 89.79s/it][A
100%|██████████| 10/10 [13:59<00:00, 92.99s/it][A100%|██████████| 10/10 [13:59<00:00, 83.95s/it]
 19%|█▉        | 98/520 [6:01:47<98:59:32, 844.49s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 20:20:55,030] [INFO] [logging.py:96:log_dist] [Rank 0] step=970, skipped=0, lr=[1.8994723024681926e-05], mom=[(0.9, 0.999)]
steps: 970 loss: 1.0581 iter time (s): 99.391 samples/sec: 1.288

100%|██████████| 10/10 [14:00<00:00, 93.03s/it][A100%|██████████| 10/10 [14:00<00:00, 84.02s/it]
 19%|█▉        | 98/520 [6:01:59<99:00:00, 844.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:00<00:00, 93.02s/it][A100%|██████████| 10/10 [14:00<00:00, 84.02s/it]
 19%|█▉        | 98/520 [6:02:18<98:59:57, 844.54s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:00<00:00, 93.01s/it][A100%|██████████| 10/10 [14:00<00:00, 84.02s/it]
 19%|█▉        | 98/520 [6:02:59<99:00:01, 844.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:00<00:00, 93.02s/it][A100%|██████████| 10/10 [14:00<00:00, 84.02s/it]
 19%|█▉        | 98/520 [6:02:17<99:00:01, 844.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:00<00:00, 93.01s/it][A100%|██████████| 10/10 [14:00<00:00, 84.02s/it]
 19%|█▉        | 98/520 [6:02:02<99:00:00, 844.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:00<00:00, 92.98s/it][A100%|██████████| 10/10 [14:00<00:00, 84.02s/it]
 19%|█▉        | 98/520 [6:01:59<99:00:02, 844.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:00<00:00, 92.99s/it][A100%|██████████| 10/10 [14:00<00:00, 84.02s/it]
 19%|█▉        | 98/520 [6:01:58<99:00:04, 844.56s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_155
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:36<23:28, 156.54s/it][A[2024-05-30 20:23:33,801] [INFO] [logging.py:96:log_dist] [Rank 0] step=971, skipped=0, lr=[1.89922466090685e-05], mom=[(0.9, 0.999)]
steps: 971 loss: 0.5612 iter time (s): 157.985 samples/sec: 0.810

 10%|█         | 1/10 [02:38<23:48, 158.77s/it][A
 10%|█         | 1/10 [02:38<23:49, 158.85s/it][A
 10%|█         | 1/10 [02:38<23:49, 158.83s/it][A
 10%|█         | 1/10 [02:38<23:49, 158.82s/it][A
 10%|█         | 1/10 [02:38<23:49, 158.83s/it][A
 10%|█         | 1/10 [02:38<23:49, 158.83s/it][A
 10%|█         | 1/10 [02:38<23:49, 158.82s/it][A
 20%|██        | 2/10 [05:14<20:59, 157.38s/it][A[2024-05-30 20:26:11,766] [INFO] [logging.py:96:log_dist] [Rank 0] step=972, skipped=0, lr=[1.8989767308839978e-05], mom=[(0.9, 0.999)]
steps: 972 loss: 0.5516 iter time (s): 157.087 samples/sec: 0.815

 20%|██        | 2/10 [05:16<21:05, 158.21s/it][A
 20%|██        | 2/10 [05:16<21:05, 158.22s/it][A
 20%|██        | 2/10 [05:16<21:05, 158.24s/it][A
 20%|██        | 2/10 [05:16<21:05, 158.23s/it][A
 20%|██        | 2/10 [05:16<21:05, 158.25s/it][A
 20%|██        | 2/10 [05:16<21:05, 158.24s/it][A
 20%|██        | 2/10 [05:16<21:05, 158.22s/it][A
 30%|███       | 3/10 [07:45<18:01, 154.55s/it][A[2024-05-30 20:28:42,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=973, skipped=0, lr=[1.8987285124791774e-05], mom=[(0.9, 0.999)]
steps: 973 loss: 0.5763 iter time (s): 150.500 samples/sec: 0.850

 30%|███       | 3/10 [07:47<18:05, 155.03s/it][A
 30%|███       | 3/10 [07:47<18:05, 155.02s/it][A
 30%|███       | 3/10 [07:47<18:05, 155.05s/it][A
 30%|███       | 3/10 [07:47<18:05, 155.04s/it][A
 30%|███       | 3/10 [07:47<18:05, 155.03s/it][A
 30%|███       | 3/10 [07:47<18:05, 155.03s/it][A
 30%|███       | 3/10 [07:47<18:05, 155.02s/it][A
 40%|████      | 4/10 [10:13<15:10, 151.78s/it][A[2024-05-30 20:31:10,501] [INFO] [logging.py:96:log_dist] [Rank 0] step=974, skipped=0, lr=[1.8984800057720235e-05], mom=[(0.9, 0.999)]
steps: 974 loss: 0.5768 iter time (s): 146.814 samples/sec: 0.872

 40%|████      | 4/10 [10:15<15:12, 152.06s/it][A
 40%|████      | 4/10 [10:15<15:12, 152.08s/it][A
 40%|████      | 4/10 [10:15<15:12, 152.09s/it][A
 40%|████      | 4/10 [10:15<15:12, 152.08s/it][A
 40%|████      | 4/10 [10:15<15:12, 152.09s/it][A
 40%|████      | 4/10 [10:15<15:12, 152.08s/it][A
 40%|████      | 4/10 [10:15<15:12, 152.08s/it][A
 50%|█████     | 5/10 [12:39<12:28, 149.64s/it][A[2024-05-30 20:33:36,316] [INFO] [logging.py:96:log_dist] [Rank 0] step=975, skipped=0, lr=[1.8982312108422632e-05], mom=[(0.9, 0.999)]
steps: 975 loss: 0.5669 iter time (s): 145.185 samples/sec: 0.882

 50%|█████     | 5/10 [12:41<12:29, 149.89s/it][A
 50%|█████     | 5/10 [12:41<12:29, 149.87s/it][A
 50%|█████     | 5/10 [12:41<12:29, 149.86s/it][A
 50%|█████     | 5/10 [12:41<12:29, 149.87s/it][A
 50%|█████     | 5/10 [12:41<12:29, 149.85s/it][A
 50%|█████     | 5/10 [12:41<12:29, 149.86s/it][A
 50%|█████     | 5/10 [12:41<12:29, 149.86s/it][A
 60%|██████    | 6/10 [15:07<09:57, 149.36s/it][A[2024-05-30 20:36:05,155] [INFO] [logging.py:96:log_dist] [Rank 0] step=976, skipped=0, lr=[1.8979821277697165e-05], mom=[(0.9, 0.999)]
steps: 976 loss: 0.5687 iter time (s): 148.032 samples/sec: 0.865

 60%|██████    | 6/10 [15:10<09:57, 149.48s/it][A
 60%|██████    | 6/10 [15:10<09:57, 149.49s/it][A
 60%|██████    | 6/10 [15:10<09:57, 149.49s/it][A
 60%|██████    | 6/10 [15:10<09:58, 149.51s/it][A
 60%|██████    | 6/10 [15:10<09:58, 149.51s/it][A
 60%|██████    | 6/10 [15:10<09:58, 149.50s/it][A
 60%|██████    | 6/10 [15:10<09:57, 149.50s/it][A
 70%|███████   | 7/10 [17:35<07:26, 148.78s/it][A[2024-05-30 20:38:32,743] [INFO] [logging.py:96:log_dist] [Rank 0] step=977, skipped=0, lr=[1.897732756634295e-05], mom=[(0.9, 0.999)]
steps: 977 loss: 0.5765 iter time (s): 146.783 samples/sec: 0.872

 70%|███████   | 7/10 [17:37<07:26, 148.85s/it][A
 70%|███████   | 7/10 [17:37<07:26, 148.86s/it][A
 70%|███████   | 7/10 [17:37<07:26, 148.85s/it][A
 70%|███████   | 7/10 [17:37<07:26, 148.84s/it][A
 70%|███████   | 7/10 [17:37<07:26, 148.85s/it][A
 70%|███████   | 7/10 [17:37<07:26, 148.84s/it][A
 70%|███████   | 7/10 [17:37<07:26, 148.84s/it][A
 80%|████████  | 8/10 [20:06<04:59, 149.64s/it][A[2024-05-30 20:41:04,214] [INFO] [logging.py:96:log_dist] [Rank 0] step=978, skipped=0, lr=[1.8974830975160035e-05], mom=[(0.9, 0.999)]
steps: 978 loss: 0.5750 iter time (s): 150.803 samples/sec: 0.849

 80%|████████  | 8/10 [20:09<04:59, 149.72s/it][A
 80%|████████  | 8/10 [20:09<04:59, 149.69s/it][A
 80%|████████  | 8/10 [20:09<04:59, 149.70s/it][A
 80%|████████  | 8/10 [20:09<04:59, 149.69s/it][A
 80%|████████  | 8/10 [20:09<04:59, 149.70s/it][A
 80%|████████  | 8/10 [20:09<04:59, 149.70s/it][A
 80%|████████  | 8/10 [20:09<04:59, 149.70s/it][A
 90%|█████████ | 9/10 [22:37<02:29, 149.77s/it][A[2024-05-30 20:43:34,155] [INFO] [logging.py:96:log_dist] [Rank 0] step=979, skipped=0, lr=[1.8972331504949387e-05], mom=[(0.9, 0.999)]
steps: 979 loss: 0.5665 iter time (s): 149.232 samples/sec: 0.858

 90%|█████████ | 9/10 [22:39<02:29, 149.76s/it][A
 90%|█████████ | 9/10 [22:39<02:29, 149.79s/it][A
 90%|█████████ | 9/10 [22:39<02:29, 149.77s/it][A
 90%|█████████ | 9/10 [22:39<02:29, 149.77s/it][A
 90%|█████████ | 9/10 [22:39<02:29, 149.77s/it][A
 90%|█████████ | 9/10 [22:39<02:29, 149.77s/it][A
 90%|█████████ | 9/10 [22:39<02:29, 149.77s/it][A
100%|██████████| 10/10 [25:00<00:00, 147.89s/it][A100%|██████████| 10/10 [25:00<00:00, 150.07s/it]
 19%|█▉        | 99/520 [6:26:48<121:39:24, 1040.30s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 20:45:57,967] [INFO] [logging.py:96:log_dist] [Rank 0] step=980, skipped=0, lr=[1.89698291565129e-05], mom=[(0.9, 0.999)]
steps: 980 loss: 0.5772 iter time (s): 143.264 samples/sec: 0.893

100%|██████████| 10/10 [25:03<00:00, 147.98s/it][A100%|██████████| 10/10 [25:03<00:00, 150.31s/it]
 19%|█▉        | 99/520 [6:27:02<121:43:32, 1040.89s/it]
100%|██████████| 10/10 [25:03<00:00, 147.97s/it][A100%|██████████| 10/10 [25:03<00:00, 150.30s/it]
 19%|█▉        | 99/520 [6:27:21<121:43:29, 1040.88s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [25:03<00:00, 147.98s/it][A100%|██████████| 10/10 [25:03<00:00, 150.31s/it]
 19%|█▉        | 99/520 [6:28:02<121:43:39, 1040.90s/it]
100%|██████████| 10/10 [25:03<00:00, 147.98s/it][A100%|██████████| 10/10 [25:03<00:00, 150.31s/it]
 19%|█▉        | 99/520 [6:27:21<121:43:33, 1040.89s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [25:03<00:00, 147.97s/it][A100%|██████████| 10/10 [25:03<00:00, 150.31s/it]
 19%|█▉        | 99/520 [6:27:05<121:43:33, 1040.89s/it]
100%|██████████| 10/10 [25:03<00:00, 147.97s/it][A100%|██████████| 10/10 [25:03<00:00, 150.30s/it]
 19%|█▉        | 99/520 [6:27:02<121:43:30, 1040.88s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [25:03<00:00, 147.97s/it][A100%|██████████| 10/10 [25:03<00:00, 150.30s/it]
 19%|█▉        | 99/520 [6:27:01<121:43:33, 1040.89s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_472

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:23<12:32, 83.58s/it][A[2024-05-30 20:47:20,287] [INFO] [logging.py:96:log_dist] [Rank 0] step=981, skipped=0, lr=[1.896732393065338e-05], mom=[(0.9, 0.999)]
steps: 981 loss: 1.1889 iter time (s): 81.232 samples/sec: 1.576

 10%|█         | 1/10 [01:22<12:18, 82.07s/it][A
 10%|█         | 1/10 [01:22<12:18, 82.10s/it][A
 10%|█         | 1/10 [01:22<12:18, 82.04s/it][A
 10%|█         | 1/10 [01:22<12:18, 82.06s/it][A
 10%|█         | 1/10 [01:21<12:17, 82.00s/it][A
 10%|█         | 1/10 [01:22<12:18, 82.05s/it][A
 10%|█         | 1/10 [01:22<12:18, 82.07s/it][A
 20%|██        | 2/10 [02:43<10:53, 81.70s/it][A[2024-05-30 20:48:40,668] [INFO] [logging.py:96:log_dist] [Rank 0] step=982, skipped=0, lr=[1.8964815828174578e-05], mom=[(0.9, 0.999)]
steps: 982 loss: 1.2041 iter time (s): 79.695 samples/sec: 1.606

 20%|██        | 2/10 [02:42<10:48, 81.07s/it][A
 20%|██        | 2/10 [02:42<10:49, 81.17s/it][A
 20%|██        | 2/10 [02:42<10:48, 81.11s/it][A
 20%|██        | 2/10 [02:42<10:48, 81.05s/it][A
 20%|██        | 2/10 [02:42<10:49, 81.14s/it][A
 20%|██        | 2/10 [02:42<10:48, 81.09s/it][A
 20%|██        | 2/10 [02:42<10:48, 81.10s/it][A
 30%|███       | 3/10 [04:04<09:29, 81.34s/it][A[2024-05-30 20:50:01,586] [INFO] [logging.py:96:log_dist] [Rank 0] step=983, skipped=0, lr=[1.896230484988115e-05], mom=[(0.9, 0.999)]
steps: 983 loss: 1.2497 iter time (s): 80.137 samples/sec: 1.597

 30%|███       | 3/10 [04:03<09:27, 81.00s/it][A
 30%|███       | 3/10 [04:03<09:26, 80.99s/it][A
 30%|███       | 3/10 [04:03<09:26, 80.98s/it][A
 30%|███       | 3/10 [04:03<09:27, 81.02s/it][A
 30%|███       | 3/10 [04:03<09:26, 80.97s/it][A
 30%|███       | 3/10 [04:03<09:26, 81.00s/it][A
 30%|███       | 3/10 [04:03<09:26, 80.98s/it][A
 40%|████      | 4/10 [05:27<08:11, 81.87s/it][A[2024-05-30 20:51:24,261] [INFO] [logging.py:96:log_dist] [Rank 0] step=984, skipped=0, lr=[1.895979099657868e-05], mom=[(0.9, 0.999)]
steps: 984 loss: 1.1918 iter time (s): 81.969 samples/sec: 1.562

 40%|████      | 4/10 [05:25<08:09, 81.65s/it][A
 40%|████      | 4/10 [05:26<08:09, 81.66s/it][A
 40%|████      | 4/10 [05:26<08:10, 81.67s/it][A
 40%|████      | 4/10 [05:26<08:09, 81.66s/it][A
 40%|████      | 4/10 [05:26<08:09, 81.66s/it][A
 40%|████      | 4/10 [05:26<08:09, 81.67s/it][A
 40%|████      | 4/10 [05:26<08:10, 81.67s/it][A
 50%|█████     | 5/10 [06:51<06:53, 82.69s/it][A[2024-05-30 20:52:48,412] [INFO] [logging.py:96:log_dist] [Rank 0] step=985, skipped=0, lr=[1.8957274269073674e-05], mom=[(0.9, 0.999)]
steps: 985 loss: 1.1733 iter time (s): 83.439 samples/sec: 1.534

 50%|█████     | 5/10 [06:50<06:52, 82.57s/it][A
 50%|█████     | 5/10 [06:50<06:52, 82.58s/it][A
 50%|█████     | 5/10 [06:50<06:52, 82.58s/it][A
 50%|█████     | 5/10 [06:50<06:52, 82.56s/it][A
 50%|█████     | 5/10 [06:50<06:52, 82.56s/it][A
 50%|█████     | 5/10 [06:50<06:52, 82.57s/it][A
 50%|█████     | 5/10 [06:50<06:52, 82.57s/it][A
 60%|██████    | 6/10 [08:09<05:24, 81.14s/it][A[2024-05-30 20:54:06,542] [INFO] [logging.py:96:log_dist] [Rank 0] step=986, skipped=0, lr=[1.8954754668173566e-05], mom=[(0.9, 0.999)]
steps: 986 loss: 1.2774 iter time (s): 77.425 samples/sec: 1.653

 60%|██████    | 6/10 [08:08<05:24, 81.08s/it][A
 60%|██████    | 6/10 [08:08<05:24, 81.08s/it][A
 60%|██████    | 6/10 [08:08<05:24, 81.08s/it][A
 60%|██████    | 6/10 [08:08<05:24, 81.07s/it][A
 60%|██████    | 6/10 [08:08<05:24, 81.07s/it][A
 60%|██████    | 6/10 [08:08<05:24, 81.06s/it][A
 60%|██████    | 6/10 [08:08<05:24, 81.07s/it][A
 70%|███████   | 7/10 [09:29<04:02, 80.80s/it][A[2024-05-30 20:55:26,650] [INFO] [logging.py:96:log_dist] [Rank 0] step=987, skipped=0, lr=[1.8952232194686696e-05], mom=[(0.9, 0.999)]
steps: 987 loss: 1.1872 iter time (s): 79.308 samples/sec: 1.614

 70%|███████   | 7/10 [09:28<04:02, 80.75s/it][A
 70%|███████   | 7/10 [09:28<04:02, 80.75s/it][A
 70%|███████   | 7/10 [09:28<04:02, 80.73s/it][A
 70%|███████   | 7/10 [09:28<04:02, 80.74s/it][A
 70%|███████   | 7/10 [09:28<04:02, 80.73s/it][A
 70%|███████   | 7/10 [09:28<04:02, 80.73s/it][A
 70%|███████   | 7/10 [09:28<04:02, 80.73s/it][A
 80%|████████  | 8/10 [10:51<02:41, 80.99s/it][A[2024-05-30 20:56:48,023] [INFO] [logging.py:96:log_dist] [Rank 0] step=988, skipped=0, lr=[1.8949706849422348e-05], mom=[(0.9, 0.999)]
steps: 988 loss: 1.1510 iter time (s): 80.672 samples/sec: 1.587

 80%|████████  | 8/10 [10:49<02:41, 80.93s/it][A
 80%|████████  | 8/10 [10:49<02:41, 80.96s/it][A
 80%|████████  | 8/10 [10:49<02:41, 80.93s/it][A
 80%|████████  | 8/10 [10:49<02:41, 80.93s/it][A
 80%|████████  | 8/10 [10:49<02:41, 80.94s/it][A
 80%|████████  | 8/10 [10:49<02:41, 80.96s/it][A
 80%|████████  | 8/10 [10:49<02:41, 80.95s/it][A
 90%|█████████ | 9/10 [12:13<01:21, 81.29s/it][A[2024-05-30 20:58:09,996] [INFO] [logging.py:96:log_dist] [Rank 0] step=989, skipped=0, lr=[1.8947178633190708e-05], mom=[(0.9, 0.999)]
steps: 989 loss: 1.2348 iter time (s): 81.213 samples/sec: 1.576

 90%|█████████ | 9/10 [12:11<01:21, 81.27s/it][A
 90%|█████████ | 9/10 [12:11<01:21, 81.26s/it][A
 90%|█████████ | 9/10 [12:11<01:21, 81.28s/it][A
 90%|█████████ | 9/10 [12:11<01:21, 81.27s/it][A
 90%|█████████ | 9/10 [12:11<01:21, 81.27s/it][A
 90%|█████████ | 9/10 [12:11<01:21, 81.27s/it][A
 90%|█████████ | 9/10 [12:11<01:21, 81.27s/it][A
100%|██████████| 10/10 [13:35<00:00, 81.57s/it][A100%|██████████| 10/10 [13:35<00:00, 81.55s/it]
[2024-05-30 20:59:32,187] [INFO] [logging.py:96:log_dist] [Rank 0] step=990, skipped=0, lr=[1.894464754680289e-05], mom=[(0.9, 0.999)]
steps: 990 loss: 1.2044 iter time (s): 81.452 samples/sec: 1.571

100%|██████████| 10/10 [13:33<00:00, 81.53s/it][A100%|██████████| 10/10 [13:33<00:00, 81.39s/it]

100%|██████████| 10/10 [13:34<00:00, 81.55s/it][A100%|██████████| 10/10 [13:34<00:00, 81.40s/it]

100%|██████████| 10/10 [13:33<00:00, 81.55s/it][A100%|██████████| 10/10 [13:33<00:00, 81.40s/it]

100%|██████████| 10/10 [13:33<00:00, 81.55s/it][A100%|██████████| 10/10 [13:33<00:00, 81.40s/it]

100%|██████████| 10/10 [13:33<00:00, 81.54s/it][A100%|██████████| 10/10 [13:33<00:00, 81.39s/it]

100%|██████████| 10/10 [13:33<00:00, 81.54s/it][A100%|██████████| 10/10 [13:33<00:00, 81.39s/it]

100%|██████████| 10/10 [13:33<00:00, 81.54s/it][A100%|██████████| 10/10 [13:33<00:00, 81.40s/it]
Checkpointing at shard 100
[2024-05-30 20:59:32,957] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step990 is about to be saved!
[2024-05-30 20:59:34,878] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_00-model_states.pt...
[2024-05-30 20:59:38,516] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_06-model_states.pt...
[2024-05-30 20:59:40,139] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_07-model_states.pt...
[2024-05-30 20:59:40,670] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_02-model_states.pt...
[2024-05-30 20:59:40,980] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_05-model_states.pt...
[2024-05-30 20:59:41,728] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_08-model_states.pt...
[2024-05-30 20:59:45,179] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_00-model_states.pt.
[2024-05-30 20:59:46,957] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_03-model_states.pt...
[2024-05-30 20:59:47,016] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_04-model_states.pt...
[2024-05-30 20:59:52,931] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_01-model_states.pt...
[2024-05-30 21:10:40,693] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_05-model_states.pt.
[2024-05-30 21:10:41,149] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_04_model_states.pt...
[2024-05-30 21:10:41,857] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_04_model_states.pt.
[2024-05-30 21:10:41,857] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step990 is ready now!
[2024-05-30 21:10:54,049] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_02-model_states.pt.
[2024-05-30 21:10:54,138] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_01_model_states.pt
[2024-05-30 21:10:54,138] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_01_model_states.pt...
[2024-05-30 21:10:54,667] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_01_model_states.pt.
[2024-05-30 21:10:54,667] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step990 is ready now!
[2024-05-30 21:11:01,409] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_08-model_states.pt.
[2024-05-30 21:11:02,133] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_09-model_states.pt...
[2024-05-30 21:11:05,734] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_09-model_states.pt.
[2024-05-30 21:11:05,756] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_07_model_states.pt...
[2024-05-30 21:11:06,580] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_07_model_states.pt.
[2024-05-30 21:11:06,580] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step990 is ready now!
[2024-05-30 21:11:13,952] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_07-model_states.pt.
[2024-05-30 21:11:14,356] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_06_model_states.pt...
[2024-05-30 21:11:14,933] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_06-model_states.pt.
[2024-05-30 21:11:14,951] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_06_model_states.pt.
[2024-05-30 21:11:14,952] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step990 is ready now!
[2024-05-30 21:11:14,991] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_05_model_states.pt...
[2024-05-30 21:11:15,735] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_05_model_states.pt.
[2024-05-30 21:11:15,735] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step990 is ready now!
[2024-05-30 21:11:46,664] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_01-model_states.pt.
[2024-05-30 21:11:46,697] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_03-model_states.pt.
[2024-05-30 21:11:46,746] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/layer_04-model_states.pt.
[2024-05-30 21:11:47,191] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_03_model_states.pt...
[2024-05-30 21:11:47,515] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_02_model_states.pt...
[2024-05-30 21:11:47,560] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_00_model_states.pt
[2024-05-30 21:11:47,560] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_00_model_states.pt...
[2024-05-30 21:11:47,679] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_03_model_states.pt.
[2024-05-30 21:11:47,681] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step990 is ready now!
[2024-05-30 21:11:48,047] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_02_model_states.pt.
[2024-05-30 21:11:48,047] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step990 is ready now!
[2024-05-30 21:11:49,077] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step990/mp_rank_00_model_states.pt.
[2024-05-30 21:11:49,077] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step990 is ready now!
Checkpoint saved using --- 736.1703073978424 seconds ---
 19%|█▉        | 100/520 [6:53:11<139:11:24, 1193.06s/it] 19%|█▉        | 100/520 [6:52:55<139:11:16, 1193.04s/it] 19%|█▉        | 100/520 [6:52:51<139:11:11, 1193.03s/it] 19%|█▉        | 100/520 [6:52:43<139:17:05, 1193.87s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_319
 19%|█▉        | 100/520 [6:52:53<139:11:57, 1193.14s/it] 19%|█▉        | 100/520 [6:52:52<139:11:15, 1193.04s/it] 19%|█▉        | 100/520 [6:53:53<139:11:35, 1193.08s/it] 19%|█▉        | 100/520 [6:53:11<139:11:49, 1193.12s/it]Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A

  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:25<12:52, 85.87s/it][A[2024-05-30 21:13:17,445] [INFO] [logging.py:96:log_dist] [Rank 0] step=991, skipped=0, lr=[1.8942113591070936e-05], mom=[(0.9, 0.999)]
steps: 991 loss: 0.5745 iter time (s): 87.629 samples/sec: 1.461

 10%|█         | 1/10 [01:28<13:12, 88.06s/it][A
 10%|█         | 1/10 [01:28<13:13, 88.18s/it][A
 10%|█         | 1/10 [01:28<13:14, 88.31s/it][A
 10%|█         | 1/10 [01:28<13:15, 88.38s/it][A
 10%|█         | 1/10 [01:28<13:16, 88.50s/it][A
 10%|█         | 1/10 [01:28<13:16, 88.51s/it][A
 10%|█         | 1/10 [01:28<13:16, 88.54s/it][A
 20%|██        | 2/10 [02:55<11:45, 88.14s/it][A[2024-05-30 21:14:46,929] [INFO] [logging.py:96:log_dist] [Rank 0] step=992, skipped=0, lr=[1.8939576766807796e-05], mom=[(0.9, 0.999)]
steps: 992 loss: 0.5783 iter time (s): 88.697 samples/sec: 1.443

 20%|██        | 2/10 [02:57<11:51, 88.93s/it][A
 20%|██        | 2/10 [02:57<11:52, 89.00s/it][A
 20%|██        | 2/10 [02:57<11:52, 89.03s/it][A
 20%|██        | 2/10 [02:57<11:52, 89.10s/it][A
 20%|██        | 2/10 [02:58<11:52, 89.09s/it][A
 20%|██        | 2/10 [02:58<11:52, 89.11s/it][A
 20%|██        | 2/10 [02:58<11:53, 89.13s/it][A
 30%|███       | 3/10 [04:25<10:22, 88.98s/it][A[2024-05-30 21:16:17,152] [INFO] [logging.py:96:log_dist] [Rank 0] step=993, skipped=0, lr=[1.8937037074827344e-05], mom=[(0.9, 0.999)]
steps: 993 loss: 0.5727 iter time (s): 89.398 samples/sec: 1.432

 30%|███       | 3/10 [04:27<10:26, 89.52s/it][A
 30%|███       | 3/10 [04:27<10:26, 89.54s/it][A
 30%|███       | 3/10 [04:28<10:27, 89.58s/it][A
 30%|███       | 3/10 [04:28<10:26, 89.57s/it][A
 30%|███       | 3/10 [04:28<10:27, 89.62s/it][A
 30%|███       | 3/10 [04:28<10:27, 89.62s/it][A
 30%|███       | 3/10 [04:28<10:27, 89.63s/it][A
 40%|████      | 4/10 [05:55<08:56, 89.45s/it][A[2024-05-30 21:17:47,321] [INFO] [logging.py:96:log_dist] [Rank 0] step=994, skipped=0, lr=[1.8934494515944387e-05], mom=[(0.9, 0.999)]
steps: 994 loss: 0.5883 iter time (s): 89.276 samples/sec: 1.434

 40%|████      | 4/10 [05:58<08:58, 89.81s/it][A
 40%|████      | 4/10 [05:58<08:59, 89.85s/it][A
 40%|████      | 4/10 [05:58<08:58, 89.83s/it][A
 40%|████      | 4/10 [05:58<08:59, 89.89s/it][A
 40%|████      | 4/10 [05:58<08:59, 89.88s/it][A
 40%|████      | 4/10 [05:58<08:59, 89.88s/it][A
 40%|████      | 4/10 [05:58<08:59, 89.88s/it][A
 50%|█████     | 5/10 [07:28<07:32, 90.50s/it][A[2024-05-30 21:19:19,681] [INFO] [logging.py:96:log_dist] [Rank 0] step=995, skipped=0, lr=[1.893194909097463e-05], mom=[(0.9, 0.999)]
steps: 995 loss: 0.5884 iter time (s): 91.489 samples/sec: 1.399

 50%|█████     | 5/10 [07:30<07:33, 90.74s/it][A
 50%|█████     | 5/10 [07:30<07:33, 90.73s/it][A
 50%|█████     | 5/10 [07:30<07:33, 90.76s/it][A
 50%|█████     | 5/10 [07:30<07:33, 90.75s/it][A
 50%|█████     | 5/10 [07:30<07:33, 90.75s/it][A
 50%|█████     | 5/10 [07:30<07:33, 90.77s/it][A
 50%|█████     | 5/10 [07:30<07:33, 90.76s/it][A
 60%|██████    | 6/10 [08:57<06:01, 90.26s/it][A[2024-05-30 21:20:49,463] [INFO] [logging.py:96:log_dist] [Rank 0] step=996, skipped=0, lr=[1.892940080073471e-05], mom=[(0.9, 0.999)]
steps: 996 loss: 0.5910 iter time (s): 88.902 samples/sec: 1.440

 60%|██████    | 6/10 [09:00<06:01, 90.44s/it][A
 60%|██████    | 6/10 [09:00<06:01, 90.44s/it][A
 60%|██████    | 6/10 [09:00<06:01, 90.45s/it][A
 60%|██████    | 6/10 [09:00<06:01, 90.44s/it][A
 60%|██████    | 6/10 [09:00<06:01, 90.48s/it][A
 60%|██████    | 6/10 [09:00<06:01, 90.46s/it][A
 60%|██████    | 6/10 [09:00<06:01, 90.46s/it][A
 70%|███████   | 7/10 [10:29<04:31, 90.58s/it][A[2024-05-30 21:22:20,723] [INFO] [logging.py:96:log_dist] [Rank 0] step=997, skipped=0, lr=[1.892684964604219e-05], mom=[(0.9, 0.999)]
steps: 997 loss: 0.5903 iter time (s): 90.238 samples/sec: 1.418

 70%|███████   | 7/10 [10:31<04:31, 90.63s/it][A
 70%|███████   | 7/10 [10:31<04:31, 90.64s/it][A
 70%|███████   | 7/10 [10:31<04:31, 90.66s/it][A
 70%|███████   | 7/10 [10:31<04:32, 90.67s/it][A
 70%|███████   | 7/10 [10:31<04:32, 90.69s/it][A
 70%|███████   | 7/10 [10:31<04:32, 90.70s/it][A
 70%|███████   | 7/10 [10:31<04:32, 90.70s/it][A
 80%|████████  | 8/10 [12:03<03:03, 91.77s/it][A[2024-05-30 21:23:55,039] [INFO] [logging.py:96:log_dist] [Rank 0] step=998, skipped=0, lr=[1.8924295627715535e-05], mom=[(0.9, 0.999)]
steps: 998 loss: 0.5790 iter time (s): 93.343 samples/sec: 1.371

 80%|████████  | 8/10 [12:05<03:03, 91.80s/it][A
 80%|████████  | 8/10 [12:05<03:03, 91.79s/it][A
 80%|████████  | 8/10 [12:05<03:03, 91.79s/it][A
 80%|████████  | 8/10 [12:06<03:03, 91.81s/it][A
 80%|████████  | 8/10 [12:06<03:03, 91.81s/it][A
 80%|████████  | 8/10 [12:06<03:03, 91.79s/it][A
 80%|████████  | 8/10 [12:06<03:03, 91.80s/it][A
 90%|█████████ | 9/10 [13:38<01:32, 92.75s/it][A[2024-05-30 21:25:29,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=999, skipped=0, lr=[1.8921738746574138e-05], mom=[(0.9, 0.999)]
steps: 999 loss: 0.5796 iter time (s): 94.171 samples/sec: 1.359

 90%|█████████ | 9/10 [13:40<01:32, 92.77s/it][A
 90%|█████████ | 9/10 [13:40<01:32, 92.80s/it][A
 90%|█████████ | 9/10 [13:40<01:32, 92.81s/it][A
 90%|█████████ | 9/10 [13:40<01:32, 92.78s/it][A
 90%|█████████ | 9/10 [13:41<01:32, 92.81s/it][A
 90%|█████████ | 9/10 [13:41<01:32, 92.81s/it][A
 90%|█████████ | 9/10 [13:41<01:32, 92.80s/it][A
100%|██████████| 10/10 [15:13<00:00, 93.44s/it][A100%|██████████| 10/10 [15:13<00:00, 91.34s/it]
 19%|█▉        | 101/520 [7:07:57<129:12:39, 1110.17s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 21:27:04,914] [INFO] [logging.py:96:log_dist] [Rank 0] step=1000, skipped=0, lr=[1.8919179003438316e-05], mom=[(0.9, 0.999)]
steps: 1000 loss: 0.5694 iter time (s): 94.135 samples/sec: 1.360

100%|██████████| 10/10 [15:15<00:00, 93.47s/it][A100%|██████████| 10/10 [15:15<00:00, 91.56s/it]
 19%|█▉        | 101/520 [7:08:09<129:13:47, 1110.33s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:15<00:00, 93.47s/it][A100%|██████████| 10/10 [15:15<00:00, 91.57s/it]
 19%|█▉        | 101/520 [7:08:28<129:13:55, 1110.35s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:15<00:00, 93.47s/it][A100%|██████████| 10/10 [15:15<00:00, 91.58s/it]
 19%|█▉        | 101/520 [7:09:09<129:14:01, 1110.36s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:15<00:00, 93.46s/it][A100%|██████████| 10/10 [15:15<00:00, 91.59s/it]
 19%|█▉        | 101/520 [7:08:27<129:14:02, 1110.37s/it]
100%|██████████| 10/10 [15:15<00:00, 93.46s/it][A100%|██████████| 10/10 [15:15<00:00, 91.60s/it]
 19%|█▉        | 101/520 [7:08:12<129:14:05, 1110.37s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:16<00:00, 93.46s/it][A100%|██████████| 10/10 [15:16<00:00, 91.60s/it]
 19%|█▉        | 101/520 [7:08:09<129:14:10, 1110.38s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:16<00:00, 93.47s/it][A100%|██████████| 10/10 [15:16<00:00, 91.61s/it]
 19%|█▉        | 101/520 [7:08:08<129:14:13, 1110.39s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_223
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:06<10:01, 66.84s/it][A[2024-05-30 21:28:11,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=1001, skipped=0, lr=[1.8916616399129296e-05], mom=[(0.9, 0.999)]
steps: 1001 loss: 0.6773 iter time (s): 65.655 samples/sec: 1.950

 10%|█         | 1/10 [01:06<09:58, 66.55s/it][A
 10%|█         | 1/10 [01:06<09:59, 66.59s/it][A
 10%|█         | 1/10 [01:06<09:58, 66.52s/it][A
 10%|█         | 1/10 [01:06<09:58, 66.46s/it][A
 10%|█         | 1/10 [01:06<09:58, 66.46s/it][A
 10%|█         | 1/10 [01:06<09:58, 66.45s/it][A
 10%|█         | 1/10 [01:06<09:58, 66.48s/it][A
 20%|██        | 2/10 [02:12<08:49, 66.23s/it][A[2024-05-30 21:29:17,386] [INFO] [logging.py:96:log_dist] [Rank 0] step=1002, skipped=0, lr=[1.891405093446922e-05], mom=[(0.9, 0.999)]
steps: 1002 loss: 0.6437 iter time (s): 65.111 samples/sec: 1.966

 20%|██        | 2/10 [02:12<08:48, 66.04s/it][A
 20%|██        | 2/10 [02:12<08:48, 66.09s/it][A
 20%|██        | 2/10 [02:12<08:48, 66.05s/it][A
 20%|██        | 2/10 [02:12<08:48, 66.02s/it][A
 20%|██        | 2/10 [02:12<08:48, 66.03s/it][A
 20%|██        | 2/10 [02:12<08:48, 66.03s/it][A
 20%|██        | 2/10 [02:12<08:48, 66.04s/it][A
 30%|███       | 3/10 [03:17<07:38, 65.44s/it][A[2024-05-30 21:30:21,895] [INFO] [logging.py:96:log_dist] [Rank 0] step=1003, skipped=0, lr=[1.8911482610281158e-05], mom=[(0.9, 0.999)]
steps: 1003 loss: 0.6584 iter time (s): 63.896 samples/sec: 2.003

 30%|███       | 3/10 [03:16<07:37, 65.35s/it][A
 30%|███       | 3/10 [03:16<07:37, 65.36s/it][A
 30%|███       | 3/10 [03:16<07:37, 65.34s/it][A
 30%|███       | 3/10 [03:16<07:37, 65.35s/it][A
 30%|███       | 3/10 [03:16<07:37, 65.34s/it][A
 30%|███       | 3/10 [03:16<07:37, 65.35s/it][A
 30%|███       | 3/10 [03:16<07:37, 65.35s/it][A
 40%|████      | 4/10 [04:20<06:28, 64.73s/it][A[2024-05-30 21:31:25,523] [INFO] [logging.py:96:log_dist] [Rank 0] step=1004, skipped=0, lr=[1.8908911427389093e-05], mom=[(0.9, 0.999)]
steps: 1004 loss: 0.6638 iter time (s): 62.993 samples/sec: 2.032

 40%|████      | 4/10 [04:20<06:28, 64.67s/it][A
 40%|████      | 4/10 [04:20<06:28, 64.67s/it][A
 40%|████      | 4/10 [04:20<06:27, 64.66s/it][A
 40%|████      | 4/10 [04:20<06:28, 64.68s/it][A

 40%|████      | 4/10 [04:20<06:28, 64.68s/it][A 40%|████      | 4/10 [04:20<06:28, 64.67s/it][A
 40%|████      | 4/10 [04:20<06:28, 64.67s/it][A
 50%|█████     | 5/10 [05:24<05:22, 64.51s/it][A[2024-05-30 21:32:29,660] [INFO] [logging.py:96:log_dist] [Rank 0] step=1005, skipped=0, lr=[1.8906337386617916e-05], mom=[(0.9, 0.999)]
steps: 1005 loss: 0.6400 iter time (s): 63.489 samples/sec: 2.016

 50%|█████     | 5/10 [05:24<05:22, 64.50s/it][A
 50%|█████     | 5/10 [05:24<05:22, 64.47s/it][A
 50%|█████     | 5/10 [05:24<05:22, 64.49s/it][A
 50%|█████     | 5/10 [05:24<05:22, 64.48s/it][A
 50%|█████     | 5/10 [05:24<05:22, 64.48s/it][A
 50%|█████     | 5/10 [05:24<05:22, 64.47s/it][A
 50%|█████     | 5/10 [05:24<05:22, 64.48s/it][A
 60%|██████    | 6/10 [06:32<04:21, 65.43s/it][A[2024-05-30 21:33:36,871] [INFO] [logging.py:96:log_dist] [Rank 0] step=1006, skipped=0, lr=[1.890376048879345e-05], mom=[(0.9, 0.999)]
steps: 1006 loss: 0.6302 iter time (s): 66.548 samples/sec: 1.923

 60%|██████    | 6/10 [06:31<04:21, 65.39s/it][A
 60%|██████    | 6/10 [06:31<04:21, 65.40s/it][A
 60%|██████    | 6/10 [06:31<04:21, 65.41s/it][A
 60%|██████    | 6/10 [06:31<04:21, 65.39s/it][A
 60%|██████    | 6/10 [06:31<04:21, 65.40s/it][A
 60%|██████    | 6/10 [06:31<04:21, 65.39s/it][A
 60%|██████    | 6/10 [06:31<04:21, 65.40s/it][A
 70%|███████   | 7/10 [07:39<03:18, 66.17s/it][A[2024-05-30 21:34:44,559] [INFO] [logging.py:96:log_dist] [Rank 0] step=1007, skipped=0, lr=[1.8901180734742436e-05], mom=[(0.9, 0.999)]
steps: 1007 loss: 0.6656 iter time (s): 67.077 samples/sec: 1.908

 70%|███████   | 7/10 [07:39<03:18, 66.16s/it][A
 70%|███████   | 7/10 [07:39<03:18, 66.15s/it][A
 70%|███████   | 7/10 [07:39<03:18, 66.15s/it][A
 70%|███████   | 7/10 [07:39<03:18, 66.15s/it][A
 70%|███████   | 7/10 [07:39<03:18, 66.16s/it][A
 70%|███████   | 7/10 [07:39<03:18, 66.15s/it][A
 70%|███████   | 7/10 [07:39<03:18, 66.16s/it][A
 80%|████████  | 8/10 [08:45<02:12, 66.09s/it][A[2024-05-30 21:35:50,478] [INFO] [logging.py:96:log_dist] [Rank 0] step=1008, skipped=0, lr=[1.8898598125292504e-05], mom=[(0.9, 0.999)]
steps: 1008 loss: 0.6321 iter time (s): 65.320 samples/sec: 1.960

 80%|████████  | 8/10 [08:45<02:12, 66.11s/it][A
 80%|████████  | 8/10 [08:45<02:12, 66.12s/it][A
 80%|████████  | 8/10 [08:45<02:12, 66.09s/it][A
 80%|████████  | 8/10 [08:45<02:12, 66.09s/it][A
 80%|████████  | 8/10 [08:45<02:12, 66.10s/it][A
 80%|████████  | 8/10 [08:45<02:12, 66.09s/it][A
 80%|████████  | 8/10 [08:45<02:12, 66.09s/it][A
 90%|█████████ | 9/10 [09:51<01:05, 65.84s/it][A[2024-05-30 21:36:55,753] [INFO] [logging.py:96:log_dist] [Rank 0] step=1009, skipped=0, lr=[1.889601266127223e-05], mom=[(0.9, 0.999)]
steps: 1009 loss: 0.5906 iter time (s): 64.636 samples/sec: 1.980

 90%|█████████ | 9/10 [09:50<01:05, 65.82s/it][A
 90%|█████████ | 9/10 [09:50<01:05, 65.89s/it][A
 90%|█████████ | 9/10 [09:50<01:05, 65.90s/it][A
 90%|█████████ | 9/10 [09:50<01:05, 65.89s/it][A
 90%|█████████ | 9/10 [09:50<01:05, 65.90s/it][A
 90%|█████████ | 9/10 [09:50<01:05, 65.89s/it][A
 90%|█████████ | 9/10 [09:50<01:05, 65.90s/it][A
100%|██████████| 10/10 [10:58<00:00, 66.36s/it][A100%|██████████| 10/10 [10:58<00:00, 65.85s/it]
 20%|█▉        | 102/520 [7:18:56<113:13:18, 975.12s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 21:38:03,286] [INFO] [logging.py:96:log_dist] [Rank 0] step=1010, skipped=0, lr=[1.8893424343511098e-05], mom=[(0.9, 0.999)]
steps: 1010 loss: 0.6145 iter time (s): 66.674 samples/sec: 1.920

100%|██████████| 10/10 [10:58<00:00, 66.35s/it][A100%|██████████| 10/10 [10:58<00:00, 65.82s/it]
 20%|█▉        | 102/520 [7:19:07<113:12:25, 974.99s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:58<00:00, 66.32s/it][A100%|██████████| 10/10 [10:58<00:00, 65.82s/it]
 20%|█▉        | 102/520 [7:19:26<113:12:28, 975.00s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:58<00:00, 66.33s/it][A100%|██████████| 10/10 [10:58<00:00, 65.82s/it]
 20%|█▉        | 102/520 [7:20:07<113:12:34, 975.01s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:58<00:00, 66.33s/it][A100%|██████████| 10/10 [10:58<00:00, 65.81s/it]
 20%|█▉        | 102/520 [7:19:26<113:12:34, 975.01s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:58<00:00, 66.32s/it][A100%|██████████| 10/10 [10:58<00:00, 65.81s/it]
 20%|█▉        | 102/520 [7:19:10<113:12:30, 975.00s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:58<00:00, 66.32s/it][A100%|██████████| 10/10 [10:58<00:00, 65.81s/it]
 20%|█▉        | 102/520 [7:19:07<113:12:31, 975.00s/it] 
100%|██████████| 10/10 [10:58<00:00, 66.33s/it][A100%|██████████| 10/10 [10:58<00:00, 65.81s/it]
 20%|█▉        | 102/520 [7:19:06<113:12:30, 975.00s/it] Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_253

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:32<13:51, 92.42s/it][A[2024-05-30 21:39:37,388] [INFO] [logging.py:96:log_dist] [Rank 0] step=1011, skipped=0, lr=[1.88908331728395e-05], mom=[(0.9, 0.999)]
steps: 1011 loss: 0.4828 iter time (s): 93.278 samples/sec: 1.372

 10%|█         | 1/10 [01:34<14:07, 94.12s/it][A
 10%|█         | 1/10 [01:34<14:08, 94.27s/it][A
 10%|█         | 1/10 [01:34<14:08, 94.28s/it][A
 10%|█         | 1/10 [01:34<14:09, 94.34s/it][A
 10%|█         | 1/10 [01:34<14:09, 94.44s/it][A
 10%|█         | 1/10 [01:35<14:16, 95.15s/it][A
 10%|█         | 1/10 [01:35<14:18, 95.39s/it][A
 20%|██        | 2/10 [03:11<12:49, 96.13s/it][A[2024-05-30 21:41:16,082] [INFO] [logging.py:96:log_dist] [Rank 0] step=1012, skipped=0, lr=[1.888823915008875e-05], mom=[(0.9, 0.999)]
steps: 1012 loss: 0.4941 iter time (s): 96.842 samples/sec: 1.322

 20%|██        | 2/10 [03:12<12:54, 96.84s/it][A
 20%|██        | 2/10 [03:12<12:54, 96.85s/it][A
 20%|██        | 2/10 [03:13<12:55, 96.90s/it][A
 20%|██        | 2/10 [03:13<12:55, 96.98s/it][A
 20%|██        | 2/10 [03:13<12:55, 96.98s/it][A
 20%|██        | 2/10 [03:13<12:54, 96.85s/it][A
 20%|██        | 2/10 [03:13<12:54, 96.80s/it][A
 30%|███       | 3/10 [04:46<11:09, 95.65s/it][A[2024-05-30 21:42:51,180] [INFO] [logging.py:96:log_dist] [Rank 0] step=1013, skipped=0, lr=[1.8885642276091073e-05], mom=[(0.9, 0.999)]
steps: 1013 loss: 0.4666 iter time (s): 94.015 samples/sec: 1.361

 30%|███       | 3/10 [04:47<11:12, 96.03s/it][A
 30%|███       | 3/10 [04:48<11:12, 96.07s/it][A
 30%|███       | 3/10 [04:48<11:12, 96.04s/it][A
 30%|███       | 3/10 [04:48<11:12, 96.02s/it][A
 30%|███       | 3/10 [04:48<11:12, 96.03s/it][A
 30%|███       | 3/10 [04:48<11:11, 95.94s/it][A
 30%|███       | 3/10 [04:48<11:11, 95.91s/it][A
 40%|████      | 4/10 [06:18<09:25, 94.26s/it][A[2024-05-30 21:44:23,294] [INFO] [logging.py:96:log_dist] [Rank 0] step=1014, skipped=0, lr=[1.8883042551679613e-05], mom=[(0.9, 0.999)]
steps: 1014 loss: 0.5445 iter time (s): 91.236 samples/sec: 1.403

 40%|████      | 4/10 [06:19<09:26, 94.42s/it][A
 40%|████      | 4/10 [06:20<09:26, 94.44s/it][A
 40%|████      | 4/10 [06:19<09:26, 94.41s/it][A
 40%|████      | 4/10 [06:20<09:26, 94.44s/it][A
 40%|████      | 4/10 [06:20<09:26, 94.43s/it][A
 40%|████      | 4/10 [06:20<09:26, 94.37s/it][A
 40%|████      | 4/10 [06:20<09:26, 94.37s/it][A
 50%|█████     | 5/10 [07:53<07:52, 94.52s/it][A[2024-05-30 21:45:58,256] [INFO] [logging.py:96:log_dist] [Rank 0] step=1015, skipped=0, lr=[1.888043997768842e-05], mom=[(0.9, 0.999)]
steps: 1015 loss: 0.5143 iter time (s): 94.268 samples/sec: 1.358

 50%|█████     | 5/10 [07:54<07:53, 94.66s/it][A
 50%|█████     | 5/10 [07:54<07:53, 94.63s/it][A
 50%|█████     | 5/10 [07:55<07:53, 94.65s/it][A
 50%|█████     | 5/10 [07:55<07:53, 94.67s/it][A
 50%|█████     | 5/10 [07:55<07:53, 94.68s/it][A
 50%|█████     | 5/10 [07:55<07:53, 94.64s/it][A
 50%|█████     | 5/10 [07:55<07:53, 94.63s/it][A
 60%|██████    | 6/10 [09:26<06:16, 94.19s/it][A[2024-05-30 21:47:31,809] [INFO] [logging.py:96:log_dist] [Rank 0] step=1016, skipped=0, lr=[1.887783455495247e-05], mom=[(0.9, 0.999)]
steps: 1016 loss: 0.4801 iter time (s): 92.672 samples/sec: 1.381

 60%|██████    | 6/10 [09:28<06:17, 94.28s/it][A
 60%|██████    | 6/10 [09:28<06:17, 94.27s/it][A
 60%|██████    | 6/10 [09:28<06:17, 94.27s/it][A
 60%|██████    | 6/10 [09:28<06:17, 94.28s/it][A
 60%|██████    | 6/10 [09:28<06:17, 94.27s/it][A
 60%|██████    | 6/10 [09:28<06:17, 94.25s/it][A
 60%|██████    | 6/10 [09:28<06:16, 94.24s/it][A
 70%|███████   | 7/10 [11:05<04:47, 95.68s/it][A[2024-05-30 21:49:10,550] [INFO] [logging.py:96:log_dist] [Rank 0] step=1017, skipped=0, lr=[1.8875226284307645e-05], mom=[(0.9, 0.999)]
steps: 1017 loss: 0.5055 iter time (s): 97.992 samples/sec: 1.306

 70%|███████   | 7/10 [11:07<04:47, 95.79s/it][A
 70%|███████   | 7/10 [11:07<04:47, 95.77s/it][A
 70%|███████   | 7/10 [11:07<04:47, 95.76s/it][A
 70%|███████   | 7/10 [11:07<04:47, 95.77s/it][A
 70%|███████   | 7/10 [11:07<04:47, 95.78s/it][A
 70%|███████   | 7/10 [11:07<04:47, 95.77s/it][A
 70%|███████   | 7/10 [11:07<04:47, 95.76s/it][A
 80%|████████  | 8/10 [12:35<03:07, 93.93s/it][A[2024-05-30 21:50:40,714] [INFO] [logging.py:96:log_dist] [Rank 0] step=1018, skipped=0, lr=[1.8872615166590748e-05], mom=[(0.9, 0.999)]
steps: 1018 loss: 0.4640 iter time (s): 89.317 samples/sec: 1.433

 80%|████████  | 8/10 [12:37<03:07, 93.97s/it][A
 80%|████████  | 8/10 [12:37<03:07, 93.97s/it][A
 80%|████████  | 8/10 [12:37<03:07, 93.99s/it][A
 80%|████████  | 8/10 [12:37<03:07, 94.00s/it][A
 80%|████████  | 8/10 [12:37<03:07, 93.98s/it][A
 80%|████████  | 8/10 [12:37<03:07, 93.97s/it][A
 80%|████████  | 8/10 [12:37<03:07, 93.97s/it][A
 90%|█████████ | 9/10 [14:06<01:32, 92.98s/it][A[2024-05-30 21:52:11,644] [INFO] [logging.py:96:log_dist] [Rank 0] step=1019, skipped=0, lr=[1.8870001202639483e-05], mom=[(0.9, 0.999)]
steps: 1019 loss: 0.4873 iter time (s): 89.973 samples/sec: 1.423

 90%|█████████ | 9/10 [14:08<01:33, 93.01s/it][A
 90%|█████████ | 9/10 [14:08<01:32, 92.99s/it][A
 90%|█████████ | 9/10 [14:08<01:32, 93.00s/it][A
 90%|█████████ | 9/10 [14:08<01:32, 92.99s/it][A
 90%|█████████ | 9/10 [14:08<01:32, 93.00s/it][A
 90%|█████████ | 9/10 [14:08<01:32, 92.99s/it][A
 90%|█████████ | 9/10 [14:08<01:32, 92.98s/it][A
100%|██████████| 10/10 [15:36<00:00, 92.04s/it][A100%|██████████| 10/10 [15:36<00:00, 93.66s/it]
 20%|█▉        | 103/520 [7:34:33<111:39:05, 963.90s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 21:53:41,590] [INFO] [logging.py:96:log_dist] [Rank 0] step=1020, skipped=0, lr=[1.886738439329248e-05], mom=[(0.9, 0.999)]
steps: 1020 loss: 0.4770 iter time (s): 89.090 samples/sec: 1.437

100%|██████████| 10/10 [15:38<00:00, 92.05s/it][A100%|██████████| 10/10 [15:38<00:00, 93.83s/it]
 20%|█▉        | 103/520 [7:34:45<111:39:55, 964.02s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:38<00:00, 92.06s/it][A100%|██████████| 10/10 [15:38<00:00, 93.83s/it]
 20%|█▉        | 103/520 [7:35:04<111:40:05, 964.04s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:38<00:00, 92.05s/it][A100%|██████████| 10/10 [15:38<00:00, 93.84s/it]
 20%|█▉        | 103/520 [7:35:46<111:40:06, 964.04s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:38<00:00, 92.07s/it][A100%|██████████| 10/10 [15:38<00:00, 93.85s/it]
 20%|█▉        | 103/520 [7:35:04<111:40:15, 964.06s/it]
100%|██████████| 10/10 [15:38<00:00, 92.06s/it][A100%|██████████| 10/10 [15:38<00:00, 93.85s/it]
 20%|█▉        | 103/520 [7:34:48<111:40:14, 964.06s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:38<00:00, 92.06s/it][A100%|██████████| 10/10 [15:38<00:00, 93.84s/it]
 20%|█▉        | 103/520 [7:34:45<111:40:17, 964.07s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:38<00:00, 92.05s/it][A100%|██████████| 10/10 [15:38<00:00, 93.84s/it]
 20%|█▉        | 103/520 [7:34:45<111:40:15, 964.07s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_241
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:05<09:53, 65.90s/it][A[2024-05-30 21:54:47,303] [INFO] [logging.py:96:log_dist] [Rank 0] step=1021, skipped=0, lr=[1.886476473938927e-05], mom=[(0.9, 0.999)]
steps: 1021 loss: 0.5881 iter time (s): 64.792 samples/sec: 1.976

 10%|█         | 1/10 [01:05<09:50, 65.60s/it][A
 10%|█         | 1/10 [01:05<09:49, 65.50s/it][A
 10%|█         | 1/10 [01:05<09:48, 65.44s/it][A

 10%|█         | 1/10 [01:05<09:49, 65.53s/it][A 10%|█         | 1/10 [01:05<09:49, 65.54s/it][A
 10%|█         | 1/10 [01:05<09:49, 65.52s/it][A
 10%|█         | 1/10 [01:05<09:49, 65.54s/it][A
 20%|██        | 2/10 [02:08<08:31, 63.88s/it][A[2024-05-30 21:55:49,778] [INFO] [logging.py:96:log_dist] [Rank 0] step=1022, skipped=0, lr=[1.886214224177031e-05], mom=[(0.9, 0.999)]
steps: 1022 loss: 0.5778 iter time (s): 61.830 samples/sec: 2.070

 20%|██        | 2/10 [02:08<08:30, 63.79s/it][A
 20%|██        | 2/10 [02:07<08:29, 63.74s/it][A
 20%|██        | 2/10 [02:07<08:29, 63.69s/it][A
 20%|██        | 2/10 [02:07<08:29, 63.70s/it][A
 20%|██        | 2/10 [02:08<08:30, 63.75s/it][A
 20%|██        | 2/10 [02:08<08:29, 63.74s/it][A
 20%|██        | 2/10 [02:08<08:29, 63.74s/it][A
 30%|███       | 3/10 [03:11<07:23, 63.39s/it][A[2024-05-30 21:56:52,578] [INFO] [logging.py:96:log_dist] [Rank 0] step=1023, skipped=0, lr=[1.8859516901276963e-05], mom=[(0.9, 0.999)]
steps: 1023 loss: 0.6226 iter time (s): 62.151 samples/sec: 2.060

 30%|███       | 3/10 [03:10<07:23, 63.29s/it][A
 30%|███       | 3/10 [03:10<07:23, 63.35s/it][A
 30%|███       | 3/10 [03:10<07:23, 63.31s/it][A
 30%|███       | 3/10 [03:10<07:22, 63.27s/it][A
 30%|███       | 3/10 [03:10<07:22, 63.28s/it][A
 30%|███       | 3/10 [03:10<07:23, 63.30s/it][A
 30%|███       | 3/10 [03:10<07:23, 63.30s/it][A
 40%|████      | 4/10 [04:16<06:25, 64.29s/it][A[2024-05-30 21:57:58,239] [INFO] [logging.py:96:log_dist] [Rank 0] step=1024, skipped=0, lr=[1.8856888718751494e-05], mom=[(0.9, 0.999)]
steps: 1024 loss: 0.6086 iter time (s): 65.082 samples/sec: 1.967

 40%|████      | 4/10 [04:16<06:25, 64.27s/it][A
 40%|████      | 4/10 [04:16<06:25, 64.28s/it][A
 40%|████      | 4/10 [04:16<06:25, 64.26s/it][A
 40%|████      | 4/10 [04:16<06:25, 64.25s/it][A
 40%|████      | 4/10 [04:16<06:25, 64.25s/it][A
 40%|████      | 4/10 [04:16<06:25, 64.26s/it][A
 40%|████      | 4/10 [04:16<06:25, 64.26s/it][A
 50%|█████     | 5/10 [05:26<05:31, 66.21s/it][A[2024-05-30 21:59:07,843] [INFO] [logging.py:96:log_dist] [Rank 0] step=1025, skipped=0, lr=[1.88542576950371e-05], mom=[(0.9, 0.999)]
steps: 1025 loss: 0.6293 iter time (s): 68.933 samples/sec: 1.857

 50%|█████     | 5/10 [05:26<05:30, 66.16s/it][A
 50%|█████     | 5/10 [05:26<05:31, 66.21s/it][A
 50%|█████     | 5/10 [05:26<05:31, 66.24s/it][A
 50%|█████     | 5/10 [05:26<05:31, 66.25s/it][A
 50%|█████     | 5/10 [05:26<05:31, 66.24s/it][A
 50%|█████     | 5/10 [05:26<05:31, 66.25s/it][A
 50%|█████     | 5/10 [05:26<05:31, 66.24s/it][A
 60%|██████    | 6/10 [06:35<04:29, 67.31s/it][A[2024-05-30 22:00:17,310] [INFO] [logging.py:96:log_dist] [Rank 0] step=1026, skipped=0, lr=[1.8851623830977872e-05], mom=[(0.9, 0.999)]
steps: 1026 loss: 0.6421 iter time (s): 68.624 samples/sec: 1.865

 60%|██████    | 6/10 [06:35<04:29, 67.31s/it][A
 60%|██████    | 6/10 [06:35<04:29, 67.31s/it][A
 60%|██████    | 6/10 [06:35<04:29, 67.27s/it][A
 60%|██████    | 6/10 [06:35<04:29, 67.27s/it][A
 60%|██████    | 6/10 [06:35<04:29, 67.27s/it][A
 60%|██████    | 6/10 [06:35<04:29, 67.28s/it][A
 60%|██████    | 6/10 [06:35<04:29, 67.28s/it][A
 70%|███████   | 7/10 [07:44<03:23, 67.86s/it][A[2024-05-30 22:01:26,311] [INFO] [logging.py:96:log_dist] [Rank 0] step=1027, skipped=0, lr=[1.8848987127418817e-05], mom=[(0.9, 0.999)]
steps: 1027 loss: 0.6519 iter time (s): 68.319 samples/sec: 1.874

 70%|███████   | 7/10 [07:44<03:23, 67.83s/it][A
 70%|███████   | 7/10 [07:44<03:23, 67.83s/it][A
 70%|███████   | 7/10 [07:44<03:23, 67.85s/it][A
 70%|███████   | 7/10 [07:44<03:23, 67.83s/it][A
 70%|███████   | 7/10 [07:44<03:23, 67.85s/it][A
 70%|███████   | 7/10 [07:44<03:23, 67.83s/it][A
 70%|███████   | 7/10 [07:44<03:23, 67.83s/it][A
 80%|████████  | 8/10 [08:50<02:14, 67.30s/it][A[2024-05-30 22:02:32,410] [INFO] [logging.py:96:log_dist] [Rank 0] step=1028, skipped=0, lr=[1.8846347585205866e-05], mom=[(0.9, 0.999)]
steps: 1028 loss: 0.5773 iter time (s): 65.420 samples/sec: 1.957

 80%|████████  | 8/10 [08:50<02:14, 67.29s/it][A
 80%|████████  | 8/10 [08:50<02:14, 67.27s/it][A
 80%|████████  | 8/10 [08:50<02:14, 67.26s/it][A
 80%|████████  | 8/10 [08:50<02:14, 67.26s/it][A
 80%|████████  | 8/10 [08:50<02:14, 67.27s/it][A
 80%|████████  | 8/10 [08:50<02:14, 67.28s/it][A
 80%|████████  | 8/10 [08:50<02:14, 67.27s/it][A
 90%|█████████ | 9/10 [10:00<01:08, 68.01s/it][A[2024-05-30 22:03:41,977] [INFO] [logging.py:96:log_dist] [Rank 0] step=1029, skipped=0, lr=[1.8843705205185838e-05], mom=[(0.9, 0.999)]
steps: 1029 loss: 0.6078 iter time (s): 68.946 samples/sec: 1.857

 90%|█████████ | 9/10 [10:00<01:08, 68.01s/it][A
 90%|█████████ | 9/10 [10:00<01:07, 68.00s/it][A
 90%|█████████ | 9/10 [10:00<01:07, 67.99s/it][A
 90%|█████████ | 9/10 [10:00<01:08, 68.00s/it][A
 90%|█████████ | 9/10 [10:00<01:07, 67.99s/it][A
 90%|█████████ | 9/10 [10:00<01:08, 68.01s/it][A
 90%|█████████ | 9/10 [10:00<01:07, 68.00s/it][A
100%|██████████| 10/10 [11:07<00:00, 67.63s/it][A100%|██████████| 10/10 [11:07<00:00, 66.74s/it]
 20%|██        | 104/520 [7:45:41<101:07:48, 875.17s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 22:04:48,763] [INFO] [logging.py:96:log_dist] [Rank 0] step=1030, skipped=0, lr=[1.884105998820648e-05], mom=[(0.9, 0.999)]
steps: 1030 loss: 0.6049 iter time (s): 66.173 samples/sec: 1.934

100%|██████████| 10/10 [11:07<00:00, 67.63s/it][A100%|██████████| 10/10 [11:07<00:00, 66.71s/it]
 20%|██        | 104/520 [7:45:53<101:06:58, 875.04s/it]
100%|██████████| 10/10 [11:06<00:00, 67.60s/it][A100%|██████████| 10/10 [11:06<00:00, 66.69s/it]
 20%|██        | 104/520 [7:46:11<101:06:49, 875.02s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:06<00:00, 67.63s/it][A100%|██████████| 10/10 [11:06<00:00, 66.70s/it]
 20%|██        | 104/520 [7:46:53<101:07:00, 875.05s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:06<00:00, 67.62s/it][A100%|██████████| 10/10 [11:06<00:00, 66.70s/it]
 20%|██        | 104/520 [7:46:11<101:06:58, 875.04s/it]
100%|██████████| 10/10 [11:06<00:00, 67.61s/it][A100%|██████████| 10/10 [11:06<00:00, 66.70s/it]
 20%|██        | 104/520 [7:45:55<101:06:54, 875.04s/it]
100%|██████████| 10/10 [11:06<00:00, 67.62s/it][A100%|██████████| 10/10 [11:06<00:00, 66.70s/it]
 20%|██        | 104/520 [7:45:52<101:06:53, 875.03s/it]
100%|██████████| 10/10 [11:06<00:00, 67.62s/it][A100%|██████████| 10/10 [11:06<00:00, 66.70s/it]
 20%|██        | 104/520 [7:45:52<101:06:54, 875.03s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_344

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:37<14:34, 97.13s/it][A[2024-05-30 22:06:27,223] [INFO] [logging.py:96:log_dist] [Rank 0] step=1031, skipped=0, lr=[1.883841193511644e-05], mom=[(0.9, 0.999)]
steps: 1031 loss: 0.5728 iter time (s): 97.716 samples/sec: 1.310

 10%|█         | 1/10 [01:38<14:46, 98.52s/it][A
 10%|█         | 1/10 [01:38<14:47, 98.58s/it][A
 10%|█         | 1/10 [01:38<14:47, 98.61s/it][A
 10%|█         | 1/10 [01:38<14:47, 98.65s/it][A
 10%|█         | 1/10 [01:38<14:48, 98.68s/it][A
 10%|█         | 1/10 [01:38<14:47, 98.66s/it][A
 10%|█         | 1/10 [01:38<14:48, 98.70s/it][A
 20%|██        | 2/10 [03:14<12:57, 97.25s/it][A[2024-05-30 22:08:04,558] [INFO] [logging.py:96:log_dist] [Rank 0] step=1032, skipped=0, lr=[1.8835761046765285e-05], mom=[(0.9, 0.999)]
steps: 1032 loss: 0.5817 iter time (s): 96.422 samples/sec: 1.328

 20%|██        | 2/10 [03:15<13:02, 97.84s/it][A
 20%|██        | 2/10 [03:15<13:03, 97.90s/it][A
 20%|██        | 2/10 [03:15<13:02, 97.85s/it][A
 20%|██        | 2/10 [03:16<13:03, 97.99s/it][A
 20%|██        | 2/10 [03:16<13:03, 97.90s/it][A
 20%|██        | 2/10 [03:16<13:03, 97.95s/it][A
 20%|██        | 2/10 [03:16<13:03, 97.93s/it][A
 30%|███       | 3/10 [04:48<11:10, 95.73s/it][A[2024-05-30 22:09:38,481] [INFO] [logging.py:96:log_dist] [Rank 0] step=1033, skipped=0, lr=[1.8833107324003475e-05], mom=[(0.9, 0.999)]
steps: 1033 loss: 0.5850 iter time (s): 92.946 samples/sec: 1.377

 30%|███       | 3/10 [04:49<11:12, 96.08s/it][A
 30%|███       | 3/10 [04:49<11:12, 96.05s/it][A
 30%|███       | 3/10 [04:50<11:12, 96.13s/it][A
 30%|███       | 3/10 [04:49<11:12, 96.11s/it][A
 30%|███       | 3/10 [04:50<11:12, 96.12s/it][A
 30%|███       | 3/10 [04:50<11:13, 96.17s/it][A
 30%|███       | 3/10 [04:50<11:13, 96.16s/it][A
 40%|████      | 4/10 [06:21<09:29, 94.85s/it][A[2024-05-30 22:11:11,987] [INFO] [logging.py:96:log_dist] [Rank 0] step=1034, skipped=0, lr=[1.8830450767682405e-05], mom=[(0.9, 0.999)]
steps: 1034 loss: 0.5851 iter time (s): 92.399 samples/sec: 1.385

 40%|████      | 4/10 [06:23<09:29, 94.99s/it][A
 40%|████      | 4/10 [06:23<09:30, 95.01s/it][A
 40%|████      | 4/10 [06:23<09:30, 95.02s/it][A
 40%|████      | 4/10 [06:23<09:30, 95.01s/it][A
 40%|████      | 4/10 [06:23<09:30, 95.00s/it][A
 40%|████      | 4/10 [06:23<09:30, 95.01s/it][A
 40%|████      | 4/10 [06:23<09:30, 95.01s/it][A
 50%|█████     | 5/10 [07:54<07:49, 93.99s/it][A[2024-05-30 22:12:44,449] [INFO] [logging.py:96:log_dist] [Rank 0] step=1035, skipped=0, lr=[1.882779137865435e-05], mom=[(0.9, 0.999)]
steps: 1035 loss: 0.5844 iter time (s): 91.655 samples/sec: 1.397

 50%|█████     | 5/10 [07:55<07:50, 94.08s/it][A
 50%|█████     | 5/10 [07:55<07:50, 94.12s/it][A
 50%|█████     | 5/10 [07:55<07:50, 94.11s/it][A
 50%|█████     | 5/10 [07:55<07:50, 94.11s/it][A
 50%|█████     | 5/10 [07:55<07:50, 94.09s/it][A
 50%|█████     | 5/10 [07:55<07:50, 94.11s/it][A
 50%|█████     | 5/10 [07:55<07:50, 94.11s/it][A
 60%|██████    | 6/10 [09:25<06:12, 93.16s/it][A[2024-05-30 22:14:15,993] [INFO] [logging.py:96:log_dist] [Rank 0] step=1036, skipped=0, lr=[1.882512915777252e-05], mom=[(0.9, 0.999)]
steps: 1036 loss: 0.5841 iter time (s): 90.711 samples/sec: 1.411

 60%|██████    | 6/10 [09:27<06:12, 93.23s/it][A
 60%|██████    | 6/10 [09:27<06:12, 93.22s/it][A
 60%|██████    | 6/10 [09:27<06:12, 93.24s/it][A
 60%|██████    | 6/10 [09:27<06:12, 93.23s/it][A
 60%|██████    | 6/10 [09:27<06:12, 93.23s/it][A
 60%|██████    | 6/10 [09:27<06:12, 93.24s/it][A
 60%|██████    | 6/10 [09:27<06:12, 93.24s/it][A
 70%|███████   | 7/10 [10:59<04:39, 93.30s/it][A[2024-05-30 22:15:49,588] [INFO] [logging.py:96:log_dist] [Rank 0] step=1037, skipped=0, lr=[1.882246410589101e-05], mom=[(0.9, 0.999)]
steps: 1037 loss: 0.5770 iter time (s): 92.681 samples/sec: 1.381

 70%|███████   | 7/10 [11:00<04:40, 93.35s/it][A
 70%|███████   | 7/10 [11:01<04:40, 93.39s/it][A
 70%|███████   | 7/10 [11:01<04:40, 93.37s/it][A
 70%|███████   | 7/10 [11:00<04:40, 93.37s/it][A
 70%|███████   | 7/10 [11:01<04:40, 93.38s/it][A
 70%|███████   | 7/10 [11:01<04:40, 93.37s/it][A
 70%|███████   | 7/10 [11:01<04:40, 93.37s/it][A
 80%|████████  | 8/10 [12:29<03:04, 92.37s/it][A[2024-05-30 22:17:19,984] [INFO] [logging.py:96:log_dist] [Rank 0] step=1038, skipped=0, lr=[1.8819796223864843e-05], mom=[(0.9, 0.999)]
steps: 1038 loss: 0.5741 iter time (s): 89.485 samples/sec: 1.430

 80%|████████  | 8/10 [12:31<03:04, 92.42s/it][A
 80%|████████  | 8/10 [12:31<03:04, 92.39s/it][A
 80%|████████  | 8/10 [12:31<03:04, 92.39s/it][A
 80%|████████  | 8/10 [12:31<03:04, 92.41s/it][A
 80%|████████  | 8/10 [12:31<03:04, 92.44s/it][A
 80%|████████  | 8/10 [12:31<03:04, 92.43s/it][A
 80%|████████  | 8/10 [12:31<03:04, 92.43s/it][A
 90%|█████████ | 9/10 [14:00<01:31, 91.76s/it][A[2024-05-30 22:18:50,406] [INFO] [logging.py:96:log_dist] [Rank 0] step=1039, skipped=0, lr=[1.881712551254994e-05], mom=[(0.9, 0.999)]
steps: 1039 loss: 0.5647 iter time (s): 89.433 samples/sec: 1.431

 90%|█████████ | 9/10 [14:01<01:31, 91.76s/it][A
 90%|█████████ | 9/10 [14:01<01:31, 91.76s/it][A
 90%|█████████ | 9/10 [14:01<01:31, 91.77s/it][A
 90%|█████████ | 9/10 [14:01<01:31, 91.76s/it][A
 90%|█████████ | 9/10 [14:01<01:31, 91.78s/it][A
 90%|█████████ | 9/10 [14:01<01:31, 91.80s/it][A
 90%|█████████ | 9/10 [14:01<01:31, 91.79s/it][A
100%|██████████| 10/10 [15:31<00:00, 91.48s/it][A100%|██████████| 10/10 [15:31<00:00, 93.12s/it]
[2024-05-30 22:20:21,255] [INFO] [logging.py:96:log_dist] [Rank 0] step=1040, skipped=0, lr=[1.881445197280313e-05], mom=[(0.9, 0.999)]
steps: 1040 loss: 0.5620 iter time (s): 89.894 samples/sec: 1.424

100%|██████████| 10/10 [15:32<00:00, 91.52s/it][A100%|██████████| 10/10 [15:32<00:00, 93.26s/it]

100%|██████████| 10/10 [15:32<00:00, 91.51s/it][A100%|██████████| 10/10 [15:32<00:00, 93.26s/it]

100%|██████████| 10/10 [15:32<00:00, 91.54s/it][A100%|██████████| 10/10 [15:32<00:00, 93.28s/it]

100%|██████████| 10/10 [15:32<00:00, 91.52s/it][A100%|██████████| 10/10 [15:32<00:00, 93.27s/it]

100%|██████████| 10/10 [15:32<00:00, 91.50s/it][A100%|██████████| 10/10 [15:32<00:00, 93.28s/it]

100%|██████████| 10/10 [15:32<00:00, 91.52s/it][A100%|██████████| 10/10 [15:32<00:00, 93.27s/it]

100%|██████████| 10/10 [15:32<00:00, 91.52s/it][A100%|██████████| 10/10 [15:32<00:00, 93.28s/it]
Checkpointing at shard 105
[2024-05-30 22:20:22,328] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step1040 is about to be saved!
[2024-05-30 22:20:24,051] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_00-model_states.pt...
[2024-05-30 22:20:27,368] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_05-model_states.pt...
[2024-05-30 22:20:30,350] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_08-model_states.pt...
[2024-05-30 22:20:30,863] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_07-model_states.pt...
[2024-05-30 22:20:31,109] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_06-model_states.pt...
[2024-05-30 22:20:33,220] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_02-model_states.pt...
[2024-05-30 22:20:33,347] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_00-model_states.pt.
[2024-05-30 22:20:35,210] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_03-model_states.pt...
[2024-05-30 22:20:35,416] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_04-model_states.pt...
[2024-05-30 22:20:41,040] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_01-model_states.pt...
[2024-05-30 22:29:05,386] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_05-model_states.pt.
[2024-05-30 22:29:05,448] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_04_model_states.pt...
[2024-05-30 22:29:06,313] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_04_model_states.pt.
[2024-05-30 22:29:06,313] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1040 is ready now!
[2024-05-30 22:31:15,689] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_01-model_states.pt.
[2024-05-30 22:31:16,282] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_00_model_states.pt
[2024-05-30 22:31:16,282] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_00_model_states.pt...
[2024-05-30 22:31:16,680] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_04-model_states.pt.
[2024-05-30 22:31:17,128] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_03_model_states.pt...
[2024-05-30 22:31:18,227] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_03_model_states.pt.
[2024-05-30 22:31:18,228] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1040 is ready now!
[2024-05-30 22:31:19,343] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_00_model_states.pt.
[2024-05-30 22:31:19,343] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1040 is ready now!
[2024-05-30 22:31:34,244] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_03-model_states.pt.
[2024-05-30 22:31:34,849] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_02_model_states.pt...
[2024-05-30 22:31:35,548] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_02_model_states.pt.
[2024-05-30 22:31:35,549] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1040 is ready now!
[2024-05-30 22:32:31,621] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_02-model_states.pt.
[2024-05-30 22:32:32,370] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_01_model_states.pt
[2024-05-30 22:32:32,370] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_01_model_states.pt...
[2024-05-30 22:32:33,151] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_01_model_states.pt.
[2024-05-30 22:32:33,151] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1040 is ready now!
[2024-05-30 22:33:17,486] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_06-model_states.pt.
[2024-05-30 22:33:18,340] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_05_model_states.pt...
[2024-05-30 22:33:19,757] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_05_model_states.pt.
[2024-05-30 22:33:19,757] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1040 is ready now!
[2024-05-30 22:33:25,717] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_07-model_states.pt.
[2024-05-30 22:33:26,658] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_06_model_states.pt...
[2024-05-30 22:33:27,432] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_06_model_states.pt.
[2024-05-30 22:33:27,432] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1040 is ready now!
[2024-05-30 22:33:34,732] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_08-model_states.pt.
[2024-05-30 22:33:35,306] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_09-model_states.pt...
[2024-05-30 22:33:37,382] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/layer_09-model_states.pt.
[2024-05-30 22:33:37,411] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_07_model_states.pt...
[2024-05-30 22:33:37,796] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1040/mp_rank_07_model_states.pt.
[2024-05-30 22:33:37,797] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1040 is ready now!
 20%|██        | 105/520 [8:14:31<130:26:00, 1131.47s/it]Checkpoint saved using --- 795.4739785194397 seconds ---
 20%|██        | 105/520 [8:14:41<130:21:39, 1130.84s/it] 20%|██        | 105/520 [8:15:00<130:21:47, 1130.86s/it] 20%|██        | 105/520 [8:14:44<130:21:43, 1130.85s/it] 20%|██        | 105/520 [8:15:41<130:21:57, 1130.88s/it] 20%|██        | 105/520 [8:14:40<130:21:36, 1130.84s/it] 20%|██        | 105/520 [8:15:00<130:22:12, 1130.92s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_85
 20%|██        | 105/520 [8:14:41<130:22:23, 1130.95s/it]Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A

  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:21<12:15, 81.67s/it][A[2024-05-30 22:35:01,954] [INFO] [logging.py:96:log_dist] [Rank 0] step=1041, skipped=0, lr=[1.8811775605482153e-05], mom=[(0.9, 0.999)]
steps: 1041 loss: 1.0979 iter time (s): 83.325 samples/sec: 1.536

 10%|█         | 1/10 [01:23<12:33, 83.68s/it][A
 10%|█         | 1/10 [01:23<12:34, 83.78s/it][A
 10%|█         | 1/10 [01:23<12:35, 83.97s/it][A
 10%|█         | 1/10 [01:24<12:36, 84.00s/it][A
 10%|█         | 1/10 [01:24<12:36, 84.05s/it][A
 10%|█         | 1/10 [01:24<12:36, 84.08s/it][A
 10%|█         | 1/10 [01:24<12:36, 84.11s/it][A
 20%|██        | 2/10 [02:45<11:04, 83.12s/it][A[2024-05-30 22:36:26,081] [INFO] [logging.py:96:log_dist] [Rank 0] step=1042, skipped=0, lr=[1.880909641144565e-05], mom=[(0.9, 0.999)]
steps: 1042 loss: 1.0956 iter time (s): 83.459 samples/sec: 1.534

 20%|██        | 2/10 [02:47<11:11, 83.95s/it][A
 20%|██        | 2/10 [02:47<11:12, 84.04s/it][A
 20%|██        | 2/10 [02:48<11:12, 84.08s/it][A
 20%|██        | 2/10 [02:48<11:12, 84.12s/it][A
 20%|██        | 2/10 [02:48<11:13, 84.18s/it][A
 20%|██        | 2/10 [02:48<11:13, 84.18s/it][A
 20%|██        | 2/10 [02:48<11:13, 84.18s/it][A
 30%|███       | 3/10 [04:08<09:39, 82.85s/it][A[2024-05-30 22:37:48,618] [INFO] [logging.py:96:log_dist] [Rank 0] step=1043, skipped=0, lr=[1.880641439155318e-05], mom=[(0.9, 0.999)]
steps: 1043 loss: 1.0735 iter time (s): 81.682 samples/sec: 1.567

 30%|███       | 3/10 [04:10<09:42, 83.27s/it][A
 30%|███       | 3/10 [04:10<09:43, 83.33s/it][A
 30%|███       | 3/10 [04:10<09:43, 83.35s/it][A
 30%|███       | 3/10 [04:10<09:43, 83.37s/it][A
 30%|███       | 3/10 [04:10<09:43, 83.38s/it][A
 30%|███       | 3/10 [04:10<09:43, 83.40s/it][A
 30%|███       | 3/10 [04:10<09:43, 83.40s/it][A
 40%|████      | 4/10 [05:31<08:18, 83.11s/it][A[2024-05-30 22:39:12,124] [INFO] [logging.py:96:log_dist] [Rank 0] step=1044, skipped=0, lr=[1.880372954666519e-05], mom=[(0.9, 0.999)]
steps: 1044 loss: 1.0848 iter time (s): 82.714 samples/sec: 1.547

 40%|████      | 4/10 [05:33<08:20, 83.38s/it][A
 40%|████      | 4/10 [05:33<08:20, 83.37s/it][A
 40%|████      | 4/10 [05:34<08:20, 83.38s/it][A
 40%|████      | 4/10 [05:34<08:20, 83.42s/it][A
 40%|████      | 4/10 [05:34<08:20, 83.42s/it][A
 40%|████      | 4/10 [05:34<08:20, 83.42s/it][A
 40%|████      | 4/10 [05:34<08:20, 83.43s/it][A
 50%|█████     | 5/10 [06:56<06:59, 83.82s/it][A[2024-05-30 22:40:37,214] [INFO] [logging.py:96:log_dist] [Rank 0] step=1045, skipped=0, lr=[1.880104187764306e-05], mom=[(0.9, 0.999)]
steps: 1045 loss: 1.0917 iter time (s): 84.328 samples/sec: 1.518

 50%|█████     | 5/10 [06:58<07:00, 84.02s/it][A
 50%|█████     | 5/10 [06:59<07:00, 84.04s/it][A
 50%|█████     | 5/10 [06:59<07:00, 84.04s/it][A
 50%|█████     | 5/10 [06:59<07:00, 84.03s/it][A
 50%|█████     | 5/10 [06:59<07:00, 84.07s/it][A
 50%|█████     | 5/10 [06:59<07:00, 84.09s/it][A
 50%|█████     | 5/10 [07:00<07:01, 84.33s/it][A
 60%|██████    | 6/10 [08:23<05:38, 84.65s/it][A[2024-05-30 22:42:03,473] [INFO] [logging.py:96:log_dist] [Rank 0] step=1046, skipped=0, lr=[1.8798351385349046e-05], mom=[(0.9, 0.999)]
steps: 1046 loss: 1.0621 iter time (s): 84.751 samples/sec: 1.510

 60%|██████    | 6/10 [08:25<05:39, 84.78s/it][A
 60%|██████    | 6/10 [08:25<05:39, 84.79s/it][A
 60%|██████    | 6/10 [08:25<05:39, 84.78s/it][A
 60%|██████    | 6/10 [08:25<05:39, 84.81s/it][A
 60%|██████    | 6/10 [08:25<05:39, 84.79s/it][A
 60%|██████    | 6/10 [08:25<05:39, 84.80s/it][A
 60%|██████    | 6/10 [08:25<05:38, 84.73s/it][A
 70%|███████   | 7/10 [09:47<04:13, 84.60s/it][A[2024-05-30 22:43:27,970] [INFO] [logging.py:96:log_dist] [Rank 0] step=1047, skipped=0, lr=[1.8795658070646338e-05], mom=[(0.9, 0.999)]
steps: 1047 loss: 1.0687 iter time (s): 83.681 samples/sec: 1.530

 70%|███████   | 7/10 [09:49<04:14, 84.67s/it][A
 70%|███████   | 7/10 [09:49<04:14, 84.68s/it][A
 70%|███████   | 7/10 [09:49<04:14, 84.70s/it][A
 70%|███████   | 7/10 [09:50<04:14, 84.69s/it][A

 70%|███████   | 7/10 [09:50<04:14, 84.69s/it][A 70%|███████   | 7/10 [09:50<04:14, 84.69s/it][A
 70%|███████   | 7/10 [09:50<04:13, 84.64s/it][A
 80%|████████  | 8/10 [11:12<02:49, 84.75s/it][A[2024-05-30 22:44:53,036] [INFO] [logging.py:96:log_dist] [Rank 0] step=1048, skipped=0, lr=[1.8792961934399006e-05], mom=[(0.9, 0.999)]
steps: 1048 loss: 1.0513 iter time (s): 84.277 samples/sec: 1.519

 80%|████████  | 8/10 [11:14<02:49, 84.80s/it][A
 80%|████████  | 8/10 [11:14<02:49, 84.79s/it][A
 80%|████████  | 8/10 [11:15<02:49, 84.80s/it][A
 80%|████████  | 8/10 [11:15<02:49, 84.80s/it][A
 80%|████████  | 8/10 [11:15<02:49, 84.80s/it][A
 80%|████████  | 8/10 [11:15<02:49, 84.80s/it][A
 80%|████████  | 8/10 [11:15<02:49, 84.77s/it][A
 90%|█████████ | 9/10 [12:37<01:24, 84.61s/it][A[2024-05-30 22:46:17,343] [INFO] [logging.py:96:log_dist] [Rank 0] step=1049, skipped=0, lr=[1.879026297747205e-05], mom=[(0.9, 0.999)]
steps: 1049 loss: 1.0300 iter time (s): 83.487 samples/sec: 1.533

 90%|█████████ | 9/10 [12:38<01:24, 84.60s/it][A
 90%|█████████ | 9/10 [12:39<01:24, 84.61s/it][A
 90%|█████████ | 9/10 [12:39<01:24, 84.62s/it][A
 90%|█████████ | 9/10 [12:39<01:24, 84.60s/it][A
 90%|█████████ | 9/10 [12:39<01:24, 84.60s/it][A
 90%|█████████ | 9/10 [12:39<01:24, 84.60s/it][A
 90%|█████████ | 9/10 [12:39<01:24, 84.60s/it][A
100%|██████████| 10/10 [14:00<00:00, 84.32s/it][A100%|██████████| 10/10 [14:00<00:00, 84.07s/it]
 20%|██        | 106/520 [8:28:33<120:07:26, 1044.56s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 22:47:40,598] [INFO] [logging.py:96:log_dist] [Rank 0] step=1050, skipped=0, lr=[1.878756120073135e-05], mom=[(0.9, 0.999)]
steps: 1050 loss: 1.0385 iter time (s): 82.532 samples/sec: 1.551

100%|██████████| 10/10 [14:02<00:00, 84.22s/it][A100%|██████████| 10/10 [14:02<00:00, 84.23s/it]
 20%|██        | 106/520 [8:28:44<120:08:08, 1044.66s/it]
100%|██████████| 10/10 [14:02<00:00, 84.20s/it][A100%|██████████| 10/10 [14:02<00:00, 84.24s/it]
 20%|██        | 106/520 [8:29:03<120:08:10, 1044.66s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:02<00:00, 84.21s/it][A100%|██████████| 10/10 [14:02<00:00, 84.25s/it]
 20%|██        | 106/520 [8:29:45<120:08:17, 1044.68s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:02<00:00, 84.22s/it][A100%|██████████| 10/10 [14:02<00:00, 84.26s/it]
 20%|██        | 106/520 [8:29:03<120:08:23, 1044.69s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:02<00:00, 84.22s/it][A100%|██████████| 10/10 [14:02<00:00, 84.27s/it]
 20%|██        | 106/520 [8:28:47<120:08:30, 1044.71s/it]
100%|██████████| 10/10 [14:02<00:00, 84.21s/it][A100%|██████████| 10/10 [14:02<00:00, 84.27s/it]
 20%|██        | 106/520 [8:28:44<120:08:28, 1044.71s/it]
100%|██████████| 10/10 [14:02<00:00, 84.19s/it][A100%|██████████| 10/10 [14:02<00:00, 84.27s/it]
 20%|██        | 106/520 [8:28:44<120:08:29, 1044.71s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_315

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:27<13:08, 87.66s/it][A[2024-05-30 22:49:09,305] [INFO] [logging.py:96:log_dist] [Rank 0] step=1051, skipped=0, lr=[1.878485660504371e-05], mom=[(0.9, 0.999)]
steps: 1051 loss: 0.5804 iter time (s): 87.646 samples/sec: 1.460

 10%|█         | 1/10 [01:28<13:17, 88.58s/it][A
 10%|█         | 1/10 [01:28<13:17, 88.62s/it][A
 10%|█         | 1/10 [01:28<13:18, 88.70s/it][A
 10%|█         | 1/10 [01:28<13:19, 88.81s/it][A
 10%|█         | 1/10 [01:28<13:18, 88.68s/it][A
 10%|█         | 1/10 [01:28<13:17, 88.66s/it][A
 10%|█         | 1/10 [01:28<13:17, 88.65s/it][A
 20%|██        | 2/10 [02:58<11:57, 89.72s/it][A[2024-05-30 22:50:40,016] [INFO] [logging.py:96:log_dist] [Rank 0] step=1052, skipped=0, lr=[1.8782149191276836e-05], mom=[(0.9, 0.999)]
steps: 1052 loss: 0.5745 iter time (s): 89.921 samples/sec: 1.423

 20%|██        | 2/10 [02:59<11:58, 89.87s/it][A
 20%|██        | 2/10 [02:59<11:59, 89.96s/it][A
 20%|██        | 2/10 [02:59<11:59, 89.89s/it][A
 20%|██        | 2/10 [02:59<12:00, 90.04s/it][A
 20%|██        | 2/10 [02:59<11:59, 89.98s/it][A
 20%|██        | 2/10 [02:59<12:00, 90.01s/it][A
 20%|██        | 2/10 [02:59<12:00, 90.00s/it][A
 30%|███       | 3/10 [04:26<10:21, 88.74s/it][A[2024-05-30 22:52:08,044] [INFO] [logging.py:96:log_dist] [Rank 0] step=1053, skipped=0, lr=[1.8779438960299324e-05], mom=[(0.9, 0.999)]
steps: 1053 loss: 0.5721 iter time (s): 87.002 samples/sec: 1.471

 30%|███       | 3/10 [04:27<10:23, 89.01s/it][A
 30%|███       | 3/10 [04:27<10:23, 89.03s/it][A
 30%|███       | 3/10 [04:27<10:23, 89.03s/it][A
 30%|███       | 3/10 [04:27<10:22, 88.99s/it][A
 30%|███       | 3/10 [04:27<10:23, 89.01s/it][A
 30%|███       | 3/10 [04:27<10:23, 89.01s/it][A
 30%|███       | 3/10 [04:27<10:23, 89.00s/it][A
 40%|████      | 4/10 [05:54<08:50, 88.38s/it][A[2024-05-30 22:53:35,865] [INFO] [logging.py:96:log_dist] [Rank 0] step=1054, skipped=0, lr=[1.8776725912980684e-05], mom=[(0.9, 0.999)]
steps: 1054 loss: 0.5875 iter time (s): 86.962 samples/sec: 1.472

 40%|████      | 4/10 [05:55<08:51, 88.53s/it][A
 40%|████      | 4/10 [05:55<08:51, 88.54s/it][A
 40%|████      | 4/10 [05:55<08:51, 88.54s/it][A
 40%|████      | 4/10 [05:55<08:51, 88.54s/it][A
 40%|████      | 4/10 [05:55<08:51, 88.53s/it][A
 40%|████      | 4/10 [05:55<08:51, 88.54s/it][A
 40%|████      | 4/10 [05:55<08:51, 88.53s/it][A
 50%|█████     | 5/10 [07:23<07:22, 88.53s/it][A[2024-05-30 22:55:04,670] [INFO] [logging.py:96:log_dist] [Rank 0] step=1055, skipped=0, lr=[1.8774010050191338e-05], mom=[(0.9, 0.999)]
steps: 1055 loss: 0.5927 iter time (s): 88.138 samples/sec: 1.452

 50%|█████     | 5/10 [07:24<07:23, 88.70s/it][A
 50%|█████     | 5/10 [07:24<07:23, 88.69s/it][A
 50%|█████     | 5/10 [07:24<07:23, 88.70s/it][A
 50%|█████     | 5/10 [07:24<07:23, 88.68s/it][A
 50%|█████     | 5/10 [07:24<07:23, 88.69s/it][A
 50%|█████     | 5/10 [07:24<07:23, 88.69s/it][A
 50%|█████     | 5/10 [07:24<07:23, 88.69s/it][A
 60%|██████    | 6/10 [08:50<05:52, 88.07s/it][A[2024-05-30 22:56:31,826] [INFO] [logging.py:96:log_dist] [Rank 0] step=1056, skipped=0, lr=[1.8771291372802595e-05], mom=[(0.9, 0.999)]
steps: 1056 loss: 0.5867 iter time (s): 86.256 samples/sec: 1.484

 60%|██████    | 6/10 [08:51<05:52, 88.13s/it][A
 60%|██████    | 6/10 [08:51<05:52, 88.16s/it][A
 60%|██████    | 6/10 [08:51<05:52, 88.14s/it][A
 60%|██████    | 6/10 [08:51<05:52, 88.15s/it][A
 60%|██████    | 6/10 [08:51<05:52, 88.14s/it][A
 60%|██████    | 6/10 [08:51<05:52, 88.14s/it][A
 60%|██████    | 6/10 [08:51<05:52, 88.14s/it][A
 70%|███████   | 7/10 [10:21<04:27, 89.10s/it][A[2024-05-30 22:58:03,077] [INFO] [logging.py:96:log_dist] [Rank 0] step=1057, skipped=0, lr=[1.8768569881686675e-05], mom=[(0.9, 0.999)]
steps: 1057 loss: 0.5893 iter time (s): 90.358 samples/sec: 1.417

 70%|███████   | 7/10 [10:22<04:27, 89.13s/it][A
 70%|███████   | 7/10 [10:22<04:27, 89.13s/it][A
 70%|███████   | 7/10 [10:22<04:27, 89.15s/it][A
 70%|███████   | 7/10 [10:22<04:27, 89.14s/it][A
 70%|███████   | 7/10 [10:22<04:27, 89.13s/it][A
 70%|███████   | 7/10 [10:22<04:27, 89.18s/it][A
 70%|███████   | 7/10 [10:22<04:27, 89.17s/it][A
 80%|████████  | 8/10 [11:50<02:58, 89.04s/it][A[2024-05-30 22:59:31,983] [INFO] [logging.py:96:log_dist] [Rank 0] step=1058, skipped=0, lr=[1.8765845577716696e-05], mom=[(0.9, 0.999)]
steps: 1058 loss: 0.5859 iter time (s): 88.007 samples/sec: 1.454

 80%|████████  | 8/10 [11:51<02:58, 89.08s/it][A
 80%|████████  | 8/10 [11:51<02:58, 89.08s/it][A
 80%|████████  | 8/10 [11:51<02:58, 89.08s/it][A
 80%|████████  | 8/10 [11:51<02:58, 89.07s/it][A
 80%|████████  | 8/10 [11:51<02:58, 89.08s/it][A
 80%|████████  | 8/10 [11:51<02:58, 89.06s/it][A
 80%|████████  | 8/10 [11:51<02:58, 89.06s/it][A
 90%|█████████ | 9/10 [13:20<01:29, 89.53s/it][A[2024-05-30 23:01:02,595] [INFO] [logging.py:96:log_dist] [Rank 0] step=1059, skipped=0, lr=[1.876311846176669e-05], mom=[(0.9, 0.999)]
steps: 1059 loss: 0.5870 iter time (s): 89.769 samples/sec: 1.426

 90%|█████████ | 9/10 [13:21<01:29, 89.56s/it][A
 90%|█████████ | 9/10 [13:22<01:29, 89.58s/it][A
 90%|█████████ | 9/10 [13:22<01:29, 89.55s/it][A
 90%|█████████ | 9/10 [13:22<01:29, 89.56s/it][A
 90%|█████████ | 9/10 [13:21<01:29, 89.54s/it][A
 90%|█████████ | 9/10 [13:22<01:29, 89.55s/it][A
 90%|█████████ | 9/10 [13:22<01:29, 89.55s/it][A
100%|██████████| 10/10 [14:48<00:00, 89.04s/it][A100%|██████████| 10/10 [14:48<00:00, 88.89s/it]
 21%|██        | 107/520 [8:43:22<114:29:36, 998.01s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 23:02:30,517] [INFO] [logging.py:96:log_dist] [Rank 0] step=1060, skipped=0, lr=[1.8760388534711582e-05], mom=[(0.9, 0.999)]
steps: 1060 loss: 0.5827 iter time (s): 87.042 samples/sec: 1.471

100%|██████████| 10/10 [14:49<00:00, 89.05s/it][A100%|██████████| 10/10 [14:49<00:00, 88.98s/it]
 21%|██        | 107/520 [8:43:34<114:31:24, 998.27s/it] 
100%|██████████| 10/10 [14:49<00:00, 89.03s/it][A100%|██████████| 10/10 [14:49<00:00, 88.99s/it]
 21%|██        | 107/520 [8:43:53<114:31:24, 998.27s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:49<00:00, 89.04s/it][A100%|██████████| 10/10 [14:49<00:00, 88.99s/it]
 21%|██        | 107/520 [8:44:35<114:31:28, 998.28s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:49<00:00, 89.05s/it][A100%|██████████| 10/10 [14:49<00:00, 89.00s/it]
 21%|██        | 107/520 [8:43:53<114:31:38, 998.30s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:49<00:00, 89.05s/it][A100%|██████████| 10/10 [14:49<00:00, 88.99s/it]
 21%|██        | 107/520 [8:43:37<114:31:43, 998.31s/it] 
100%|██████████| 10/10 [14:49<00:00, 89.03s/it][A100%|██████████| 10/10 [14:49<00:00, 88.99s/it]
 21%|██        | 107/520 [8:43:34<114:31:42, 998.31s/it] 
100%|██████████| 10/10 [14:49<00:00, 89.03s/it][A100%|██████████| 10/10 [14:49<00:00, 88.99s/it]
 21%|██        | 107/520 [8:43:34<114:31:44, 998.32s/it] Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_416

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:06<09:59, 66.64s/it][A[2024-05-30 23:03:37,111] [INFO] [logging.py:96:log_dist] [Rank 0] step=1061, skipped=0, lr=[1.8757655797427196e-05], mom=[(0.9, 0.999)]
steps: 1061 loss: 0.2731 iter time (s): 65.482 samples/sec: 1.955

 10%|█         | 1/10 [01:06<09:59, 66.59s/it][A
 10%|█         | 1/10 [01:06<09:59, 66.58s/it][A
 10%|█         | 1/10 [01:06<10:00, 66.69s/it][A
 10%|█         | 1/10 [01:06<09:59, 66.59s/it][A
 10%|█         | 1/10 [01:06<09:57, 66.44s/it][A
 10%|█         | 1/10 [01:06<09:58, 66.46s/it][A
 10%|█         | 1/10 [01:06<09:58, 66.46s/it][A
 20%|██        | 2/10 [02:12<08:49, 66.17s/it][A[2024-05-30 23:04:42,943] [INFO] [logging.py:96:log_dist] [Rank 0] step=1062, skipped=0, lr=[1.8754920250790268e-05], mom=[(0.9, 0.999)]
steps: 1062 loss: 0.2793 iter time (s): 64.994 samples/sec: 1.969

 20%|██        | 2/10 [02:12<08:48, 66.07s/it][A
 20%|██        | 2/10 [02:12<08:48, 66.07s/it][A
 20%|██        | 2/10 [02:12<08:48, 66.06s/it][A
 20%|██        | 2/10 [02:12<08:48, 66.06s/it][A
 20%|██        | 2/10 [02:12<08:47, 66.00s/it][A
 20%|██        | 2/10 [02:12<08:47, 66.00s/it][A
 20%|██        | 2/10 [02:12<08:47, 66.00s/it][A
 30%|███       | 3/10 [03:19<07:46, 66.68s/it][A[2024-05-30 23:05:50,220] [INFO] [logging.py:96:log_dist] [Rank 0] step=1063, skipped=0, lr=[1.8752181895678423e-05], mom=[(0.9, 0.999)]
steps: 1063 loss: 0.2883 iter time (s): 66.558 samples/sec: 1.923

 30%|███       | 3/10 [03:19<07:46, 66.61s/it][A
 30%|███       | 3/10 [03:19<07:46, 66.61s/it][A
 30%|███       | 3/10 [03:19<07:46, 66.58s/it][A
 30%|███       | 3/10 [03:19<07:46, 66.60s/it][A
 30%|███       | 3/10 [03:19<07:45, 66.55s/it][A
 30%|███       | 3/10 [03:19<07:45, 66.55s/it][A
 30%|███       | 3/10 [03:19<07:45, 66.56s/it][A
 40%|████      | 4/10 [04:25<06:37, 66.27s/it][A[2024-05-30 23:06:55,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=1064, skipped=0, lr=[1.8749440732970196e-05], mom=[(0.9, 0.999)]
steps: 1064 loss: 0.2857 iter time (s): 64.999 samples/sec: 1.969

 40%|████      | 4/10 [04:25<06:37, 66.23s/it][A
 40%|████      | 4/10 [04:25<06:37, 66.22s/it][A
 40%|████      | 4/10 [04:25<06:37, 66.20s/it][A
 40%|████      | 4/10 [04:25<06:37, 66.21s/it][A
 40%|████      | 4/10 [04:24<06:37, 66.18s/it][A
 40%|████      | 4/10 [04:24<06:37, 66.19s/it][A
 40%|████      | 4/10 [04:24<06:37, 66.19s/it][A
 50%|█████     | 5/10 [05:30<05:29, 65.93s/it][A[2024-05-30 23:08:01,182] [INFO] [logging.py:96:log_dist] [Rank 0] step=1065, skipped=0, lr=[1.874669676354502e-05], mom=[(0.9, 0.999)]
steps: 1065 loss: 0.2819 iter time (s): 64.657 samples/sec: 1.980

 50%|█████     | 5/10 [05:30<05:29, 65.88s/it][A
 50%|█████     | 5/10 [05:30<05:29, 65.90s/it][A
 50%|█████     | 5/10 [05:30<05:29, 65.88s/it][A
 50%|█████     | 5/10 [05:30<05:29, 65.87s/it][A
 50%|█████     | 5/10 [05:30<05:29, 65.87s/it][A
 50%|█████     | 5/10 [05:30<05:29, 65.87s/it][A
 50%|█████     | 5/10 [05:30<05:29, 65.87s/it][A
 60%|██████    | 6/10 [06:37<04:24, 66.07s/it][A[2024-05-30 23:09:07,513] [INFO] [logging.py:96:log_dist] [Rank 0] step=1066, skipped=0, lr=[1.874394998828323e-05], mom=[(0.9, 0.999)]
steps: 1066 loss: 0.2757 iter time (s): 65.762 samples/sec: 1.946

 60%|██████    | 6/10 [06:36<04:24, 66.05s/it][A
 60%|██████    | 6/10 [06:36<04:24, 66.06s/it][A
 60%|██████    | 6/10 [06:36<04:24, 66.06s/it][A
 60%|██████    | 6/10 [06:36<04:24, 66.07s/it][A
 60%|██████    | 6/10 [06:36<04:24, 66.05s/it][A
 60%|██████    | 6/10 [06:36<04:24, 66.05s/it][A
 60%|██████    | 6/10 [06:36<04:24, 66.06s/it][A
 70%|███████   | 7/10 [07:45<03:20, 66.76s/it][A[2024-05-30 23:10:15,727] [INFO] [logging.py:96:log_dist] [Rank 0] step=1067, skipped=0, lr=[1.8741200408066057e-05], mom=[(0.9, 0.999)]
steps: 1067 loss: 0.2664 iter time (s): 67.594 samples/sec: 1.894

 70%|███████   | 7/10 [07:45<03:20, 66.78s/it][A
 70%|███████   | 7/10 [07:45<03:20, 66.81s/it][A
 70%|███████   | 7/10 [07:45<03:20, 66.80s/it][A
 70%|███████   | 7/10 [07:45<03:20, 66.77s/it][A
 70%|███████   | 7/10 [07:44<03:20, 66.78s/it][A
 70%|███████   | 7/10 [07:44<03:20, 66.78s/it][A
 70%|███████   | 7/10 [07:44<03:20, 66.78s/it][A
 80%|████████  | 8/10 [08:52<02:14, 67.03s/it][A[2024-05-30 23:11:23,337] [INFO] [logging.py:96:log_dist] [Rank 0] step=1068, skipped=0, lr=[1.873844802377564e-05], mom=[(0.9, 0.999)]
steps: 1068 loss: 0.2697 iter time (s): 66.874 samples/sec: 1.914

 80%|████████  | 8/10 [08:52<02:14, 67.03s/it][A
 80%|████████  | 8/10 [08:52<02:14, 67.03s/it][A
 80%|████████  | 8/10 [08:52<02:14, 67.02s/it][A
 80%|████████  | 8/10 [08:52<02:14, 67.03s/it][A
 80%|████████  | 8/10 [08:52<02:14, 67.02s/it][A
 80%|████████  | 8/10 [08:52<02:14, 67.01s/it][A
 80%|████████  | 8/10 [08:52<02:14, 67.02s/it][A
 90%|█████████ | 9/10 [09:58<01:06, 66.62s/it][A[2024-05-30 23:12:29,068] [INFO] [logging.py:96:log_dist] [Rank 0] step=1069, skipped=0, lr=[1.8735692836295005e-05], mom=[(0.9, 0.999)]
steps: 1069 loss: 0.2900 iter time (s): 65.074 samples/sec: 1.967

 90%|█████████ | 9/10 [09:58<01:06, 66.62s/it][A
 90%|█████████ | 9/10 [09:58<01:06, 66.62s/it][A
 90%|█████████ | 9/10 [09:58<01:06, 66.63s/it][A
 90%|█████████ | 9/10 [09:58<01:06, 66.62s/it][A
 90%|█████████ | 9/10 [09:58<01:06, 66.62s/it][A
 90%|█████████ | 9/10 [09:58<01:06, 66.62s/it][A
 90%|█████████ | 9/10 [09:58<01:06, 66.61s/it][A
100%|██████████| 10/10 [11:05<00:00, 66.85s/it][A100%|██████████| 10/10 [11:05<00:00, 66.59s/it]
 21%|██        | 108/520 [8:54:29<102:50:06, 898.56s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 23:13:36,403] [INFO] [logging.py:96:log_dist] [Rank 0] step=1070, skipped=0, lr=[1.873293484650809e-05], mom=[(0.9, 0.999)]
steps: 1070 loss: 0.2898 iter time (s): 66.646 samples/sec: 1.921

100%|██████████| 10/10 [11:05<00:00, 66.83s/it][A100%|██████████| 10/10 [11:05<00:00, 66.57s/it]
 21%|██        | 108/520 [8:54:40<102:50:01, 898.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:05<00:00, 66.82s/it][A100%|██████████| 10/10 [11:05<00:00, 66.57s/it]
 21%|██        | 108/520 [8:54:59<102:50:02, 898.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:05<00:00, 66.83s/it][A100%|██████████| 10/10 [11:05<00:00, 66.57s/it]
 21%|██        | 108/520 [8:55:40<102:50:01, 898.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:05<00:00, 66.84s/it][A100%|██████████| 10/10 [11:05<00:00, 66.57s/it]
 21%|██        | 108/520 [8:54:59<102:50:05, 898.56s/it]
100%|██████████| 10/10 [11:05<00:00, 66.83s/it][A100%|██████████| 10/10 [11:05<00:00, 66.55s/it]
 21%|██        | 108/520 [8:54:43<102:50:01, 898.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:05<00:00, 66.84s/it][A100%|██████████| 10/10 [11:05<00:00, 66.56s/it]
 21%|██        | 108/520 [8:54:40<102:50:05, 898.56s/it]
100%|██████████| 10/10 [11:05<00:00, 66.83s/it][A100%|██████████| 10/10 [11:05<00:00, 66.55s/it]
 21%|██        | 108/520 [8:54:39<102:50:04, 898.55s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_383

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:16<20:31, 136.80s/it][A[2024-05-30 23:15:55,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=1071, skipped=0, lr=[1.873017405529972e-05], mom=[(0.9, 0.999)]
steps: 1071 loss: 0.8046 iter time (s): 138.237 samples/sec: 0.926

 10%|█         | 1/10 [02:19<20:51, 139.09s/it][A
 10%|█         | 1/10 [02:19<20:52, 139.13s/it][A
 10%|█         | 1/10 [02:19<20:52, 139.13s/it][A
 10%|█         | 1/10 [02:19<20:52, 139.17s/it][A
 10%|█         | 1/10 [02:19<20:51, 139.08s/it][A
 10%|█         | 1/10 [02:19<20:52, 139.12s/it][A
 10%|█         | 1/10 [02:19<20:52, 139.13s/it][A
 20%|██        | 2/10 [04:33<18:14, 136.80s/it][A[2024-05-30 23:18:12,279] [INFO] [logging.py:96:log_dist] [Rank 0] step=1072, skipped=0, lr=[1.872741046355563e-05], mom=[(0.9, 0.999)]
steps: 1072 loss: 0.8109 iter time (s): 135.971 samples/sec: 0.941

 20%|██        | 2/10 [04:35<18:21, 137.74s/it][A
 20%|██        | 2/10 [04:35<18:22, 137.78s/it][A
 20%|██        | 2/10 [04:35<18:22, 137.75s/it][A
 20%|██        | 2/10 [04:35<18:22, 137.77s/it][A
 20%|██        | 2/10 [04:35<18:21, 137.74s/it][A
 20%|██        | 2/10 [04:35<18:22, 137.77s/it][A
 20%|██        | 2/10 [04:35<18:22, 137.77s/it][A
 30%|███       | 3/10 [06:52<16:05, 137.94s/it][A[2024-05-30 23:20:31,536] [INFO] [logging.py:96:log_dist] [Rank 0] step=1073, skipped=0, lr=[1.872464407216245e-05], mom=[(0.9, 0.999)]
steps: 1073 loss: 0.7918 iter time (s): 138.463 samples/sec: 0.924

 30%|███       | 3/10 [06:55<16:09, 138.44s/it][A
 30%|███       | 3/10 [06:55<16:09, 138.44s/it][A
 30%|███       | 3/10 [06:55<16:09, 138.44s/it][A
 30%|███       | 3/10 [06:55<16:08, 138.43s/it][A
 30%|███       | 3/10 [06:55<16:09, 138.44s/it][A
 30%|███       | 3/10 [06:55<16:09, 138.43s/it][A
 30%|███       | 3/10 [06:55<16:09, 138.44s/it][A
 40%|████      | 4/10 [09:09<13:45, 137.61s/it][A[2024-05-30 23:22:48,649] [INFO] [logging.py:96:log_dist] [Rank 0] step=1074, skipped=0, lr=[1.872187488200771e-05], mom=[(0.9, 0.999)]
steps: 1074 loss: 0.7966 iter time (s): 136.355 samples/sec: 0.939

 40%|████      | 4/10 [09:12<13:47, 137.92s/it][A
 40%|████      | 4/10 [09:12<13:47, 137.92s/it][A
 40%|████      | 4/10 [09:12<13:47, 137.93s/it][A
 40%|████      | 4/10 [09:12<13:47, 137.94s/it][A
 40%|████      | 4/10 [09:12<13:47, 137.94s/it][A
 40%|████      | 4/10 [09:12<13:47, 137.95s/it][A
 40%|████      | 4/10 [09:12<13:47, 137.94s/it][A
 50%|█████     | 5/10 [11:25<11:24, 136.90s/it][A[2024-05-30 23:25:04,298] [INFO] [logging.py:96:log_dist] [Rank 0] step=1075, skipped=0, lr=[1.8719102893979823e-05], mom=[(0.9, 0.999)]
steps: 1075 loss: 0.7987 iter time (s): 134.791 samples/sec: 0.950

 50%|█████     | 5/10 [11:27<11:25, 137.11s/it][A
 50%|█████     | 5/10 [11:27<11:25, 137.11s/it][A
 50%|█████     | 5/10 [11:27<11:25, 137.10s/it][A
 50%|█████     | 5/10 [11:27<11:25, 137.09s/it][A
 50%|█████     | 5/10 [11:27<11:25, 137.09s/it][A
 50%|█████     | 5/10 [11:27<11:25, 137.09s/it][A
 50%|█████     | 5/10 [11:27<11:25, 137.09s/it][A
 60%|██████    | 6/10 [13:41<09:05, 136.42s/it][A[2024-05-30 23:27:19,764] [INFO] [logging.py:96:log_dist] [Rank 0] step=1076, skipped=0, lr=[1.8716328108968125e-05], mom=[(0.9, 0.999)]
steps: 1076 loss: 0.7563 iter time (s): 134.691 samples/sec: 0.950

 60%|██████    | 6/10 [13:43<09:06, 136.55s/it][A
 60%|██████    | 6/10 [13:43<09:06, 136.63s/it][A
 60%|██████    | 6/10 [13:43<09:06, 136.62s/it][A
 60%|██████    | 6/10 [13:43<09:06, 136.63s/it][A
 60%|██████    | 6/10 [13:43<09:06, 136.62s/it][A
 60%|██████    | 6/10 [13:43<09:06, 136.64s/it][A
 60%|██████    | 6/10 [13:43<09:06, 136.62s/it][A
 70%|███████   | 7/10 [16:01<06:53, 137.85s/it][A[2024-05-30 23:29:40,580] [INFO] [logging.py:96:log_dist] [Rank 0] step=1077, skipped=0, lr=[1.8713550527862825e-05], mom=[(0.9, 0.999)]
steps: 1077 loss: 0.7578 iter time (s): 139.780 samples/sec: 0.916

 70%|███████   | 7/10 [16:04<06:53, 137.94s/it][A
 70%|███████   | 7/10 [16:04<06:53, 137.94s/it][A
 70%|███████   | 7/10 [16:04<06:53, 137.96s/it][A
 70%|███████   | 7/10 [16:04<06:53, 137.93s/it][A
 70%|███████   | 7/10 [16:04<06:53, 137.92s/it][A
 70%|███████   | 7/10 [16:04<06:53, 137.94s/it][A
 70%|███████   | 7/10 [16:04<06:53, 137.94s/it][A
 80%|████████  | 8/10 [18:27<04:40, 140.26s/it][A[2024-05-30 23:32:06,020] [INFO] [logging.py:96:log_dist] [Rank 0] step=1078, skipped=0, lr=[1.8710770151555047e-05], mom=[(0.9, 0.999)]
steps: 1078 loss: 0.7637 iter time (s): 144.604 samples/sec: 0.885

 80%|████████  | 8/10 [18:29<04:40, 140.34s/it][A
 80%|████████  | 8/10 [18:29<04:40, 140.31s/it][A
 80%|████████  | 8/10 [18:29<04:40, 140.30s/it][A
 80%|████████  | 8/10 [18:29<04:40, 140.32s/it][A
 80%|████████  | 8/10 [18:29<04:40, 140.30s/it][A
 80%|████████  | 8/10 [18:29<04:40, 140.30s/it][A
 80%|████████  | 8/10 [18:29<04:40, 140.31s/it][A
 90%|█████████ | 9/10 [20:49<02:20, 140.90s/it][A[2024-05-30 23:34:28,294] [INFO] [logging.py:96:log_dist] [Rank 0] step=1079, skipped=0, lr=[1.8707986980936804e-05], mom=[(0.9, 0.999)]
steps: 1079 loss: 0.7656 iter time (s): 141.509 samples/sec: 0.905

 90%|█████████ | 9/10 [20:51<02:20, 140.94s/it][A
 90%|█████████ | 9/10 [20:52<02:20, 140.96s/it][A
 90%|█████████ | 9/10 [20:51<02:20, 140.93s/it][A
 90%|█████████ | 9/10 [20:51<02:20, 140.92s/it][A
 90%|█████████ | 9/10 [20:51<02:20, 140.93s/it][A
 90%|█████████ | 9/10 [20:51<02:20, 140.93s/it][A
 90%|█████████ | 9/10 [20:52<02:20, 140.94s/it][A
100%|██████████| 10/10 [23:10<00:00, 140.98s/it][A100%|██████████| 10/10 [23:10<00:00, 139.08s/it]
 21%|██        | 109/520 [9:17:40<119:27:14, 1046.31s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 23:36:49,444] [INFO] [logging.py:96:log_dist] [Rank 0] step=1080, skipped=0, lr=[1.8705201016901002e-05], mom=[(0.9, 0.999)]
steps: 1080 loss: 0.7369 iter time (s): 140.304 samples/sec: 0.912

100%|██████████| 10/10 [23:13<00:00, 141.03s/it][A100%|██████████| 10/10 [23:13<00:00, 139.32s/it]
 21%|██        | 109/520 [9:17:53<119:31:28, 1046.93s/it]
100%|██████████| 10/10 [23:13<00:00, 141.01s/it][A100%|██████████| 10/10 [23:13<00:00, 139.32s/it]
 21%|██        | 109/520 [9:18:12<119:31:29, 1046.93s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [23:13<00:00, 141.01s/it][A100%|██████████| 10/10 [23:13<00:00, 139.32s/it]
 21%|██        | 109/520 [9:18:54<119:31:32, 1046.94s/it]
100%|██████████| 10/10 [23:13<00:00, 141.00s/it][A100%|██████████| 10/10 [23:13<00:00, 139.31s/it]
 21%|██        | 109/520 [9:18:12<119:31:24, 1046.92s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [23:13<00:00, 140.99s/it][A100%|██████████| 10/10 [23:13<00:00, 139.31s/it]
 21%|██        | 109/520 [9:17:56<119:31:23, 1046.92s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [23:13<00:00, 140.99s/it][A100%|██████████| 10/10 [23:13<00:00, 139.31s/it]
 21%|██        | 109/520 [9:17:53<119:31:24, 1046.92s/it]
100%|██████████| 10/10 [23:13<00:00, 140.99s/it][A100%|██████████| 10/10 [23:13<00:00, 139.31s/it]
 21%|██        | 109/520 [9:17:53<119:31:26, 1046.93s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_381

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:14<20:12, 134.72s/it][A[2024-05-30 23:39:04,337] [INFO] [logging.py:96:log_dist] [Rank 0] step=1081, skipped=0, lr=[1.8702412260341453e-05], mom=[(0.9, 0.999)]
steps: 1081 loss: 0.7753 iter time (s): 133.896 samples/sec: 0.956

 10%|█         | 1/10 [02:14<20:12, 134.69s/it][A
 10%|█         | 1/10 [02:14<20:13, 134.82s/it][A
 10%|█         | 1/10 [02:14<20:13, 134.87s/it][A
 10%|█         | 1/10 [02:14<20:14, 134.89s/it][A
 10%|█         | 1/10 [02:14<20:14, 134.93s/it][A
 10%|█         | 1/10 [02:14<20:13, 134.88s/it][A
 10%|█         | 1/10 [02:14<20:13, 134.85s/it][A
 20%|██        | 2/10 [04:31<18:09, 136.20s/it][A[2024-05-30 23:41:21,564] [INFO] [logging.py:96:log_dist] [Rank 0] step=1082, skipped=0, lr=[1.869962071215286e-05], mom=[(0.9, 0.999)]
steps: 1082 loss: 0.7568 iter time (s): 136.392 samples/sec: 0.938

 20%|██        | 2/10 [04:32<18:09, 136.25s/it][A
 20%|██        | 2/10 [04:32<18:09, 136.23s/it][A
 20%|██        | 2/10 [04:32<18:10, 136.28s/it][A
 20%|██        | 2/10 [04:32<18:10, 136.30s/it][A
 20%|██        | 2/10 [04:32<18:10, 136.31s/it][A
 20%|██        | 2/10 [04:32<18:10, 136.30s/it][A
 20%|██        | 2/10 [04:32<18:10, 136.29s/it][A
 30%|███       | 3/10 [06:45<15:43, 134.82s/it][A[2024-05-30 23:43:34,767] [INFO] [logging.py:96:log_dist] [Rank 0] step=1083, skipped=0, lr=[1.869682637323081e-05], mom=[(0.9, 0.999)]
steps: 1083 loss: 0.7560 iter time (s): 132.297 samples/sec: 0.968

 30%|███       | 3/10 [06:45<15:43, 134.83s/it][A
 30%|███       | 3/10 [06:45<15:43, 134.81s/it][A
 30%|███       | 3/10 [06:45<15:43, 134.83s/it][A
 30%|███       | 3/10 [06:45<15:44, 134.86s/it][A
 30%|███       | 3/10 [06:45<15:43, 134.85s/it][A
 30%|███       | 3/10 [06:45<15:44, 134.87s/it][A
 30%|███       | 3/10 [06:45<15:43, 134.85s/it][A
 40%|████      | 4/10 [08:59<13:27, 134.62s/it][A[2024-05-30 23:45:49,088] [INFO] [logging.py:96:log_dist] [Rank 0] step=1084, skipped=0, lr=[1.8694029244471805e-05], mom=[(0.9, 0.999)]
steps: 1084 loss: 0.7391 iter time (s): 133.486 samples/sec: 0.959

 40%|████      | 4/10 [08:59<13:27, 134.62s/it][A
 40%|████      | 4/10 [08:59<13:27, 134.64s/it][A
 40%|████      | 4/10 [08:59<13:27, 134.66s/it][A
 40%|████      | 4/10 [08:59<13:27, 134.67s/it][A
 40%|████      | 4/10 [08:59<13:27, 134.65s/it][A
 40%|████      | 4/10 [08:59<13:27, 134.66s/it][A
 40%|████      | 4/10 [08:59<13:27, 134.66s/it][A
 50%|█████     | 5/10 [11:12<11:10, 134.10s/it][A[2024-05-30 23:48:02,243] [INFO] [logging.py:96:log_dist] [Rank 0] step=1085, skipped=0, lr=[1.8691229326773237e-05], mom=[(0.9, 0.999)]
steps: 1085 loss: 0.7574 iter time (s): 132.249 samples/sec: 0.968

 50%|█████     | 5/10 [11:12<11:10, 134.07s/it][A
 50%|█████     | 5/10 [11:12<11:10, 134.10s/it][A
 50%|█████     | 5/10 [11:12<11:10, 134.12s/it][A
 50%|█████     | 5/10 [11:12<11:10, 134.11s/it][A
 50%|█████     | 5/10 [11:12<11:10, 134.13s/it][A
 50%|█████     | 5/10 [11:12<11:10, 134.11s/it][A
 50%|█████     | 5/10 [11:12<11:10, 134.11s/it][A
 60%|██████    | 6/10 [13:25<08:55, 133.80s/it][A[2024-05-30 23:50:15,492] [INFO] [logging.py:96:log_dist] [Rank 0] step=1086, skipped=0, lr=[1.868842662103338e-05], mom=[(0.9, 0.999)]
steps: 1086 loss: 0.7643 iter time (s): 132.377 samples/sec: 0.967

 60%|██████    | 6/10 [13:25<08:55, 133.82s/it][A
 60%|██████    | 6/10 [13:25<08:55, 133.78s/it][A
 60%|██████    | 6/10 [13:26<08:55, 133.83s/it][A
 60%|██████    | 6/10 [13:26<08:55, 133.83s/it][A
 60%|██████    | 6/10 [13:26<08:55, 133.88s/it][A
 60%|██████    | 6/10 [13:26<08:55, 133.83s/it][A
 60%|██████    | 6/10 [13:26<08:55, 133.84s/it][A
 70%|███████   | 7/10 [15:40<06:42, 134.04s/it][A[2024-05-30 23:52:29,995] [INFO] [logging.py:96:log_dist] [Rank 0] step=1087, skipped=0, lr=[1.868562112815142e-05], mom=[(0.9, 0.999)]
steps: 1087 loss: 0.7277 iter time (s): 133.596 samples/sec: 0.958

 70%|███████   | 7/10 [15:40<06:42, 134.02s/it][A
 70%|███████   | 7/10 [15:40<06:42, 134.05s/it][A
 70%|███████   | 7/10 [15:40<06:42, 134.02s/it][A
 70%|███████   | 7/10 [15:40<06:42, 134.05s/it][A
 70%|███████   | 7/10 [15:40<06:42, 134.06s/it][A
 70%|███████   | 7/10 [15:40<06:42, 134.06s/it][A
 70%|███████   | 7/10 [15:40<06:42, 134.05s/it][A
 80%|████████  | 8/10 [17:54<04:28, 134.11s/it][A[2024-05-30 23:54:44,268] [INFO] [logging.py:96:log_dist] [Rank 0] step=1088, skipped=0, lr=[1.868281284902742e-05], mom=[(0.9, 0.999)]
steps: 1088 loss: 0.7468 iter time (s): 133.316 samples/sec: 0.960

 80%|████████  | 8/10 [17:54<04:28, 134.11s/it][A
 80%|████████  | 8/10 [17:54<04:28, 134.11s/it][A
 80%|████████  | 8/10 [17:54<04:28, 134.07s/it][A
 80%|████████  | 8/10 [17:54<04:28, 134.09s/it][A
 80%|████████  | 8/10 [17:54<04:28, 134.10s/it][A
 80%|████████  | 8/10 [17:54<04:28, 134.09s/it][A
 80%|████████  | 8/10 [17:54<04:28, 134.09s/it][A
 90%|█████████ | 9/10 [20:07<02:13, 133.78s/it][A[2024-05-30 23:56:57,350] [INFO] [logging.py:96:log_dist] [Rank 0] step=1089, skipped=0, lr=[1.8680001784562353e-05], mom=[(0.9, 0.999)]
steps: 1089 loss: 0.7162 iter time (s): 132.256 samples/sec: 0.968

 90%|█████████ | 9/10 [20:07<02:13, 133.76s/it][A
 90%|█████████ | 9/10 [20:07<02:13, 133.80s/it][A
 90%|█████████ | 9/10 [20:07<02:13, 133.78s/it][A
 90%|█████████ | 9/10 [20:07<02:13, 133.77s/it][A
 90%|█████████ | 9/10 [20:07<02:13, 133.78s/it][A
 90%|█████████ | 9/10 [20:07<02:13, 133.78s/it][A
 90%|█████████ | 9/10 [20:07<02:13, 133.78s/it][A
100%|██████████| 10/10 [22:21<00:00, 133.70s/it][A100%|██████████| 10/10 [22:21<00:00, 134.12s/it]
[2024-05-30 23:59:10,852] [INFO] [logging.py:96:log_dist] [Rank 0] step=1090, skipped=0, lr=[1.8677187935658075e-05], mom=[(0.9, 0.999)]
steps: 1090 loss: 0.7227 iter time (s): 132.671 samples/sec: 0.965

100%|██████████| 10/10 [22:21<00:00, 133.69s/it][A100%|██████████| 10/10 [22:21<00:00, 134.12s/it]

100%|██████████| 10/10 [22:21<00:00, 133.70s/it][A100%|██████████| 10/10 [22:21<00:00, 134.12s/it]

100%|██████████| 10/10 [22:21<00:00, 133.70s/it][A100%|██████████| 10/10 [22:21<00:00, 134.14s/it]

100%|██████████| 10/10 [22:21<00:00, 133.71s/it][A100%|██████████| 10/10 [22:21<00:00, 134.14s/it]

100%|██████████| 10/10 [22:21<00:00, 133.70s/it][A100%|██████████| 10/10 [22:21<00:00, 134.14s/it]

100%|██████████| 10/10 [22:21<00:00, 133.71s/it][A100%|██████████| 10/10 [22:21<00:00, 134.14s/it]

100%|██████████| 10/10 [22:21<00:00, 133.70s/it][A100%|██████████| 10/10 [22:21<00:00, 134.14s/it]
Checkpointing at shard 110
[2024-05-30 23:59:11,787] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step1090 is about to be saved!
[2024-05-30 23:59:13,770] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_00-model_states.pt...
[2024-05-30 23:59:17,448] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_05-model_states.pt...
[2024-05-30 23:59:18,694] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_06-model_states.pt...
[2024-05-30 23:59:19,443] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_08-model_states.pt...
[2024-05-30 23:59:19,600] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_07-model_states.pt...
[2024-05-30 23:59:20,822] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_02-model_states.pt...
[2024-05-30 23:59:22,734] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_00-model_states.pt.
[2024-05-30 23:59:24,687] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_03-model_states.pt...
[2024-05-30 23:59:24,926] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_04-model_states.pt...
[2024-05-30 23:59:31,104] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_01-model_states.pt...
[2024-05-31 00:09:42,817] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_02-model_states.pt.
[2024-05-31 00:09:42,817] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_03-model_states.pt.
[2024-05-31 00:09:42,873] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_04-model_states.pt.
[2024-05-31 00:09:42,882] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_06-model_states.pt.
[2024-05-31 00:09:42,885] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_07-model_states.pt.
[2024-05-31 00:09:42,896] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_08-model_states.pt.
[2024-05-31 00:09:42,941] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_05-model_states.pt.
[2024-05-31 00:09:43,047] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_04_model_states.pt...
[2024-05-31 00:09:43,408] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_01_model_states.pt
[2024-05-31 00:09:43,408] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_01_model_states.pt...
[2024-05-31 00:09:43,491] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_04_model_states.pt.
[2024-05-31 00:09:43,491] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1090 is ready now!
[2024-05-31 00:09:43,494] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_01-model_states.pt.
[2024-05-31 00:09:43,496] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_09-model_states.pt...
[2024-05-31 00:09:43,623] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_05_model_states.pt...
[2024-05-31 00:09:43,744] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_06_model_states.pt...
[2024-05-31 00:09:43,893] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_03_model_states.pt...
[2024-05-31 00:09:43,893] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_02_model_states.pt...
[2024-05-31 00:09:44,049] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_01_model_states.pt.
[2024-05-31 00:09:44,049] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1090 is ready now!
[2024-05-31 00:09:44,328] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_00_model_states.pt
[2024-05-31 00:09:44,328] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_00_model_states.pt...
[2024-05-31 00:09:44,637] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_05_model_states.pt.
[2024-05-31 00:09:44,637] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1090 is ready now!
[2024-05-31 00:09:44,777] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_06_model_states.pt.
[2024-05-31 00:09:44,777] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1090 is ready now!
[2024-05-31 00:09:44,792] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_03_model_states.pt.
[2024-05-31 00:09:44,792] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1090 is ready now!
[2024-05-31 00:09:44,796] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_02_model_states.pt.
[2024-05-31 00:09:44,796] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1090 is ready now!
[2024-05-31 00:09:47,261] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_00_model_states.pt.
[2024-05-31 00:09:47,261] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1090 is ready now!
[2024-05-31 00:09:47,330] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/layer_09-model_states.pt.
[2024-05-31 00:09:47,334] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_07_model_states.pt...
[2024-05-31 00:09:47,621] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1090/mp_rank_07_model_states.pt.
[2024-05-31 00:09:47,622] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1090 is ready now!
Checkpoint saved using --- 635.8395752906799 seconds ---
 21%|██        | 110/520 [9:50:50<151:01:02, 1326.01s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_306
 21%|██        | 110/520 [9:51:09<151:01:14, 1326.03s/it] 21%|██        | 110/520 [9:50:41<151:06:16, 1326.77s/it] 21%|██        | 110/520 [9:51:10<151:01:38, 1326.09s/it] 21%|██        | 110/520 [9:50:51<151:01:46, 1326.11s/it] 21%|██        | 110/520 [9:51:51<151:01:23, 1326.06s/it] 21%|██        | 110/520 [9:50:53<151:01:08, 1326.02s/it] 21%|██        | 110/520 [9:50:51<151:01:05, 1326.01s/it]Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A

  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [00:00<?, ?it/s][A

  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:30<13:35, 90.57s/it][A[2024-05-31 00:11:20,657] [INFO] [logging.py:96:log_dist] [Rank 0] step=1091, skipped=0, lr=[1.8674371303217337e-05], mom=[(0.9, 0.999)]
steps: 1091 loss: 0.5900 iter time (s): 92.587 samples/sec: 1.382

 10%|█         | 1/10 [01:32<13:56, 92.97s/it][A
 10%|█         | 1/10 [01:33<13:57, 93.10s/it][A
 10%|█         | 1/10 [01:33<13:59, 93.26s/it][A
 10%|█         | 1/10 [01:33<14:00, 93.33s/it][A
 10%|█         | 1/10 [01:33<14:00, 93.39s/it][A
 10%|█         | 1/10 [01:33<14:00, 93.41s/it][A
 10%|█         | 1/10 [01:33<14:00, 93.44s/it][A
 20%|██        | 2/10 [03:01<12:07, 90.99s/it][A[2024-05-31 00:12:51,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=1092, skipped=0, lr=[1.8671551888143788e-05], mom=[(0.9, 0.999)]
steps: 1092 loss: 0.5847 iter time (s): 90.252 samples/sec: 1.418

 20%|██        | 2/10 [03:04<12:14, 91.85s/it][A
 20%|██        | 2/10 [03:04<12:15, 91.91s/it][A
 20%|██        | 2/10 [03:04<12:15, 91.92s/it][A
 20%|██        | 2/10 [03:04<12:15, 91.98s/it][A
 20%|██        | 2/10 [03:04<12:16, 92.02s/it][A
 20%|██        | 2/10 [03:04<12:16, 92.04s/it][A
 20%|██        | 2/10 [03:04<12:16, 92.05s/it][A
 30%|███       | 3/10 [04:33<10:38, 91.27s/it][A[2024-05-31 00:14:23,535] [INFO] [logging.py:96:log_dist] [Rank 0] step=1093, skipped=0, lr=[1.8668729691341965e-05], mom=[(0.9, 0.999)]
steps: 1093 loss: 0.5870 iter time (s): 90.773 samples/sec: 1.410

 30%|███       | 3/10 [04:35<10:42, 91.75s/it][A
 30%|███       | 3/10 [04:35<10:42, 91.76s/it][A
 30%|███       | 3/10 [04:35<10:42, 91.81s/it][A
 30%|███       | 3/10 [04:36<10:42, 91.81s/it][A
 30%|███       | 3/10 [04:36<10:42, 91.83s/it][A
 30%|███       | 3/10 [04:36<10:42, 91.84s/it][A
 30%|███       | 3/10 [04:36<10:42, 91.85s/it][A
 40%|████      | 4/10 [06:05<09:10, 91.70s/it][A[2024-05-31 00:15:55,923] [INFO] [logging.py:96:log_dist] [Rank 0] step=1094, skipped=0, lr=[1.86659047137173e-05], mom=[(0.9, 0.999)]
steps: 1094 loss: 0.5806 iter time (s): 91.642 samples/sec: 1.397

 40%|████      | 4/10 [06:08<09:12, 92.03s/it][A
 40%|████      | 4/10 [06:08<09:12, 92.01s/it][A
 40%|████      | 4/10 [06:08<09:12, 92.03s/it][A
 40%|████      | 4/10 [06:08<09:12, 92.06s/it][A
 40%|████      | 4/10 [06:08<09:12, 92.07s/it][A
 40%|████      | 4/10 [06:08<09:12, 92.08s/it][A
 40%|████      | 4/10 [06:08<09:12, 92.09s/it][A
 50%|█████     | 5/10 [07:42<07:46, 93.34s/it][A[2024-05-31 00:17:32,145] [INFO] [logging.py:96:log_dist] [Rank 0] step=1095, skipped=0, lr=[1.8663076956176112e-05], mom=[(0.9, 0.999)]
steps: 1095 loss: 0.5861 iter time (s): 95.394 samples/sec: 1.342

 50%|█████     | 5/10 [07:44<07:47, 93.52s/it][A
 50%|█████     | 5/10 [07:44<07:47, 93.55s/it][A
 50%|█████     | 5/10 [07:44<07:47, 93.54s/it][A
 50%|█████     | 5/10 [07:44<07:47, 93.55s/it][A
 50%|█████     | 5/10 [07:44<07:47, 93.57s/it][A
 50%|█████     | 5/10 [07:44<07:47, 93.57s/it][A
 50%|█████     | 5/10 [07:44<07:47, 93.57s/it][A
 60%|██████    | 6/10 [09:20<06:20, 95.03s/it][A[2024-05-31 00:19:10,471] [INFO] [logging.py:96:log_dist] [Rank 0] step=1096, skipped=0, lr=[1.8660246419625625e-05], mom=[(0.9, 0.999)]
steps: 1096 loss: 0.5939 iter time (s): 97.467 samples/sec: 1.313

 60%|██████    | 6/10 [09:22<06:20, 95.14s/it][A
 60%|██████    | 6/10 [09:22<06:20, 95.15s/it][A
 60%|██████    | 6/10 [09:22<06:20, 95.18s/it][A
 60%|██████    | 6/10 [09:22<06:20, 95.18s/it][A
 60%|██████    | 6/10 [09:23<06:20, 95.18s/it][A
 60%|██████    | 6/10 [09:23<06:20, 95.18s/it][A
 60%|██████    | 6/10 [09:23<06:20, 95.18s/it][A
 70%|███████   | 7/10 [10:55<04:44, 95.00s/it][A[2024-05-31 00:20:45,405] [INFO] [logging.py:96:log_dist] [Rank 0] step=1097, skipped=0, lr=[1.8657413104973932e-05], mom=[(0.9, 0.999)]
steps: 1097 loss: 0.5829 iter time (s): 94.279 samples/sec: 1.358

 70%|███████   | 7/10 [10:57<04:45, 95.13s/it][A
 70%|███████   | 7/10 [10:57<04:45, 95.15s/it][A
 70%|███████   | 7/10 [10:57<04:45, 95.15s/it][A
 70%|███████   | 7/10 [10:58<04:45, 95.16s/it][A
 70%|███████   | 7/10 [10:58<04:45, 95.15s/it][A
 70%|███████   | 7/10 [10:58<04:45, 95.16s/it][A
 70%|███████   | 7/10 [10:58<04:45, 95.16s/it][A
 80%|████████  | 8/10 [12:30<03:10, 95.11s/it][A[2024-05-31 00:22:20,732] [INFO] [logging.py:96:log_dist] [Rank 0] step=1098, skipped=0, lr=[1.865457701313004e-05], mom=[(0.9, 0.999)]
steps: 1098 loss: 0.5921 iter time (s): 94.298 samples/sec: 1.357

 80%|████████  | 8/10 [12:32<03:10, 95.14s/it][A
 80%|████████  | 8/10 [12:32<03:10, 95.13s/it][A
 80%|████████  | 8/10 [12:33<03:10, 95.13s/it][A
 80%|████████  | 8/10 [12:33<03:10, 95.15s/it][A
 80%|████████  | 8/10 [12:33<03:10, 95.14s/it][A
 80%|████████  | 8/10 [12:33<03:10, 95.19s/it][A
 80%|████████  | 8/10 [12:33<03:10, 95.18s/it][A
 90%|█████████ | 9/10 [14:04<01:34, 94.69s/it][A[2024-05-31 00:23:54,504] [INFO] [logging.py:96:log_dist] [Rank 0] step=1099, skipped=0, lr=[1.8651738145003838e-05], mom=[(0.9, 0.999)]
steps: 1099 loss: 0.5901 iter time (s): 92.835 samples/sec: 1.379

 90%|█████████ | 9/10 [14:06<01:34, 94.71s/it][A
 90%|█████████ | 9/10 [14:06<01:34, 94.72s/it][A
 90%|█████████ | 9/10 [14:06<01:34, 94.70s/it][A
 90%|█████████ | 9/10 [14:06<01:34, 94.71s/it][A
 90%|█████████ | 9/10 [14:07<01:34, 94.70s/it][A
 90%|█████████ | 9/10 [14:07<01:34, 94.71s/it][A
 90%|█████████ | 9/10 [14:07<01:34, 94.71s/it][A
100%|██████████| 10/10 [15:36<00:00, 93.93s/it][A100%|██████████| 10/10 [15:36<00:00, 93.66s/it]
 21%|██▏       | 111/520 [10:06:18<137:27:48, 1209.95s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-31 00:25:26,736] [INFO] [logging.py:96:log_dist] [Rank 0] step=1100, skipped=0, lr=[1.86488965015061e-05], mom=[(0.9, 0.999)]
steps: 1100 loss: 0.5959 iter time (s): 91.394 samples/sec: 1.401

100%|██████████| 10/10 [15:38<00:00, 93.93s/it][A100%|██████████| 10/10 [15:38<00:00, 93.88s/it]
 21%|██▏       | 111/520 [10:06:30<137:29:01, 1210.13s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:39<00:00, 93.97s/it][A100%|██████████| 10/10 [15:39<00:00, 93.90s/it]
 21%|██▏       | 111/520 [10:06:50<137:29:26, 1210.19s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:39<00:00, 93.95s/it][A100%|██████████| 10/10 [15:39<00:00, 93.91s/it]
 21%|██▏       | 111/520 [10:07:31<137:29:21, 1210.18s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:39<00:00, 93.94s/it][A100%|██████████| 10/10 [15:39<00:00, 93.92s/it]
 21%|██▏       | 111/520 [10:06:49<137:29:26, 1210.19s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:39<00:00, 93.94s/it][A100%|██████████| 10/10 [15:39<00:00, 93.93s/it]
 21%|██▏       | 111/520 [10:06:33<137:29:33, 1210.20s/it]
100%|██████████| 10/10 [15:39<00:00, 93.95s/it][A100%|██████████| 10/10 [15:39<00:00, 93.93s/it]
 21%|██▏       | 111/520 [10:06:31<137:29:35, 1210.21s/it]
100%|██████████| 10/10 [15:39<00:00, 93.94s/it][A100%|██████████| 10/10 [15:39<00:00, 93.93s/it]
 21%|██▏       | 111/520 [10:06:30<137:29:36, 1210.21s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_plain_texts/shard_28

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:03<18:33, 123.70s/it][A[2024-05-31 00:27:31,656] [INFO] [logging.py:96:log_dist] [Rank 0] step=1101, skipped=0, lr=[1.8646052083548497e-05], mom=[(0.9, 0.999)]
steps: 1101 loss: 0.8804 iter time (s): 124.033 samples/sec: 1.032

 10%|█         | 1/10 [02:05<18:47, 125.24s/it][A
 10%|█         | 1/10 [02:05<18:45, 125.09s/it][A
 10%|█         | 1/10 [02:05<18:46, 125.22s/it][A
 10%|█         | 1/10 [02:05<18:46, 125.15s/it][A
 10%|█         | 1/10 [02:05<18:46, 125.11s/it][A
 10%|█         | 1/10 [02:05<18:45, 125.07s/it][A
 10%|█         | 1/10 [02:05<18:45, 125.07s/it][A
 20%|██        | 2/10 [04:08<16:35, 124.41s/it][A[2024-05-31 00:29:36,619] [INFO] [logging.py:96:log_dist] [Rank 0] step=1102, skipped=0, lr=[1.8643204892043593e-05], mom=[(0.9, 0.999)]
steps: 1102 loss: 0.7853 iter time (s): 124.126 samples/sec: 1.031

 20%|██        | 2/10 [04:10<16:40, 125.09s/it][A
 20%|██        | 2/10 [04:10<16:40, 125.07s/it][A
 20%|██        | 2/10 [04:10<16:40, 125.10s/it][A
 20%|██        | 2/10 [04:10<16:40, 125.09s/it][A
 20%|██        | 2/10 [04:10<16:40, 125.10s/it][A
 20%|██        | 2/10 [04:10<16:41, 125.22s/it][A
 20%|██        | 2/10 [04:10<16:43, 125.45s/it][A
 30%|███       | 3/10 [06:14<14:35, 125.11s/it][A[2024-05-31 00:31:42,534] [INFO] [logging.py:96:log_dist] [Rank 0] step=1103, skipped=0, lr=[1.8640354927904837e-05], mom=[(0.9, 0.999)]
steps: 1103 loss: 0.7879 iter time (s): 124.677 samples/sec: 1.027

 30%|███       | 3/10 [06:16<14:38, 125.50s/it][A
 30%|███       | 3/10 [06:16<14:38, 125.46s/it][A
 30%|███       | 3/10 [06:16<14:38, 125.46s/it][A
 30%|███       | 3/10 [06:16<14:38, 125.45s/it][A
 30%|███       | 3/10 [06:16<14:38, 125.52s/it][A
 30%|███       | 3/10 [06:16<14:37, 125.35s/it][A
 30%|███       | 3/10 [06:16<14:37, 125.41s/it][A
 40%|████      | 4/10 [08:19<12:30, 125.14s/it][A[2024-05-31 00:33:47,710] [INFO] [logging.py:96:log_dist] [Rank 0] step=1104, skipped=0, lr=[1.8637502192046558e-05], mom=[(0.9, 0.999)]
steps: 1104 loss: 0.8299 iter time (s): 124.274 samples/sec: 1.030

 40%|████      | 4/10 [08:21<12:31, 125.33s/it][A
 40%|████      | 4/10 [08:21<12:31, 125.32s/it][A
 40%|████      | 4/10 [08:21<12:32, 125.34s/it][A
 40%|████      | 4/10 [08:21<12:31, 125.32s/it][A
 40%|████      | 4/10 [08:21<12:31, 125.30s/it][A
 40%|████      | 4/10 [08:21<12:31, 125.26s/it][A
 40%|████      | 4/10 [08:21<12:31, 125.30s/it][A
 50%|█████     | 5/10 [10:24<10:25, 125.03s/it][A[2024-05-31 00:35:52,570] [INFO] [logging.py:96:log_dist] [Rank 0] step=1105, skipped=0, lr=[1.8634646685384002e-05], mom=[(0.9, 0.999)]
steps: 1105 loss: 0.7571 iter time (s): 123.986 samples/sec: 1.032

 50%|█████     | 5/10 [10:26<10:25, 125.14s/it][A
 50%|█████     | 5/10 [10:25<10:25, 125.12s/it][A
 50%|█████     | 5/10 [10:26<10:25, 125.13s/it][A
 50%|█████     | 5/10 [10:25<10:25, 125.10s/it][A
 50%|█████     | 5/10 [10:25<10:25, 125.11s/it][A
 50%|█████     | 5/10 [10:25<10:25, 125.07s/it][A
 50%|█████     | 5/10 [10:25<10:25, 125.09s/it][A
 60%|██████    | 6/10 [12:29<08:19, 124.97s/it][A[2024-05-31 00:37:57,385] [INFO] [logging.py:96:log_dist] [Rank 0] step=1106, skipped=0, lr=[1.8631788408833273e-05], mom=[(0.9, 0.999)]
steps: 1106 loss: 0.8144 iter time (s): 124.052 samples/sec: 1.032

 60%|██████    | 6/10 [12:30<08:20, 125.03s/it][A
 60%|██████    | 6/10 [12:30<08:20, 125.01s/it][A
 60%|██████    | 6/10 [12:30<08:20, 125.01s/it][A
 60%|██████    | 6/10 [12:30<08:20, 125.02s/it][A
 60%|██████    | 6/10 [12:30<08:20, 125.03s/it][A
 60%|██████    | 6/10 [12:30<08:20, 125.00s/it][A
 60%|██████    | 6/10 [12:30<08:20, 125.02s/it][A
 70%|███████   | 7/10 [14:34<06:14, 124.88s/it][A[2024-05-31 00:40:02,098] [INFO] [logging.py:96:log_dist] [Rank 0] step=1107, skipped=0, lr=[1.8628927363311382e-05], mom=[(0.9, 0.999)]
steps: 1107 loss: 0.8725 iter time (s): 123.878 samples/sec: 1.033

 70%|███████   | 7/10 [14:35<06:14, 124.92s/it][A
 70%|███████   | 7/10 [14:35<06:14, 124.92s/it][A
 70%|███████   | 7/10 [14:35<06:14, 124.88s/it][A
 70%|███████   | 7/10 [14:35<06:14, 124.92s/it][A
 70%|███████   | 7/10 [14:35<06:14, 124.90s/it][A
 70%|███████   | 7/10 [14:35<06:14, 124.87s/it][A
 70%|███████   | 7/10 [14:35<06:14, 124.89s/it][A
 80%|████████  | 8/10 [16:38<04:09, 124.86s/it][A[2024-05-31 00:42:06,932] [INFO] [logging.py:96:log_dist] [Rank 0] step=1108, skipped=0, lr=[1.862606354973622e-05], mom=[(0.9, 0.999)]
steps: 1108 loss: 0.8441 iter time (s): 124.136 samples/sec: 1.031

 80%|████████  | 8/10 [16:40<04:09, 124.87s/it][A
 80%|████████  | 8/10 [16:40<04:09, 124.86s/it][A
 80%|████████  | 8/10 [16:40<04:09, 124.89s/it][A
 80%|████████  | 8/10 [16:40<04:09, 124.90s/it][A
 80%|████████  | 8/10 [16:40<04:09, 124.89s/it][A
 80%|████████  | 8/10 [16:40<04:09, 124.87s/it][A
 80%|████████  | 8/10 [16:40<04:09, 124.88s/it][A
 90%|█████████ | 9/10 [18:44<02:04, 124.96s/it][A[2024-05-31 00:44:12,122] [INFO] [logging.py:96:log_dist] [Rank 0] step=1109, skipped=0, lr=[1.8623196969026577e-05], mom=[(0.9, 0.999)]
steps: 1109 loss: 0.7985 iter time (s): 124.426 samples/sec: 1.029

 90%|█████████ | 9/10 [18:45<02:04, 124.99s/it][A
 90%|█████████ | 9/10 [18:45<02:05, 125.02s/it][A
 90%|█████████ | 9/10 [18:45<02:05, 125.02s/it][A
 90%|█████████ | 9/10 [18:45<02:05, 125.03s/it][A
 90%|█████████ | 9/10 [18:45<02:05, 125.01s/it][A
 90%|█████████ | 9/10 [18:45<02:05, 125.00s/it][A
 90%|█████████ | 9/10 [18:45<02:05, 125.01s/it][A
100%|██████████| 10/10 [20:49<00:00, 124.96s/it][A100%|██████████| 10/10 [20:49<00:00, 124.91s/it]
 22%|██▏       | 112/520 [10:27:08<138:28:06, 1221.78s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-31 00:46:17,088] [INFO] [logging.py:96:log_dist] [Rank 0] step=1110, skipped=0, lr=[1.8620327622102114e-05], mom=[(0.9, 0.999)]
steps: 1110 loss: 0.8258 iter time (s): 124.151 samples/sec: 1.031

100%|██████████| 10/10 [20:50<00:00, 124.96s/it][A100%|██████████| 10/10 [20:50<00:00, 125.05s/it]
 22%|██▏       | 112/520 [10:27:21<138:31:18, 1222.25s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [20:50<00:00, 124.98s/it][A100%|██████████| 10/10 [20:50<00:00, 125.05s/it]
 22%|██▏       | 112/520 [10:27:40<138:31:28, 1222.28s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [20:50<00:00, 125.00s/it][A100%|██████████| 10/10 [20:50<00:00, 125.06s/it]
 22%|██▏       | 112/520 [10:28:22<138:31:44, 1222.32s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [20:50<00:00, 125.03s/it][A100%|██████████| 10/10 [20:50<00:00, 125.07s/it]
 22%|██▏       | 112/520 [10:27:40<138:31:57, 1222.35s/it]
100%|██████████| 10/10 [20:50<00:00, 125.01s/it][A100%|██████████| 10/10 [20:50<00:00, 125.06s/it]
 22%|██▏       | 112/520 [10:27:24<138:31:53, 1222.34s/it]
100%|██████████| 10/10 [20:50<00:00, 125.01s/it][A100%|██████████| 10/10 [20:50<00:00, 125.05s/it]
 22%|██▏       | 112/520 [10:27:20<138:31:53, 1222.34s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_38

100%|██████████| 10/10 [20:50<00:00, 125.01s/it][A100%|██████████| 10/10 [20:50<00:00, 125.05s/it]
 22%|██▏       | 112/520 [10:27:21<138:31:55, 1222.34s/it]
  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:56<17:24, 116.01s/it][A[2024-05-31 00:48:13,024] [INFO] [logging.py:96:log_dist] [Rank 0] step=1111, skipped=0, lr=[1.8617455509883398e-05], mom=[(0.9, 0.999)]
steps: 1111 loss: 0.8501 iter time (s): 114.703 samples/sec: 1.116

 10%|█         | 1/10 [01:55<17:22, 115.86s/it][A
 10%|█         | 1/10 [01:55<17:20, 115.64s/it][A
 10%|█         | 1/10 [01:55<17:21, 115.73s/it][A
 10%|█         | 1/10 [01:55<17:20, 115.58s/it][A
 10%|█         | 1/10 [01:55<17:19, 115.51s/it][A
 10%|█         | 1/10 [01:55<17:19, 115.55s/it][A
 10%|█         | 1/10 [01:55<17:20, 115.58s/it][A
 20%|██        | 2/10 [03:52<15:31, 116.46s/it][A[2024-05-31 00:50:09,787] [INFO] [logging.py:96:log_dist] [Rank 0] step=1112, skipped=0, lr=[1.8614580633291866e-05], mom=[(0.9, 0.999)]
steps: 1112 loss: 0.8376 iter time (s): 116.032 samples/sec: 1.103

 20%|██        | 2/10 [03:52<15:32, 116.51s/it][A
 20%|██        | 2/10 [03:52<15:31, 116.43s/it][A
 20%|██        | 2/10 [03:52<15:31, 116.44s/it][A
 20%|██        | 2/10 [03:52<15:30, 116.37s/it][A
 20%|██        | 2/10 [03:52<15:30, 116.35s/it][A
 20%|██        | 2/10 [03:52<15:30, 116.37s/it][A
 20%|██        | 2/10 [03:52<15:31, 116.38s/it][A
 30%|███       | 3/10 [05:48<13:31, 115.91s/it][A[2024-05-31 00:52:05,044] [INFO] [logging.py:96:log_dist] [Rank 0] step=1113, skipped=0, lr=[1.861170299324985e-05], mom=[(0.9, 0.999)]
steps: 1113 loss: 0.8171 iter time (s): 114.181 samples/sec: 1.121

 30%|███       | 3/10 [05:47<13:30, 115.81s/it][A
 30%|███       | 3/10 [05:47<13:30, 115.78s/it][A
 30%|███       | 3/10 [05:47<13:30, 115.83s/it][A
 30%|███       | 3/10 [05:47<13:30, 115.78s/it][A
 30%|███       | 3/10 [05:47<13:30, 115.76s/it][A
 30%|███       | 3/10 [05:47<13:30, 115.77s/it][A
 30%|███       | 3/10 [05:47<13:30, 115.79s/it][A
 40%|████      | 4/10 [07:42<11:31, 115.33s/it][A[2024-05-31 00:53:59,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=1114, skipped=0, lr=[1.8608822590680574e-05], mom=[(0.9, 0.999)]
steps: 1114 loss: 0.8160 iter time (s): 113.625 samples/sec: 1.127

 40%|████      | 4/10 [07:42<11:31, 115.31s/it][A
 40%|████      | 4/10 [07:42<11:31, 115.31s/it][A
 40%|████      | 4/10 [07:42<11:31, 115.32s/it][A
 40%|████      | 4/10 [07:42<11:31, 115.31s/it][A
 40%|████      | 4/10 [07:42<11:31, 115.31s/it][A
 40%|████      | 4/10 [07:42<11:31, 115.31s/it][A
 40%|████      | 4/10 [07:42<11:31, 115.31s/it][A
 50%|█████     | 5/10 [09:39<09:40, 116.04s/it][A[2024-05-31 00:55:56,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=1115, skipped=0, lr=[1.860593942650814e-05], mom=[(0.9, 0.999)]
steps: 1115 loss: 0.8275 iter time (s): 116.298 samples/sec: 1.101

 50%|█████     | 5/10 [09:39<09:40, 116.02s/it][A
 50%|█████     | 5/10 [09:39<09:39, 116.00s/it][A
 50%|█████     | 5/10 [09:39<09:39, 116.00s/it][A
 50%|█████     | 5/10 [09:39<09:39, 115.99s/it][A
 50%|█████     | 5/10 [09:39<09:39, 115.99s/it][A
 50%|█████     | 5/10 [09:39<09:39, 115.99s/it][A
 50%|█████     | 5/10 [09:39<09:39, 115.99s/it][A
 60%|██████    | 6/10 [11:34<07:41, 115.50s/it][A[2024-05-31 00:57:51,245] [INFO] [logging.py:96:log_dist] [Rank 0] step=1116, skipped=0, lr=[1.860305350165754e-05], mom=[(0.9, 0.999)]
steps: 1116 loss: 0.8413 iter time (s): 113.560 samples/sec: 1.127

 60%|██████    | 6/10 [11:34<07:41, 115.48s/it][A
 60%|██████    | 6/10 [11:33<07:41, 115.49s/it][A
 60%|██████    | 6/10 [11:34<07:41, 115.49s/it][A
 60%|██████    | 6/10 [11:33<07:41, 115.47s/it][A
 60%|██████    | 6/10 [11:33<07:41, 115.46s/it][A
 60%|██████    | 6/10 [11:33<07:41, 115.48s/it][A
 60%|██████    | 6/10 [11:33<07:41, 115.48s/it][A
 70%|███████   | 7/10 [13:30<05:47, 115.72s/it][A[2024-05-31 00:59:47,096] [INFO] [logging.py:96:log_dist] [Rank 0] step=1117, skipped=0, lr=[1.8600164817054645e-05], mom=[(0.9, 0.999)]
steps: 1117 loss: 0.8394 iter time (s): 114.893 samples/sec: 1.114

 70%|███████   | 7/10 [13:29<05:46, 115.59s/it][A
 70%|███████   | 7/10 [13:29<05:46, 115.59s/it][A
 70%|███████   | 7/10 [13:29<05:46, 115.59s/it][A
 70%|███████   | 7/10 [13:29<05:46, 115.57s/it][A
 70%|███████   | 7/10 [13:29<05:46, 115.60s/it][A
 70%|███████   | 7/10 [13:29<05:46, 115.58s/it][A
 70%|███████   | 7/10 [13:29<05:46, 115.58s/it][A
 80%|████████  | 8/10 [15:21<03:48, 114.34s/it][A[2024-05-31 01:01:38,845] [INFO] [logging.py:96:log_dist] [Rank 0] step=1118, skipped=0, lr=[1.8597273373626225e-05], mom=[(0.9, 0.999)]
steps: 1118 loss: 0.8414 iter time (s): 110.860 samples/sec: 1.155

 80%|████████  | 8/10 [15:21<03:48, 114.38s/it][A
 80%|████████  | 8/10 [15:21<03:48, 114.37s/it][A
 80%|████████  | 8/10 [15:21<03:48, 114.36s/it][A
 80%|████████  | 8/10 [15:21<03:48, 114.36s/it][A
 80%|████████  | 8/10 [15:21<03:48, 114.36s/it][A
 80%|████████  | 8/10 [15:21<03:48, 114.37s/it][A
 80%|████████  | 8/10 [15:21<03:48, 114.37s/it][A
 90%|█████████ | 9/10 [17:15<01:54, 114.04s/it][A[2024-05-31 01:03:32,212] [INFO] [logging.py:96:log_dist] [Rank 0] step=1119, skipped=0, lr=[1.859437917229992e-05], mom=[(0.9, 0.999)]
steps: 1119 loss: 0.8550 iter time (s): 112.532 samples/sec: 1.137

 90%|█████████ | 9/10 [17:15<01:54, 114.08s/it][A
 90%|█████████ | 9/10 [17:14<01:54, 114.08s/it][A
 90%|█████████ | 9/10 [17:15<01:54, 114.10s/it][A
 90%|█████████ | 9/10 [17:14<01:54, 114.08s/it][A
 90%|█████████ | 9/10 [17:14<01:54, 114.08s/it][A
 90%|█████████ | 9/10 [17:14<01:54, 114.07s/it][A
 90%|█████████ | 9/10 [17:14<01:54, 114.08s/it][A
100%|██████████| 10/10 [19:11<00:00, 114.78s/it][A100%|██████████| 10/10 [19:11<00:00, 115.16s/it]
 22%|██▏       | 113/520 [10:46:20<135:45:42, 1200.84s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-31 01:05:28,647] [INFO] [logging.py:96:log_dist] [Rank 0] step=1120, skipped=0, lr=[1.8591482214004264e-05], mom=[(0.9, 0.999)]
steps: 1120 loss: 0.8132 iter time (s): 115.470 samples/sec: 1.109

100%|██████████| 10/10 [19:11<00:00, 114.77s/it][A100%|██████████| 10/10 [19:11<00:00, 115.14s/it]
 22%|██▏       | 113/520 [10:46:32<135:46:48, 1201.00s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [19:11<00:00, 114.81s/it][A100%|██████████| 10/10 [19:11<00:00, 115.14s/it]
 22%|██▏       | 113/520 [10:46:52<135:47:02, 1201.04s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [19:11<00:00, 114.77s/it][A100%|██████████| 10/10 [19:11<00:00, 115.13s/it]
 22%|██▏       | 113/520 [10:47:33<135:46:57, 1201.03s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [19:11<00:00, 114.77s/it][A100%|██████████| 10/10 [19:11<00:00, 115.12s/it]
 22%|██▏       | 113/520 [10:46:51<135:46:56, 1201.02s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [19:11<00:00, 114.78s/it][A100%|██████████| 10/10 [19:11<00:00, 115.11s/it]
 22%|██▏       | 113/520 [10:46:35<135:47:00, 1201.03s/it]
100%|██████████| 10/10 [19:11<00:00, 114.77s/it][A100%|██████████| 10/10 [19:11<00:00, 115.12s/it]
 22%|██▏       | 113/520 [10:46:32<135:46:59, 1201.03s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [19:11<00:00, 114.78s/it][A100%|██████████| 10/10 [19:11<00:00, 115.12s/it]
 22%|██▏       | 113/520 [10:46:32<135:47:03, 1201.04s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_227
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:08<10:15, 68.38s/it][A[2024-05-31 01:06:36,479] [INFO] [logging.py:96:log_dist] [Rank 0] step=1121, skipped=0, lr=[1.8588582499668674e-05], mom=[(0.9, 0.999)]
steps: 1121 loss: 0.5896 iter time (s): 66.744 samples/sec: 1.918

 10%|█         | 1/10 [01:07<10:09, 67.74s/it][A
 10%|█         | 1/10 [01:07<10:09, 67.74s/it][A
 10%|█         | 1/10 [01:07<10:09, 67.72s/it][A
 10%|█         | 1/10 [01:07<10:10, 67.83s/it][A
 10%|█         | 1/10 [01:07<10:09, 67.72s/it][A
 10%|█         | 1/10 [01:07<10:10, 67.82s/it][A
 10%|█         | 1/10 [01:07<10:09, 67.75s/it][A
 20%|██        | 2/10 [02:16<09:06, 68.29s/it][A[2024-05-31 01:07:44,699] [INFO] [logging.py:96:log_dist] [Rank 0] step=1122, skipped=0, lr=[1.8585680030223446e-05], mom=[(0.9, 0.999)]
steps: 1122 loss: 0.6439 iter time (s): 67.357 samples/sec: 1.900

 20%|██        | 2/10 [02:15<09:03, 67.99s/it][A
 20%|██        | 2/10 [02:15<09:03, 67.93s/it][A
 20%|██        | 2/10 [02:15<09:03, 67.98s/it][A
 20%|██        | 2/10 [02:15<09:03, 67.94s/it][A
 20%|██        | 2/10 [02:15<09:03, 67.90s/it][A
 20%|██        | 2/10 [02:15<09:03, 67.89s/it][A
 20%|██        | 2/10 [02:15<09:03, 67.91s/it][A
 30%|███       | 3/10 [03:24<07:57, 68.24s/it][A[2024-05-31 01:08:52,873] [INFO] [logging.py:96:log_dist] [Rank 0] step=1123, skipped=0, lr=[1.8582774806599772e-05], mom=[(0.9, 0.999)]
steps: 1123 loss: 0.6469 iter time (s): 67.516 samples/sec: 1.896

 30%|███       | 3/10 [03:24<07:56, 68.08s/it][A
 30%|███       | 3/10 [03:23<07:56, 68.04s/it][A
 30%|███       | 3/10 [03:24<07:56, 68.09s/it][A
 30%|███       | 3/10 [03:24<07:56, 68.04s/it][A
 30%|███       | 3/10 [03:23<07:56, 68.03s/it][A
 30%|███       | 3/10 [03:23<07:56, 68.02s/it][A
 30%|███       | 3/10 [03:23<07:56, 68.03s/it][A
 40%|████      | 4/10 [04:30<06:44, 67.44s/it][A[2024-05-31 01:09:59,084] [INFO] [logging.py:96:log_dist] [Rank 0] step=1124, skipped=0, lr=[1.857986682972971e-05], mom=[(0.9, 0.999)]
steps: 1124 loss: 0.6195 iter time (s): 65.561 samples/sec: 1.952

 40%|████      | 4/10 [04:30<06:43, 67.33s/it][A
 40%|████      | 4/10 [04:30<06:43, 67.32s/it][A
 40%|████      | 4/10 [04:30<06:44, 67.36s/it][A
 40%|████      | 4/10 [04:30<06:43, 67.31s/it][A
 40%|████      | 4/10 [04:30<06:44, 67.34s/it][A
 40%|████      | 4/10 [04:30<06:43, 67.31s/it][A
 40%|████      | 4/10 [04:30<06:43, 67.31s/it][A
 50%|█████     | 5/10 [05:40<05:40, 68.01s/it][A[2024-05-31 01:11:08,102] [INFO] [logging.py:96:log_dist] [Rank 0] step=1125, skipped=0, lr=[1.857695610054622e-05], mom=[(0.9, 0.999)]
steps: 1125 loss: 0.6333 iter time (s): 68.353 samples/sec: 1.873

 50%|█████     | 5/10 [05:39<05:39, 67.93s/it][A
 50%|█████     | 5/10 [05:39<05:39, 67.92s/it][A
 50%|█████     | 5/10 [05:39<05:39, 67.90s/it][A
 50%|█████     | 5/10 [05:39<05:39, 67.91s/it][A
 50%|█████     | 5/10 [05:39<05:39, 67.92s/it][A
 50%|█████     | 5/10 [05:39<05:39, 67.91s/it][A
 50%|█████     | 5/10 [05:39<05:39, 67.91s/it][A
 60%|██████    | 6/10 [06:51<04:36, 69.25s/it][A[2024-05-31 01:12:19,756] [INFO] [logging.py:96:log_dist] [Rank 0] step=1126, skipped=0, lr=[1.8574042619983133e-05], mom=[(0.9, 0.999)]
steps: 1126 loss: 0.6357 iter time (s): 71.216 samples/sec: 1.797

 60%|██████    | 6/10 [06:51<04:37, 69.27s/it][A
 60%|██████    | 6/10 [06:51<04:37, 69.26s/it][A
 60%|██████    | 6/10 [06:51<04:37, 69.26s/it][A
 60%|██████    | 6/10 [06:51<04:37, 69.25s/it][A
 60%|██████    | 6/10 [06:51<04:37, 69.26s/it][A
 60%|██████    | 6/10 [06:50<04:36, 69.25s/it][A
 60%|██████    | 6/10 [06:50<04:37, 69.26s/it][A
 70%|███████   | 7/10 [08:03<03:30, 70.08s/it][A[2024-05-31 01:13:31,543] [INFO] [logging.py:96:log_dist] [Rank 0] step=1127, skipped=0, lr=[1.8571126388975168e-05], mom=[(0.9, 0.999)]
steps: 1127 loss: 0.6641 iter time (s): 70.968 samples/sec: 1.804

 70%|███████   | 7/10 [08:02<03:30, 70.02s/it][A
 70%|███████   | 7/10 [08:02<03:30, 70.01s/it][A
 70%|███████   | 7/10 [08:02<03:30, 70.04s/it][A
 70%|███████   | 7/10 [08:02<03:30, 70.02s/it][A
 70%|███████   | 7/10 [08:02<03:30, 70.02s/it][A
 70%|███████   | 7/10 [08:02<03:30, 70.02s/it][A
 70%|███████   | 7/10 [08:02<03:30, 70.03s/it][A
 80%|████████  | 8/10 [09:12<02:19, 69.66s/it][A[2024-05-31 01:14:40,103] [INFO] [logging.py:96:log_dist] [Rank 0] step=1128, skipped=0, lr=[1.8568207408457917e-05], mom=[(0.9, 0.999)]
steps: 1128 loss: 0.6623 iter time (s): 67.930 samples/sec: 1.884

 80%|████████  | 8/10 [09:11<02:19, 69.56s/it][A
 80%|████████  | 8/10 [09:11<02:19, 69.58s/it][A
 80%|████████  | 8/10 [09:11<02:19, 69.56s/it][A
 80%|████████  | 8/10 [09:11<02:19, 69.55s/it][A
 80%|████████  | 8/10 [09:11<02:19, 69.57s/it][A
 80%|████████  | 8/10 [09:11<02:19, 69.56s/it][A
 80%|████████  | 8/10 [09:11<02:19, 69.56s/it][A
 90%|█████████ | 9/10 [10:16<01:07, 67.88s/it][A[2024-05-31 01:15:44,282] [INFO] [logging.py:96:log_dist] [Rank 0] step=1129, skipped=0, lr=[1.856528567936787e-05], mom=[(0.9, 0.999)]
steps: 1129 loss: 0.6479 iter time (s): 63.515 samples/sec: 2.015

 90%|█████████ | 9/10 [10:15<01:07, 67.86s/it][A
 90%|█████████ | 9/10 [10:15<01:07, 67.90s/it][A
 90%|█████████ | 9/10 [10:15<01:07, 67.89s/it][A
 90%|█████████ | 9/10 [10:15<01:07, 67.88s/it][A
 90%|█████████ | 9/10 [10:15<01:07, 67.86s/it][A
 90%|█████████ | 9/10 [10:15<01:07, 67.87s/it][A
 90%|█████████ | 9/10 [10:15<01:07, 67.87s/it][A
100%|██████████| 10/10 [11:23<00:00, 67.73s/it][A100%|██████████| 10/10 [11:23<00:00, 68.36s/it]
 22%|██▏       | 114/520 [10:57:44<117:57:00, 1045.86s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-31 01:16:51,581] [INFO] [logging.py:96:log_dist] [Rank 0] step=1130, skipped=0, lr=[1.8562361202642387e-05], mom=[(0.9, 0.999)]
steps: 1130 loss: 0.6118 iter time (s): 66.705 samples/sec: 1.919

100%|██████████| 10/10 [11:22<00:00, 67.69s/it][A100%|██████████| 10/10 [11:22<00:00, 68.28s/it]
 22%|██▏       | 114/520 [10:57:55<117:54:59, 1045.57s/it]
100%|██████████| 10/10 [11:22<00:00, 67.69s/it][A100%|██████████| 10/10 [11:22<00:00, 68.26s/it]
 22%|██▏       | 114/520 [10:58:14<117:54:45, 1045.53s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:22<00:00, 67.68s/it][A100%|██████████| 10/10 [11:22<00:00, 68.27s/it]
 22%|██▏       | 114/520 [10:58:56<117:54:46, 1045.53s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:22<00:00, 67.70s/it][A100%|██████████| 10/10 [11:22<00:00, 68.27s/it]
 22%|██▏       | 114/520 [10:58:14<117:54:51, 1045.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:22<00:00, 67.69s/it][A100%|██████████| 10/10 [11:22<00:00, 68.26s/it]
 22%|██▏       | 114/520 [10:57:58<117:54:48, 1045.54s/it]
100%|██████████| 10/10 [11:22<00:00, 67.69s/it][A100%|██████████| 10/10 [11:22<00:00, 68.26s/it]
 22%|██▏       | 114/520 [10:57:55<117:54:47, 1045.54s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:22<00:00, 67.70s/it][A100%|██████████| 10/10 [11:22<00:00, 68.26s/it]
 22%|██▏       | 114/520 [10:57:55<117:54:52, 1045.55s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_69
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:28<13:14, 88.26s/it][A[2024-05-31 01:18:21,130] [INFO] [logging.py:96:log_dist] [Rank 0] step=1131, skipped=0, lr=[1.8559433979219707e-05], mom=[(0.9, 0.999)]
steps: 1131 loss: 1.0727 iter time (s): 88.625 samples/sec: 1.444

 10%|█         | 1/10 [01:29<13:26, 89.64s/it][A
 10%|█         | 1/10 [01:29<13:27, 89.73s/it][A
 10%|█         | 1/10 [01:29<13:28, 89.80s/it][A
 10%|█         | 1/10 [01:29<13:28, 89.80s/it][A
 10%|█         | 1/10 [01:29<13:28, 89.80s/it][A
 10%|█         | 1/10 [01:29<13:28, 89.81s/it][A
 10%|█         | 1/10 [01:29<13:27, 89.68s/it][A
 20%|██        | 2/10 [03:00<12:03, 90.45s/it][A[2024-05-31 01:19:53,116] [INFO] [logging.py:96:log_dist] [Rank 0] step=1132, skipped=0, lr=[1.855650401003897e-05], mom=[(0.9, 0.999)]
steps: 1132 loss: 1.0654 iter time (s): 91.230 samples/sec: 1.403

 20%|██        | 2/10 [03:01<12:08, 91.06s/it][A
 20%|██        | 2/10 [03:01<12:08, 91.06s/it][A
 20%|██        | 2/10 [03:01<12:08, 91.07s/it][A
 20%|██        | 2/10 [03:01<12:08, 91.10s/it][A
 20%|██        | 2/10 [03:01<12:08, 91.10s/it][A
 20%|██        | 2/10 [03:01<12:08, 91.09s/it][A
 20%|██        | 2/10 [03:01<12:08, 91.04s/it][A
 30%|███       | 3/10 [04:27<10:22, 88.91s/it][A[2024-05-31 01:21:20,188] [INFO] [logging.py:96:log_dist] [Rank 0] step=1133, skipped=0, lr=[1.855357129604017e-05], mom=[(0.9, 0.999)]
steps: 1133 loss: 1.0801 iter time (s): 86.131 samples/sec: 1.486

 30%|███       | 3/10 [04:28<10:24, 89.17s/it][A
 30%|███       | 3/10 [04:28<10:24, 89.15s/it][A
 30%|███       | 3/10 [04:28<10:24, 89.15s/it][A
 30%|███       | 3/10 [04:28<10:24, 89.15s/it][A
 30%|███       | 3/10 [04:28<10:24, 89.16s/it][A
 30%|███       | 3/10 [04:28<10:24, 89.16s/it][A
 30%|███       | 3/10 [04:28<10:23, 89.14s/it][A
 40%|████      | 4/10 [05:57<08:55, 89.25s/it][A[2024-05-31 01:22:49,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=1134, skipped=0, lr=[1.8550635838164194e-05], mom=[(0.9, 0.999)]
steps: 1134 loss: 1.0797 iter time (s): 89.053 samples/sec: 1.437

 40%|████      | 4/10 [05:58<08:56, 89.41s/it][A
 40%|████      | 4/10 [05:58<08:56, 89.41s/it][A
 40%|████      | 4/10 [05:58<08:56, 89.41s/it][A
 40%|████      | 4/10 [05:58<08:56, 89.40s/it][A
 40%|████      | 4/10 [05:58<08:56, 89.40s/it][A
 40%|████      | 4/10 [05:58<08:56, 89.40s/it][A
 40%|████      | 4/10 [05:58<08:56, 89.39s/it][A
 50%|█████     | 5/10 [07:24<07:22, 88.54s/it][A[2024-05-31 01:24:17,237] [INFO] [logging.py:96:log_dist] [Rank 0] step=1135, skipped=0, lr=[1.854769763735282e-05], mom=[(0.9, 0.999)]
steps: 1135 loss: 1.0410 iter time (s): 86.581 samples/sec: 1.478

 50%|█████     | 5/10 [07:25<07:23, 88.63s/it][A
 50%|█████     | 5/10 [07:25<07:23, 88.66s/it][A
 50%|█████     | 5/10 [07:25<07:23, 88.66s/it][A
 50%|█████     | 5/10 [07:25<07:23, 88.66s/it][A
 50%|█████     | 5/10 [07:25<07:23, 88.67s/it][A
 50%|█████     | 5/10 [07:25<07:23, 88.66s/it][A
 50%|█████     | 5/10 [07:25<07:23, 88.65s/it][A
 60%|██████    | 6/10 [08:54<05:56, 89.13s/it][A[2024-05-31 01:25:47,505] [INFO] [logging.py:96:log_dist] [Rank 0] step=1136, skipped=0, lr=[1.854475669454869e-05], mom=[(0.9, 0.999)]
steps: 1136 loss: 1.0440 iter time (s): 89.517 samples/sec: 1.430

 60%|██████    | 6/10 [08:55<05:56, 89.19s/it][A
 60%|██████    | 6/10 [08:56<05:56, 89.23s/it][A
 60%|██████    | 6/10 [08:56<05:56, 89.22s/it][A
 60%|██████    | 6/10 [08:56<05:56, 89.20s/it][A
 60%|██████    | 6/10 [08:56<05:56, 89.21s/it][A
 60%|██████    | 6/10 [08:56<05:56, 89.21s/it][A
 60%|██████    | 6/10 [08:55<05:56, 89.20s/it][A
 70%|███████   | 7/10 [10:19<04:23, 87.73s/it][A[2024-05-31 01:27:12,331] [INFO] [logging.py:96:log_dist] [Rank 0] step=1137, skipped=0, lr=[1.854181301069533e-05], mom=[(0.9, 0.999)]
steps: 1137 loss: 1.0634 iter time (s): 84.098 samples/sec: 1.522

 70%|███████   | 7/10 [10:20<04:23, 87.78s/it][A
 70%|███████   | 7/10 [10:20<04:23, 87.79s/it][A
 70%|███████   | 7/10 [10:20<04:23, 87.79s/it][A
 70%|███████   | 7/10 [10:20<04:23, 87.78s/it][A
 70%|███████   | 7/10 [10:20<04:23, 87.78s/it][A
 70%|███████   | 7/10 [10:20<04:23, 87.78s/it][A
 70%|███████   | 7/10 [10:20<04:23, 87.78s/it][A
 80%|████████  | 8/10 [11:44<02:53, 86.73s/it][A[2024-05-31 01:28:36,928] [INFO] [logging.py:96:log_dist] [Rank 0] step=1138, skipped=0, lr=[1.8538866586737148e-05], mom=[(0.9, 0.999)]
steps: 1138 loss: 1.0716 iter time (s): 83.768 samples/sec: 1.528

 80%|████████  | 8/10 [11:45<02:53, 86.73s/it][A
 80%|████████  | 8/10 [11:45<02:53, 86.77s/it][A
 80%|████████  | 8/10 [11:45<02:53, 86.76s/it][A
 80%|████████  | 8/10 [11:45<02:53, 86.76s/it][A
 80%|████████  | 8/10 [11:45<02:53, 86.76s/it][A
 80%|████████  | 8/10 [11:45<02:53, 86.86s/it][A
 80%|████████  | 8/10 [11:45<02:53, 86.91s/it][A
 90%|█████████ | 9/10 [13:11<01:26, 86.93s/it][A[2024-05-31 01:30:04,309] [INFO] [logging.py:96:log_dist] [Rank 0] step=1139, skipped=0, lr=[1.8535917423619432e-05], mom=[(0.9, 0.999)]
steps: 1139 loss: 1.0285 iter time (s): 86.274 samples/sec: 1.484

 90%|█████████ | 9/10 [13:12<01:26, 86.94s/it][A
 90%|█████████ | 9/10 [13:12<01:26, 86.96s/it][A
 90%|█████████ | 9/10 [13:12<01:26, 86.92s/it][A
 90%|█████████ | 9/10 [13:12<01:26, 86.90s/it][A
 90%|█████████ | 9/10 [13:12<01:26, 86.97s/it][A
 90%|█████████ | 9/10 [13:12<01:26, 86.95s/it][A
 90%|█████████ | 9/10 [13:12<01:26, 86.92s/it][A
100%|██████████| 10/10 [14:37<00:00, 86.57s/it][A100%|██████████| 10/10 [14:37<00:00, 87.72s/it]
[2024-05-31 01:31:30,063] [INFO] [logging.py:96:log_dist] [Rank 0] step=1140, skipped=0, lr=[1.8532965522288343e-05], mom=[(0.9, 0.999)]
steps: 1140 loss: 1.0554 iter time (s): 84.976 samples/sec: 1.506

100%|██████████| 10/10 [14:38<00:00, 86.54s/it][A100%|██████████| 10/10 [14:38<00:00, 87.84s/it]

100%|██████████| 10/10 [14:38<00:00, 86.60s/it][A100%|██████████| 10/10 [14:38<00:00, 87.86s/it]

100%|██████████| 10/10 [14:38<00:00, 86.55s/it][A100%|██████████| 10/10 [14:38<00:00, 87.85s/it]

100%|██████████| 10/10 [14:38<00:00, 86.53s/it][A100%|██████████| 10/10 [14:38<00:00, 87.85s/it]

100%|██████████| 10/10 [14:38<00:00, 86.58s/it][A100%|██████████| 10/10 [14:38<00:00, 87.86s/it]

100%|██████████| 10/10 [14:38<00:00, 86.56s/it][A100%|██████████| 10/10 [14:38<00:00, 87.85s/it]

100%|██████████| 10/10 [14:38<00:00, 86.54s/it][A100%|██████████| 10/10 [14:38<00:00, 87.84s/it]
Checkpointing at shard 115
[2024-05-31 01:31:30,841] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step1140 is about to be saved!
[2024-05-31 01:31:32,814] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_00-model_states.pt...
[2024-05-31 01:31:37,807] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_02-model_states.pt...
[2024-05-31 01:31:38,512] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_06-model_states.pt...
[2024-05-31 01:31:38,656] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_05-model_states.pt...
[2024-05-31 01:31:38,724] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_07-model_states.pt...
[2024-05-31 01:31:39,468] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_08-model_states.pt...
[2024-05-31 01:31:43,631] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_00-model_states.pt.
[2024-05-31 01:31:44,058] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_04-model_states.pt...
[2024-05-31 01:31:44,566] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_03-model_states.pt...
[2024-05-31 01:31:52,724] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_01-model_states.pt...
[2024-05-31 01:44:00,718] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_07-model_states.pt.
[2024-05-31 01:44:01,207] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_06_model_states.pt...
[2024-05-31 01:44:01,994] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_06_model_states.pt.
[2024-05-31 01:44:01,994] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1140 is ready now!
[2024-05-31 01:44:05,593] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_08-model_states.pt.
[2024-05-31 01:44:06,267] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_09-model_states.pt...
[2024-05-31 01:44:13,403] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_09-model_states.pt.
[2024-05-31 01:44:13,419] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_07_model_states.pt...
[2024-05-31 01:44:13,892] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_07_model_states.pt.
[2024-05-31 01:44:13,892] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1140 is ready now!
[2024-05-31 01:44:14,594] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_05-model_states.pt.
[2024-05-31 01:44:15,055] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_04_model_states.pt...
[2024-05-31 01:44:16,070] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_04_model_states.pt.
[2024-05-31 01:44:16,071] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1140 is ready now!
[2024-05-31 01:44:35,938] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_01-model_states.pt.
[2024-05-31 01:44:36,365] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_06-model_states.pt.
[2024-05-31 01:44:36,622] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_00_model_states.pt
[2024-05-31 01:44:36,623] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_00_model_states.pt...
[2024-05-31 01:44:36,669] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_05_model_states.pt...
[2024-05-31 01:44:37,263] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_05_model_states.pt.
[2024-05-31 01:44:37,263] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1140 is ready now!
[2024-05-31 01:44:39,421] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_00_model_states.pt.
[2024-05-31 01:44:39,421] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1140 is ready now!
[2024-05-31 01:44:49,104] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_02-model_states.pt.
[2024-05-31 01:44:49,242] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_01_model_states.pt
[2024-05-31 01:44:49,243] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_01_model_states.pt...
[2024-05-31 01:44:50,426] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_01_model_states.pt.
[2024-05-31 01:44:50,426] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1140 is ready now!
[2024-05-31 01:45:01,832] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_03-model_states.pt.
[2024-05-31 01:45:01,852] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/layer_04-model_states.pt.
[2024-05-31 01:45:01,922] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_03_model_states.pt...
[2024-05-31 01:45:02,146] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_03_model_states.pt.
[2024-05-31 01:45:02,147] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1140 is ready now!
[2024-05-31 01:45:02,526] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_02_model_states.pt...
[2024-05-31 01:45:02,875] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1140/mp_rank_02_model_states.pt.
[2024-05-31 01:45:02,875] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1140 is ready now!
 22%|██▏       | 115/520 [11:26:25<139:23:47, 1239.08s/it] 22%|██▏       | 115/520 [11:26:09<139:23:42, 1239.07s/it]Checkpoint saved using --- 812.0395619869232 seconds ---
 22%|██▏       | 115/520 [11:26:05<139:23:35, 1239.05s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_106
 22%|██▏       | 115/520 [11:26:06<139:23:39, 1239.06s/it] 22%|██▏       | 115/520 [11:26:06<139:24:28, 1239.18s/it] 22%|██▏       | 115/520 [11:25:56<139:28:38, 1239.80s/it] 22%|██▏       | 115/520 [11:26:25<139:24:13, 1239.14s/it] 22%|██▏       | 115/520 [11:27:06<139:24:01, 1239.11s/it]Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A

  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:24<12:36, 84.01s/it][A[2024-05-31 01:46:29,181] [INFO] [logging.py:96:log_dist] [Rank 0] step=1141, skipped=0, lr=[1.853001088369093e-05], mom=[(0.9, 0.999)]
steps: 1141 loss: 1.0548 iter time (s): 85.646 samples/sec: 1.495

 10%|█         | 1/10 [01:26<12:54, 86.06s/it][A
 10%|█         | 1/10 [01:26<12:55, 86.17s/it][A
 10%|█         | 1/10 [01:26<12:56, 86.26s/it][A
 10%|█         | 1/10 [01:26<12:57, 86.38s/it][A
 10%|█         | 1/10 [01:26<12:57, 86.39s/it][A
 10%|█         | 1/10 [01:26<12:57, 86.43s/it][A
 10%|█         | 1/10 [01:26<12:58, 86.46s/it][A
 20%|██        | 2/10 [02:50<11:22, 85.33s/it][A[2024-05-31 01:47:55,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=1142, skipped=0, lr=[1.852705350877511e-05], mom=[(0.9, 0.999)]
steps: 1142 loss: 1.0362 iter time (s): 85.478 samples/sec: 1.497

 20%|██        | 2/10 [02:52<11:29, 86.15s/it][A
 20%|██        | 2/10 [02:52<11:29, 86.19s/it][A
 20%|██        | 2/10 [02:52<11:29, 86.20s/it][A
 20%|██        | 2/10 [02:52<11:30, 86.28s/it][A
 20%|██        | 2/10 [02:52<11:30, 86.32s/it][A
 20%|██        | 2/10 [02:52<11:30, 86.33s/it][A
 20%|██        | 2/10 [02:52<11:30, 86.33s/it][A
 30%|███       | 3/10 [04:16<09:58, 85.53s/it][A[2024-05-31 01:49:21,202] [INFO] [logging.py:96:log_dist] [Rank 0] step=1143, skipped=0, lr=[1.8524093398489678e-05], mom=[(0.9, 0.999)]
steps: 1143 loss: 1.0618 iter time (s): 85.000 samples/sec: 1.506

 30%|███       | 3/10 [04:17<10:01, 85.95s/it][A
 30%|███       | 3/10 [04:18<10:01, 85.98s/it][A
 30%|███       | 3/10 [04:18<10:02, 86.00s/it][A
 30%|███       | 3/10 [04:18<10:02, 86.02s/it][A
 30%|███       | 3/10 [04:18<10:02, 86.04s/it][A
 30%|███       | 3/10 [04:18<10:02, 86.05s/it][A
 30%|███       | 3/10 [04:18<10:02, 86.05s/it][A
 40%|████      | 4/10 [05:44<08:39, 86.66s/it][A[2024-05-31 01:50:49,603] [INFO] [logging.py:96:log_dist] [Rank 0] step=1144, skipped=0, lr=[1.852113055378432e-05], mom=[(0.9, 0.999)]
steps: 1144 loss: 1.0385 iter time (s): 87.692 samples/sec: 1.460

 40%|████      | 4/10 [05:46<08:41, 86.93s/it][A
 40%|████      | 4/10 [05:46<08:41, 86.94s/it][A
 40%|████      | 4/10 [05:46<08:41, 86.95s/it][A
 40%|████      | 4/10 [05:46<08:41, 86.98s/it][A
 40%|████      | 4/10 [05:46<08:41, 86.99s/it][A
 40%|████      | 4/10 [05:46<08:41, 86.99s/it][A
 40%|████      | 4/10 [05:46<08:41, 87.00s/it][A
 50%|█████     | 5/10 [07:12<07:15, 87.02s/it][A[2024-05-31 01:52:17,268] [INFO] [logging.py:96:log_dist] [Rank 0] step=1145, skipped=0, lr=[1.8518164975609584e-05], mom=[(0.9, 0.999)]
steps: 1145 loss: 1.0429 iter time (s): 86.972 samples/sec: 1.472

 50%|█████     | 5/10 [07:14<07:16, 87.22s/it][A
 50%|█████     | 5/10 [07:14<07:16, 87.24s/it][A
 50%|█████     | 5/10 [07:14<07:16, 87.25s/it][A
 50%|█████     | 5/10 [07:14<07:16, 87.24s/it][A
 50%|█████     | 5/10 [07:14<07:16, 87.26s/it][A
 50%|█████     | 5/10 [07:14<07:16, 87.26s/it][A
 50%|█████     | 5/10 [07:14<07:16, 87.26s/it][A
 60%|██████    | 6/10 [08:41<05:51, 87.96s/it][A[2024-05-31 01:53:47,053] [INFO] [logging.py:96:log_dist] [Rank 0] step=1146, skipped=0, lr=[1.85151966649169e-05], mom=[(0.9, 0.999)]
steps: 1146 loss: 1.0500 iter time (s): 89.019 samples/sec: 1.438

 60%|██████    | 6/10 [08:43<05:52, 88.10s/it][A
 60%|██████    | 6/10 [08:44<05:52, 88.10s/it][A
 60%|██████    | 6/10 [08:44<05:52, 88.11s/it][A
 60%|██████    | 6/10 [08:44<05:52, 88.12s/it][A
 60%|██████    | 6/10 [08:44<05:52, 88.12s/it][A
 60%|██████    | 6/10 [08:44<05:52, 88.11s/it][A
 60%|██████    | 6/10 [08:44<05:52, 88.12s/it][A
 70%|███████   | 7/10 [10:08<04:22, 87.54s/it][A[2024-05-31 01:55:13,714] [INFO] [logging.py:96:log_dist] [Rank 0] step=1147, skipped=0, lr=[1.8512225622658585e-05], mom=[(0.9, 0.999)]
steps: 1147 loss: 1.0218 iter time (s): 85.831 samples/sec: 1.491

 70%|███████   | 7/10 [10:10<04:22, 87.60s/it][A
 70%|███████   | 7/10 [10:10<04:22, 87.60s/it][A
 70%|███████   | 7/10 [10:10<04:22, 87.60s/it][A
 70%|███████   | 7/10 [10:10<04:22, 87.64s/it][A
 70%|███████   | 7/10 [10:10<04:22, 87.62s/it][A
 70%|███████   | 7/10 [10:10<04:22, 87.62s/it][A
 70%|███████   | 7/10 [10:10<04:22, 87.62s/it][A
 80%|████████  | 8/10 [11:36<02:55, 87.51s/it][A[2024-05-31 01:56:41,177] [INFO] [logging.py:96:log_dist] [Rank 0] step=1148, skipped=0, lr=[1.850925184978782e-05], mom=[(0.9, 0.999)]
steps: 1148 loss: 1.0437 iter time (s): 86.694 samples/sec: 1.476

 80%|████████  | 8/10 [11:37<02:55, 87.56s/it][A
 80%|████████  | 8/10 [11:38<02:55, 87.55s/it][A
 80%|████████  | 8/10 [11:38<02:55, 87.57s/it][A
 80%|████████  | 8/10 [11:38<02:55, 87.57s/it][A
 80%|████████  | 8/10 [11:38<02:55, 87.55s/it][A
 80%|████████  | 8/10 [11:38<02:55, 87.57s/it][A
 80%|████████  | 8/10 [11:38<02:55, 87.57s/it][A
 90%|█████████ | 9/10 [13:04<01:27, 87.70s/it][A[2024-05-31 01:58:09,281] [INFO] [logging.py:96:log_dist] [Rank 0] step=1149, skipped=0, lr=[1.8506275347258654e-05], mom=[(0.9, 0.999)]
steps: 1149 loss: 1.0627 iter time (s): 87.349 samples/sec: 1.465

 90%|█████████ | 9/10 [13:06<01:27, 87.71s/it][A
 90%|█████████ | 9/10 [13:06<01:27, 87.72s/it][A
 90%|█████████ | 9/10 [13:06<01:27, 87.73s/it][A
 90%|█████████ | 9/10 [13:06<01:27, 87.73s/it][A
 90%|█████████ | 9/10 [13:06<01:27, 87.73s/it][A
 90%|█████████ | 9/10 [13:06<01:27, 87.72s/it][A
 90%|█████████ | 9/10 [13:06<01:27, 87.73s/it][A
100%|██████████| 10/10 [14:29<00:00, 87.10s/it][A100%|██████████| 10/10 [14:29<00:00, 86.99s/it]
 22%|██▏       | 116/520 [11:40:27<126:42:07, 1129.03s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-31 01:59:35,039] [INFO] [logging.py:96:log_dist] [Rank 0] step=1150, skipped=0, lr=[1.8503296116026036e-05], mom=[(0.9, 0.999)]
steps: 1150 loss: 1.0489 iter time (s): 85.003 samples/sec: 1.506

100%|██████████| 10/10 [14:31<00:00, 87.13s/it][A100%|██████████| 10/10 [14:31<00:00, 87.19s/it]
 22%|██▏       | 116/520 [11:40:39<126:43:16, 1129.20s/it]
100%|██████████| 10/10 [14:31<00:00, 87.11s/it][A100%|██████████| 10/10 [14:31<00:00, 87.19s/it]
 22%|██▏       | 116/520 [11:40:58<126:43:10, 1129.18s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:32<00:00, 87.12s/it][A100%|██████████| 10/10 [14:32<00:00, 87.21s/it]
 22%|██▏       | 116/520 [11:41:39<126:43:24, 1129.22s/it]
100%|██████████| 10/10 [14:32<00:00, 87.11s/it][A100%|██████████| 10/10 [14:32<00:00, 87.21s/it]
 22%|██▏       | 116/520 [11:40:57<126:43:17, 1129.20s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:32<00:00, 87.12s/it][A100%|██████████| 10/10 [14:32<00:00, 87.22s/it]
 22%|██▏       | 116/520 [11:40:42<126:43:24, 1129.22s/it]
100%|██████████| 10/10 [14:32<00:00, 87.11s/it][A100%|██████████| 10/10 [14:32<00:00, 87.22s/it]
 22%|██▏       | 116/520 [11:40:39<126:43:25, 1129.22s/it]
100%|██████████| 10/10 [14:32<00:00, 87.11s/it][A100%|██████████| 10/10 [14:32<00:00, 87.23s/it]
 22%|██▏       | 116/520 [11:40:38<126:43:26, 1129.22s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_339

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:33<14:05, 93.97s/it][A[2024-05-31 02:01:09,793] [INFO] [logging.py:96:log_dist] [Rank 0] step=1151, skipped=0, lr=[1.8500314157045768e-05], mom=[(0.9, 0.999)]
steps: 1151 loss: 0.5677 iter time (s): 93.910 samples/sec: 1.363

 10%|█         | 1/10 [01:34<14:13, 94.82s/it][A
 10%|█         | 1/10 [01:34<14:14, 94.97s/it][A
 10%|█         | 1/10 [01:34<14:13, 94.84s/it][A
 10%|█         | 1/10 [01:34<14:14, 94.98s/it][A
 10%|█         | 1/10 [01:34<14:13, 94.83s/it][A
 10%|█         | 1/10 [01:34<14:13, 94.88s/it][A
 10%|█         | 1/10 [01:34<14:14, 94.90s/it][A
 20%|██        | 2/10 [03:05<12:22, 92.81s/it][A[2024-05-31 02:02:41,787] [INFO] [logging.py:96:log_dist] [Rank 0] step=1152, skipped=0, lr=[1.8497329471274545e-05], mom=[(0.9, 0.999)]
steps: 1152 loss: 0.5609 iter time (s): 91.050 samples/sec: 1.406

 20%|██        | 2/10 [03:06<12:24, 93.05s/it][A
 20%|██        | 2/10 [03:06<12:24, 93.10s/it][A
 20%|██        | 2/10 [03:06<12:24, 93.10s/it][A
 20%|██        | 2/10 [03:06<12:25, 93.15s/it][A
 20%|██        | 2/10 [03:06<12:24, 93.12s/it][A
 20%|██        | 2/10 [03:06<12:24, 93.10s/it][A
 20%|██        | 2/10 [03:06<12:24, 93.12s/it][A
 30%|███       | 3/10 [04:39<10:50, 92.95s/it][A[2024-05-31 02:04:14,904] [INFO] [logging.py:96:log_dist] [Rank 0] step=1153, skipped=0, lr=[1.8494342059669922e-05], mom=[(0.9, 0.999)]
steps: 1153 loss: 0.5511 iter time (s): 92.251 samples/sec: 1.388

 30%|███       | 3/10 [04:39<10:51, 93.09s/it][A
 30%|███       | 3/10 [04:39<10:51, 93.12s/it][A
 30%|███       | 3/10 [04:39<10:51, 93.09s/it][A
 30%|███       | 3/10 [04:39<10:51, 93.10s/it][A
 30%|███       | 3/10 [04:39<10:51, 93.07s/it][A
 30%|███       | 3/10 [04:39<10:51, 93.09s/it][A
 30%|███       | 3/10 [04:39<10:51, 93.09s/it][A
 40%|████      | 4/10 [06:13<09:20, 93.40s/it][A[2024-05-31 02:05:48,995] [INFO] [logging.py:96:log_dist] [Rank 0] step=1154, skipped=0, lr=[1.8491351923190337e-05], mom=[(0.9, 0.999)]
steps: 1154 loss: 0.5518 iter time (s): 93.316 samples/sec: 1.372

 40%|████      | 4/10 [06:14<09:21, 93.55s/it][A
 40%|████      | 4/10 [06:14<09:21, 93.56s/it][A
 40%|████      | 4/10 [06:14<09:21, 93.56s/it][A
 40%|████      | 4/10 [06:14<09:21, 93.57s/it][A
 40%|████      | 4/10 [06:14<09:21, 93.59s/it][A
 40%|████      | 4/10 [06:14<09:21, 93.57s/it][A
 40%|████      | 4/10 [06:14<09:21, 93.57s/it][A
 50%|█████     | 5/10 [07:47<07:48, 93.79s/it][A[2024-05-31 02:07:23,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=1155, skipped=0, lr=[1.84883590627951e-05], mom=[(0.9, 0.999)]
steps: 1155 loss: 0.5506 iter time (s): 93.456 samples/sec: 1.370

 50%|█████     | 5/10 [07:48<07:49, 93.82s/it][A
 50%|█████     | 5/10 [07:48<07:49, 93.81s/it][A
 50%|█████     | 5/10 [07:48<07:49, 93.82s/it][A
 50%|█████     | 5/10 [07:48<07:49, 93.86s/it][A
 50%|█████     | 5/10 [07:48<07:49, 93.83s/it][A
 50%|█████     | 5/10 [07:48<07:49, 93.83s/it][A
 50%|█████     | 5/10 [07:48<07:49, 93.84s/it][A
 60%|██████    | 6/10 [09:23<06:17, 94.35s/it][A[2024-05-31 02:08:58,911] [INFO] [logging.py:96:log_dist] [Rank 0] step=1156, skipped=0, lr=[1.8485363479444395e-05], mom=[(0.9, 0.999)]
steps: 1156 loss: 0.5470 iter time (s): 94.628 samples/sec: 1.353

 60%|██████    | 6/10 [09:23<06:17, 94.38s/it][A
 60%|██████    | 6/10 [09:23<06:17, 94.37s/it][A
 60%|██████    | 6/10 [09:23<06:17, 94.38s/it][A
 60%|██████    | 6/10 [09:23<06:17, 94.38s/it][A
 60%|██████    | 6/10 [09:23<06:17, 94.39s/it][A
 60%|██████    | 6/10 [09:23<06:17, 94.39s/it][A
 60%|██████    | 6/10 [09:23<06:17, 94.39s/it][A
 70%|███████   | 7/10 [11:05<04:50, 96.97s/it][A[2024-05-31 02:10:41,150] [INFO] [logging.py:96:log_dist] [Rank 0] step=1157, skipped=0, lr=[1.8482365174099276e-05], mom=[(0.9, 0.999)]
steps: 1157 loss: 0.5659 iter time (s): 101.365 samples/sec: 1.263

 70%|███████   | 7/10 [11:06<04:50, 96.97s/it][A
 70%|███████   | 7/10 [11:06<04:50, 96.94s/it][A
 70%|███████   | 7/10 [11:06<04:50, 96.96s/it][A
 70%|███████   | 7/10 [11:06<04:50, 96.98s/it][A
 70%|███████   | 7/10 [11:06<04:50, 96.96s/it][A
 70%|███████   | 7/10 [11:06<04:50, 96.98s/it][A
 70%|███████   | 7/10 [11:06<04:50, 96.99s/it][A
 80%|████████  | 8/10 [12:36<03:10, 95.22s/it][A[2024-05-31 02:12:12,751] [INFO] [logging.py:96:log_dist] [Rank 0] step=1158, skipped=0, lr=[1.8479364147721685e-05], mom=[(0.9, 0.999)]
steps: 1158 loss: 0.5592 iter time (s): 90.666 samples/sec: 1.412

 80%|████████  | 8/10 [12:37<03:10, 95.28s/it][A
 80%|████████  | 8/10 [12:37<03:10, 95.29s/it][A
 80%|████████  | 8/10 [12:37<03:10, 95.28s/it][A
 80%|████████  | 8/10 [12:37<03:10, 95.28s/it][A
 80%|████████  | 8/10 [12:37<03:10, 95.28s/it][A
 80%|████████  | 8/10 [12:37<03:10, 95.27s/it][A
 80%|████████  | 8/10 [12:37<03:10, 95.27s/it][A
 90%|█████████ | 9/10 [14:13<01:35, 95.66s/it][A[2024-05-31 02:13:49,378] [INFO] [logging.py:96:log_dist] [Rank 0] step=1159, skipped=0, lr=[1.847636040127441e-05], mom=[(0.9, 0.999)]
steps: 1159 loss: 0.5538 iter time (s): 95.693 samples/sec: 1.338

 90%|█████████ | 9/10 [14:14<01:35, 95.65s/it][A
 90%|█████████ | 9/10 [14:14<01:35, 95.69s/it][A
 90%|█████████ | 9/10 [14:14<01:35, 95.69s/it][A
 90%|█████████ | 9/10 [14:14<01:35, 95.68s/it][A
 90%|█████████ | 9/10 [14:14<01:35, 95.67s/it][A
 90%|█████████ | 9/10 [14:14<01:35, 95.67s/it][A
 90%|█████████ | 9/10 [14:14<01:35, 95.67s/it][A
100%|██████████| 10/10 [15:47<00:00, 95.19s/it][A100%|██████████| 10/10 [15:47<00:00, 94.77s/it]
 22%|██▎       | 117/520 [11:56:15<120:19:04, 1074.80s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-31 02:15:23,507] [INFO] [logging.py:96:log_dist] [Rank 0] step=1160, skipped=0, lr=[1.847335393572114e-05], mom=[(0.9, 0.999)]
steps: 1160 loss: 0.5550 iter time (s): 93.289 samples/sec: 1.372

100%|██████████| 10/10 [15:48<00:00, 95.22s/it][A100%|██████████| 10/10 [15:48<00:00, 94.85s/it]
 22%|██▎       | 117/520 [11:56:27<120:20:31, 1075.02s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:48<00:00, 95.24s/it][A100%|██████████| 10/10 [15:48<00:00, 94.86s/it]
 22%|██▎       | 117/520 [11:56:46<120:20:42, 1075.04s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:48<00:00, 95.25s/it][A100%|██████████| 10/10 [15:48<00:00, 94.87s/it]
 22%|██▎       | 117/520 [11:57:28<120:20:55, 1075.07s/it]
100%|██████████| 10/10 [15:48<00:00, 95.23s/it][A100%|██████████| 10/10 [15:48<00:00, 94.87s/it]
 22%|██▎       | 117/520 [11:56:46<120:20:49, 1075.06s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:48<00:00, 95.23s/it][A100%|██████████| 10/10 [15:48<00:00, 94.86s/it]
 22%|██▎       | 117/520 [11:56:30<120:20:53, 1075.07s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:48<00:00, 95.23s/it][A100%|██████████| 10/10 [15:48<00:00, 94.86s/it]
 22%|██▎       | 117/520 [11:56:27<120:20:57, 1075.08s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:48<00:00, 95.23s/it][A100%|██████████| 10/10 [15:48<00:00, 94.87s/it]
 22%|██▎       | 117/520 [11:56:27<120:20:58, 1075.08s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_143
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:51<16:43, 111.51s/it][A[2024-05-31 02:17:15,931] [INFO] [logging.py:96:log_dist] [Rank 0] step=1161, skipped=0, lr=[1.8470344752026417e-05], mom=[(0.9, 0.999)]
steps: 1161 loss: 0.5952 iter time (s): 111.203 samples/sec: 1.151

 10%|█         | 1/10 [01:52<16:49, 112.18s/it][A
 10%|█         | 1/10 [01:52<16:50, 112.23s/it][A
 10%|█         | 1/10 [01:52<16:48, 112.03s/it][A
 10%|█         | 1/10 [01:52<16:49, 112.12s/it][A
 10%|█         | 1/10 [01:52<16:49, 112.16s/it][A
 10%|█         | 1/10 [01:52<16:49, 112.17s/it][A
 10%|█         | 1/10 [01:52<16:48, 112.09s/it][A
 20%|██        | 2/10 [03:44<14:57, 112.15s/it][A[2024-05-31 02:19:08,527] [INFO] [logging.py:96:log_dist] [Rank 0] step=1162, skipped=0, lr=[1.8467332851155663e-05], mom=[(0.9, 0.999)]
steps: 1162 loss: 0.5997 iter time (s): 111.877 samples/sec: 1.144

 20%|██        | 2/10 [03:44<14:59, 112.45s/it][A
 20%|██        | 2/10 [03:44<14:59, 112.45s/it][A
 20%|██        | 2/10 [03:44<14:58, 112.37s/it][A
 20%|██        | 2/10 [03:44<14:59, 112.40s/it][A
 20%|██        | 2/10 [03:44<14:59, 112.44s/it][A
 20%|██        | 2/10 [03:44<14:59, 112.42s/it][A
 20%|██        | 2/10 [03:44<14:59, 112.41s/it][A
 30%|███       | 3/10 [05:44<13:30, 115.81s/it][A[2024-05-31 02:21:08,700] [INFO] [logging.py:96:log_dist] [Rank 0] step=1163, skipped=0, lr=[1.8464318234075174e-05], mom=[(0.9, 0.999)]
steps: 1163 loss: 0.5819 iter time (s): 119.502 samples/sec: 1.071

 30%|███       | 3/10 [05:45<13:32, 116.01s/it][A
 30%|███       | 3/10 [05:45<13:32, 116.04s/it][A
 30%|███       | 3/10 [05:44<13:32, 116.01s/it][A
 30%|███       | 3/10 [05:45<13:32, 116.02s/it][A
 30%|███       | 3/10 [05:45<13:32, 116.02s/it][A
 30%|███       | 3/10 [05:45<13:32, 116.02s/it][A
 30%|███       | 3/10 [05:44<13:31, 116.00s/it][A
 40%|████      | 4/10 [07:46<11:50, 118.47s/it][A[2024-05-31 02:23:11,238] [INFO] [logging.py:96:log_dist] [Rank 0] step=1164, skipped=0, lr=[1.846130090175211e-05], mom=[(0.9, 0.999)]
steps: 1164 loss: 0.6032 iter time (s): 121.777 samples/sec: 1.051

 40%|████      | 4/10 [07:47<11:51, 118.60s/it][A
 40%|████      | 4/10 [07:47<11:51, 118.58s/it][A
 40%|████      | 4/10 [07:47<11:51, 118.58s/it][A
 40%|████      | 4/10 [07:47<11:51, 118.59s/it][A
 40%|████      | 4/10 [07:47<11:51, 118.58s/it][A
 40%|████      | 4/10 [07:47<11:51, 118.58s/it][A
 40%|████      | 4/10 [07:47<11:51, 118.58s/it][A
 50%|█████     | 5/10 [09:47<09:56, 119.32s/it][A[2024-05-31 02:25:12,060] [INFO] [logging.py:96:log_dist] [Rank 0] step=1165, skipped=0, lr=[1.845828085515451e-05], mom=[(0.9, 0.999)]
steps: 1165 loss: 0.5942 iter time (s): 119.962 samples/sec: 1.067

 50%|█████     | 5/10 [09:48<09:57, 119.42s/it][A
 50%|█████     | 5/10 [09:48<09:56, 119.38s/it][A
 50%|█████     | 5/10 [09:48<09:56, 119.38s/it][A
 50%|█████     | 5/10 [09:48<09:56, 119.36s/it][A
 50%|█████     | 5/10 [09:48<09:56, 119.38s/it][A
 50%|█████     | 5/10 [09:48<09:56, 119.38s/it][A
 50%|█████     | 5/10 [09:48<09:56, 119.36s/it][A
 60%|██████    | 6/10 [11:31<07:36, 114.00s/it][A[2024-05-31 02:26:55,742] [INFO] [logging.py:96:log_dist] [Rank 0] step=1166, skipped=0, lr=[1.8455258095251272e-05], mom=[(0.9, 0.999)]
steps: 1166 loss: 0.5741 iter time (s): 102.828 samples/sec: 1.245

 60%|██████    | 6/10 [11:31<07:35, 114.00s/it][A
 60%|██████    | 6/10 [11:32<07:36, 114.01s/it][A
 60%|██████    | 6/10 [11:31<07:35, 113.98s/it][A
 60%|██████    | 6/10 [11:31<07:35, 113.98s/it][A
 60%|██████    | 6/10 [11:31<07:35, 114.00s/it][A
 60%|██████    | 6/10 [11:31<07:35, 114.00s/it][A
 60%|██████    | 6/10 [11:31<07:35, 113.99s/it][A
 70%|███████   | 7/10 [13:14<05:31, 110.49s/it][A[2024-05-31 02:28:39,060] [INFO] [logging.py:96:log_dist] [Rank 0] step=1167, skipped=0, lr=[1.845223262301218e-05], mom=[(0.9, 0.999)]
steps: 1167 loss: 0.5930 iter time (s): 102.588 samples/sec: 1.248

 70%|███████   | 7/10 [13:15<05:31, 110.56s/it][A
 70%|███████   | 7/10 [13:15<05:31, 110.57s/it][A
 70%|███████   | 7/10 [13:15<05:31, 110.55s/it][A
 70%|███████   | 7/10 [13:15<05:31, 110.56s/it][A
 70%|███████   | 7/10 [13:15<05:31, 110.56s/it][A
 70%|███████   | 7/10 [13:15<05:31, 110.55s/it][A
 70%|███████   | 7/10 [13:15<05:31, 110.55s/it][A
 80%|████████  | 8/10 [14:51<03:32, 106.28s/it][A[2024-05-31 02:30:16,250] [INFO] [logging.py:96:log_dist] [Rank 0] step=1168, skipped=0, lr=[1.8449204439407883e-05], mom=[(0.9, 0.999)]
steps: 1168 loss: 0.5779 iter time (s): 96.327 samples/sec: 1.329

 80%|████████  | 8/10 [14:52<03:32, 106.28s/it][A
 80%|████████  | 8/10 [14:52<03:32, 106.26s/it][A
 80%|████████  | 8/10 [14:52<03:32, 106.27s/it][A
 80%|████████  | 8/10 [14:52<03:32, 106.29s/it][A
 80%|████████  | 8/10 [14:52<03:32, 106.28s/it][A
 80%|████████  | 8/10 [14:52<03:32, 106.27s/it][A
 80%|████████  | 8/10 [14:52<03:32, 106.27s/it][A
 90%|█████████ | 9/10 [16:31<01:44, 104.25s/it][A[2024-05-31 02:31:56,039] [INFO] [logging.py:96:log_dist] [Rank 0] step=1169, skipped=0, lr=[1.8446173545409887e-05], mom=[(0.9, 0.999)]
steps: 1169 loss: 0.5742 iter time (s): 99.003 samples/sec: 1.293

 90%|█████████ | 9/10 [16:32<01:44, 104.22s/it][A
 90%|█████████ | 9/10 [16:32<01:44, 104.23s/it][A
 90%|█████████ | 9/10 [16:32<01:44, 104.24s/it][A
 90%|█████████ | 9/10 [16:32<01:44, 104.24s/it][A
 90%|█████████ | 9/10 [16:32<01:44, 104.24s/it][A
 90%|█████████ | 9/10 [16:32<01:44, 104.24s/it][A
 90%|█████████ | 9/10 [16:32<01:44, 104.25s/it][A
100%|██████████| 10/10 [18:09<00:00, 102.37s/it][A100%|██████████| 10/10 [18:09<00:00, 108.98s/it]
 23%|██▎       | 118/520 [12:14:25<120:32:14, 1079.44s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-31 02:33:34,201] [INFO] [logging.py:96:log_dist] [Rank 0] step=1170, skipped=0, lr=[1.8443139941990585e-05], mom=[(0.9, 0.999)]
steps: 1170 loss: 0.5438 iter time (s): 97.462 samples/sec: 1.313

100%|██████████| 10/10 [18:10<00:00, 102.37s/it][A100%|██████████| 10/10 [18:10<00:00, 109.05s/it]
 23%|██▎       | 118/520 [12:14:38<120:33:51, 1079.68s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [18:10<00:00, 102.37s/it][A100%|██████████| 10/10 [18:10<00:00, 109.05s/it]
 23%|██▎       | 118/520 [12:14:57<120:33:55, 1079.69s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [18:10<00:00, 102.39s/it][A100%|██████████| 10/10 [18:10<00:00, 109.04s/it]
 23%|██▎       | 118/520 [12:15:38<120:33:58, 1079.70s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [18:10<00:00, 102.37s/it][A100%|██████████| 10/10 [18:10<00:00, 109.04s/it]
 23%|██▎       | 118/520 [12:14:57<120:33:56, 1079.69s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [18:10<00:00, 102.38s/it][A100%|██████████| 10/10 [18:10<00:00, 109.05s/it]
 23%|██▎       | 118/520 [12:14:41<120:33:58, 1079.70s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [18:10<00:00, 102.38s/it][A100%|██████████| 10/10 [18:10<00:00, 109.05s/it]
 23%|██▎       | 118/520 [12:14:38<120:34:00, 1079.70s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [18:10<00:00, 102.38s/it][A100%|██████████| 10/10 [18:10<00:00, 109.04s/it]
 23%|██▎       | 118/520 [12:14:37<120:33:58, 1079.70s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_464
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:01<09:14, 61.59s/it][A[2024-05-31 02:34:35,113] [INFO] [logging.py:96:log_dist] [Rank 0] step=1171, skipped=0, lr=[1.8440103630123234e-05], mom=[(0.9, 0.999)]
steps: 1171 loss: 0.2717 iter time (s): 59.984 samples/sec: 2.134

 10%|█         | 1/10 [01:00<09:07, 60.79s/it][A
 10%|█         | 1/10 [01:00<09:06, 60.77s/it][A
 10%|█         | 1/10 [01:00<09:06, 60.68s/it][A
 10%|█         | 1/10 [01:00<09:06, 60.78s/it][A
 10%|█         | 1/10 [01:00<09:07, 60.79s/it][A
 10%|█         | 1/10 [01:00<09:06, 60.76s/it][A
 10%|█         | 1/10 [01:00<09:06, 60.75s/it][A
 20%|██        | 2/10 [02:02<08:11, 61.40s/it][A[2024-05-31 02:35:36,382] [INFO] [logging.py:96:log_dist] [Rank 0] step=1172, skipped=0, lr=[1.8437064610781955e-05], mom=[(0.9, 0.999)]
steps: 1172 loss: 0.2779 iter time (s): 60.606 samples/sec: 2.112

 20%|██        | 2/10 [02:02<08:09, 61.13s/it][A
 20%|██        | 2/10 [02:02<08:08, 61.06s/it][A
 20%|██        | 2/10 [02:01<08:08, 61.01s/it][A
 20%|██        | 2/10 [02:02<08:08, 61.07s/it][A
 20%|██        | 2/10 [02:01<08:08, 61.02s/it][A
 20%|██        | 2/10 [02:02<08:08, 61.05s/it][A
 20%|██        | 2/10 [02:02<08:08, 61.05s/it][A
 30%|███       | 3/10 [03:04<07:12, 61.72s/it][A[2024-05-31 02:36:38,493] [INFO] [logging.py:96:log_dist] [Rank 0] step=1173, skipped=0, lr=[1.8434022884941738e-05], mom=[(0.9, 0.999)]
steps: 1173 loss: 0.2916 iter time (s): 61.444 samples/sec: 2.083

 30%|███       | 3/10 [03:04<07:11, 61.61s/it][A
 30%|███       | 3/10 [03:04<07:10, 61.56s/it][A
 30%|███       | 3/10 [03:04<07:11, 61.61s/it][A
 30%|███       | 3/10 [03:04<07:11, 61.63s/it][A
 30%|███       | 3/10 [03:04<07:11, 61.64s/it][A
 30%|███       | 3/10 [03:04<07:11, 61.64s/it][A
 30%|███       | 3/10 [03:04<07:12, 61.83s/it][A
 40%|████      | 4/10 [04:06<06:08, 61.46s/it][A[2024-05-31 02:37:39,022] [INFO] [logging.py:96:log_dist] [Rank 0] step=1174, skipped=0, lr=[1.8430978453578452e-05], mom=[(0.9, 0.999)]
steps: 1174 loss: 0.2652 iter time (s): 59.635 samples/sec: 2.146

 40%|████      | 4/10 [04:04<06:07, 61.19s/it][A
 40%|████      | 4/10 [04:04<06:06, 61.17s/it][A
 40%|████      | 4/10 [04:04<06:07, 61.22s/it][A
 40%|████      | 4/10 [04:04<06:07, 61.17s/it][A
 40%|████      | 4/10 [04:04<06:07, 61.21s/it][A
 40%|████      | 4/10 [04:04<06:06, 61.13s/it][A
 40%|████      | 4/10 [04:04<06:07, 61.18s/it][A
 50%|█████     | 5/10 [05:05<05:03, 60.63s/it][A[2024-05-31 02:38:38,720] [INFO] [logging.py:96:log_dist] [Rank 0] step=1175, skipped=0, lr=[1.8427931317668816e-05], mom=[(0.9, 0.999)]
steps: 1175 loss: 0.2778 iter time (s): 58.869 samples/sec: 2.174

 50%|█████     | 5/10 [05:04<05:03, 60.62s/it][A
 50%|█████     | 5/10 [05:04<05:03, 60.61s/it][A
 50%|█████     | 5/10 [05:04<05:03, 60.66s/it][A
 50%|█████     | 5/10 [05:04<05:03, 60.66s/it][A
 50%|█████     | 5/10 [05:04<05:03, 60.63s/it][A
 50%|█████     | 5/10 [05:04<05:03, 60.73s/it][A
 50%|█████     | 5/10 [05:04<05:03, 60.70s/it][A
 60%|██████    | 6/10 [06:06<04:03, 60.82s/it][A[2024-05-31 02:39:39,375] [INFO] [logging.py:96:log_dist] [Rank 0] step=1176, skipped=0, lr=[1.8424881478190436e-05], mom=[(0.9, 0.999)]
steps: 1176 loss: 0.2837 iter time (s): 59.658 samples/sec: 2.146

 60%|██████    | 6/10 [06:05<04:02, 60.62s/it][A
 60%|██████    | 6/10 [06:05<04:02, 60.61s/it][A
 60%|██████    | 6/10 [06:04<04:02, 60.60s/it][A
 60%|██████    | 6/10 [06:05<04:02, 60.55s/it][A
 60%|██████    | 6/10 [06:05<04:02, 60.59s/it][A
 60%|██████    | 6/10 [06:04<04:02, 60.56s/it][A
 60%|██████    | 6/10 [06:04<04:02, 60.57s/it][A
 70%|███████   | 7/10 [07:06<03:02, 60.72s/it][A[2024-05-31 02:40:40,412] [INFO] [logging.py:96:log_dist] [Rank 0] step=1177, skipped=0, lr=[1.8421828936121776e-05], mom=[(0.9, 0.999)]
steps: 1177 loss: 0.2918 iter time (s): 60.396 samples/sec: 2.119

 70%|███████   | 7/10 [07:06<03:02, 60.75s/it][A
 70%|███████   | 7/10 [07:06<03:02, 60.73s/it][A
 70%|███████   | 7/10 [07:05<03:02, 60.75s/it][A
 70%|███████   | 7/10 [07:06<03:02, 60.73s/it][A
 70%|███████   | 7/10 [07:06<03:02, 60.72s/it][A
 70%|███████   | 7/10 [07:06<03:02, 60.74s/it][A
 70%|███████   | 7/10 [07:06<03:02, 60.72s/it][A
 80%|████████  | 8/10 [08:07<02:01, 60.69s/it][A[2024-05-31 02:41:41,058] [INFO] [logging.py:96:log_dist] [Rank 0] step=1178, skipped=0, lr=[1.8418773692442157e-05], mom=[(0.9, 0.999)]
steps: 1178 loss: 0.2577 iter time (s): 60.000 samples/sec: 2.133

 80%|████████  | 8/10 [08:06<02:01, 60.71s/it][A
 80%|████████  | 8/10 [08:06<02:01, 60.71s/it][A
 80%|████████  | 8/10 [08:06<02:01, 60.72s/it][A
 80%|████████  | 8/10 [08:06<02:01, 60.70s/it][A
 80%|████████  | 8/10 [08:06<02:01, 60.71s/it][A
 80%|████████  | 8/10 [08:06<02:01, 60.71s/it][A
 80%|████████  | 8/10 [08:06<02:01, 60.71s/it][A
 90%|█████████ | 9/10 [09:08<01:00, 60.75s/it][A[2024-05-31 02:42:41,905] [INFO] [logging.py:96:log_dist] [Rank 0] step=1179, skipped=0, lr=[1.8415715748131786e-05], mom=[(0.9, 0.999)]
steps: 1179 loss: 0.2699 iter time (s): 60.210 samples/sec: 2.126

 90%|█████████ | 9/10 [09:07<01:00, 60.77s/it][A
 90%|█████████ | 9/10 [09:07<01:00, 60.75s/it][A
 90%|█████████ | 9/10 [09:07<01:00, 60.77s/it][A
 90%|█████████ | 9/10 [09:07<01:00, 60.74s/it][A
 90%|█████████ | 9/10 [09:07<01:00, 60.75s/it][A
 90%|█████████ | 9/10 [09:07<01:00, 60.75s/it][A
 90%|█████████ | 9/10 [09:07<01:00, 60.75s/it][A
100%|██████████| 10/10 [10:09<00:00, 60.77s/it][A100%|██████████| 10/10 [10:09<00:00, 60.92s/it]
 23%|██▎       | 119/520 [12:24:35<104:32:05, 938.47s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-31 02:43:42,720] [INFO] [logging.py:96:log_dist] [Rank 0] step=1180, skipped=0, lr=[1.8412655104171725e-05], mom=[(0.9, 0.999)]
steps: 1180 loss: 0.2688 iter time (s): 60.183 samples/sec: 2.127

100%|██████████| 10/10 [10:08<00:00, 60.77s/it][A100%|██████████| 10/10 [10:08<00:00, 60.84s/it]
 23%|██▎       | 119/520 [12:25:05<104:30:57, 938.30s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:08<00:00, 60.80s/it][A100%|██████████| 10/10 [10:08<00:00, 60.85s/it]
 23%|██▎       | 119/520 [12:24:47<104:31:13, 938.34s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:08<00:00, 60.77s/it][A100%|██████████| 10/10 [10:08<00:00, 60.83s/it]
 23%|██▎       | 119/520 [12:25:47<104:30:51, 938.28s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:08<00:00, 60.78s/it][A100%|██████████| 10/10 [10:08<00:00, 60.84s/it]
 23%|██▎       | 119/520 [12:25:05<104:31:03, 938.31s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:08<00:00, 60.77s/it][A100%|██████████| 10/10 [10:08<00:00, 60.84s/it]
 23%|██▎       | 119/520 [12:24:49<104:31:00, 938.31s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:08<00:00, 60.77s/it][A100%|██████████| 10/10 [10:08<00:00, 60.84s/it]
 23%|██▎       | 119/520 [12:24:46<104:30:59, 938.30s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:08<00:00, 60.77s/it][A100%|██████████| 10/10 [10:08<00:00, 60.84s/it]
 23%|██▎       | 119/520 [12:24:46<104:30:59, 938.30s/it] Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_431
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:00<09:08, 60.94s/it][A[2024-05-31 02:44:43,943] [INFO] [logging.py:96:log_dist] [Rank 0] step=1181, skipped=0, lr=[1.8409591761543907e-05], mom=[(0.9, 0.999)]
steps: 1181 loss: 0.2772 iter time (s): 60.440 samples/sec: 2.118

 10%|█         | 1/10 [01:01<09:12, 61.34s/it][A
 10%|█         | 1/10 [01:01<09:13, 61.49s/it][A
 10%|█         | 1/10 [01:01<09:13, 61.46s/it][A
 10%|█         | 1/10 [01:01<09:12, 61.38s/it][A
 10%|█         | 1/10 [01:01<09:12, 61.40s/it][A
 10%|█         | 1/10 [01:01<09:12, 61.42s/it][A
 10%|█         | 1/10 [01:01<09:12, 61.40s/it][A
 20%|██        | 2/10 [02:02<08:10, 61.27s/it][A[2024-05-31 02:45:45,455] [INFO] [logging.py:96:log_dist] [Rank 0] step=1182, skipped=0, lr=[1.840652572123113e-05], mom=[(0.9, 0.999)]
steps: 1182 loss: 0.2623 iter time (s): 60.632 samples/sec: 2.111

 20%|██        | 2/10 [02:02<08:10, 61.33s/it][A
 20%|██        | 2/10 [02:02<08:10, 61.35s/it][A
 20%|██        | 2/10 [02:02<08:10, 61.34s/it][A
 20%|██        | 2/10 [02:02<08:10, 61.37s/it][A
 20%|██        | 2/10 [02:02<08:10, 61.36s/it][A
 20%|██        | 2/10 [02:02<08:10, 61.34s/it][A
 20%|██        | 2/10 [02:02<08:10, 61.35s/it][A
 30%|███       | 3/10 [03:04<07:10, 61.52s/it][A[2024-05-31 02:46:47,272] [INFO] [logging.py:96:log_dist] [Rank 0] step=1183, skipped=0, lr=[1.8403456984217045e-05], mom=[(0.9, 0.999)]
steps: 1183 loss: 0.2721 iter time (s): 61.169 samples/sec: 2.093

 30%|███       | 3/10 [03:04<07:10, 61.55s/it][A
 30%|███       | 3/10 [03:04<07:10, 61.56s/it][A
 30%|███       | 3/10 [03:04<07:10, 61.56s/it][A
 30%|███       | 3/10 [03:04<07:10, 61.56s/it][A
 30%|███       | 3/10 [03:04<07:10, 61.57s/it][A
 30%|███       | 3/10 [03:04<07:10, 61.57s/it][A
 30%|███       | 3/10 [03:04<07:10, 61.57s/it][A
 40%|████      | 4/10 [04:04<06:06, 61.09s/it][A[2024-05-31 02:47:47,701] [INFO] [logging.py:96:log_dist] [Rank 0] step=1184, skipped=0, lr=[1.8400385551486187e-05], mom=[(0.9, 0.999)]
steps: 1184 loss: 0.2698 iter time (s): 59.742 samples/sec: 2.143

 40%|████      | 4/10 [04:04<06:06, 61.10s/it][A
 40%|████      | 4/10 [04:04<06:06, 61.11s/it][A
 40%|████      | 4/10 [04:04<06:06, 61.11s/it][A
 40%|████      | 4/10 [04:04<06:06, 61.10s/it][A
 40%|████      | 4/10 [04:04<06:06, 61.11s/it][A
 40%|████      | 4/10 [04:04<06:06, 61.11s/it][A
 40%|████      | 4/10 [04:04<06:06, 61.12s/it][A
 50%|█████     | 5/10 [05:05<05:04, 60.93s/it][A[2024-05-31 02:48:48,351] [INFO] [logging.py:96:log_dist] [Rank 0] step=1185, skipped=0, lr=[1.8397311424023952e-05], mom=[(0.9, 0.999)]
steps: 1185 loss: 0.2778 iter time (s): 60.025 samples/sec: 2.132

 50%|█████     | 5/10 [05:05<05:04, 60.94s/it][A
 50%|█████     | 5/10 [05:05<05:04, 60.95s/it][A
 50%|█████     | 5/10 [05:05<05:04, 60.95s/it][A
 50%|█████     | 5/10 [05:05<05:04, 60.95s/it][A
 50%|█████     | 5/10 [05:05<05:04, 60.94s/it][A
 50%|█████     | 5/10 [05:05<05:04, 60.95s/it][A
 50%|█████     | 5/10 [05:05<05:04, 60.96s/it][A
 60%|██████    | 6/10 [06:06<04:03, 60.90s/it][A[2024-05-31 02:49:49,172] [INFO] [logging.py:96:log_dist] [Rank 0] step=1186, skipped=0, lr=[1.8394234602816588e-05], mom=[(0.9, 0.999)]
steps: 1186 loss: 0.2620 iter time (s): 60.114 samples/sec: 2.129

 60%|██████    | 6/10 [06:06<04:03, 60.87s/it][A
 60%|██████    | 6/10 [06:06<04:03, 60.90s/it][A
 60%|██████    | 6/10 [06:06<04:03, 60.90s/it][A
 60%|██████    | 6/10 [06:06<04:03, 60.89s/it][A
 60%|██████    | 6/10 [06:06<04:03, 60.89s/it][A
 60%|██████    | 6/10 [06:06<04:03, 60.89s/it][A
 60%|██████    | 6/10 [06:06<04:03, 60.89s/it][A
 70%|███████   | 7/10 [07:06<03:02, 60.83s/it][A[2024-05-31 02:50:49,876] [INFO] [logging.py:96:log_dist] [Rank 0] step=1187, skipped=0, lr=[1.8391155088851216e-05], mom=[(0.9, 0.999)]
steps: 1187 loss: 0.2393 iter time (s): 60.080 samples/sec: 2.130

 70%|███████   | 7/10 [07:07<03:02, 60.83s/it][A
 70%|███████   | 7/10 [07:07<03:02, 60.85s/it][A
 70%|███████   | 7/10 [07:07<03:02, 60.84s/it][A
 70%|███████   | 7/10 [07:07<03:02, 60.84s/it][A
 70%|███████   | 7/10 [07:07<03:02, 60.84s/it][A
 70%|███████   | 7/10 [07:07<03:02, 60.84s/it][A
 70%|███████   | 7/10 [07:07<03:02, 60.84s/it][A
 80%|████████  | 8/10 [08:07<02:01, 60.88s/it][A[2024-05-31 02:51:50,860] [INFO] [logging.py:96:log_dist] [Rank 0] step=1188, skipped=0, lr=[1.8388072883115827e-05], mom=[(0.9, 0.999)]
steps: 1188 loss: 0.2701 iter time (s): 60.348 samples/sec: 2.121

 80%|████████  | 8/10 [08:08<02:01, 60.89s/it][A
 80%|████████  | 8/10 [08:08<02:01, 60.88s/it][A
 80%|████████  | 8/10 [08:08<02:01, 60.89s/it][A
 80%|████████  | 8/10 [08:08<02:01, 60.89s/it][A
 80%|████████  | 8/10 [08:08<02:01, 60.88s/it][A
 80%|████████  | 8/10 [08:08<02:01, 60.90s/it][A
 80%|████████  | 8/10 [08:08<02:01, 60.89s/it][A
 90%|█████████ | 9/10 [09:09<01:01, 61.17s/it][A[2024-05-31 02:52:52,650] [INFO] [logging.py:96:log_dist] [Rank 0] step=1189, skipped=0, lr=[1.8384987986599266e-05], mom=[(0.9, 0.999)]
steps: 1189 loss: 0.2689 iter time (s): 61.131 samples/sec: 2.094

 90%|█████████ | 9/10 [09:09<01:01, 61.16s/it][A
 90%|█████████ | 9/10 [09:09<01:01, 61.15s/it][A
 90%|█████████ | 9/10 [09:09<01:01, 61.17s/it][A
 90%|█████████ | 9/10 [09:09<01:01, 61.16s/it][A
 90%|█████████ | 9/10 [09:09<01:01, 61.19s/it][A
 90%|█████████ | 9/10 [09:09<01:01, 61.17s/it][A
 90%|█████████ | 9/10 [09:09<01:01, 61.17s/it][A
100%|██████████| 10/10 [10:09<00:00, 60.83s/it][A100%|██████████| 10/10 [10:09<00:00, 60.97s/it]
[2024-05-31 02:53:52,725] [INFO] [logging.py:96:log_dist] [Rank 0] step=1190, skipped=0, lr=[1.8381900400291245e-05], mom=[(0.9, 0.999)]
steps: 1190 loss: 0.2520 iter time (s): 59.428 samples/sec: 2.154

100%|██████████| 10/10 [10:09<00:00, 60.85s/it][A100%|██████████| 10/10 [10:09<00:00, 61.00s/it]

100%|██████████| 10/10 [10:10<00:00, 60.84s/it][A100%|██████████| 10/10 [10:10<00:00, 61.00s/it]

100%|██████████| 10/10 [10:10<00:00, 60.84s/it][A100%|██████████| 10/10 [10:10<00:00, 61.00s/it]

100%|██████████| 10/10 [10:09<00:00, 60.84s/it][A100%|██████████| 10/10 [10:09<00:00, 61.00s/it]

100%|██████████| 10/10 [10:09<00:00, 60.83s/it][A100%|██████████| 10/10 [10:09<00:00, 61.00s/it]

100%|██████████| 10/10 [10:09<00:00, 60.83s/it][A100%|██████████| 10/10 [10:09<00:00, 61.00s/it]

100%|██████████| 10/10 [10:09<00:00, 60.83s/it][A100%|██████████| 10/10 [10:09<00:00, 61.00s/it]
Checkpointing at shard 120
[2024-05-31 02:53:53,422] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step1190 is about to be saved!
[2024-05-31 02:53:55,030] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_00-model_states.pt...
[2024-05-31 02:53:58,941] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_06-model_states.pt...
[2024-05-31 02:53:59,663] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_02-model_states.pt...
[2024-05-31 02:53:59,915] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_05-model_states.pt...
[2024-05-31 02:53:59,939] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_00-model_states.pt.
[2024-05-31 02:54:00,451] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_08-model_states.pt...
[2024-05-31 02:54:01,310] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_07-model_states.pt...
[2024-05-31 02:54:06,383] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_03-model_states.pt...
[2024-05-31 02:54:06,537] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_04-model_states.pt...
[2024-05-31 02:54:08,293] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_01-model_states.pt...
[2024-05-31 03:02:50,814] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_04-model_states.pt.
[2024-05-31 03:02:50,823] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_01-model_states.pt.
[2024-05-31 03:02:50,856] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_03-model_states.pt.
[2024-05-31 03:02:51,409] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_03_model_states.pt...
[2024-05-31 03:02:51,537] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_02_model_states.pt...
[2024-05-31 03:02:52,884] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_00_model_states.pt
[2024-05-31 03:02:52,885] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_00_model_states.pt...
[2024-05-31 03:03:01,155] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_02_model_states.pt.
[2024-05-31 03:03:01,155] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1190 is ready now!
[2024-05-31 03:03:01,163] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_03_model_states.pt.
[2024-05-31 03:03:01,163] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1190 is ready now!
[2024-05-31 03:03:02,016] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_00_model_states.pt.
[2024-05-31 03:03:02,016] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1190 is ready now!
[2024-05-31 03:03:13,590] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_07-model_states.pt.
[2024-05-31 03:03:14,103] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_06_model_states.pt...
[2024-05-31 03:03:14,527] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_06_model_states.pt.
[2024-05-31 03:03:14,527] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1190 is ready now!
[2024-05-31 03:04:15,725] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_08-model_states.pt.
[2024-05-31 03:04:15,898] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_09-model_states.pt...
[2024-05-31 03:04:18,300] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_05-model_states.pt.
[2024-05-31 03:04:18,658] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_09-model_states.pt.
[2024-05-31 03:04:18,677] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_07_model_states.pt...
[2024-05-31 03:04:18,831] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_06-model_states.pt.
[2024-05-31 03:04:18,904] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_04_model_states.pt...
[2024-05-31 03:04:19,223] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_05_model_states.pt...
[2024-05-31 03:04:19,494] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_07_model_states.pt.
[2024-05-31 03:04:19,495] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1190 is ready now!
[2024-05-31 03:04:21,599] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_04_model_states.pt.
[2024-05-31 03:04:21,599] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1190 is ready now!
[2024-05-31 03:04:22,686] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_05_model_states.pt.
[2024-05-31 03:04:22,687] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1190 is ready now!
[2024-05-31 03:04:22,771] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/layer_02-model_states.pt.
[2024-05-31 03:04:22,810] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_01_model_states.pt
[2024-05-31 03:04:22,811] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_01_model_states.pt...
[2024-05-31 03:04:22,959] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1190/mp_rank_01_model_states.pt.
[2024-05-31 03:04:22,959] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1190 is ready now!
 23%|██▎       | 120/520 [12:46:27<114:18:09, 1028.72s/it] 23%|██▎       | 120/520 [12:45:16<114:22:26, 1029.37s/it] 23%|██▎       | 120/520 [12:45:26<114:17:51, 1028.68s/it]Checkpoint saved using --- 629.5386927127838 seconds ---
 23%|██▎       | 120/520 [12:45:45<114:18:01, 1028.70s/it] 23%|██▎       | 120/520 [12:45:25<114:17:48, 1028.67s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_31
 23%|██▎       | 120/520 [12:45:45<114:18:25, 1028.76s/it] 23%|██▎       | 120/520 [12:45:26<114:18:34, 1028.79s/it] 23%|██▎       | 120/520 [12:45:29<114:17:54, 1028.69s/it]Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A

  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [00:00<?, ?it/s][A

  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:35<14:23, 95.99s/it][A[2024-05-31 03:06:01,540] [INFO] [logging.py:96:log_dist] [Rank 0] step=1191, skipped=0, lr=[1.8378810125182337e-05], mom=[(0.9, 0.999)]
steps: 1191 loss: 0.8316 iter time (s): 98.069 samples/sec: 1.305

 10%|█         | 1/10 [01:38<14:47, 98.61s/it][A
 10%|█         | 1/10 [01:38<14:48, 98.76s/it][A
 10%|█         | 1/10 [01:38<14:49, 98.87s/it][A
 10%|█         | 1/10 [01:38<14:50, 98.93s/it][A
 10%|█         | 1/10 [01:39<14:51, 99.02s/it][A
 10%|█         | 1/10 [01:39<14:51, 99.03s/it][A
 10%|█         | 1/10 [01:39<14:51, 99.06s/it][A
 20%|██        | 2/10 [03:12<12:50, 96.28s/it][A[2024-05-31 03:07:38,008] [INFO] [logging.py:96:log_dist] [Rank 0] step=1192, skipped=0, lr=[1.8375717162263975e-05], mom=[(0.9, 0.999)]
steps: 1192 loss: 0.8547 iter time (s): 95.596 samples/sec: 1.339

 20%|██        | 2/10 [03:15<12:58, 97.34s/it][A
 20%|██        | 2/10 [03:15<12:59, 97.42s/it][A
 20%|██        | 2/10 [03:15<13:00, 97.59s/it][A
 20%|██        | 2/10 [03:15<13:00, 97.60s/it][A
 20%|██        | 2/10 [03:15<13:01, 97.67s/it][A
 20%|██        | 2/10 [03:16<13:02, 97.87s/it][A
 20%|██        | 2/10 [03:16<13:03, 97.90s/it][A
 30%|███       | 3/10 [04:49<11:16, 96.60s/it][A[2024-05-31 03:09:14,985] [INFO] [logging.py:96:log_dist] [Rank 0] step=1193, skipped=0, lr=[1.8372621512528464e-05], mom=[(0.9, 0.999)]
steps: 1193 loss: 0.8412 iter time (s): 95.544 samples/sec: 1.340

 30%|███       | 3/10 [04:52<11:20, 97.20s/it][A
 30%|███       | 3/10 [04:52<11:20, 97.22s/it][A
 30%|███       | 3/10 [04:52<11:20, 97.28s/it][A
 30%|███       | 3/10 [04:52<11:21, 97.32s/it][A
 30%|███       | 3/10 [04:52<11:20, 97.24s/it][A
 30%|███       | 3/10 [04:52<11:21, 97.32s/it][A
 30%|███       | 3/10 [04:52<11:20, 97.27s/it][A
 40%|████      | 4/10 [06:25<09:38, 96.46s/it][A[2024-05-31 03:10:51,263] [INFO] [logging.py:96:log_dist] [Rank 0] step=1194, skipped=0, lr=[1.8369523176968968e-05], mom=[(0.9, 0.999)]
steps: 1194 loss: 0.8360 iter time (s): 95.255 samples/sec: 1.344

 40%|████      | 4/10 [06:28<09:41, 96.84s/it][A
 40%|████      | 4/10 [06:28<09:40, 96.83s/it][A
 40%|████      | 4/10 [06:28<09:40, 96.82s/it][A
 40%|████      | 4/10 [06:28<09:41, 96.84s/it][A
 40%|████      | 4/10 [06:28<09:40, 96.82s/it][A
 40%|████      | 4/10 [06:28<09:41, 96.85s/it][A
 40%|████      | 4/10 [06:28<09:41, 96.83s/it][A
 50%|█████     | 5/10 [08:02<08:03, 96.71s/it][A[2024-05-31 03:12:28,383] [INFO] [logging.py:96:log_dist] [Rank 0] step=1195, skipped=0, lr=[1.83664221565795e-05], mom=[(0.9, 0.999)]
steps: 1195 loss: 0.8374 iter time (s): 96.215 samples/sec: 1.330

 50%|█████     | 5/10 [08:05<08:04, 96.91s/it][A
 50%|█████     | 5/10 [08:05<08:04, 96.95s/it][A
 50%|█████     | 5/10 [08:05<08:04, 96.94s/it][A
 50%|█████     | 5/10 [08:05<08:04, 96.94s/it][A
 50%|█████     | 5/10 [08:05<08:04, 96.91s/it][A
 50%|█████     | 5/10 [08:05<08:04, 96.94s/it][A
 50%|█████     | 5/10 [08:05<08:04, 96.93s/it][A
 60%|██████    | 6/10 [09:38<06:25, 96.48s/it][A[2024-05-31 03:14:04,429] [INFO] [logging.py:96:log_dist] [Rank 0] step=1196, skipped=0, lr=[1.8363318452354957e-05], mom=[(0.9, 0.999)]
steps: 1196 loss: 0.8284 iter time (s): 95.167 samples/sec: 1.345

 60%|██████    | 6/10 [09:41<06:26, 96.63s/it][A
 60%|██████    | 6/10 [09:41<06:26, 96.62s/it][A
 60%|██████    | 6/10 [09:41<06:26, 96.61s/it][A
 60%|██████    | 6/10 [09:41<06:26, 96.61s/it][A
 60%|██████    | 6/10 [09:41<06:26, 96.62s/it][A
 60%|██████    | 6/10 [09:41<06:26, 96.62s/it][A
 60%|██████    | 6/10 [09:41<06:26, 96.64s/it][A
 70%|███████   | 7/10 [11:15<04:49, 96.52s/it][A[2024-05-31 03:15:40,773] [INFO] [logging.py:96:log_dist] [Rank 0] step=1197, skipped=0, lr=[1.836021206529107e-05], mom=[(0.9, 0.999)]
steps: 1197 loss: 0.8206 iter time (s): 95.491 samples/sec: 1.340

 70%|███████   | 7/10 [11:17<04:49, 96.50s/it][A
 70%|███████   | 7/10 [11:17<04:49, 96.51s/it][A
 70%|███████   | 7/10 [11:18<04:49, 96.55s/it][A
 70%|███████   | 7/10 [11:18<04:49, 96.57s/it][A
 70%|███████   | 7/10 [11:18<04:49, 96.56s/it][A
 70%|███████   | 7/10 [11:18<04:49, 96.60s/it][A
 70%|███████   | 7/10 [11:18<04:49, 96.59s/it][A
 80%|████████  | 8/10 [12:51<03:12, 96.32s/it][A[2024-05-31 03:17:16,926] [INFO] [logging.py:96:log_dist] [Rank 0] step=1198, skipped=0, lr=[1.8357102996384456e-05], mom=[(0.9, 0.999)]
steps: 1198 loss: 0.8066 iter time (s): 95.107 samples/sec: 1.346

 80%|████████  | 8/10 [12:53<03:12, 96.41s/it][A
 80%|████████  | 8/10 [12:54<03:12, 96.40s/it][A
 80%|████████  | 8/10 [12:54<03:12, 96.42s/it][A
 80%|████████  | 8/10 [12:54<03:12, 96.41s/it][A
 80%|████████  | 8/10 [12:54<03:12, 96.39s/it][A
 80%|████████  | 8/10 [12:54<03:12, 96.39s/it][A
 80%|████████  | 8/10 [12:54<03:12, 96.39s/it][A
 90%|█████████ | 9/10 [14:28<01:36, 96.65s/it][A[2024-05-31 03:18:54,299] [INFO] [logging.py:96:log_dist] [Rank 0] step=1199, skipped=0, lr=[1.8353991246632582e-05], mom=[(0.9, 0.999)]
steps: 1199 loss: 0.8198 iter time (s): 96.525 samples/sec: 1.326

 90%|█████████ | 9/10 [14:31<01:36, 96.71s/it][A
 90%|█████████ | 9/10 [14:31<01:36, 96.70s/it][A
 90%|█████████ | 9/10 [14:31<01:36, 96.70s/it][A
 90%|█████████ | 9/10 [14:31<01:36, 96.71s/it][A
 90%|█████████ | 9/10 [14:31<01:36, 96.71s/it][A
 90%|█████████ | 9/10 [14:31<01:36, 96.70s/it][A
 90%|█████████ | 9/10 [14:31<01:36, 96.70s/it][A
100%|██████████| 10/10 [16:04<00:00, 96.43s/it][A100%|██████████| 10/10 [16:04<00:00, 96.47s/it]
 23%|██▎       | 121/520 [13:01:22<111:57:04, 1010.09s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-31 03:20:30,237] [INFO] [logging.py:96:log_dist] [Rank 0] step=1200, skipped=0, lr=[1.8350876817033766e-05], mom=[(0.9, 0.999)]
steps: 1200 loss: 0.8311 iter time (s): 95.067 samples/sec: 1.346

100%|██████████| 10/10 [16:07<00:00, 96.47s/it][A100%|██████████| 10/10 [16:07<00:00, 96.73s/it]
 23%|██▎       | 121/520 [13:01:34<111:59:26, 1010.44s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:07<00:00, 96.47s/it][A100%|██████████| 10/10 [16:07<00:00, 96.74s/it]
 23%|██▎       | 121/520 [13:01:53<111:59:35, 1010.46s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:07<00:00, 96.48s/it][A100%|██████████| 10/10 [16:07<00:00, 96.76s/it]
 23%|██▎       | 121/520 [13:02:34<111:59:45, 1010.49s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:07<00:00, 96.44s/it][A100%|██████████| 10/10 [16:07<00:00, 96.76s/it]
 23%|██▎       | 121/520 [13:01:37<111:59:41, 1010.48s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:07<00:00, 96.47s/it][A100%|██████████| 10/10 [16:07<00:00, 96.76s/it]
 23%|██▎       | 121/520 [13:01:53<111:59:47, 1010.50s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:07<00:00, 96.46s/it][A100%|██████████| 10/10 [16:07<00:00, 96.77s/it]
 23%|██▎       | 121/520 [13:01:34<111:59:50, 1010.50s/it]
100%|██████████| 10/10 [16:07<00:00, 96.45s/it][A100%|██████████| 10/10 [16:07<00:00, 96.77s/it]
 23%|██▎       | 121/520 [13:01:33<111:59:49, 1010.50s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_177

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:10<19:36, 130.70s/it][A[2024-05-31 03:22:42,132] [INFO] [logging.py:96:log_dist] [Rank 0] step=1201, skipped=0, lr=[1.83477597085872e-05], mom=[(0.9, 0.999)]
steps: 1201 loss: 0.5796 iter time (s): 130.919 samples/sec: 0.978

 10%|█         | 1/10 [02:11<19:46, 131.80s/it][A
 10%|█         | 1/10 [02:11<19:46, 131.81s/it][A
 10%|█         | 1/10 [02:11<19:45, 131.73s/it][A
 10%|█         | 1/10 [02:11<19:45, 131.73s/it][A
 10%|█         | 1/10 [02:11<19:46, 131.81s/it][A
 10%|█         | 1/10 [02:11<19:45, 131.75s/it][A
 10%|█         | 1/10 [02:11<19:45, 131.75s/it][A
 20%|██        | 2/10 [04:22<17:29, 131.24s/it][A[2024-05-31 03:24:53,779] [INFO] [logging.py:96:log_dist] [Rank 0] step=1202, skipped=0, lr=[1.834463992229293e-05], mom=[(0.9, 0.999)]
steps: 1202 loss: 0.5744 iter time (s): 130.959 samples/sec: 0.977

 20%|██        | 2/10 [04:23<17:34, 131.76s/it][A
 20%|██        | 2/10 [04:23<17:34, 131.83s/it][A
 20%|██        | 2/10 [04:23<17:33, 131.74s/it][A
 20%|██        | 2/10 [04:23<17:34, 131.78s/it][A
 20%|██        | 2/10 [04:23<17:34, 131.80s/it][A
 20%|██        | 2/10 [04:23<17:34, 131.76s/it][A
 20%|██        | 2/10 [04:23<17:34, 131.77s/it][A
 30%|███       | 3/10 [06:34<15:20, 131.44s/it][A[2024-05-31 03:27:05,465] [INFO] [logging.py:96:log_dist] [Rank 0] step=1203, skipped=0, lr=[1.8341517459151855e-05], mom=[(0.9, 0.999)]
steps: 1203 loss: 0.5824 iter time (s): 130.863 samples/sec: 0.978

 30%|███       | 3/10 [06:35<15:21, 131.69s/it][A
 30%|███       | 3/10 [06:35<15:21, 131.65s/it][A
 30%|███       | 3/10 [06:35<15:21, 131.70s/it][A
 30%|███       | 3/10 [06:35<15:21, 131.68s/it][A
 30%|███       | 3/10 [06:35<15:21, 131.69s/it][A
 30%|███       | 3/10 [06:35<15:21, 131.70s/it][A
 30%|███       | 3/10 [06:35<15:22, 131.73s/it][A
 40%|████      | 4/10 [08:45<13:09, 131.51s/it][A[2024-05-31 03:29:17,103] [INFO] [logging.py:96:log_dist] [Rank 0] step=1204, skipped=0, lr=[1.8338392320165747e-05], mom=[(0.9, 0.999)]
steps: 1204 loss: 0.5575 iter time (s): 130.890 samples/sec: 0.978

 40%|████      | 4/10 [08:46<13:10, 131.74s/it][A
 40%|████      | 4/10 [08:47<13:10, 131.76s/it][A
 40%|████      | 4/10 [08:46<13:10, 131.75s/it][A
 40%|████      | 4/10 [08:47<13:10, 131.77s/it][A
 40%|████      | 4/10 [08:47<13:10, 131.79s/it][A
 40%|████      | 4/10 [08:47<13:10, 131.76s/it][A
 40%|████      | 4/10 [08:47<13:10, 131.78s/it][A
 50%|█████     | 5/10 [10:57<10:58, 131.78s/it][A[2024-05-31 03:31:29,348] [INFO] [logging.py:96:log_dist] [Rank 0] step=1205, skipped=0, lr=[1.8335264506337223e-05], mom=[(0.9, 0.999)]
steps: 1205 loss: 0.5777 iter time (s): 131.227 samples/sec: 0.975

 50%|█████     | 5/10 [10:59<10:59, 131.85s/it][A
 50%|█████     | 5/10 [10:59<10:59, 131.85s/it][A
 50%|█████     | 5/10 [10:58<10:59, 131.84s/it][A
 50%|█████     | 5/10 [10:58<10:59, 131.83s/it][A
 50%|█████     | 5/10 [10:59<10:59, 131.83s/it][A
 50%|█████     | 5/10 [10:58<10:59, 131.82s/it][A
 50%|█████     | 5/10 [10:58<10:59, 131.83s/it][A
 60%|██████    | 6/10 [13:09<08:47, 131.82s/it][A[2024-05-31 03:33:40,827] [INFO] [logging.py:96:log_dist] [Rank 0] step=1206, skipped=0, lr=[1.8332134018669768e-05], mom=[(0.9, 0.999)]
steps: 1206 loss: 0.5699 iter time (s): 130.806 samples/sec: 0.979

 60%|██████    | 6/10 [13:10<08:46, 131.74s/it][A
 60%|██████    | 6/10 [13:10<08:46, 131.73s/it][A
 60%|██████    | 6/10 [13:10<08:46, 131.72s/it][A
 60%|██████    | 6/10 [13:10<08:46, 131.70s/it][A
 60%|██████    | 6/10 [13:10<08:46, 131.71s/it][A
 60%|██████    | 6/10 [13:10<08:46, 131.70s/it][A
 60%|██████    | 6/10 [13:10<08:46, 131.71s/it][A
 70%|███████   | 7/10 [15:21<06:34, 131.66s/it][A[2024-05-31 03:35:52,588] [INFO] [logging.py:96:log_dist] [Rank 0] step=1207, skipped=0, lr=[1.8329000858167714e-05], mom=[(0.9, 0.999)]
steps: 1207 loss: 0.5521 iter time (s): 131.064 samples/sec: 0.977

 70%|███████   | 7/10 [15:22<06:35, 131.75s/it][A
 70%|███████   | 7/10 [15:22<06:35, 131.74s/it][A
 70%|███████   | 7/10 [15:22<06:35, 131.75s/it][A
 70%|███████   | 7/10 [15:22<06:35, 131.74s/it][A
 70%|███████   | 7/10 [15:22<06:35, 131.74s/it][A
 70%|███████   | 7/10 [15:22<06:35, 131.74s/it][A
 70%|███████   | 7/10 [15:22<06:35, 131.74s/it][A
 80%|████████  | 8/10 [17:33<04:23, 131.75s/it][A[2024-05-31 03:38:04,514] [INFO] [logging.py:96:log_dist] [Rank 0] step=1208, skipped=0, lr=[1.832586502583626e-05], mom=[(0.9, 0.999)]
steps: 1208 loss: 0.5571 iter time (s): 131.198 samples/sec: 0.976

 80%|████████  | 8/10 [17:34<04:23, 131.81s/it][A
 80%|████████  | 8/10 [17:34<04:23, 131.77s/it][A
 80%|████████  | 8/10 [17:34<04:23, 131.78s/it][A
 80%|████████  | 8/10 [17:34<04:23, 131.78s/it][A
 80%|████████  | 8/10 [17:34<04:23, 131.79s/it][A
 80%|████████  | 8/10 [17:34<04:23, 131.79s/it][A
 80%|████████  | 8/10 [17:34<04:23, 131.79s/it][A
 90%|█████████ | 9/10 [19:44<02:11, 131.76s/it][A[2024-05-31 03:40:16,295] [INFO] [logging.py:96:log_dist] [Rank 0] step=1209, skipped=0, lr=[1.832272652268146e-05], mom=[(0.9, 0.999)]
steps: 1209 loss: 0.5643 iter time (s): 131.097 samples/sec: 0.976

 90%|█████████ | 9/10 [19:45<02:11, 131.80s/it][A
 90%|█████████ | 9/10 [19:45<02:11, 131.80s/it][A
 90%|█████████ | 9/10 [19:45<02:11, 131.79s/it][A
 90%|█████████ | 9/10 [19:45<02:11, 131.79s/it][A
 90%|█████████ | 9/10 [19:45<02:11, 131.79s/it][A
 90%|█████████ | 9/10 [19:45<02:11, 131.79s/it][A
 90%|█████████ | 9/10 [19:45<02:11, 131.79s/it][A
100%|██████████| 10/10 [21:56<00:00, 131.82s/it][A100%|██████████| 10/10 [21:56<00:00, 131.68s/it]
 23%|██▎       | 122/520 [13:23:19<121:51:00, 1102.16s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-31 03:42:28,256] [INFO] [logging.py:96:log_dist] [Rank 0] step=1210, skipped=0, lr=[1.831958534971022e-05], mom=[(0.9, 0.999)]
steps: 1210 loss: 0.5435 iter time (s): 131.252 samples/sec: 0.975

100%|██████████| 10/10 [21:57<00:00, 131.85s/it][A100%|██████████| 10/10 [21:57<00:00, 131.80s/it]
 23%|██▎       | 122/520 [13:23:32<121:54:34, 1102.70s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:57<00:00, 131.84s/it][A100%|██████████| 10/10 [21:57<00:00, 131.79s/it]
 23%|██▎       | 122/520 [13:23:51<121:54:34, 1102.70s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:57<00:00, 131.84s/it][A100%|██████████| 10/10 [21:57<00:00, 131.79s/it]
 23%|██▎       | 122/520 [13:24:32<121:54:37, 1102.71s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:57<00:00, 131.84s/it][A100%|██████████| 10/10 [21:57<00:00, 131.79s/it]
 23%|██▎       | 122/520 [13:23:51<121:54:38, 1102.71s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:57<00:00, 131.83s/it][A100%|██████████| 10/10 [21:57<00:00, 131.79s/it]
 23%|██▎       | 122/520 [13:23:35<121:54:37, 1102.71s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:57<00:00, 131.84s/it][A100%|██████████| 10/10 [21:57<00:00, 131.79s/it]
 23%|██▎       | 122/520 [13:23:32<121:54:42, 1102.72s/it]
100%|██████████| 10/10 [21:57<00:00, 131.84s/it][A100%|██████████| 10/10 [21:57<00:00, 131.79s/it]
 23%|██▎       | 122/520 [13:23:31<121:54:41, 1102.72s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_8

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:37<14:33, 97.10s/it][A[2024-05-31 03:44:04,626] [INFO] [logging.py:96:log_dist] [Rank 0] step=1211, skipped=0, lr=[1.831644150793031e-05], mom=[(0.9, 0.999)]
steps: 1211 loss: 0.8117 iter time (s): 95.567 samples/sec: 1.339

 10%|█         | 1/10 [01:36<14:27, 96.43s/it][A
 10%|█         | 1/10 [01:36<14:28, 96.45s/it][A
 10%|█         | 1/10 [01:36<14:28, 96.54s/it][A
 10%|█         | 1/10 [01:36<14:28, 96.54s/it][A
 10%|█         | 1/10 [01:36<14:29, 96.58s/it][A
 10%|█         | 1/10 [01:36<14:28, 96.51s/it][A
 10%|█         | 1/10 [01:36<14:28, 96.53s/it][A
 20%|██        | 2/10 [03:13<12:53, 96.71s/it][A[2024-05-31 03:45:40,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=1212, skipped=0, lr=[1.831329499835035e-05], mom=[(0.9, 0.999)]
steps: 1212 loss: 0.8171 iter time (s): 95.396 samples/sec: 1.342

 20%|██        | 2/10 [03:12<12:50, 96.32s/it][A
 20%|██        | 2/10 [03:12<12:50, 96.36s/it][A
 20%|██        | 2/10 [03:12<12:50, 96.34s/it][A
 20%|██        | 2/10 [03:12<12:50, 96.33s/it][A
 20%|██        | 2/10 [03:12<12:50, 96.36s/it][A
 20%|██        | 2/10 [03:12<12:50, 96.35s/it][A
 20%|██        | 2/10 [03:12<12:50, 96.36s/it][A
 30%|███       | 3/10 [04:49<11:15, 96.55s/it][A[2024-05-31 03:47:17,447] [INFO] [logging.py:96:log_dist] [Rank 0] step=1213, skipped=0, lr=[1.8310145821979816e-05], mom=[(0.9, 0.999)]
steps: 1213 loss: 0.8100 iter time (s): 95.720 samples/sec: 1.337

 30%|███       | 3/10 [04:49<11:15, 96.44s/it][A
 30%|███       | 3/10 [04:49<11:15, 96.46s/it][A
 30%|███       | 3/10 [04:49<11:15, 96.46s/it][A
 30%|███       | 3/10 [04:49<11:15, 96.48s/it][A
 30%|███       | 3/10 [04:49<11:15, 96.50s/it][A
 30%|███       | 3/10 [04:49<11:15, 96.48s/it][A
 30%|███       | 3/10 [04:49<11:15, 96.48s/it][A
 40%|████      | 4/10 [06:26<09:38, 96.45s/it][A[2024-05-31 03:48:53,740] [INFO] [logging.py:96:log_dist] [Rank 0] step=1214, skipped=0, lr=[1.8306993979829052e-05], mom=[(0.9, 0.999)]
steps: 1214 loss: 0.8176 iter time (s): 95.382 samples/sec: 1.342

 40%|████      | 4/10 [06:25<09:38, 96.38s/it][A
 40%|████      | 4/10 [06:25<09:38, 96.37s/it][A
 40%|████      | 4/10 [06:25<09:38, 96.37s/it][A
 40%|████      | 4/10 [06:25<09:38, 96.42s/it][A
 40%|████      | 4/10 [06:25<09:38, 96.40s/it][A
 40%|████      | 4/10 [06:25<09:38, 96.40s/it][A
 40%|████      | 4/10 [06:25<09:38, 96.39s/it][A
 50%|█████     | 5/10 [08:03<08:03, 96.64s/it][A[2024-05-31 03:50:30,701] [INFO] [logging.py:96:log_dist] [Rank 0] step=1215, skipped=0, lr=[1.8303839472909237e-05], mom=[(0.9, 0.999)]
steps: 1215 loss: 0.8200 iter time (s): 96.087 samples/sec: 1.332

 50%|█████     | 5/10 [08:02<08:02, 96.59s/it][A
 50%|█████     | 5/10 [08:02<08:03, 96.63s/it][A
 50%|█████     | 5/10 [08:02<08:03, 96.63s/it][A
 50%|█████     | 5/10 [08:02<08:03, 96.60s/it][A
 50%|█████     | 5/10 [08:02<08:03, 96.62s/it][A
 50%|█████     | 5/10 [08:02<08:03, 96.61s/it][A
 50%|█████     | 5/10 [08:02<08:03, 96.61s/it][A
 60%|██████    | 6/10 [09:39<06:26, 96.53s/it][A[2024-05-31 03:52:07,042] [INFO] [logging.py:96:log_dist] [Rank 0] step=1216, skipped=0, lr=[1.8300682302232418e-05], mom=[(0.9, 0.999)]
steps: 1216 loss: 0.8190 iter time (s): 95.421 samples/sec: 1.341

 60%|██████    | 6/10 [09:38<06:25, 96.49s/it][A
 60%|██████    | 6/10 [09:38<06:25, 96.48s/it][A
 60%|██████    | 6/10 [09:38<06:26, 96.51s/it][A
 60%|██████    | 6/10 [09:38<06:26, 96.50s/it][A
 60%|██████    | 6/10 [09:38<06:26, 96.51s/it][A
 60%|██████    | 6/10 [09:38<06:25, 96.50s/it][A
 60%|██████    | 6/10 [09:38<06:26, 96.50s/it][A
 70%|███████   | 7/10 [11:16<04:50, 96.69s/it][A[2024-05-31 03:53:44,050] [INFO] [logging.py:96:log_dist] [Rank 0] step=1217, skipped=0, lr=[1.8297522468811495e-05], mom=[(0.9, 0.999)]
steps: 1217 loss: 0.8118 iter time (s): 96.143 samples/sec: 1.331

 70%|███████   | 7/10 [11:15<04:49, 96.66s/it][A
 70%|███████   | 7/10 [11:15<04:49, 96.66s/it][A
 70%|███████   | 7/10 [11:15<04:49, 96.65s/it][A
 70%|███████   | 7/10 [11:15<04:50, 96.68s/it][A
 70%|███████   | 7/10 [11:16<04:50, 96.69s/it][A
 70%|███████   | 7/10 [11:15<04:50, 96.68s/it][A
 70%|███████   | 7/10 [11:15<04:50, 96.68s/it][A
 80%|████████  | 8/10 [12:54<03:14, 97.11s/it][A[2024-05-31 03:55:22,051] [INFO] [logging.py:96:log_dist] [Rank 0] step=1218, skipped=0, lr=[1.829435997366022e-05], mom=[(0.9, 0.999)]
steps: 1218 loss: 0.8213 iter time (s): 97.090 samples/sec: 1.318

 80%|████████  | 8/10 [12:53<03:14, 97.09s/it][A
 80%|████████  | 8/10 [12:53<03:14, 97.10s/it][A
 80%|████████  | 8/10 [12:53<03:14, 97.07s/it][A
 80%|████████  | 8/10 [12:53<03:14, 97.07s/it][A
 80%|████████  | 8/10 [12:53<03:14, 97.07s/it][A
 80%|████████  | 8/10 [12:53<03:14, 97.07s/it][A
 80%|████████  | 8/10 [12:53<03:14, 97.08s/it][A
 90%|█████████ | 9/10 [14:30<01:36, 96.83s/it][A[2024-05-31 03:56:58,278] [INFO] [logging.py:96:log_dist] [Rank 0] step=1219, skipped=0, lr=[1.82911948177932e-05], mom=[(0.9, 0.999)]
steps: 1219 loss: 0.8205 iter time (s): 95.399 samples/sec: 1.342

 90%|█████████ | 9/10 [14:30<01:36, 96.84s/it][A
 90%|█████████ | 9/10 [14:30<01:36, 96.85s/it][A
 90%|█████████ | 9/10 [14:30<01:36, 96.84s/it][A
 90%|█████████ | 9/10 [14:30<01:36, 96.84s/it][A
 90%|█████████ | 9/10 [14:30<01:36, 96.84s/it][A
 90%|█████████ | 9/10 [14:30<01:36, 96.84s/it][A
 90%|█████████ | 9/10 [14:30<01:36, 96.84s/it][A
100%|██████████| 10/10 [16:06<00:00, 96.35s/it][A100%|██████████| 10/10 [16:06<00:00, 96.60s/it]
 24%|██▎       | 123/520 [13:39:25<117:02:55, 1061.40s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-31 03:58:33,567] [INFO] [logging.py:96:log_dist] [Rank 0] step=1220, skipped=0, lr=[1.8288027002225893e-05], mom=[(0.9, 0.999)]
steps: 1220 loss: 0.8301 iter time (s): 94.363 samples/sec: 1.356

100%|██████████| 10/10 [16:05<00:00, 96.36s/it][A100%|██████████| 10/10 [16:05<00:00, 96.54s/it]
 24%|██▎       | 123/520 [13:39:37<117:03:41, 1061.52s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:05<00:00, 96.34s/it][A100%|██████████| 10/10 [16:05<00:00, 96.54s/it]
 24%|██▎       | 123/520 [13:39:56<117:03:39, 1061.51s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:05<00:00, 96.36s/it][A100%|██████████| 10/10 [16:05<00:00, 96.55s/it]
 24%|██▎       | 123/520 [13:40:38<117:03:53, 1061.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:05<00:00, 96.36s/it][A100%|██████████| 10/10 [16:05<00:00, 96.55s/it]
 24%|██▎       | 123/520 [13:39:56<117:03:55, 1061.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:05<00:00, 96.36s/it][A100%|██████████| 10/10 [16:05<00:00, 96.55s/it]
 24%|██▎       | 123/520 [13:39:40<117:03:59, 1061.56s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:05<00:00, 96.37s/it][A100%|██████████| 10/10 [16:05<00:00, 96.55s/it]
 24%|██▎       | 123/520 [13:39:37<117:04:00, 1061.56s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:05<00:00, 96.36s/it][A100%|██████████| 10/10 [16:05<00:00, 96.55s/it]
 24%|██▎       | 123/520 [13:39:37<117:04:00, 1061.56s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_261
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:20<12:04, 80.52s/it][A[2024-05-31 03:59:53,840] [INFO] [logging.py:96:log_dist] [Rank 0] step=1221, skipped=0, lr=[1.828485652797462e-05], mom=[(0.9, 0.999)]
steps: 1221 loss: 0.4970 iter time (s): 79.228 samples/sec: 1.616

 10%|█         | 1/10 [01:20<12:01, 80.18s/it][A
 10%|█         | 1/10 [01:20<12:02, 80.27s/it][A
 10%|█         | 1/10 [01:20<12:01, 80.15s/it][A
 10%|█         | 1/10 [01:20<12:01, 80.22s/it][A
 10%|█         | 1/10 [01:20<12:01, 80.21s/it][A
 10%|█         | 1/10 [01:20<12:01, 80.17s/it][A
 10%|█         | 1/10 [01:20<12:01, 80.18s/it][A
 20%|██        | 2/10 [02:39<10:37, 79.74s/it][A[2024-05-31 04:01:13,026] [INFO] [logging.py:96:log_dist] [Rank 0] step=1222, skipped=0, lr=[1.828168339605654e-05], mom=[(0.9, 0.999)]
steps: 1222 loss: 0.4895 iter time (s): 78.351 samples/sec: 1.634

 20%|██        | 2/10 [02:39<10:36, 79.61s/it][A
 20%|██        | 2/10 [02:39<10:37, 79.64s/it][A
 20%|██        | 2/10 [02:39<10:36, 79.59s/it][A
 20%|██        | 2/10 [02:39<10:36, 79.61s/it][A
 20%|██        | 2/10 [02:39<10:36, 79.61s/it][A
 20%|██        | 2/10 [02:39<10:36, 79.61s/it][A
 20%|██        | 2/10 [02:39<10:36, 79.60s/it][A
 30%|███       | 3/10 [03:59<09:17, 79.57s/it][A[2024-05-31 04:02:32,389] [INFO] [logging.py:96:log_dist] [Rank 0] step=1223, skipped=0, lr=[1.8278507607489682e-05], mom=[(0.9, 0.999)]
steps: 1223 loss: 0.4846 iter time (s): 78.514 samples/sec: 1.630

 30%|███       | 3/10 [03:58<09:16, 79.50s/it][A
 30%|███       | 3/10 [03:58<09:16, 79.50s/it][A
 30%|███       | 3/10 [03:58<09:16, 79.48s/it][A
 30%|███       | 3/10 [03:58<09:16, 79.45s/it][A
 30%|███       | 3/10 [03:58<09:16, 79.48s/it][A
 30%|███       | 3/10 [03:58<09:16, 79.47s/it][A
 30%|███       | 3/10 [03:58<09:16, 79.47s/it][A
 40%|████      | 4/10 [05:18<07:56, 79.48s/it][A[2024-05-31 04:03:51,751] [INFO] [logging.py:96:log_dist] [Rank 0] step=1224, skipped=0, lr=[1.8275329163292906e-05], mom=[(0.9, 0.999)]
steps: 1224 loss: 0.4753 iter time (s): 78.572 samples/sec: 1.629

 40%|████      | 4/10 [05:18<07:56, 79.43s/it][A
 40%|████      | 4/10 [05:18<07:56, 79.44s/it][A
 40%|████      | 4/10 [05:18<07:56, 79.41s/it][A
 40%|████      | 4/10 [05:18<07:56, 79.41s/it][A
 40%|████      | 4/10 [05:18<07:56, 79.42s/it][A
 40%|████      | 4/10 [05:18<07:56, 79.41s/it][A
 40%|████      | 4/10 [05:18<07:56, 79.41s/it][A
 50%|█████     | 5/10 [06:37<06:37, 79.48s/it][A[2024-05-31 04:05:11,229] [INFO] [logging.py:96:log_dist] [Rank 0] step=1225, skipped=0, lr=[1.8272148064485945e-05], mom=[(0.9, 0.999)]
steps: 1225 loss: 0.4936 iter time (s): 78.729 samples/sec: 1.626

 50%|█████     | 5/10 [06:37<06:37, 79.50s/it][A
 50%|█████     | 5/10 [06:37<06:37, 79.47s/it][A
 50%|█████     | 5/10 [06:37<06:37, 79.46s/it][A
 50%|█████     | 5/10 [06:37<06:37, 79.46s/it][A
 50%|█████     | 5/10 [06:37<06:37, 79.46s/it][A
 50%|█████     | 5/10 [06:37<06:37, 79.46s/it][A
 50%|█████     | 5/10 [06:37<06:37, 79.47s/it][A
 60%|██████    | 6/10 [07:56<05:17, 79.33s/it][A[2024-05-31 04:06:29,942] [INFO] [logging.py:96:log_dist] [Rank 0] step=1226, skipped=0, lr=[1.826896431208937e-05], mom=[(0.9, 0.999)]
steps: 1226 loss: 0.4826 iter time (s): 77.862 samples/sec: 1.644

 60%|██████    | 6/10 [07:56<05:16, 79.20s/it][A
 60%|██████    | 6/10 [07:56<05:16, 79.22s/it][A
 60%|██████    | 6/10 [07:56<05:16, 79.20s/it][A
 60%|██████    | 6/10 [07:56<05:16, 79.19s/it][A
 60%|██████    | 6/10 [07:56<05:16, 79.22s/it][A
 60%|██████    | 6/10 [07:56<05:16, 79.20s/it][A
 60%|██████    | 6/10 [07:56<05:16, 79.20s/it][A
 70%|███████   | 7/10 [09:15<03:57, 79.23s/it][A[2024-05-31 04:07:49,318] [INFO] [logging.py:96:log_dist] [Rank 0] step=1227, skipped=0, lr=[1.826577790712461e-05], mom=[(0.9, 0.999)]
steps: 1227 loss: 0.4616 iter time (s): 78.560 samples/sec: 1.629

 70%|███████   | 7/10 [09:15<03:57, 79.26s/it][A
 70%|███████   | 7/10 [09:15<03:57, 79.28s/it][A
 70%|███████   | 7/10 [09:15<03:57, 79.27s/it][A
 70%|███████   | 7/10 [09:15<03:57, 79.28s/it][A
 70%|███████   | 7/10 [09:15<03:57, 79.28s/it][A
 70%|███████   | 7/10 [09:15<03:57, 79.27s/it][A
 70%|███████   | 7/10 [09:15<03:57, 79.28s/it][A
 80%|████████  | 8/10 [10:35<02:38, 79.33s/it][A[2024-05-31 04:09:08,865] [INFO] [logging.py:96:log_dist] [Rank 0] step=1228, skipped=0, lr=[1.8262588850613936e-05], mom=[(0.9, 0.999)]
steps: 1228 loss: 0.4712 iter time (s): 78.666 samples/sec: 1.627

 80%|████████  | 8/10 [10:35<02:38, 79.33s/it][A
 80%|████████  | 8/10 [10:35<02:38, 79.35s/it][A
 80%|████████  | 8/10 [10:35<02:38, 79.36s/it][A
 80%|████████  | 8/10 [10:35<02:38, 79.35s/it][A
 80%|████████  | 8/10 [10:35<02:38, 79.34s/it][A
 80%|████████  | 8/10 [10:35<02:38, 79.39s/it][A
 80%|████████  | 8/10 [10:35<02:38, 79.39s/it][A
 90%|█████████ | 9/10 [11:55<01:19, 79.68s/it][A[2024-05-31 04:10:29,305] [INFO] [logging.py:96:log_dist] [Rank 0] step=1229, skipped=0, lr=[1.825939714358049e-05], mom=[(0.9, 0.999)]
steps: 1229 loss: 0.4590 iter time (s): 79.521 samples/sec: 1.610

 90%|█████████ | 9/10 [11:55<01:19, 79.72s/it][A
 90%|█████████ | 9/10 [11:55<01:19, 79.73s/it][A
 90%|█████████ | 9/10 [11:55<01:19, 79.70s/it][A
 90%|█████████ | 9/10 [11:55<01:19, 79.72s/it][A
 90%|█████████ | 9/10 [11:55<01:19, 79.70s/it][A
 90%|█████████ | 9/10 [11:55<01:19, 79.74s/it][A
 90%|█████████ | 9/10 [11:55<01:19, 79.74s/it][A
100%|██████████| 10/10 [13:15<00:00, 79.66s/it][A100%|██████████| 10/10 [13:15<00:00, 79.56s/it]
 24%|██▍       | 124/520 [13:52:41<107:59:21, 981.72s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-31 04:11:48,908] [INFO] [logging.py:96:log_dist] [Rank 0] step=1230, skipped=0, lr=[1.8256202787048238e-05], mom=[(0.9, 0.999)]
steps: 1230 loss: 0.4562 iter time (s): 78.589 samples/sec: 1.629

100%|██████████| 10/10 [13:15<00:00, 79.65s/it][A100%|██████████| 10/10 [13:15<00:00, 79.53s/it]
 24%|██▍       | 124/520 [13:52:53<107:58:50, 981.64s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:15<00:00, 79.66s/it][A100%|██████████| 10/10 [13:15<00:00, 79.54s/it]
 24%|██▍       | 124/520 [13:53:12<107:59:01, 981.67s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:15<00:00, 79.65s/it][A100%|██████████| 10/10 [13:15<00:00, 79.52s/it]
 24%|██▍       | 124/520 [13:53:53<107:58:53, 981.65s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:15<00:00, 79.65s/it][A100%|██████████| 10/10 [13:15<00:00, 79.52s/it]
 24%|██▍       | 124/520 [13:53:11<107:58:54, 981.65s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:15<00:00, 79.64s/it][A100%|██████████| 10/10 [13:15<00:00, 79.52s/it]
 24%|██▍       | 124/520 [13:52:55<107:58:57, 981.66s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:15<00:00, 79.63s/it][A100%|██████████| 10/10 [13:15<00:00, 79.52s/it]
 24%|██▍       | 124/520 [13:52:52<107:58:57, 981.66s/it] Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_473

100%|██████████| 10/10 [13:15<00:00, 79.64s/it][A100%|██████████| 10/10 [13:15<00:00, 79.52s/it]
 24%|██▍       | 124/520 [13:52:53<107:58:59, 981.67s/it] Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:20<12:03, 80.42s/it][A[2024-05-31 04:13:09,636] [INFO] [logging.py:96:log_dist] [Rank 0] step=1231, skipped=0, lr=[1.8253005782042013e-05], mom=[(0.9, 0.999)]
steps: 1231 loss: 1.2198 iter time (s): 79.800 samples/sec: 1.604

 10%|█         | 1/10 [01:20<12:05, 80.65s/it][A
 10%|█         | 1/10 [01:20<12:05, 80.62s/it][A
 10%|█         | 1/10 [01:20<12:05, 80.62s/it][A
 10%|█         | 1/10 [01:20<12:05, 80.65s/it][A
 10%|█         | 1/10 [01:20<12:06, 80.67s/it][A
 10%|█         | 1/10 [01:20<12:05, 80.63s/it][A
 10%|█         | 1/10 [01:20<12:05, 80.64s/it][A
 20%|██        | 2/10 [02:40<10:39, 79.96s/it][A[2024-05-31 04:14:29,271] [INFO] [logging.py:96:log_dist] [Rank 0] step=1232, skipped=0, lr=[1.82498061295875e-05], mom=[(0.9, 0.999)]
steps: 1232 loss: 1.2260 iter time (s): 78.910 samples/sec: 1.622

 20%|██        | 2/10 [02:40<10:40, 80.06s/it][A
 20%|██        | 2/10 [02:40<10:40, 80.06s/it][A
 20%|██        | 2/10 [02:40<10:40, 80.07s/it][A
 20%|██        | 2/10 [02:40<10:40, 80.06s/it][A
 20%|██        | 2/10 [02:40<10:40, 80.06s/it][A
 20%|██        | 2/10 [02:40<10:40, 80.05s/it][A
 20%|██        | 2/10 [02:40<10:40, 80.06s/it][A
 30%|███       | 3/10 [04:00<09:20, 80.08s/it][A[2024-05-31 04:15:49,485] [INFO] [logging.py:96:log_dist] [Rank 0] step=1233, skipped=0, lr=[1.8246603830711213e-05], mom=[(0.9, 0.999)]
steps: 1233 loss: 1.1164 iter time (s): 79.479 samples/sec: 1.610

 30%|███       | 3/10 [04:00<09:21, 80.14s/it][A
 30%|███       | 3/10 [04:00<09:20, 80.13s/it][A
 30%|███       | 3/10 [04:00<09:20, 80.10s/it][A
 30%|███       | 3/10 [04:00<09:20, 80.12s/it][A
 30%|███       | 3/10 [04:00<09:20, 80.14s/it][A
 30%|███       | 3/10 [04:00<09:20, 80.12s/it][A
 30%|███       | 3/10 [04:00<09:20, 80.13s/it][A
 40%|████      | 4/10 [05:20<07:59, 79.98s/it][A[2024-05-31 04:17:09,334] [INFO] [logging.py:96:log_dist] [Rank 0] step=1234, skipped=0, lr=[1.8243398886440542e-05], mom=[(0.9, 0.999)]
steps: 1234 loss: 1.2026 iter time (s): 79.119 samples/sec: 1.618

 40%|████      | 4/10 [05:20<08:00, 80.01s/it][A
 40%|████      | 4/10 [05:20<07:59, 80.00s/it][A
 40%|████      | 4/10 [05:20<08:00, 80.02s/it][A
 40%|████      | 4/10 [05:20<08:00, 80.02s/it][A
 40%|████      | 4/10 [05:20<08:00, 80.02s/it][A
 40%|████      | 4/10 [05:20<08:00, 80.02s/it][A
 40%|████      | 4/10 [05:20<08:00, 80.02s/it][A
 50%|█████     | 5/10 [06:40<06:40, 80.09s/it][A[2024-05-31 04:18:29,626] [INFO] [logging.py:96:log_dist] [Rank 0] step=1235, skipped=0, lr=[1.824019129780371e-05], mom=[(0.9, 0.999)]
steps: 1235 loss: 1.1795 iter time (s): 79.561 samples/sec: 1.609

 50%|█████     | 5/10 [06:40<06:40, 80.11s/it][A
 50%|█████     | 5/10 [06:40<06:40, 80.11s/it][A
 50%|█████     | 5/10 [06:40<06:40, 80.13s/it][A
 50%|█████     | 5/10 [06:40<06:40, 80.11s/it][A
 50%|█████     | 5/10 [06:40<06:40, 80.10s/it][A
 50%|█████     | 5/10 [06:40<06:40, 80.10s/it][A
 50%|█████     | 5/10 [06:40<06:40, 80.10s/it][A
 60%|██████    | 6/10 [08:00<05:20, 80.02s/it][A[2024-05-31 04:19:49,489] [INFO] [logging.py:96:log_dist] [Rank 0] step=1236, skipped=0, lr=[1.8236981065829788e-05], mom=[(0.9, 0.999)]
steps: 1236 loss: 1.0999 iter time (s): 79.163 samples/sec: 1.617

 60%|██████    | 6/10 [08:00<05:20, 80.04s/it][A
 60%|██████    | 6/10 [08:00<05:20, 80.02s/it][A
 60%|██████    | 6/10 [08:00<05:20, 80.03s/it][A
 60%|██████    | 6/10 [08:00<05:20, 80.05s/it][A
 60%|██████    | 6/10 [08:00<05:20, 80.04s/it][A
 60%|██████    | 6/10 [08:00<05:20, 80.03s/it][A
 60%|██████    | 6/10 [08:00<05:20, 80.04s/it][A
 70%|███████   | 7/10 [09:19<03:59, 79.92s/it][A[2024-05-31 04:21:09,224] [INFO] [logging.py:96:log_dist] [Rank 0] step=1237, skipped=0, lr=[1.8233768191548695e-05], mom=[(0.9, 0.999)]
steps: 1237 loss: 1.1265 iter time (s): 78.986 samples/sec: 1.621

 70%|███████   | 7/10 [09:20<03:59, 79.93s/it][A
 70%|███████   | 7/10 [09:20<03:59, 79.96s/it][A
 70%|███████   | 7/10 [09:20<03:59, 79.95s/it][A
 70%|███████   | 7/10 [09:20<03:59, 79.94s/it][A
 70%|███████   | 7/10 [09:20<03:59, 79.94s/it][A
 70%|███████   | 7/10 [09:20<03:59, 79.94s/it][A
 70%|███████   | 7/10 [09:20<03:59, 79.94s/it][A
 80%|████████  | 8/10 [10:39<02:39, 79.77s/it][A[2024-05-31 04:22:28,678] [INFO] [logging.py:96:log_dist] [Rank 0] step=1238, skipped=0, lr=[1.8230552675991208e-05], mom=[(0.9, 0.999)]
steps: 1238 loss: 1.1567 iter time (s): 78.709 samples/sec: 1.626

 80%|████████  | 8/10 [10:39<02:39, 79.78s/it][A
 80%|████████  | 8/10 [10:39<02:39, 79.77s/it][A
 80%|████████  | 8/10 [10:39<02:39, 79.78s/it][A
 80%|████████  | 8/10 [10:39<02:39, 79.77s/it][A
 80%|████████  | 8/10 [10:39<02:39, 79.79s/it][A
 80%|████████  | 8/10 [10:39<02:39, 79.78s/it][A
 80%|████████  | 8/10 [10:39<02:39, 79.78s/it][A
 90%|█████████ | 9/10 [11:59<01:19, 79.88s/it][A[2024-05-31 04:23:48,772] [INFO] [logging.py:96:log_dist] [Rank 0] step=1239, skipped=0, lr=[1.822733452018894e-05], mom=[(0.9, 0.999)]
steps: 1239 loss: 1.1772 iter time (s): 79.366 samples/sec: 1.613

 90%|█████████ | 9/10 [11:59<01:19, 79.89s/it][A
 90%|█████████ | 9/10 [11:59<01:19, 79.88s/it][A
 90%|█████████ | 9/10 [11:59<01:19, 79.87s/it][A
 90%|█████████ | 9/10 [11:59<01:19, 79.88s/it][A
 90%|█████████ | 9/10 [11:59<01:19, 79.87s/it][A
 90%|█████████ | 9/10 [11:59<01:19, 79.89s/it][A
 90%|█████████ | 9/10 [11:59<01:19, 79.88s/it][A
100%|██████████| 10/10 [13:18<00:00, 79.71s/it][A100%|██████████| 10/10 [13:18<00:00, 79.89s/it]
[2024-05-31 04:25:08,094] [INFO] [logging.py:96:log_dist] [Rank 0] step=1240, skipped=0, lr=[1.822411372517436e-05], mom=[(0.9, 0.999)]
steps: 1240 loss: 1.1776 iter time (s): 78.582 samples/sec: 1.629

100%|██████████| 10/10 [13:19<00:00, 79.71s/it][A100%|██████████| 10/10 [13:19<00:00, 79.91s/it]

100%|██████████| 10/10 [13:19<00:00, 79.72s/it][A100%|██████████| 10/10 [13:19<00:00, 79.91s/it]

100%|██████████| 10/10 [13:19<00:00, 79.72s/it][A100%|██████████| 10/10 [13:19<00:00, 79.91s/it]

100%|██████████| 10/10 [13:19<00:00, 79.71s/it][A100%|██████████| 10/10 [13:19<00:00, 79.91s/it]

100%|██████████| 10/10 [13:19<00:00, 79.71s/it][A100%|██████████| 10/10 [13:19<00:00, 79.92s/it]

100%|██████████| 10/10 [13:19<00:00, 79.71s/it][A100%|██████████| 10/10 [13:19<00:00, 79.91s/it]

100%|██████████| 10/10 [13:19<00:00, 79.71s/it][A100%|██████████| 10/10 [13:19<00:00, 79.91s/it]
Checkpointing at shard 125
[2024-05-31 04:25:08,829] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step1240 is about to be saved!
[2024-05-31 04:25:10,498] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_00-model_states.pt...
[2024-05-31 04:25:15,018] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_06-model_states.pt...
[2024-05-31 04:25:15,266] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_00-model_states.pt.
[2024-05-31 04:25:15,910] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_05-model_states.pt...
[2024-05-31 04:25:16,272] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_07-model_states.pt...
[2024-05-31 04:25:16,293] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_08-model_states.pt...
[2024-05-31 04:25:21,106] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_02-model_states.pt...
[2024-05-31 04:25:22,255] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_03-model_states.pt...
[2024-05-31 04:25:22,663] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_04-model_states.pt...
[2024-05-31 04:25:25,942] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_01-model_states.pt...
[2024-05-31 04:29:42,537] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_01-model_states.pt.
[2024-05-31 04:29:44,102] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_00_model_states.pt
[2024-05-31 04:29:44,102] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_00_model_states.pt...
[2024-05-31 04:29:44,971] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_00_model_states.pt.
[2024-05-31 04:29:44,972] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1240 is ready now!
[2024-05-31 04:29:47,575] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_03-model_states.pt.
[2024-05-31 04:29:48,007] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_04-model_states.pt.
[2024-05-31 04:29:48,316] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_02_model_states.pt...
[2024-05-31 04:29:48,457] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_02_model_states.pt.
[2024-05-31 04:29:48,457] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1240 is ready now!
[2024-05-31 04:29:48,788] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_03_model_states.pt...
[2024-05-31 04:29:49,398] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_03_model_states.pt.
[2024-05-31 04:29:49,398] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1240 is ready now!
[2024-05-31 04:29:53,404] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_02-model_states.pt.
[2024-05-31 04:29:53,930] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_01_model_states.pt
[2024-05-31 04:29:53,930] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_01_model_states.pt...
[2024-05-31 04:29:54,363] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_01_model_states.pt.
[2024-05-31 04:29:54,363] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1240 is ready now!
[2024-05-31 04:30:15,422] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_05-model_states.pt.
[2024-05-31 04:30:15,719] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_07-model_states.pt.
[2024-05-31 04:30:15,749] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_04_model_states.pt...
[2024-05-31 04:30:15,876] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_04_model_states.pt.
[2024-05-31 04:30:15,876] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1240 is ready now!
[2024-05-31 04:30:15,941] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_08-model_states.pt.
[2024-05-31 04:30:15,996] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_06-model_states.pt.
[2024-05-31 04:30:16,069] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_06_model_states.pt...
[2024-05-31 04:30:16,162] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_06_model_states.pt.
[2024-05-31 04:30:16,162] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1240 is ready now!
[2024-05-31 04:30:16,168] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_09-model_states.pt...
[2024-05-31 04:30:16,318] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_05_model_states.pt...
[2024-05-31 04:30:16,391] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_05_model_states.pt.
[2024-05-31 04:30:16,391] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1240 is ready now!
[2024-05-31 04:30:16,749] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/layer_09-model_states.pt.
[2024-05-31 04:30:16,776] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_07_model_states.pt...
[2024-05-31 04:30:16,839] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint/global_step1240/mp_rank_07_model_states.pt.
[2024-05-31 04:30:16,839] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1240 is ready now!
 24%|██▍       | 125/520 [14:12:20<111:50:44, 1019.35s/it]Checkpoint saved using --- 308.01180815696716 seconds ---
 24%|██▍       | 125/520 [14:11:39<111:51:00, 1019.39s/it] 24%|██▍       | 125/520 [14:11:20<111:51:12, 1019.42s/it] 24%|██▍       | 125/520 [14:11:10<111:55:43, 1020.11s/it] 24%|██▍       | 125/520 [14:11:39<111:50:36, 1019.33s/it] 24%|██▍       | 125/520 [14:11:19<111:50:24, 1019.30s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_361
 24%|██▍       | 125/520 [14:11:20<111:50:25, 1019.30s/it] 24%|██▍       | 125/520 [14:11:23<111:50:32, 1019.32s/it]Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s]
[A  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [01:20<?, ?it/s]
 24%|██▍       | 125/520 [14:12:39<44:54:25, 409.28s/it]  
Traceback (most recent call last):
  File "llava/train_parallel_deepspeed_mixtral_lora.py", line 401, in <module>
    main()
  File "llava/train_parallel_deepspeed_mixtral_lora.py", line 379, in main
    loss = engine.train_batch(data_iter=training_dataloader)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/pipe/engine.py", line 373, in train_batch
    self._exec_schedule(sched)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/pipe/engine.py", line 1373, in _exec_schedule
    self._exec_instr(**cmd.kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/pipe/engine.py", line 679, in _exec_forward_pass
    outputs = super().forward(inputs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    ret_val = func(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/engine.py", line 1852, in forward
    loss = self.module(*inputs, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/pipe/module.py", line 351, in forward
    x = func(forward_input)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/pipe/module.py", line 344, in exec_func
    inputs = layer(inputs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/llava/deepspeed_pipeline_model.py", line 135, in forward
    layer_outputs = layer(
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/llava/mixtral_modification/modeling_mixtral.py", line 1110, in forward
    hidden_states, router_logits, shared_sparse_adapter_router_logits = self.block_sparse_moe(hidden_states)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/llava/mixtral_modification/modeling_mixtral.py", line 992, in forward
    current_hidden_states = expert_layer(current_state) * routing_weights[top_x_list, idx_list, None]
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/llava/mixtral_modification/modeling_mixtral.py", line 882, in forward
    current_hidden_states = self.act_fn(self.w1(hidden_states)) * self.w3(hidden_states)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 122.00 MiB. GPU 0 has a total capacity of 79.14 GiB of which 78.75 MiB is free. Including non-PyTorch memory, this process has 79.05 GiB memory in use. Of the allocated memory 70.10 GiB is allocated by PyTorch, and 4.34 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[2024-05-31 04:31:58,985] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3640369
[2024-05-31 04:31:59,009] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3640370
[2024-05-31 04:32:00,194] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3640371
[2024-05-31 04:32:01,362] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3640372
[2024-05-31 04:32:02,357] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3640373
[2024-05-31 04:32:03,392] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3640375
[2024-05-31 04:32:04,435] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3640378
[2024-05-31 04:32:05,431] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3640379
[2024-05-31 04:32:06,436] [ERROR] [launch.py:322:sigkill_handler] ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=7', '--num_stages=8', '--lora_r=128', '--lora_alpha=256', '--save_model_shard=5', '--skip_shard=74', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_128_256_checkpoint'] exits with return code = 1
