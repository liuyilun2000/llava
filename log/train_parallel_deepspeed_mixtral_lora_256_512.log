[2024-05-29 00:26:08,320] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 00:26:11,868] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-05-29 00:26:11,869] [INFO] [runner.py:568:main] cmd = /home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgMywgNCwgNSwgNiwgN119 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None llava/train_parallel_deepspeed_mixtral_lora.py --num_stages=8 --lora_r=256 --lora_alpha=512 --save_model_shard=10 --skip_shard=10 --checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint
[2024-05-29 00:26:15,213] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 00:26:16,918] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]}
[2024-05-29 00:26:16,918] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=8, node_rank=0
[2024-05-29 00:26:16,918] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]})
[2024-05-29 00:26:16,918] [INFO] [launch.py:163:main] dist_world_size=8
[2024-05-29 00:26:16,918] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
[2024-05-29 00:26:16,932] [INFO] [launch.py:253:main] process 3980491 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=0', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=10', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 00:26:16,943] [INFO] [launch.py:253:main] process 3980492 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=1', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=10', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 00:26:16,954] [INFO] [launch.py:253:main] process 3980493 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=2', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=10', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 00:26:16,970] [INFO] [launch.py:253:main] process 3980494 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=3', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=10', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 00:26:16,986] [INFO] [launch.py:253:main] process 3980495 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=4', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=10', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 00:26:17,002] [INFO] [launch.py:253:main] process 3980496 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=5', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=10', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 00:26:17,018] [INFO] [launch.py:253:main] process 3980497 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=6', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=10', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 00:26:17,032] [INFO] [launch.py:253:main] process 3980498 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=7', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=10', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 00:26:22,667] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 00:26:22,859] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 00:26:23,380] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 00:26:23,556] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 00:26:27,161] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 00:26:27,806] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 00:26:33,677] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 00:26:33,874] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 00:26:34,371] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 00:26:34,620] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 00:26:49,050] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 00:26:49,688] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 00:26:50,897] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 00:26:51,588] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 00:26:51,588] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:00<00:14,  1.27it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:20,  1.07s/it]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:20,  1.08s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:20,  1.09s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:25,  1.33s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:20,  1.15s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:25,  1.36s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:22,  1.27s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:25,  1.41s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:26,  1.45s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:27,  1.52s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:25,  1.49s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:03<00:23,  1.36s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:27,  1.52s/it][2024-05-29 00:26:59,980] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:26,  1.53s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:28,  1.70s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:05<00:25,  1.58s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:05<00:21,  1.35s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:32,  1.92s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:28,  1.65s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:06<00:24,  1.56s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:06<00:25,  1.56s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:06<00:19,  1.30s/it][2024-05-29 00:27:02,557] [INFO] [comm.py:637:init_distributed] cdb=None
Loading checkpoint shards:  25%|██▌       | 5/20 [00:07<00:23,  1.57s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:31,  1.94s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:06<00:26,  1.67s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:07<00:23,  1.58s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:08<00:25,  1.72s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:08<00:21,  1.56s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:09<00:23,  1.66s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:28,  1.89s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:08<00:25,  1.72s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:09<00:23,  1.69s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:10<00:29,  2.11s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:09<00:23,  1.69s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:11<00:24,  1.89s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:11<00:24,  1.86s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:27,  1.99s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:12<00:24,  1.92s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:12<00:19,  1.64s/it]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:  40%|████      | 8/20 [00:13<00:22,  1.89s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:12<00:26,  2.06s/it]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:  35%|███▌      | 7/20 [00:12<00:25,  1.98s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:13<00:27,  2.09s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:14<00:25,  2.16s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:14<00:20,  1.87s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:36,  1.90s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:15<00:20,  1.89s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:15<00:25,  2.15s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:37,  1.97s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:14<00:24,  2.06s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:16<00:27,  2.29s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:33,  1.88s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:16<00:23,  2.18s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:17<00:19,  1.94s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:16<00:20,  2.03s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:17<00:24,  2.25s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:16<00:23,  2.10s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:04<00:42,  2.35s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:33,  1.96s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:18<00:25,  2.33s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:19<00:22,  2.20s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:19<00:18,  2.06s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:19<00:18,  2.07s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:19<00:22,  2.21s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:06<00:40,  2.38s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:19<00:22,  2.24s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:32,  2.02s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:21<00:19,  2.14s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:21<00:23,  2.31s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:21<00:16,  2.04s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:22<00:17,  2.13s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:21<00:19,  2.13s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:22<00:13,  1.87s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:21<00:20,  2.23s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:09<00:37,  2.34s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:10<00:30,  2.06s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:23<00:16,  2.10s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:23<00:19,  2.21s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:24<00:15,  2.15s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:23<00:16,  2.08s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:24<00:11,  1.86s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:25<00:14,  2.02s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:23<00:17,  2.21s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:24<00:16,  2.12s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:29,  2.14s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:11<00:36,  2.40s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:26<00:13,  2.18s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:26<00:15,  2.18s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:26<00:09,  1.99s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:27<00:12,  2.03s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:25<00:15,  2.16s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:14<00:28,  2.19s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:27<00:15,  2.22s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:14<00:33,  2.39s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:28<00:12,  2.10s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:29<00:11,  2.30s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:28<00:08,  2.01s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:28<00:09,  1.98s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:27<00:12,  2.07s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:16<00:26,  2.18s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:29<00:13,  2.20s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:16<00:29,  2.23s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:30<00:10,  2.14s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:31<00:08,  2.23s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:29<00:09,  1.98s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:30<00:07,  1.93s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:30<00:05,  1.99s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:31<00:10,  2.02s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:18<00:23,  2.13s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:18<00:26,  2.24s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:32<00:08,  2.12s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:32<00:05,  1.92s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:31<00:07,  1.96s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:32<00:07,  1.84s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:33<00:06,  2.21s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:32<00:04,  2.01s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:21<00:22,  2.22s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:20<00:24,  2.27s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:34<00:01,  1.87s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:34<00:06,  2.05s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:33<00:05,  1.93s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:34<00:05,  1.84s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:34<00:03,  1.98s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:35<00:04,  2.16s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:35<00:00,  1.82s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:35<00:00,  1.80s/it]
Loading checkpoint shards:  50%|█████     | 10/20 [00:22<00:21,  2.14s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:36<00:04,  2.02s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:35<00:03,  1.92s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:23<00:20,  2.26s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:36<00:01,  1.91s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:36<00:03,  1.93s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:38<00:02,  2.39s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:36<00:01,  1.87s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:38<00:00,  1.85s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:38<00:00,  1.91s/it]
Loading checkpoint shards:  60%|██████    | 12/20 [00:25<00:16,  2.12s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:37<00:00,  1.39s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:37<00:00,  1.86s/it]
Loading checkpoint shards:  95%|█████████▌| 19/20 [00:38<00:02,  2.02s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:38<00:00,  1.85s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:38<00:00,  1.94s/it]
Loading checkpoint shards:  95%|█████████▌| 19/20 [00:38<00:01,  1.89s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:25<00:20,  2.33s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:38<00:00,  1.45s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:38<00:00,  1.94s/it]
Loading checkpoint shards: 100%|██████████| 20/20 [00:38<00:00,  1.61s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:38<00:00,  1.94s/it]
Loading checkpoint shards:  65%|██████▌   | 13/20 [00:27<00:14,  2.10s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:27<00:18,  2.32s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:29<00:12,  2.14s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:30<00:16,  2.42s/it]Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
Loading checkpoint shards:  75%|███████▌  | 15/20 [00:32<00:12,  2.44s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:32<00:14,  2.43s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:34<00:08,  2.22s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:34<00:11,  2.36s/it]Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
Loading checkpoint shards:  85%|████████▌ | 17/20 [00:36<00:06,  2.18s/it]Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
Loading checkpoint shards:  80%|████████  | 16/20 [00:36<00:08,  2.18s/it]Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
Loading checkpoint shards:  90%|█████████ | 18/20 [00:38<00:04,  2.03s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:37<00:05,  1.88s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:39<00:01,  1.67s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:39<00:00,  1.23s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:39<00:00,  1.97s/it]
Loading checkpoint shards:  90%|█████████ | 18/20 [00:38<00:03,  1.55s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:39<00:01,  1.28s/it]Rank 4 initialized with CUDA_MEM (60717531136, 84974239744)
Deepspeed engine initializing at --- RANK 4 --- ...
Loading checkpoint shards: 100%|██████████| 20/20 [00:39<00:00,  1.02it/s]Loading checkpoint shards: 100%|██████████| 20/20 [00:39<00:00,  1.98s/it]
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
Rank 7 initialized with CUDA_MEM (60191145984, 84974239744)
Deepspeed engine initializing at --- RANK 7 --- ...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
SEED_LAYERS=False BASE_SEED=1234 SEED_FN=None
Using topology: {ProcessCoord(pipe=0, data=0): 0, ProcessCoord(pipe=1, data=0): 1, ProcessCoord(pipe=2, data=0): 2, ProcessCoord(pipe=3, data=0): 3, ProcessCoord(pipe=4, data=0): 4, ProcessCoord(pipe=5, data=0): 5, ProcessCoord(pipe=6, data=0): 6, ProcessCoord(pipe=7, data=0): 7}
[2024-05-29 00:27:51,676] [INFO] [module.py:375:_partition_layers] Partitioning pipeline stages with method type:LanguageModelLayerWrapper
stage=0 layers=2
     0: LlavaMultiModalModuleWrapper
     1: LanguageModelLayerWrapper
stage=1 layers=1
     2: LanguageModelLayerWrapper
stage=2 layers=1
     3: LanguageModelLayerWrapper
stage=3 layers=1
     4: LanguageModelLayerWrapper
stage=4 layers=1
     5: LanguageModelLayerWrapper
stage=5 layers=1
     6: LanguageModelLayerWrapper
stage=6 layers=1
     7: LanguageModelLayerWrapper
stage=7 layers=2
     8: LanguageModelLayerWrapper
     9: LanguageModelFinalWrapper
  loss: loss_fn
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Rank 6 initialized with CUDA_MEM (60717531136, 84974239744)
Deepspeed engine initializing at --- RANK 6 --- ...
Rank 1 initialized with CUDA_MEM (60717531136, 84974239744)
Deepspeed engine initializing at --- RANK 1 --- ...
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 1.8883464336395264 seconds
[2024-05-29 00:27:52,457] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 0.4045231342315674 seconds
[2024-05-29 00:27:52,536] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Rank 3 initialized with CUDA_MEM (60717531136, 84974239744)
Deepspeed engine initializing at --- RANK 3 --- ...
Rank 2 initialized with CUDA_MEM (60717531136, 84974239744)
Deepspeed engine initializing at --- RANK 2 --- ...
Rank 5 initialized with CUDA_MEM (60717531136, 84974239744)
Deepspeed engine initializing at --- RANK 5 --- ...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Rank 0 initialized with CUDA_MEM (58697973760, 84974239744)
Deepspeed engine initializing at --- RANK 0 --- ...
[2024-05-29 00:27:54,258] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.9610137939453125 seconds
[2024-05-29 00:27:54,321] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 0.8045544624328613 seconds
[2024-05-29 00:27:54,336] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 0.20320940017700195 seconds
[2024-05-29 00:27:54,392] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 1.0049731731414795 seconds
[2024-05-29 00:27:54,412] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
[2024-05-29 00:27:54,568] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 3.600088119506836 seconds
[2024-05-29 00:27:58,265] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 3.1082873344421387 seconds
[2024-05-29 00:27:58,289] [INFO] [logging.py:96:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adam as basic optimizer
[2024-05-29 00:27:58,289] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-05-29 00:27:58,303] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-05-29 00:27:58,303] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2024-05-29 00:27:58,303] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = WarmupCosineLR
[2024-05-29 00:27:58,303] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupCosineLR object at 0x14c8e0b28e80>
[2024-05-29 00:27:58,303] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[2e-05], mom=[(0.9, 0.999)]
[2024-05-29 00:27:58,304] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-05-29 00:27:58,304] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   bfloat16_enabled ............. False
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x14c8e0b289d0>
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-05-29 00:27:58,305] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 128
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 65536
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   loss_scale ................... 0
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=True, output_path='/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint', job_name='deepspeed_monitor_logs') enabled=True
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   optimizer_name ............... adam
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   optimizer_params ............. {'lr': 2e-05}
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True, 'use_reentrant': False}
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   scheduler_name ............... WarmupCosineLR
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   scheduler_params ............. {'total_num_steps': 5718, 'warmup_min_ratio': 0.1, 'warmup_num_steps': 171.54}
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   steps_per_print .............. 1
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   train_batch_size ............. 128
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  1
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   zero_enabled ................. False
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-05-29 00:27:58,306] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 0
[2024-05-29 00:27:58,307] [INFO] [config.py:986:print_user_config]   json = {
    "train_batch_size": 128, 
    "train_micro_batch_size_per_gpu": 1, 
    "gradient_accumulation_steps": 128, 
    "steps_per_print": 1, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 2e-05
        }
    }, 
    "scheduler": {
        "type": "WarmupCosineLR", 
        "params": {
            "total_num_steps": 5.718000e+03, 
            "warmup_min_ratio": 0.1, 
            "warmup_num_steps": 171.54
        }
    }, 
    "pipeline": {
        "use_reentrant": false
    }, 
    "csv_monitor": {
        "enabled": true, 
        "output_path": "/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint", 
        "job_name": "deepspeed_monitor_logs"
    }
}
[2024-05-29 00:27:58,307] [INFO] [engine.py:101:__init__] CONFIG: micro_batches=128 micro_batch_size=1
[2024-05-29 00:27:58,307] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
[2024-05-29 00:28:02,692] [INFO] [engine.py:160:__init__] RANK=3 STAGE=3 LAYERS=1 [4, 5) STAGE_PARAMS=13631488 (13.631M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
[2024-05-29 00:28:02,692] [INFO] [engine.py:160:__init__] RANK=2 STAGE=2 LAYERS=1 [3, 4) STAGE_PARAMS=13631488 (13.631M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
[2024-05-29 00:28:02,692] [INFO] [engine.py:160:__init__] RANK=0 STAGE=0 LAYERS=2 [0, 2) STAGE_PARAMS=55590912 (55.591M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
[2024-05-29 00:28:02,692] [INFO] [engine.py:160:__init__] RANK=1 STAGE=1 LAYERS=1 [2, 3) STAGE_PARAMS=13631488 (13.631M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
[2024-05-29 00:28:02,692] [INFO] [engine.py:160:__init__] RANK=6 STAGE=6 LAYERS=1 [7, 8) STAGE_PARAMS=13631488 (13.631M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
[2024-05-29 00:28:02,692] [INFO] [engine.py:160:__init__] RANK=4 STAGE=4 LAYERS=1 [5, 6) STAGE_PARAMS=13631488 (13.631M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
[2024-05-29 00:28:02,692] [INFO] [engine.py:160:__init__] RANK=5 STAGE=5 LAYERS=1 [6, 7) STAGE_PARAMS=13631488 (13.631M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
[2024-05-29 00:28:02,692] [INFO] [engine.py:160:__init__] RANK=7 STAGE=7 LAYERS=2 [8, 10) STAGE_PARAMS=13631488 (13.631M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
Deepspeed engine successfully initialized at --- RANK 0 --- hosting 24 of 136 trainable parameters
Loading latest model checkpoint at shard 10
[2024-05-29 00:28:05,429] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt...
[2024-05-29 00:28:05,511] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt.
[2024-05-29 00:28:05,511] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt...
[2024-05-29 00:28:05,579] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt.
[2024-05-29 00:28:05,583] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_00-model_states.pt...
[2024-05-29 00:28:05,962] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_00-model_states.pt.
[2024-05-29 00:28:05,965] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_00-model_states.pt...
[2024-05-29 00:28:06,252] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_00-model_states.pt.
Deepspeed engine successfully initialized at --- RANK 7 --- hosting 16 of 136 trainable parameters
[2024-05-29 00:28:06,417] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt...
[2024-05-29 00:28:06,440] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_01-model_states.pt...
[2024-05-29 00:28:06,591] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt.
[2024-05-29 00:28:06,594] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_07_model_states.pt...
[2024-05-29 00:28:06,643] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_07_model_states.pt.
[2024-05-29 00:28:06,647] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_08-model_states.pt...
Deepspeed engine successfully initialized at --- RANK 2 --- hosting 16 of 136 trainable parameters
Deepspeed engine successfully initialized at --- RANK 1 --- hosting 16 of 136 trainable parameters
[2024-05-29 00:28:09,118] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt...
[2024-05-29 00:28:09,122] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt...
[2024-05-29 00:28:09,244] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt.
[2024-05-29 00:28:09,245] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_02_model_states.pt...
[2024-05-29 00:28:09,258] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt.
[2024-05-29 00:28:09,258] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_02_model_states.pt.
[2024-05-29 00:28:09,258] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_01_model_states.pt...
[2024-05-29 00:28:09,259] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_03-model_states.pt...
[2024-05-29 00:28:09,278] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_01_model_states.pt.
[2024-05-29 00:28:09,282] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_02-model_states.pt...
Deepspeed engine successfully initialized at --- RANK 3 --- hosting 16 of 136 trainable parameters
Deepspeed engine successfully initialized at --- RANK 4 --- hosting 16 of 136 trainable parameters
[2024-05-29 00:28:09,405] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt...
[2024-05-29 00:28:09,416] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt...
[2024-05-29 00:28:09,509] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt.
[2024-05-29 00:28:09,511] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_04_model_states.pt...
Deepspeed engine successfully initialized at --- RANK 6 --- hosting 16 of 136 trainable parameters
Deepspeed engine successfully initialized at --- RANK 5 --- hosting 16 of 136 trainable parameters
[2024-05-29 00:28:09,535] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt...
[2024-05-29 00:28:09,536] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt...
[2024-05-29 00:28:09,542] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt.
[2024-05-29 00:28:09,542] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_03_model_states.pt...
[2024-05-29 00:28:09,546] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_04_model_states.pt.
[2024-05-29 00:28:09,547] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_05-model_states.pt...
[2024-05-29 00:28:09,565] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_03_model_states.pt.
[2024-05-29 00:28:09,565] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_04-model_states.pt...
[2024-05-29 00:28:09,652] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt.
[2024-05-29 00:28:09,655] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_06_model_states.pt...
[2024-05-29 00:28:09,666] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_00_model_states.pt.
[2024-05-29 00:28:09,674] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_05_model_states.pt...
[2024-05-29 00:28:09,704] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_05_model_states.pt.
[2024-05-29 00:28:09,708] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_06-model_states.pt...
[2024-05-29 00:28:09,718] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/mp_rank_06_model_states.pt.
[2024-05-29 00:28:09,722] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_07-model_states.pt...
[2024-05-29 00:37:11,347] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_08-model_states.pt.
[2024-05-29 00:37:11,817] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_08-model_states.pt...
[2024-05-29 00:37:16,975] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_06-model_states.pt.
[2024-05-29 00:37:17,514] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_06-model_states.pt...
[2024-05-29 00:37:20,811] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_03-model_states.pt.
[2024-05-29 00:37:21,202] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_03-model_states.pt...
[2024-05-29 00:37:23,381] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_08-model_states.pt.
[2024-05-29 00:37:24,927] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_09-model_states.pt...
[2024-05-29 00:37:32,402] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_03-model_states.pt.
[2024-05-29 00:37:33,418] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_06-model_states.pt.
[2024-05-29 00:37:33,586] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_01-model_states.pt.
[2024-05-29 00:37:34,085] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_01-model_states.pt...
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 00:37:40,337] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_09-model_states.pt.
[2024-05-29 00:37:40,355] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_09-model_states.pt...
[2024-05-29 00:37:40,531] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_09-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 00:37:45,821] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_01-model_states.pt.
[2024-05-29 00:37:46,168] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_02-model_states.pt.
[2024-05-29 00:37:46,474] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_02-model_states.pt...
  0%|          | 0/520 [00:00<?, ?it/s]Shard 0 / 10 skipped
Shard 1 / 10 skipped
Shard 2 / 10 skipped
Shard 3 / 10 skipped
Shard 4 / 10 skipped
Shard 5 / 10 skipped
Shard 6 / 10 skipped
Shard 7 / 10 skipped
Shard 8 / 10 skipped
Shard 9 / 10 skipped
Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_4
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 00:37:49,462] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_05-model_states.pt.
[2024-05-29 00:37:49,888] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_05-model_states.pt...
[2024-05-29 00:37:52,627] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_02-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 00:37:56,588] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_07-model_states.pt.
[2024-05-29 00:37:56,840] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_07-model_states.pt...
[2024-05-29 00:38:00,928] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_05-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 00:38:07,221] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_04-model_states.pt.
[2024-05-29 00:38:07,595] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_04-model_states.pt...
[2024-05-29 00:38:08,105] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_07-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 00:38:16,857] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step100/layer_04-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 00:40:01,625] [INFO] [logging.py:96:log_dist] [Rank 0] step=101, skipped=0, lr=[1.8146770190488428e-05], mom=[(0.9, 0.999)]
steps: 101 loss: 0.9785 iter time (s): 138.781 samples/sec: 0.922

 10%|█         | 1/10 [02:25<21:51, 145.75s/it][A
 10%|█         | 1/10 [01:56<17:28, 116.52s/it][A
 10%|█         | 1/10 [02:31<22:42, 151.41s/it][A
 10%|█         | 1/10 [02:04<18:41, 124.60s/it][A
 10%|█         | 1/10 [02:32<22:52, 152.48s/it][A
 10%|█         | 1/10 [02:12<19:56, 132.92s/it][A
 10%|█         | 1/10 [01:48<16:19, 108.81s/it][A
 10%|█         | 1/10 [02:20<21:01, 140.21s/it][A
 20%|██        | 2/10 [04:04<15:45, 118.24s/it][A[2024-05-29 00:41:48,291] [INFO] [logging.py:96:log_dist] [Rank 0] step=102, skipped=0, lr=[1.8181240095647642e-05], mom=[(0.9, 0.999)]
steps: 102 loss: 0.9617 iter time (s): 99.906 samples/sec: 1.281

 20%|██        | 2/10 [03:37<14:20, 107.56s/it][A
 20%|██        | 2/10 [04:12<16:15, 121.88s/it][A
 20%|██        | 2/10 [03:45<14:46, 110.79s/it][A
 20%|██        | 2/10 [03:29<13:53, 104.16s/it][A
 20%|██        | 2/10 [04:13<16:18, 122.33s/it][A
 20%|██        | 2/10 [03:54<15:13, 114.23s/it][A
 20%|██        | 2/10 [04:00<15:35, 117.00s/it][A
 30%|███       | 3/10 [05:46<12:53, 110.55s/it][A[2024-05-29 00:43:29,711] [INFO] [logging.py:96:log_dist] [Rank 0] step=103, skipped=0, lr=[1.821537370368803e-05], mom=[(0.9, 0.999)]
steps: 103 loss: 0.9648 iter time (s): 100.647 samples/sec: 1.272

 30%|███       | 3/10 [05:19<12:13, 104.76s/it][A
 30%|███       | 3/10 [05:54<13:08, 112.59s/it][A
 30%|███       | 3/10 [05:27<12:25, 106.55s/it][A
 30%|███       | 3/10 [05:11<12:00, 102.97s/it][A
 30%|███       | 3/10 [05:55<13:09, 112.84s/it][A
 30%|███       | 3/10 [05:35<12:39, 108.43s/it][A
 30%|███       | 3/10 [05:42<12:49, 109.94s/it][A
 40%|████      | 4/10 [07:26<10:39, 106.57s/it][A[2024-05-29 00:45:10,158] [INFO] [logging.py:96:log_dist] [Rank 0] step=104, skipped=0, lr=[1.8249177513257787e-05], mom=[(0.9, 0.999)]
steps: 104 loss: 0.9585 iter time (s): 99.506 samples/sec: 1.286

 40%|████      | 4/10 [06:59<10:18, 103.09s/it][A
 40%|████      | 4/10 [07:34<10:46, 107.80s/it][A
 40%|████      | 4/10 [07:07<10:24, 104.16s/it][A
 40%|████      | 4/10 [06:51<10:11, 101.96s/it][A
 40%|████      | 4/10 [07:35<10:47, 107.95s/it][A
 40%|████      | 4/10 [07:16<10:31, 105.30s/it][A
 40%|████      | 4/10 [07:22<10:37, 106.21s/it][A
 50%|█████     | 5/10 [09:07<08:42, 104.41s/it][A[2024-05-29 00:46:50,730] [INFO] [logging.py:96:log_dist] [Rank 0] step=105, skipped=0, lr=[1.828265783643528e-05], mom=[(0.9, 0.999)]
steps: 105 loss: 0.9437 iter time (s): 99.558 samples/sec: 1.286

 50%|█████     | 5/10 [08:40<08:31, 102.21s/it][A
 50%|█████     | 5/10 [09:15<08:46, 105.23s/it][A
 50%|█████     | 5/10 [08:48<08:34, 102.91s/it][A
 50%|█████     | 5/10 [08:32<08:27, 101.53s/it][A
 50%|█████     | 5/10 [09:16<08:46, 105.35s/it][A
 50%|█████     | 5/10 [08:56<08:38, 103.64s/it][A
 50%|█████     | 5/10 [09:03<08:41, 104.23s/it][A
 60%|██████    | 6/10 [10:53<06:59, 104.90s/it][A[2024-05-29 00:48:36,622] [INFO] [logging.py:96:log_dist] [Rank 0] step=106, skipped=0, lr=[1.8315820805803032e-05], mom=[(0.9, 0.999)]
steps: 106 loss: 0.9461 iter time (s): 104.775 samples/sec: 1.222

 60%|██████    | 6/10 [10:26<06:53, 103.41s/it][A
 60%|██████    | 6/10 [11:01<07:01, 105.41s/it][A
 60%|██████    | 6/10 [10:34<06:55, 103.86s/it][A
 60%|██████    | 6/10 [10:18<06:51, 102.94s/it][A
 60%|██████    | 6/10 [11:02<07:01, 105.44s/it][A
 60%|██████    | 6/10 [10:42<06:57, 104.32s/it][A
 60%|██████    | 6/10 [10:49<06:58, 104.71s/it][A
 70%|███████   | 7/10 [12:33<05:10, 103.39s/it][A[2024-05-29 00:50:16,870] [INFO] [logging.py:96:log_dist] [Rank 0] step=107, skipped=0, lr=[1.8348672381189623e-05], mom=[(0.9, 0.999)]
steps: 107 loss: 0.9286 iter time (s): 99.410 samples/sec: 1.288

 70%|███████   | 7/10 [12:06<05:07, 102.41s/it][A
 70%|███████   | 7/10 [12:41<05:11, 103.73s/it][A
 70%|███████   | 7/10 [12:14<05:08, 102.67s/it][A
 70%|███████   | 7/10 [11:58<05:06, 102.05s/it][A
 70%|███████   | 7/10 [12:42<05:11, 103.73s/it][A
 70%|███████   | 7/10 [12:22<05:08, 102.99s/it][A
 70%|███████   | 7/10 [12:29<05:09, 103.24s/it][A
 80%|████████  | 8/10 [14:15<03:26, 103.08s/it][A[2024-05-29 00:51:59,307] [INFO] [logging.py:96:log_dist] [Rank 0] step=108, skipped=0, lr=[1.8381218356097962e-05], mom=[(0.9, 0.999)]
steps: 108 loss: 0.9197 iter time (s): 101.611 samples/sec: 1.260

 80%|████████  | 8/10 [13:48<03:24, 102.39s/it][A
 80%|████████  | 8/10 [14:23<03:26, 103.30s/it][A
 80%|████████  | 8/10 [13:56<03:25, 102.60s/it][A
 80%|████████  | 8/10 [13:40<03:24, 102.19s/it][A
 80%|████████  | 8/10 [14:24<03:26, 103.33s/it][A
 80%|████████  | 8/10 [14:05<03:25, 102.81s/it][A
 80%|████████  | 8/10 [14:12<03:25, 102.99s/it][A
 90%|█████████ | 9/10 [16:05<01:45, 105.14s/it][A[2024-05-29 00:53:48,976] [INFO] [logging.py:96:log_dist] [Rank 0] step=109, skipped=0, lr=[1.841346436383733e-05], mom=[(0.9, 0.999)]
steps: 109 loss: 0.9186 iter time (s): 108.826 samples/sec: 1.176

 90%|█████████ | 9/10 [15:38<01:44, 104.68s/it][A
 90%|█████████ | 9/10 [16:13<01:45, 105.29s/it][A
 90%|█████████ | 9/10 [15:46<01:44, 104.79s/it][A
 90%|█████████ | 9/10 [15:30<01:44, 104.52s/it][A
 90%|█████████ | 9/10 [16:14<01:45, 105.31s/it][A
 90%|█████████ | 9/10 [15:54<01:44, 104.96s/it][A
 90%|█████████ | 9/10 [16:01<01:45, 105.08s/it][A
100%|██████████| 10/10 [17:47<00:00, 104.10s/it][A100%|██████████| 10/10 [17:47<00:00, 106.72s/it]
  2%|▏         | 11/520 [17:47<13:43:05, 97.02s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 00:55:30,714] [INFO] [logging.py:96:log_dist] [Rank 0] step=110, skipped=0, lr=[1.844541588337544e-05], mom=[(0.9, 0.999)]
steps: 110 loss: 0.9142 iter time (s): 100.864 samples/sec: 1.269

100%|██████████| 10/10 [17:20<00:00, 103.77s/it][A100%|██████████| 10/10 [17:20<00:00, 104.03s/it]
  2%|▏         | 11/520 [17:20<13:22:21, 94.58s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:55<00:00, 104.18s/it][A100%|██████████| 10/10 [17:55<00:00, 107.51s/it]
  2%|▏         | 11/520 [17:55<13:49:11, 97.74s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:28<00:00, 103.85s/it][A100%|██████████| 10/10 [17:28<00:00, 104.81s/it]
  2%|▏         | 11/520 [17:28<13:28:23, 95.29s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:12<00:00, 103.67s/it][A100%|██████████| 10/10 [17:12<00:00, 103.23s/it]
  2%|▏         | 11/520 [17:12<13:16:08, 93.85s/it]
100%|██████████| 10/10 [17:56<00:00, 104.22s/it][A100%|██████████| 10/10 [17:56<00:00, 107.62s/it]
  2%|▏         | 11/520 [17:56<13:50:22, 97.88s/it]
100%|██████████| 10/10 [17:36<00:00, 103.97s/it][A100%|██████████| 10/10 [17:36<00:00, 105.65s/it]
  2%|▏         | 11/520 [17:36<13:34:51, 96.05s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:43<00:00, 104.05s/it][A100%|██████████| 10/10 [17:43<00:00, 106.35s/it]
  2%|▏         | 11/520 [17:43<13:40:12, 96.68s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_323
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:24<12:37, 84.22s/it][A[2024-05-29 00:56:54,767] [INFO] [logging.py:96:log_dist] [Rank 0] step=111, skipped=0, lr=[1.847707824492561e-05], mom=[(0.9, 0.999)]
steps: 111 loss: 0.8472 iter time (s): 83.076 samples/sec: 1.541

 10%|█         | 1/10 [01:24<12:36, 84.08s/it][A
 10%|█         | 1/10 [01:24<12:36, 84.02s/it][A
 10%|█         | 1/10 [01:23<12:35, 83.93s/it][A
 10%|█         | 1/10 [01:23<12:34, 83.83s/it][A
 10%|█         | 1/10 [01:23<12:35, 83.91s/it][A
 10%|█         | 1/10 [01:23<12:35, 83.97s/it][A
 10%|█         | 1/10 [01:23<12:35, 83.97s/it][A
 20%|██        | 2/10 [02:48<11:12, 84.01s/it][A[2024-05-29 00:58:18,644] [INFO] [logging.py:96:log_dist] [Rank 0] step=112, skipped=0, lr=[1.850845663528346e-05], mom=[(0.9, 0.999)]
steps: 112 loss: 0.8498 iter time (s): 83.146 samples/sec: 1.539

 20%|██        | 2/10 [02:47<11:11, 83.98s/it][A
 20%|██        | 2/10 [02:47<11:11, 83.97s/it][A
 20%|██        | 2/10 [02:47<11:11, 83.94s/it][A
 20%|██        | 2/10 [02:47<11:11, 83.96s/it][A
 20%|██        | 2/10 [02:47<11:11, 83.95s/it][A
 20%|██        | 2/10 [02:47<11:11, 83.97s/it][A
 20%|██        | 2/10 [02:47<11:11, 83.96s/it][A
 30%|███       | 3/10 [04:11<09:46, 83.75s/it][A[2024-05-29 00:59:42,081] [INFO] [logging.py:96:log_dist] [Rank 0] step=113, skipped=0, lr=[1.8539556102926362e-05], mom=[(0.9, 0.999)]
steps: 113 loss: 0.8484 iter time (s): 82.599 samples/sec: 1.550

 30%|███       | 3/10 [04:11<09:46, 83.72s/it][A
 30%|███       | 3/10 [04:11<09:45, 83.69s/it][A
 30%|███       | 3/10 [04:11<09:45, 83.68s/it][A
 30%|███       | 3/10 [04:11<09:45, 83.70s/it][A
 30%|███       | 3/10 [04:11<09:45, 83.69s/it][A
 30%|███       | 3/10 [04:11<09:45, 83.70s/it][A
 30%|███       | 3/10 [04:11<09:45, 83.71s/it][A
 40%|████      | 4/10 [05:35<08:23, 83.91s/it][A[2024-05-29 01:01:06,252] [INFO] [logging.py:96:log_dist] [Rank 0] step=114, skipped=0, lr=[1.857038156288827e-05], mom=[(0.9, 0.999)]
steps: 114 loss: 0.8097 iter time (s): 83.319 samples/sec: 1.536

 40%|████      | 4/10 [05:35<08:23, 83.87s/it][A
 40%|████      | 4/10 [05:35<08:23, 83.92s/it][A
 40%|████      | 4/10 [05:35<08:23, 83.97s/it][A
 40%|████      | 4/10 [05:35<08:23, 83.91s/it][A
 40%|████      | 4/10 [05:35<08:23, 83.96s/it][A
 40%|████      | 4/10 [05:35<08:23, 83.94s/it][A
 40%|████      | 4/10 [05:35<08:24, 84.06s/it][A
 50%|█████     | 5/10 [06:59<06:59, 83.88s/it][A[2024-05-29 01:02:30,072] [INFO] [logging.py:96:log_dist] [Rank 0] step=115, skipped=0, lr=[1.8600937801421617e-05], mom=[(0.9, 0.999)]
steps: 115 loss: 0.8126 iter time (s): 82.831 samples/sec: 1.545

 50%|█████     | 5/10 [06:59<06:59, 83.88s/it][A
 50%|█████     | 5/10 [06:59<06:59, 83.84s/it][A
 50%|█████     | 5/10 [06:59<06:59, 83.84s/it][A
 50%|█████     | 5/10 [06:59<06:59, 83.84s/it][A
 50%|█████     | 5/10 [06:59<06:59, 83.83s/it][A
 50%|█████     | 5/10 [06:59<06:59, 83.81s/it][A
 50%|█████     | 5/10 [06:59<06:59, 83.83s/it][A
 60%|██████    | 6/10 [08:23<05:35, 83.91s/it][A[2024-05-29 01:03:54,024] [INFO] [logging.py:96:log_dist] [Rank 0] step=116, skipped=0, lr=[1.8631229480457462e-05], mom=[(0.9, 0.999)]
steps: 116 loss: 0.7975 iter time (s): 83.147 samples/sec: 1.539

 60%|██████    | 6/10 [08:23<05:35, 83.87s/it][A
 60%|██████    | 6/10 [08:23<05:35, 83.87s/it][A
 60%|██████    | 6/10 [08:23<05:35, 83.88s/it][A
 60%|██████    | 6/10 [08:23<05:35, 83.88s/it][A
 60%|██████    | 6/10 [08:23<05:35, 83.87s/it][A
 60%|██████    | 6/10 [08:23<05:35, 83.85s/it][A
 60%|██████    | 6/10 [08:23<05:35, 83.87s/it][A
 70%|███████   | 7/10 [09:47<04:11, 83.80s/it][A[2024-05-29 01:05:17,617] [INFO] [logging.py:96:log_dist] [Rank 0] step=117, skipped=0, lr=[1.8661261141874143e-05], mom=[(0.9, 0.999)]
steps: 117 loss: 0.7950 iter time (s): 82.803 samples/sec: 1.546

 70%|███████   | 7/10 [09:46<04:11, 83.78s/it][A
 70%|███████   | 7/10 [09:46<04:11, 83.77s/it][A
 70%|███████   | 7/10 [09:46<04:11, 83.76s/it][A
 70%|███████   | 7/10 [09:46<04:11, 83.77s/it][A
 70%|███████   | 7/10 [09:46<04:11, 83.77s/it][A
 70%|███████   | 7/10 [09:46<04:11, 83.76s/it][A
 70%|███████   | 7/10 [09:46<04:11, 83.77s/it][A
 80%|████████  | 8/10 [11:10<02:47, 83.84s/it][A[2024-05-29 01:06:41,543] [INFO] [logging.py:96:log_dist] [Rank 0] step=118, skipped=0, lr=[1.869103721158431e-05], mom=[(0.9, 0.999)]
steps: 118 loss: 0.7874 iter time (s): 83.163 samples/sec: 1.539

 80%|████████  | 8/10 [11:10<02:47, 83.84s/it][A
 80%|████████  | 8/10 [11:10<02:47, 83.82s/it][A
 80%|████████  | 8/10 [11:10<02:47, 83.83s/it][A
 80%|████████  | 8/10 [11:10<02:47, 83.83s/it][A
 80%|████████  | 8/10 [11:10<02:47, 83.83s/it][A
 80%|████████  | 8/10 [11:10<02:47, 83.83s/it][A
 80%|████████  | 8/10 [11:10<02:47, 83.84s/it][A
 90%|█████████ | 9/10 [12:36<01:24, 84.32s/it][A[2024-05-29 01:08:06,899] [INFO] [logging.py:96:log_dist] [Rank 0] step=119, skipped=0, lr=[1.8720562003449495e-05], mom=[(0.9, 0.999)]
steps: 119 loss: 0.7700 iter time (s): 84.574 samples/sec: 1.513

 90%|█████████ | 9/10 [12:36<01:24, 84.31s/it][A
 90%|█████████ | 9/10 [12:36<01:24, 84.32s/it][A
 90%|█████████ | 9/10 [12:36<01:24, 84.31s/it][A
 90%|█████████ | 9/10 [12:36<01:24, 84.31s/it][A
 90%|█████████ | 9/10 [12:36<01:24, 84.32s/it][A
 90%|█████████ | 9/10 [12:36<01:24, 84.31s/it][A
 90%|█████████ | 9/10 [12:36<01:24, 84.32s/it][A
100%|██████████| 10/10 [14:00<00:00, 84.13s/it][A100%|██████████| 10/10 [14:00<00:00, 84.01s/it]
  2%|▏         | 12/520 [31:47<25:44:50, 182.46s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 01:09:30,615] [INFO] [logging.py:96:log_dist] [Rank 0] step=120, skipped=0, lr=[1.87498397230309e-05], mom=[(0.9, 0.999)]
steps: 120 loss: 0.7678 iter time (s): 82.843 samples/sec: 1.545

100%|██████████| 10/10 [13:59<00:00, 84.13s/it][A100%|██████████| 10/10 [13:59<00:00, 83.99s/it]
  2%|▏         | 12/520 [31:20<25:26:07, 180.25s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:00<00:00, 84.17s/it][A100%|██████████| 10/10 [14:00<00:00, 84.00s/it]
  2%|▏         | 12/520 [31:55<25:50:00, 183.07s/it]
100%|██████████| 10/10 [13:59<00:00, 84.16s/it][A100%|██████████| 10/10 [13:59<00:00, 83.99s/it]
  2%|▏         | 12/520 [31:28<25:31:32, 180.89s/it]
100%|██████████| 10/10 [13:59<00:00, 84.15s/it][A100%|██████████| 10/10 [13:59<00:00, 83.98s/it]
  2%|▏         | 12/520 [31:12<25:20:37, 179.60s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:59<00:00, 84.16s/it][A100%|██████████| 10/10 [13:59<00:00, 83.99s/it]
  2%|▏         | 12/520 [31:56<25:50:55, 183.18s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:59<00:00, 84.16s/it][A100%|██████████| 10/10 [13:59<00:00, 84.00s/it]
  2%|▏         | 12/520 [31:36<25:37:14, 181.56s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:59<00:00, 84.17s/it][A100%|██████████| 10/10 [13:59<00:00, 84.00s/it]
  2%|▏         | 12/520 [31:43<25:41:57, 182.12s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_175

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:19<20:58, 139.88s/it][A[2024-05-29 01:11:52,509] [INFO] [logging.py:96:log_dist] [Rank 0] step=121, skipped=0, lr=[1.8778874471184513e-05], mom=[(0.9, 0.999)]
steps: 121 loss: 0.7061 iter time (s): 140.818 samples/sec: 0.909

 10%|█         | 1/10 [02:21<21:15, 141.75s/it][A
 10%|█         | 1/10 [02:21<21:13, 141.49s/it][A
 10%|█         | 1/10 [02:21<21:14, 141.58s/it][A
 10%|█         | 1/10 [02:21<21:14, 141.58s/it][A
 10%|█         | 1/10 [02:21<21:14, 141.60s/it][A
 10%|█         | 1/10 [02:21<21:14, 141.63s/it][A
 10%|█         | 1/10 [02:21<21:14, 141.65s/it][A
 20%|██        | 2/10 [04:41<18:45, 140.66s/it][A[2024-05-29 01:14:13,717] [INFO] [logging.py:96:log_dist] [Rank 0] step=122, skipped=0, lr=[1.880767024750831e-05], mom=[(0.9, 0.999)]
steps: 122 loss: 0.7000 iter time (s): 140.475 samples/sec: 0.911

 20%|██        | 2/10 [04:42<18:51, 141.42s/it][A
 20%|██        | 2/10 [04:42<18:50, 141.34s/it][A
 20%|██        | 2/10 [04:42<18:51, 141.38s/it][A
 20%|██        | 2/10 [04:42<18:50, 141.36s/it][A
 20%|██        | 2/10 [04:42<18:51, 141.38s/it][A
 20%|██        | 2/10 [04:42<18:50, 141.37s/it][A
 20%|██        | 2/10 [04:42<18:51, 141.38s/it][A
 30%|███       | 3/10 [07:03<16:31, 141.62s/it][A[2024-05-29 01:16:36,415] [INFO] [logging.py:96:log_dist] [Rank 0] step=123, skipped=0, lr=[1.8836230953648723e-05], mom=[(0.9, 0.999)]
steps: 123 loss: 0.6840 iter time (s): 142.049 samples/sec: 0.901

 30%|███       | 3/10 [07:05<16:34, 142.06s/it][A
 30%|███       | 3/10 [07:05<16:33, 141.96s/it][A
 30%|███       | 3/10 [07:05<16:34, 142.02s/it][A
 30%|███       | 3/10 [07:05<16:33, 142.00s/it][A
 30%|███       | 3/10 [07:05<16:34, 142.01s/it][A
 30%|███       | 3/10 [07:05<16:34, 142.01s/it][A
 30%|███       | 3/10 [07:05<16:34, 142.01s/it][A
 40%|████      | 4/10 [09:27<14:15, 142.59s/it][A[2024-05-29 01:19:00,569] [INFO] [logging.py:96:log_dist] [Rank 0] step=124, skipped=0, lr=[1.8864560396473256e-05], mom=[(0.9, 0.999)]
steps: 124 loss: 0.6803 iter time (s): 143.339 samples/sec: 0.893

 40%|████      | 4/10 [09:29<14:16, 142.80s/it][A
 40%|████      | 4/10 [09:29<14:16, 142.80s/it][A
 40%|████      | 4/10 [09:29<14:16, 142.79s/it][A
 40%|████      | 4/10 [09:29<14:16, 142.82s/it][A
 40%|████      | 4/10 [09:29<14:16, 142.81s/it][A
 40%|████      | 4/10 [09:29<14:16, 142.82s/it][A
 40%|████      | 4/10 [09:29<14:16, 142.82s/it][A
 50%|█████     | 5/10 [11:48<11:49, 141.93s/it][A[2024-05-29 01:21:21,330] [INFO] [logging.py:96:log_dist] [Rank 0] step=125, skipped=0, lr=[1.889266229111566e-05], mom=[(0.9, 0.999)]
steps: 125 loss: 0.6532 iter time (s): 140.104 samples/sec: 0.914

 50%|█████     | 5/10 [11:50<11:50, 142.10s/it][A
 50%|█████     | 5/10 [11:50<11:50, 142.08s/it][A
 50%|█████     | 5/10 [11:50<11:50, 142.05s/it][A
 50%|█████     | 5/10 [11:50<11:50, 142.09s/it][A
 50%|█████     | 5/10 [11:50<11:50, 142.09s/it][A
 50%|█████     | 5/10 [11:50<11:50, 142.09s/it][A
 50%|█████     | 5/10 [11:50<11:50, 142.09s/it][A
 60%|██████    | 6/10 [14:13<09:31, 142.97s/it][A[2024-05-29 01:23:46,322] [INFO] [logging.py:96:log_dist] [Rank 0] step=126, skipped=0, lr=[1.8920540263899815e-05], mom=[(0.9, 0.999)]
steps: 126 loss: 0.6822 iter time (s): 144.304 samples/sec: 0.887

 60%|██████    | 6/10 [14:15<09:32, 143.10s/it][A
 60%|██████    | 6/10 [14:15<09:32, 143.06s/it][A
 60%|██████    | 6/10 [14:15<09:32, 143.09s/it][A
 60%|██████    | 6/10 [14:15<09:32, 143.10s/it][A
 60%|██████    | 6/10 [14:15<09:32, 143.08s/it][A
 60%|██████    | 6/10 [14:15<09:32, 143.08s/it][A
 60%|██████    | 6/10 [14:15<09:32, 143.09s/it][A
 70%|███████   | 7/10 [16:34<07:07, 142.41s/it][A[2024-05-29 01:26:07,583] [INFO] [logging.py:96:log_dist] [Rank 0] step=127, skipped=0, lr=[1.8948197855148e-05], mom=[(0.9, 0.999)]
steps: 127 loss: 0.6605 iter time (s): 140.488 samples/sec: 0.911

 70%|███████   | 7/10 [16:36<07:07, 142.48s/it][A
 70%|███████   | 7/10 [16:36<07:07, 142.46s/it][A
 70%|███████   | 7/10 [16:36<07:07, 142.47s/it][A
 70%|███████   | 7/10 [16:36<07:07, 142.49s/it][A
 70%|███████   | 7/10 [16:36<07:07, 142.48s/it][A
 70%|███████   | 7/10 [16:36<07:07, 142.47s/it][A
 70%|███████   | 7/10 [16:36<07:07, 142.46s/it][A
 80%|████████  | 8/10 [19:02<04:48, 144.02s/it][A[2024-05-29 01:28:35,029] [INFO] [logging.py:96:log_dist] [Rank 0] step=128, skipped=0, lr=[1.8975638521879078e-05], mom=[(0.9, 0.999)]
steps: 128 loss: 0.6721 iter time (s): 146.785 samples/sec: 0.872

 80%|████████  | 8/10 [19:04<04:48, 144.07s/it][A
 80%|████████  | 8/10 [19:04<04:48, 144.07s/it][A
 80%|████████  | 8/10 [19:04<04:48, 144.07s/it][A
 80%|████████  | 8/10 [19:04<04:48, 144.06s/it][A
 80%|████████  | 8/10 [19:04<04:48, 144.07s/it][A
 80%|████████  | 8/10 [19:04<04:48, 144.07s/it][A
 80%|████████  | 8/10 [19:04<04:48, 144.07s/it][A
 90%|█████████ | 9/10 [21:22<02:22, 142.71s/it][A[2024-05-29 01:30:54,891] [INFO] [logging.py:96:log_dist] [Rank 0] step=129, skipped=0, lr=[1.9002865640401647e-05], mom=[(0.9, 0.999)]
steps: 129 loss: 0.6489 iter time (s): 139.119 samples/sec: 0.920

 90%|█████████ | 9/10 [21:24<02:22, 142.75s/it][A
 90%|█████████ | 9/10 [21:23<02:22, 142.74s/it][A
 90%|█████████ | 9/10 [21:23<02:22, 142.74s/it][A
 90%|█████████ | 9/10 [21:23<02:22, 142.74s/it][A
 90%|█████████ | 9/10 [21:24<02:22, 142.75s/it][A
 90%|█████████ | 9/10 [21:24<02:22, 142.75s/it][A
 90%|█████████ | 9/10 [21:24<02:22, 142.75s/it][A
100%|██████████| 10/10 [23:49<00:00, 143.98s/it][A100%|██████████| 10/10 [23:49<00:00, 142.91s/it]
  2%|▎         | 13/520 [55:37<50:28:03, 358.35s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 01:33:21,700] [INFO] [logging.py:96:log_dist] [Rank 0] step=130, skipped=0, lr=[1.902988250880708e-05], mom=[(0.9, 0.999)]
steps: 130 loss: 0.6426 iter time (s): 146.092 samples/sec: 0.876

100%|██████████| 10/10 [23:50<00:00, 144.00s/it][A100%|██████████| 10/10 [23:50<00:00, 143.09s/it]
  2%|▎         | 13/520 [55:11<50:13:45, 356.66s/it]
100%|██████████| 10/10 [23:50<00:00, 143.98s/it][A100%|██████████| 10/10 [23:50<00:00, 143.06s/it]
  2%|▎         | 13/520 [55:46<50:34:01, 359.06s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [23:50<00:00, 144.00s/it][A100%|██████████| 10/10 [23:50<00:00, 143.08s/it]
  2%|▎         | 13/520 [55:19<50:18:22, 357.20s/it]
100%|██████████| 10/10 [23:50<00:00, 144.02s/it][A100%|██████████| 10/10 [23:50<00:00, 143.08s/it]
  2%|▎         | 13/520 [55:03<50:08:59, 356.09s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [23:50<00:00, 144.00s/it][A100%|██████████| 10/10 [23:50<00:00, 143.08s/it]
  2%|▎         | 13/520 [55:47<50:34:52, 359.16s/it]
100%|██████████| 10/10 [23:50<00:00, 144.00s/it][A100%|██████████| 10/10 [23:50<00:00, 143.08s/it]
  2%|▎         | 13/520 [55:27<50:23:09, 357.77s/it]
100%|██████████| 10/10 [23:50<00:00, 144.00s/it][A100%|██████████| 10/10 [23:50<00:00, 143.08s/it]
  2%|▎         | 13/520 [55:34<50:27:10, 358.25s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_337

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:28<13:14, 88.33s/it][A[2024-05-29 01:34:48,772] [INFO] [logging.py:96:log_dist] [Rank 0] step=131, skipped=0, lr=[1.9056692349367072e-05], mom=[(0.9, 0.999)]
steps: 131 loss: 0.7281 iter time (s): 85.990 samples/sec: 1.489

 10%|█         | 1/10 [01:27<13:03, 87.11s/it][A
 10%|█         | 1/10 [01:27<13:04, 87.15s/it][A
 10%|█         | 1/10 [01:27<13:03, 87.09s/it][A
 10%|█         | 1/10 [01:27<13:03, 87.04s/it][A
 10%|█         | 1/10 [01:26<13:02, 87.00s/it][A
 10%|█         | 1/10 [01:26<13:02, 86.96s/it][A
 10%|█         | 1/10 [01:26<13:02, 86.93s/it][A
 20%|██        | 2/10 [02:54<11:34, 86.86s/it][A[2024-05-29 01:36:14,593] [INFO] [logging.py:96:log_dist] [Rank 0] step=132, skipped=0, lr=[1.9083298310839972e-05], mom=[(0.9, 0.999)]
steps: 132 loss: 0.7217 iter time (s): 84.905 samples/sec: 1.508

 20%|██        | 2/10 [02:52<11:30, 86.30s/it][A
 20%|██        | 2/10 [02:52<11:30, 86.31s/it][A
 20%|██        | 2/10 [02:52<11:30, 86.30s/it][A
 20%|██        | 2/10 [02:52<11:29, 86.25s/it][A
 20%|██        | 2/10 [02:52<11:30, 86.25s/it][A
 20%|██        | 2/10 [02:52<11:29, 86.22s/it][A
 20%|██        | 2/10 [02:52<11:29, 86.21s/it][A
 30%|███       | 3/10 [04:18<09:59, 85.66s/it][A[2024-05-29 01:37:38,839] [INFO] [logging.py:96:log_dist] [Rank 0] step=133, skipped=0, lr=[1.910970347069012e-05], mom=[(0.9, 0.999)]
steps: 133 loss: 0.7151 iter time (s): 83.440 samples/sec: 1.534

 30%|███       | 3/10 [04:17<09:57, 85.37s/it][A
 30%|███       | 3/10 [04:17<09:57, 85.38s/it][A
 30%|███       | 3/10 [04:17<09:57, 85.35s/it][A
 30%|███       | 3/10 [04:17<09:57, 85.35s/it][A
 30%|███       | 3/10 [04:16<09:57, 85.31s/it][A
 30%|███       | 3/10 [04:17<09:57, 85.36s/it][A
 30%|███       | 3/10 [04:16<09:57, 85.32s/it][A
 40%|████      | 4/10 [05:42<08:29, 84.91s/it][A[2024-05-29 01:39:02,586] [INFO] [logging.py:96:log_dist] [Rank 0] step=134, skipped=0, lr=[1.9135910837224043e-05], mom=[(0.9, 0.999)]
steps: 134 loss: 0.7034 iter time (s): 82.973 samples/sec: 1.543

 40%|████      | 4/10 [05:40<08:28, 84.73s/it][A
 40%|████      | 4/10 [05:40<08:28, 84.75s/it][A
 40%|████      | 4/10 [05:40<08:28, 84.73s/it][A
 40%|████      | 4/10 [05:40<08:28, 84.70s/it][A
 40%|████      | 4/10 [05:40<08:28, 84.73s/it][A
 40%|████      | 4/10 [05:40<08:28, 84.70s/it][A
 40%|████      | 4/10 [05:40<08:28, 84.70s/it][A
 50%|█████     | 5/10 [07:08<07:07, 85.50s/it][A[2024-05-29 01:40:29,131] [INFO] [logging.py:96:log_dist] [Rank 0] step=135, skipped=0, lr=[1.9161923351647253e-05], mom=[(0.9, 0.999)]
steps: 135 loss: 0.7021 iter time (s): 85.722 samples/sec: 1.493

 50%|█████     | 5/10 [07:07<07:06, 85.36s/it][A
 50%|█████     | 5/10 [07:07<07:06, 85.39s/it][A
 50%|█████     | 5/10 [07:07<07:06, 85.35s/it][A
 50%|█████     | 5/10 [07:07<07:06, 85.36s/it][A
 50%|█████     | 5/10 [07:07<07:06, 85.36s/it][A
 50%|█████     | 5/10 [07:07<07:06, 85.36s/it][A
 50%|█████     | 5/10 [07:07<07:06, 85.35s/it][A
 60%|██████    | 6/10 [08:32<05:40, 85.08s/it][A[2024-05-29 01:41:53,416] [INFO] [logging.py:96:log_dist] [Rank 0] step=136, skipped=0, lr=[1.9187743890045118e-05], mom=[(0.9, 0.999)]
steps: 136 loss: 0.6926 iter time (s): 83.531 samples/sec: 1.532

 60%|██████    | 6/10 [08:31<05:40, 85.03s/it][A
 60%|██████    | 6/10 [08:31<05:40, 85.01s/it][A
 60%|██████    | 6/10 [08:31<05:40, 85.02s/it][A
 60%|██████    | 6/10 [08:31<05:40, 85.00s/it][A
 60%|██████    | 6/10 [08:31<05:40, 85.02s/it][A
 60%|██████    | 6/10 [08:31<05:40, 85.01s/it][A
 60%|██████    | 6/10 [08:31<05:40, 85.01s/it][A
 70%|███████   | 7/10 [09:57<04:14, 84.77s/it][A[2024-05-29 01:43:17,534] [INFO] [logging.py:96:log_dist] [Rank 0] step=137, skipped=0, lr=[1.921337526529119e-05], mom=[(0.9, 0.999)]
steps: 137 loss: 0.6933 iter time (s): 83.298 samples/sec: 1.537

 70%|███████   | 7/10 [09:55<04:14, 84.71s/it][A
 70%|███████   | 7/10 [09:55<04:14, 84.73s/it][A
 70%|███████   | 7/10 [09:55<04:14, 84.71s/it][A
 70%|███████   | 7/10 [09:55<04:14, 84.72s/it][A
 70%|███████   | 7/10 [09:55<04:14, 84.72s/it][A
 70%|███████   | 7/10 [09:55<04:14, 84.72s/it][A
 70%|███████   | 7/10 [09:55<04:14, 84.72s/it][A
 80%|████████  | 8/10 [11:22<02:49, 84.90s/it][A[2024-05-29 01:44:42,702] [INFO] [logging.py:96:log_dist] [Rank 0] step=138, skipped=0, lr=[1.923882022888615e-05], mom=[(0.9, 0.999)]
steps: 138 loss: 0.6845 iter time (s): 84.351 samples/sec: 1.517

 80%|████████  | 8/10 [11:20<02:49, 84.87s/it][A
 80%|████████  | 8/10 [11:20<02:49, 84.85s/it][A
 80%|████████  | 8/10 [11:20<02:49, 84.88s/it][A
 80%|████████  | 8/10 [11:20<02:49, 84.85s/it][A
 80%|████████  | 8/10 [11:20<02:49, 84.87s/it][A
 80%|████████  | 8/10 [11:20<02:49, 84.86s/it][A
 80%|████████  | 8/10 [11:20<02:49, 84.86s/it][A
 90%|█████████ | 9/10 [12:46<01:24, 84.73s/it][A[2024-05-29 01:46:07,089] [INFO] [logging.py:96:log_dist] [Rank 0] step=139, skipped=0, lr=[1.9264081472730333e-05], mom=[(0.9, 0.999)]
steps: 139 loss: 0.6706 iter time (s): 83.591 samples/sec: 1.531

 90%|█████████ | 9/10 [12:45<01:24, 84.69s/it][A
 90%|█████████ | 9/10 [12:45<01:24, 84.70s/it][A
 90%|█████████ | 9/10 [12:45<01:24, 84.72s/it][A
 90%|█████████ | 9/10 [12:45<01:24, 84.72s/it][A
 90%|█████████ | 9/10 [12:45<01:24, 84.70s/it][A
 90%|█████████ | 9/10 [12:45<01:24, 84.71s/it][A
 90%|█████████ | 9/10 [12:45<01:24, 84.70s/it][A
100%|██████████| 10/10 [14:11<00:00, 84.65s/it][A100%|██████████| 10/10 [14:11<00:00, 85.11s/it]
  3%|▎         | 14/520 [1:09:48<61:59:25, 441.04s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 01:47:31,548] [INFO] [logging.py:96:log_dist] [Rank 0] step=140, skipped=0, lr=[1.9289161630832753e-05], mom=[(0.9, 0.999)]
steps: 140 loss: 0.6455 iter time (s): 83.625 samples/sec: 1.531

100%|██████████| 10/10 [14:09<00:00, 84.62s/it][A100%|██████████| 10/10 [14:09<00:00, 84.97s/it]
  3%|▎         | 14/520 [1:09:21<61:45:23, 439.37s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:09<00:00, 84.64s/it][A100%|██████████| 10/10 [14:09<00:00, 84.99s/it]
  3%|▎         | 14/520 [1:09:56<62:02:21, 441.39s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:09<00:00, 84.62s/it][A100%|██████████| 10/10 [14:09<00:00, 84.98s/it]
  3%|▎         | 14/520 [1:09:29<61:49:08, 439.82s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:09<00:00, 84.60s/it][A100%|██████████| 10/10 [14:09<00:00, 84.96s/it]
  3%|▎         | 14/520 [1:09:12<61:41:20, 438.89s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:09<00:00, 84.61s/it][A100%|██████████| 10/10 [14:09<00:00, 84.96s/it]
  3%|▎         | 14/520 [1:09:57<62:02:56, 441.46s/it]
100%|██████████| 10/10 [14:09<00:00, 84.62s/it][A100%|██████████| 10/10 [14:09<00:00, 84.96s/it]
  3%|▎         | 14/520 [1:09:37<61:53:12, 440.30s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:09<00:00, 84.62s/it][A100%|██████████| 10/10 [14:09<00:00, 84.96s/it]
  3%|▎         | 14/520 [1:09:44<61:56:32, 440.70s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_358
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:36<23:27, 156.41s/it][A[2024-05-29 01:50:09,889] [INFO] [logging.py:96:log_dist] [Rank 0] step=141, skipped=0, lr=[1.9314063280959264e-05], mom=[(0.9, 0.999)]
steps: 141 loss: 0.8320 iter time (s): 157.392 samples/sec: 0.813

 10%|█         | 1/10 [02:38<23:45, 158.41s/it][A
 10%|█         | 1/10 [02:38<23:45, 158.38s/it][A
 10%|█         | 1/10 [02:38<23:46, 158.46s/it][A
 10%|█         | 1/10 [02:38<23:46, 158.45s/it][A
 10%|█         | 1/10 [02:38<23:45, 158.41s/it][A
 10%|█         | 1/10 [02:38<23:45, 158.36s/it][A
 10%|█         | 1/10 [02:38<23:45, 158.34s/it][A
 20%|██        | 2/10 [05:12<20:49, 156.24s/it][A[2024-05-29 01:52:46,451] [INFO] [logging.py:96:log_dist] [Rank 0] step=142, skipped=0, lr=[1.933878894622252e-05], mom=[(0.9, 0.999)]
steps: 142 loss: 0.8343 iter time (s): 155.686 samples/sec: 0.822

 20%|██        | 2/10 [05:14<20:57, 157.19s/it][A
 20%|██        | 2/10 [05:14<20:58, 157.25s/it][A
 20%|██        | 2/10 [05:14<20:58, 157.31s/it][A
 20%|██        | 2/10 [05:14<20:58, 157.27s/it][A
 20%|██        | 2/10 [05:14<20:57, 157.25s/it][A
 20%|██        | 2/10 [05:14<20:57, 157.22s/it][A
 20%|██        | 2/10 [05:14<20:57, 157.25s/it][A
 30%|███       | 3/10 [07:49<18:17, 156.73s/it][A[2024-05-29 01:55:23,790] [INFO] [logging.py:96:log_dist] [Rank 0] step=143, skipped=0, lr=[1.9363341096616153e-05], mom=[(0.9, 0.999)]
steps: 143 loss: 0.8232 iter time (s): 156.589 samples/sec: 0.817

 30%|███       | 3/10 [07:52<18:21, 157.29s/it][A
 30%|███       | 3/10 [07:52<18:20, 157.28s/it][A
 30%|███       | 3/10 [07:52<18:21, 157.31s/it][A
 30%|███       | 3/10 [07:52<18:21, 157.31s/it][A
 30%|███       | 3/10 [07:52<18:21, 157.31s/it][A
 30%|███       | 3/10 [07:52<18:21, 157.35s/it][A
 30%|███       | 3/10 [07:52<18:21, 157.35s/it][A
 40%|████      | 4/10 [10:26<15:39, 156.63s/it][A[2024-05-29 01:58:00,243] [INFO] [logging.py:96:log_dist] [Rank 0] step=144, skipped=0, lr=[1.9387722150495435e-05], mom=[(0.9, 0.999)]
steps: 144 loss: 0.8290 iter time (s): 155.557 samples/sec: 0.823

 40%|████      | 4/10 [10:28<15:42, 157.01s/it][A
 40%|████      | 4/10 [10:28<15:41, 156.99s/it][A
 40%|████      | 4/10 [10:28<15:42, 157.03s/it][A
 40%|████      | 4/10 [10:28<15:42, 157.01s/it][A
 40%|████      | 4/10 [10:28<15:42, 157.00s/it][A
 40%|████      | 4/10 [10:28<15:41, 156.98s/it][A
 40%|████      | 4/10 [10:28<15:41, 156.98s/it][A
 50%|█████     | 5/10 [13:02<13:01, 156.40s/it][A[2024-05-29 02:00:36,237] [INFO] [logging.py:96:log_dist] [Rank 0] step=145, skipped=0, lr=[1.9411934476006756e-05], mom=[(0.9, 0.999)]
steps: 145 loss: 0.8234 iter time (s): 155.179 samples/sec: 0.825

 50%|█████     | 5/10 [13:04<13:03, 156.62s/it][A
 50%|█████     | 5/10 [13:04<13:03, 156.62s/it][A
 50%|█████     | 5/10 [13:04<13:03, 156.64s/it][A
 50%|█████     | 5/10 [13:04<13:03, 156.64s/it][A
 50%|█████     | 5/10 [13:04<13:03, 156.63s/it][A
 50%|█████     | 5/10 [13:04<13:03, 156.62s/it][A
 50%|█████     | 5/10 [13:04<13:03, 156.62s/it][A
 60%|██████    | 6/10 [15:38<10:25, 156.34s/it][A[2024-05-29 02:03:12,644] [INFO] [logging.py:96:log_dist] [Rank 0] step=146, skipped=0, lr=[1.943598039246798e-05], mom=[(0.9, 0.999)]
steps: 146 loss: 0.8100 iter time (s): 155.525 samples/sec: 0.823

 60%|██████    | 6/10 [15:40<10:25, 156.27s/it][A
 60%|██████    | 6/10 [15:41<10:26, 156.54s/it][A
 60%|██████    | 6/10 [15:41<10:26, 156.52s/it][A
 60%|██████    | 6/10 [15:41<10:26, 156.51s/it][A
 60%|██████    | 6/10 [15:41<10:26, 156.52s/it][A
 60%|██████    | 6/10 [15:40<10:25, 156.50s/it][A
 60%|██████    | 6/10 [15:40<10:25, 156.47s/it][A
 70%|███████   | 7/10 [18:14<07:49, 156.36s/it][A[2024-05-29 02:05:48,861] [INFO] [logging.py:96:log_dist] [Rank 0] step=147, skipped=0, lr=[1.9459862171701665e-05], mom=[(0.9, 0.999)]
steps: 147 loss: 0.8201 iter time (s): 156.148 samples/sec: 0.820

 70%|███████   | 7/10 [18:17<07:49, 156.45s/it][A
 70%|███████   | 7/10 [18:17<07:49, 156.44s/it][A
 70%|███████   | 7/10 [18:17<07:49, 156.44s/it][A
 70%|███████   | 7/10 [18:17<07:49, 156.42s/it][A
 70%|███████   | 7/10 [18:17<07:49, 156.44s/it][A
 70%|███████   | 7/10 [18:17<07:49, 156.43s/it][A
 70%|███████   | 7/10 [18:17<07:49, 156.49s/it][A
 80%|████████  | 8/10 [20:51<05:13, 156.50s/it][A[2024-05-29 02:08:25,675] [INFO] [logging.py:96:log_dist] [Rank 0] step=148, skipped=0, lr=[1.948358203932308e-05], mom=[(0.9, 0.999)]
steps: 148 loss: 0.8052 iter time (s): 156.027 samples/sec: 0.820

 80%|████████  | 8/10 [20:54<05:13, 156.58s/it][A
 80%|████████  | 8/10 [20:54<05:13, 156.60s/it][A
 80%|████████  | 8/10 [20:54<05:13, 156.61s/it][A
 80%|████████  | 8/10 [20:54<05:13, 156.61s/it][A
 80%|████████  | 8/10 [20:54<05:13, 156.59s/it][A
 80%|████████  | 8/10 [20:54<05:13, 156.62s/it][A
 80%|████████  | 8/10 [20:54<05:13, 156.59s/it][A
 90%|█████████ | 9/10 [23:27<02:36, 156.18s/it][A[2024-05-29 02:11:01,161] [INFO] [logging.py:96:log_dist] [Rank 0] step=149, skipped=0, lr=[1.9507142175984895e-05], mom=[(0.9, 0.999)]
steps: 149 loss: 0.8025 iter time (s): 154.608 samples/sec: 0.828

 90%|█████████ | 9/10 [23:29<02:36, 156.20s/it][A
 90%|█████████ | 9/10 [23:29<02:36, 156.20s/it][A
 90%|█████████ | 9/10 [23:29<02:36, 156.22s/it][A
 90%|█████████ | 9/10 [23:29<02:36, 156.23s/it][A
 90%|█████████ | 9/10 [23:29<02:36, 156.23s/it][A
 90%|█████████ | 9/10 [23:29<02:36, 156.25s/it][A
 90%|█████████ | 9/10 [23:29<02:36, 156.22s/it][A
100%|██████████| 10/10 [26:03<00:00, 156.26s/it][A100%|██████████| 10/10 [26:03<00:00, 156.37s/it]
  3%|▎         | 15/520 [1:35:52<92:18:53, 658.09s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 02:13:37,611] [INFO] [logging.py:96:log_dist] [Rank 0] step=150, skipped=0, lr=[1.953054471858019e-05], mom=[(0.9, 0.999)]
steps: 150 loss: 0.7883 iter time (s): 155.623 samples/sec: 0.823

100%|██████████| 10/10 [26:06<00:00, 156.41s/it][A100%|██████████| 10/10 [26:06<00:00, 156.64s/it]
  3%|▎         | 15/520 [1:35:27<92:11:36, 657.22s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [26:06<00:00, 156.41s/it][A100%|██████████| 10/10 [26:06<00:00, 156.64s/it]
  3%|▎         | 15/520 [1:36:02<92:25:04, 658.82s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [26:06<00:00, 156.35s/it][A100%|██████████| 10/10 [26:06<00:00, 156.63s/it]
  3%|▎         | 15/520 [1:35:19<92:08:04, 656.80s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [26:06<00:00, 156.35s/it][A100%|██████████| 10/10 [26:06<00:00, 156.63s/it]
  3%|▎         | 15/520 [1:36:03<92:25:23, 658.86s/it]
100%|██████████| 10/10 [26:06<00:00, 156.39s/it][A100%|██████████| 10/10 [26:06<00:00, 156.65s/it]
  3%|▎         | 15/520 [1:35:35<92:14:33, 657.57s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [26:06<00:00, 156.36s/it][A100%|██████████| 10/10 [26:06<00:00, 156.62s/it]
  3%|▎         | 15/520 [1:35:43<92:17:36, 657.93s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [26:06<00:00, 156.40s/it][A100%|██████████| 10/10 [26:06<00:00, 156.63s/it]
  3%|▎         | 15/520 [1:35:50<92:20:20, 658.26s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_plain_texts/shard_24
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:12<19:55, 132.80s/it][A[2024-05-29 02:15:49,774] [INFO] [logging.py:96:log_dist] [Rank 0] step=151, skipped=0, lr=[1.9553791761405558e-05], mom=[(0.9, 0.999)]
steps: 151 loss: 0.9259 iter time (s): 131.167 samples/sec: 0.976

 10%|█         | 1/10 [02:12<19:48, 132.02s/it][A
 10%|█         | 1/10 [02:11<19:47, 131.95s/it][A
 10%|█         | 1/10 [02:12<19:49, 132.13s/it][A
 10%|█         | 1/10 [02:12<19:49, 132.16s/it][A
 10%|█         | 1/10 [02:12<19:49, 132.12s/it][A
 10%|█         | 1/10 [02:12<19:48, 132.06s/it][A
 10%|█         | 1/10 [02:12<19:48, 132.03s/it][A
 20%|██        | 2/10 [04:24<17:36, 132.08s/it][A[2024-05-29 02:18:01,383] [INFO] [logging.py:96:log_dist] [Rank 0] step=152, skipped=0, lr=[1.957688535728574e-05], mom=[(0.9, 0.999)]
steps: 152 loss: 0.9744 iter time (s): 130.844 samples/sec: 0.978

 20%|██        | 2/10 [04:23<17:34, 131.81s/it][A
 20%|██        | 2/10 [04:23<17:34, 131.77s/it][A
 20%|██        | 2/10 [04:23<17:34, 131.85s/it][A
 20%|██        | 2/10 [04:23<17:35, 131.88s/it][A
 20%|██        | 2/10 [04:23<17:35, 131.89s/it][A
 20%|██        | 2/10 [04:23<17:35, 131.89s/it][A
 20%|██        | 2/10 [04:23<17:34, 131.87s/it][A
 30%|███       | 3/10 [06:36<15:23, 131.98s/it][A[2024-05-29 02:20:13,232] [INFO] [logging.py:96:log_dist] [Rank 0] step=153, skipped=0, lr=[1.959982751866147e-05], mom=[(0.9, 0.999)]
steps: 153 loss: 1.0035 iter time (s): 130.985 samples/sec: 0.977

 30%|███       | 3/10 [06:35<15:22, 131.77s/it][A
 30%|███       | 3/10 [06:35<15:22, 131.79s/it][A
 30%|███       | 3/10 [06:35<15:22, 131.79s/it][A
 30%|███       | 3/10 [06:35<15:22, 131.85s/it][A
 30%|███       | 3/10 [06:35<15:22, 131.82s/it][A
 30%|███       | 3/10 [06:35<15:23, 131.86s/it][A
 30%|███       | 3/10 [06:35<15:22, 131.85s/it][A
 40%|████      | 4/10 [08:47<13:11, 131.89s/it][A[2024-05-29 02:22:24,977] [INFO] [logging.py:96:log_dist] [Rank 0] step=154, skipped=0, lr=[1.962262021864183e-05], mom=[(0.9, 0.999)]
steps: 154 loss: 0.9538 iter time (s): 130.970 samples/sec: 0.977

 40%|████      | 4/10 [08:47<13:11, 131.86s/it][A
 40%|████      | 4/10 [08:47<13:11, 131.84s/it][A
 40%|████      | 4/10 [08:47<13:11, 131.90s/it][A
 40%|████      | 4/10 [08:47<13:11, 131.89s/it][A
 40%|████      | 4/10 [08:47<13:11, 131.88s/it][A
 40%|████      | 4/10 [08:47<13:11, 131.87s/it][A
 40%|████      | 4/10 [08:47<13:11, 131.87s/it][A
 50%|█████     | 5/10 [11:00<10:59, 131.96s/it][A[2024-05-29 02:24:37,116] [INFO] [logging.py:96:log_dist] [Rank 0] step=155, skipped=0, lr=[1.964526539202255e-05], mom=[(0.9, 0.999)]
steps: 155 loss: 0.8989 iter time (s): 131.097 samples/sec: 0.976

 50%|█████     | 5/10 [10:59<10:59, 131.92s/it][A
 50%|█████     | 5/10 [10:59<10:59, 131.89s/it][A
 50%|█████     | 5/10 [10:59<10:59, 131.89s/it][A
 50%|█████     | 5/10 [10:59<10:59, 131.93s/it][A
 50%|█████     | 5/10 [10:59<10:59, 131.93s/it][A
 50%|█████     | 5/10 [10:59<10:59, 131.93s/it][A
 50%|█████     | 5/10 [10:59<10:59, 131.93s/it][A
 60%|██████    | 6/10 [13:12<08:48, 132.01s/it][A[2024-05-29 02:26:49,176] [INFO] [logging.py:96:log_dist] [Rank 0] step=156, skipped=0, lr=[1.9667764936271615e-05], mom=[(0.9, 0.999)]
steps: 156 loss: 0.9091 iter time (s): 131.154 samples/sec: 0.976

 60%|██████    | 6/10 [13:11<08:47, 131.97s/it][A
 60%|██████    | 6/10 [13:11<08:47, 131.94s/it][A
 60%|██████    | 6/10 [13:11<08:47, 131.95s/it][A
 60%|██████    | 6/10 [13:11<08:47, 131.98s/it][A
 60%|██████    | 6/10 [13:11<08:47, 131.95s/it][A
 60%|██████    | 6/10 [13:11<08:47, 131.95s/it][A
 60%|██████    | 6/10 [13:11<08:47, 131.96s/it][A
 70%|███████   | 7/10 [15:23<06:35, 131.93s/it][A[2024-05-29 02:29:00,951] [INFO] [logging.py:96:log_dist] [Rank 0] step=157, skipped=0, lr=[1.9690120712483303e-05], mom=[(0.9, 0.999)]
steps: 157 loss: 0.9874 iter time (s): 130.923 samples/sec: 0.978

 70%|███████   | 7/10 [15:23<06:35, 131.92s/it][A
 70%|███████   | 7/10 [15:23<06:35, 131.99s/it][A
 70%|███████   | 7/10 [15:23<06:35, 131.94s/it][A
 70%|███████   | 7/10 [15:23<06:35, 131.95s/it][A
 70%|███████   | 7/10 [15:23<06:35, 131.97s/it][A
 70%|███████   | 7/10 [15:23<06:35, 131.95s/it][A
 70%|███████   | 7/10 [15:23<06:35, 131.95s/it][A
 80%|████████  | 8/10 [17:36<04:24, 132.14s/it][A[2024-05-29 02:31:13,539] [INFO] [logging.py:96:log_dist] [Rank 0] step=158, skipped=0, lr=[1.9712334546302004e-05], mom=[(0.9, 0.999)]
steps: 158 loss: 0.8872 iter time (s): 131.557 samples/sec: 0.973

 80%|████████  | 8/10 [17:35<04:24, 132.11s/it][A
 80%|████████  | 8/10 [17:35<04:24, 132.14s/it][A
 80%|████████  | 8/10 [17:36<04:24, 132.16s/it][A
 80%|████████  | 8/10 [17:36<04:24, 132.15s/it][A
 80%|████████  | 8/10 [17:36<04:24, 132.13s/it][A
 80%|████████  | 8/10 [17:36<04:24, 132.15s/it][A
 80%|████████  | 8/10 [17:36<04:24, 132.14s/it][A
 90%|█████████ | 9/10 [19:48<02:12, 132.10s/it][A[2024-05-29 02:33:25,567] [INFO] [logging.py:96:log_dist] [Rank 0] step=159, skipped=0, lr=[1.973440822881686e-05], mom=[(0.9, 0.999)]
steps: 159 loss: 0.9219 iter time (s): 131.072 samples/sec: 0.977

 90%|█████████ | 9/10 [19:47<02:12, 132.08s/it][A
 90%|█████████ | 9/10 [19:47<02:12, 132.06s/it][A
 90%|█████████ | 9/10 [19:47<02:12, 132.06s/it][A
 90%|█████████ | 9/10 [19:47<02:12, 132.06s/it][A
 90%|█████████ | 9/10 [19:47<02:12, 132.06s/it][A
 90%|█████████ | 9/10 [19:47<02:12, 132.05s/it][A
 90%|█████████ | 9/10 [19:47<02:12, 132.07s/it][A
100%|██████████| 10/10 [22:00<00:00, 132.06s/it][A100%|██████████| 10/10 [22:00<00:00, 132.05s/it]
  3%|▎         | 16/520 [1:57:53<112:12:24, 801.48s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 02:35:37,555] [INFO] [logging.py:96:log_dist] [Rank 0] step=160, skipped=0, lr=[1.9756343517428372e-05], mom=[(0.9, 0.999)]
steps: 160 loss: 0.8791 iter time (s): 131.195 samples/sec: 0.976

100%|██████████| 10/10 [21:59<00:00, 132.07s/it][A100%|██████████| 10/10 [21:59<00:00, 131.99s/it]
  3%|▎         | 16/520 [1:57:27<112:05:02, 800.60s/it]
100%|██████████| 10/10 [21:59<00:00, 132.04s/it][A100%|██████████| 10/10 [21:59<00:00, 131.98s/it]
  3%|▎         | 16/520 [1:58:02<112:15:28, 801.84s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:59<00:00, 132.06s/it][A100%|██████████| 10/10 [21:59<00:00, 131.99s/it]
  3%|▎         | 16/520 [1:57:35<112:07:29, 800.89s/it]
100%|██████████| 10/10 [22:00<00:00, 132.04s/it][A100%|██████████| 10/10 [22:00<00:00, 132.00s/it]
  3%|▎         | 16/520 [1:57:19<112:02:31, 800.30s/it]
100%|██████████| 10/10 [22:00<00:00, 132.06s/it][A100%|██████████| 10/10 [22:00<00:00, 132.00s/it]
  3%|▎         | 16/520 [1:58:03<112:16:08, 801.92s/it]
100%|██████████| 10/10 [21:59<00:00, 132.05s/it][A100%|██████████| 10/10 [21:59<00:00, 132.00s/it]
  3%|▎         | 16/520 [1:57:43<112:09:56, 801.18s/it]
100%|██████████| 10/10 [21:59<00:00, 132.05s/it][A100%|██████████| 10/10 [21:59<00:00, 131.99s/it]
  3%|▎         | 16/520 [1:57:50<112:12:01, 801.43s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_156

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:17<20:38, 137.63s/it][A[2024-05-29 02:37:55,809] [INFO] [logging.py:96:log_dist] [Rank 0] step=161, skipped=0, lr=[1.9778142136688e-05], mom=[(0.9, 0.999)]
steps: 161 loss: 0.6682 iter time (s): 136.926 samples/sec: 0.935

 10%|█         | 1/10 [02:17<20:39, 137.73s/it][A
 10%|█         | 1/10 [02:17<20:41, 137.91s/it][A
 10%|█         | 1/10 [02:17<20:38, 137.65s/it][A
 10%|█         | 1/10 [02:17<20:39, 137.67s/it][A
 10%|█         | 1/10 [02:17<20:38, 137.66s/it][A
 10%|█         | 1/10 [02:17<20:39, 137.69s/it][A
 10%|█         | 1/10 [02:17<20:39, 137.70s/it][A
 20%|██        | 2/10 [04:33<18:14, 136.83s/it][A[2024-05-29 02:40:12,089] [INFO] [logging.py:96:log_dist] [Rank 0] step=162, skipped=0, lr=[1.9799805779111784e-05], mom=[(0.9, 0.999)]
steps: 162 loss: 0.6548 iter time (s): 135.474 samples/sec: 0.945

 20%|██        | 2/10 [04:33<18:14, 136.85s/it][A
 20%|██        | 2/10 [04:34<18:14, 136.87s/it][A
 20%|██        | 2/10 [04:33<18:14, 136.78s/it][A
 20%|██        | 2/10 [04:33<18:14, 136.80s/it][A
 20%|██        | 2/10 [04:33<18:14, 136.79s/it][A
 20%|██        | 2/10 [04:33<18:14, 136.82s/it][A
 20%|██        | 2/10 [04:33<18:14, 136.81s/it][A
 30%|███       | 3/10 [06:50<15:58, 136.86s/it][A[2024-05-29 02:42:28,983] [INFO] [logging.py:96:log_dist] [Rank 0] step=163, skipped=0, lr=[1.9821336105968915e-05], mom=[(0.9, 0.999)]
steps: 163 loss: 0.6414 iter time (s): 136.244 samples/sec: 0.939

 30%|███       | 3/10 [06:50<15:58, 136.92s/it][A
 30%|███       | 3/10 [06:51<15:58, 136.96s/it][A
 30%|███       | 3/10 [06:50<15:58, 136.89s/it][A
 30%|███       | 3/10 [06:50<15:58, 136.92s/it][A
 30%|███       | 3/10 [06:50<15:58, 136.90s/it][A
 30%|███       | 3/10 [06:50<15:58, 136.90s/it][A
 30%|███       | 3/10 [06:50<15:58, 136.91s/it][A
 40%|████      | 4/10 [09:07<13:40, 136.76s/it][A[2024-05-29 02:44:45,572] [INFO] [logging.py:96:log_dist] [Rank 0] step=164, skipped=0, lr=[1.98427347480462e-05], mom=[(0.9, 0.999)]
steps: 164 loss: 0.6687 iter time (s): 135.789 samples/sec: 0.943

 40%|████      | 4/10 [09:07<13:40, 136.77s/it][A
 40%|████      | 4/10 [09:07<13:40, 136.79s/it][A
 40%|████      | 4/10 [09:07<13:40, 136.75s/it][A
 40%|████      | 4/10 [09:07<13:40, 136.74s/it][A
 40%|████      | 4/10 [09:07<13:40, 136.74s/it][A
 40%|████      | 4/10 [09:07<13:40, 136.74s/it][A
 40%|████      | 4/10 [09:07<13:40, 136.75s/it][A
 50%|█████     | 5/10 [11:24<11:24, 136.84s/it][A[2024-05-29 02:47:02,578] [INFO] [logging.py:96:log_dist] [Rank 0] step=165, skipped=0, lr=[1.9864003306389262e-05], mom=[(0.9, 0.999)]
steps: 165 loss: 0.6496 iter time (s): 136.348 samples/sec: 0.939

 50%|█████     | 5/10 [11:24<11:24, 136.89s/it][A
 50%|█████     | 5/10 [11:24<11:24, 136.89s/it][A
 50%|█████     | 5/10 [11:24<11:24, 136.86s/it][A
 50%|█████     | 5/10 [11:24<11:24, 136.85s/it][A
 50%|█████     | 5/10 [11:24<11:24, 136.87s/it][A
 50%|█████     | 5/10 [11:24<11:24, 136.87s/it][A
 50%|█████     | 5/10 [11:24<11:24, 136.87s/it][A
 60%|██████    | 6/10 [13:42<09:08, 137.18s/it][A[2024-05-29 02:49:20,422] [INFO] [logging.py:96:log_dist] [Rank 0] step=166, skipped=0, lr=[1.9885143353021433e-05], mom=[(0.9, 0.999)]
steps: 166 loss: 0.6450 iter time (s): 137.063 samples/sec: 0.934

 60%|██████    | 6/10 [13:42<09:08, 137.15s/it][A
 60%|██████    | 6/10 [13:42<09:08, 137.20s/it][A
 60%|██████    | 6/10 [13:42<09:08, 137.18s/it][A
 60%|██████    | 6/10 [13:42<09:08, 137.17s/it][A
 60%|██████    | 6/10 [13:42<09:08, 137.17s/it][A
 60%|██████    | 6/10 [13:42<09:08, 137.17s/it][A
 60%|██████    | 6/10 [13:42<09:08, 137.17s/it][A
 70%|███████   | 7/10 [16:08<06:59, 139.99s/it][A[2024-05-29 02:51:46,195] [INFO] [logging.py:96:log_dist] [Rank 0] step=167, skipped=0, lr=[1.990615643164092e-05], mom=[(0.9, 0.999)]
steps: 167 loss: 0.6455 iter time (s): 145.108 samples/sec: 0.882

 70%|███████   | 7/10 [16:08<06:59, 140.00s/it][A
 70%|███████   | 7/10 [16:08<06:59, 140.00s/it][A
 70%|███████   | 7/10 [16:08<06:59, 139.98s/it][A
 70%|███████   | 7/10 [16:08<07:00, 140.00s/it][A
 70%|███████   | 7/10 [16:08<06:59, 139.99s/it][A
 70%|███████   | 7/10 [16:08<06:59, 140.00s/it][A
 70%|███████   | 7/10 [16:08<06:59, 140.00s/it][A
 80%|████████  | 8/10 [18:29<04:40, 140.47s/it][A[2024-05-29 02:54:07,681] [INFO] [logging.py:96:log_dist] [Rank 0] step=168, skipped=0, lr=[1.9927044058297284e-05], mom=[(0.9, 0.999)]
steps: 168 loss: 0.6216 iter time (s): 140.782 samples/sec: 0.909

 80%|████████  | 8/10 [18:29<04:40, 140.48s/it][A
 80%|████████  | 8/10 [18:29<04:40, 140.48s/it][A
 80%|████████  | 8/10 [18:29<04:40, 140.47s/it][A
 80%|████████  | 8/10 [18:29<04:40, 140.49s/it][A
 80%|████████  | 8/10 [18:29<04:40, 140.47s/it][A
 80%|████████  | 8/10 [18:29<04:40, 140.47s/it][A
 80%|████████  | 8/10 [18:29<04:40, 140.48s/it][A
 90%|█████████ | 9/10 [20:47<02:19, 139.74s/it][A[2024-05-29 02:56:25,816] [INFO] [logging.py:96:log_dist] [Rank 0] step=169, skipped=0, lr=[1.9947807722047796e-05], mom=[(0.9, 0.999)]
steps: 169 loss: 0.6318 iter time (s): 137.462 samples/sec: 0.931

 90%|█████████ | 9/10 [20:47<02:19, 139.73s/it][A
 90%|█████████ | 9/10 [20:47<02:19, 139.73s/it][A
 90%|█████████ | 9/10 [20:47<02:19, 139.74s/it][A
 90%|█████████ | 9/10 [20:47<02:19, 139.74s/it][A
 90%|█████████ | 9/10 [20:47<02:19, 139.76s/it][A
 90%|█████████ | 9/10 [20:47<02:19, 139.75s/it][A
 90%|█████████ | 9/10 [20:47<02:19, 139.75s/it][A
100%|██████████| 10/10 [23:04<00:00, 138.99s/it][A100%|██████████| 10/10 [23:04<00:00, 138.49s/it]
  3%|▎         | 17/520 [2:20:58<131:14:30, 939.31s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 02:58:43,131] [INFO] [logging.py:96:log_dist] [Rank 0] step=170, skipped=0, lr=[1.9968448885594408e-05], mom=[(0.9, 0.999)]
steps: 170 loss: 0.6153 iter time (s): 136.548 samples/sec: 0.937

100%|██████████| 10/10 [23:05<00:00, 138.98s/it][A100%|██████████| 10/10 [23:05<00:00, 138.50s/it]
  3%|▎         | 17/520 [2:20:32<131:08:42, 938.61s/it]
100%|██████████| 10/10 [23:05<00:00, 138.98s/it][A100%|██████████| 10/10 [23:05<00:00, 138.51s/it]
  3%|▎         | 17/520 [2:21:07<131:16:47, 939.58s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [23:04<00:00, 138.96s/it][A100%|██████████| 10/10 [23:04<00:00, 138.49s/it]
  3%|▎         | 17/520 [2:20:40<131:10:25, 938.82s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [23:04<00:00, 138.95s/it][A100%|██████████| 10/10 [23:04<00:00, 138.49s/it]
  3%|▎         | 17/520 [2:20:24<131:06:43, 938.38s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [23:04<00:00, 138.98s/it][A100%|██████████| 10/10 [23:04<00:00, 138.49s/it]
  3%|▎         | 17/520 [2:21:08<131:17:08, 939.62s/it]
100%|██████████| 10/10 [23:04<00:00, 138.96s/it][A100%|██████████| 10/10 [23:04<00:00, 138.49s/it]
  3%|▎         | 17/520 [2:20:48<131:12:22, 939.05s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [23:04<00:00, 138.97s/it][A100%|██████████| 10/10 [23:04<00:00, 138.50s/it]
  3%|▎         | 17/520 [2:20:55<131:14:02, 939.25s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_387
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:58<17:49, 118.84s/it][A[2024-05-29 03:00:41,960] [INFO] [logging.py:96:log_dist] [Rank 0] step=171, skipped=0, lr=[1.9988968985902092e-05], mom=[(0.9, 0.999)]
steps: 171 loss: 0.7708 iter time (s): 117.899 samples/sec: 1.086

 10%|█         | 1/10 [01:58<17:48, 118.68s/it][A
 10%|█         | 1/10 [01:58<17:48, 118.75s/it][A
 10%|█         | 1/10 [01:58<17:49, 118.87s/it][A
 10%|█         | 1/10 [01:58<17:50, 118.91s/it][A
 10%|█         | 1/10 [01:58<17:49, 118.87s/it][A
 10%|█         | 1/10 [01:58<17:50, 118.90s/it][A
 10%|█         | 1/10 [01:58<17:49, 118.80s/it][A
 20%|██        | 2/10 [03:56<15:45, 118.13s/it][A[2024-05-29 03:02:39,594] [INFO] [logging.py:96:log_dist] [Rank 0] step=172, skipped=0, lr=[2.000936943479912e-05], mom=[(0.9, 0.999)]
steps: 172 loss: 0.7565 iter time (s): 116.851 samples/sec: 1.095

 20%|██        | 2/10 [03:56<15:44, 118.09s/it][A
 20%|██        | 2/10 [03:56<15:45, 118.15s/it][A
 20%|██        | 2/10 [03:56<15:45, 118.19s/it][A
 20%|██        | 2/10 [03:56<15:45, 118.24s/it][A
 20%|██        | 2/10 [03:56<15:45, 118.20s/it][A
 20%|██        | 2/10 [03:56<15:45, 118.22s/it][A
 20%|██        | 2/10 [03:56<15:45, 118.18s/it][A
 30%|███       | 3/10 [05:54<13:45, 117.95s/it][A[2024-05-29 03:04:37,307] [INFO] [logging.py:96:log_dist] [Rank 0] step=173, skipped=0, lr=[1.9999996580991077e-05], mom=[(0.9, 0.999)]
steps: 173 loss: 0.7642 iter time (s): 116.874 samples/sec: 1.095

 30%|███       | 3/10 [05:54<13:45, 117.93s/it][A
 30%|███       | 3/10 [05:54<13:45, 117.93s/it][A
 30%|███       | 3/10 [05:54<13:45, 117.97s/it][A
 30%|███       | 3/10 [05:54<13:45, 117.96s/it][A
 30%|███       | 3/10 [05:54<13:45, 117.97s/it][A
 30%|███       | 3/10 [05:54<13:45, 117.97s/it][A
 30%|███       | 3/10 [05:54<13:45, 117.96s/it][A
 40%|████      | 4/10 [07:51<11:46, 117.78s/it][A[2024-05-29 03:06:34,837] [INFO] [logging.py:96:log_dist] [Rank 0] step=174, skipped=0, lr=[1.9999990293454576e-05], mom=[(0.9, 0.999)]
steps: 174 loss: 0.7699 iter time (s): 116.698 samples/sec: 1.097

 40%|████      | 4/10 [07:51<11:46, 117.75s/it][A
 40%|████      | 4/10 [07:51<11:46, 117.81s/it][A
 40%|████      | 4/10 [07:51<11:46, 117.78s/it][A
 40%|████      | 4/10 [07:51<11:46, 117.82s/it][A
 40%|████      | 4/10 [07:51<11:46, 117.81s/it][A
 40%|████      | 4/10 [07:52<11:47, 117.87s/it][A
 40%|████      | 4/10 [07:51<11:47, 117.86s/it][A
 50%|█████     | 5/10 [09:49<09:49, 117.93s/it][A[2024-05-29 03:08:33,038] [INFO] [logging.py:96:log_dist] [Rank 0] step=175, skipped=0, lr=[1.999998079799378e-05], mom=[(0.9, 0.999)]
steps: 175 loss: 0.7689 iter time (s): 117.203 samples/sec: 1.092

 50%|█████     | 5/10 [09:49<09:49, 117.93s/it][A
 50%|█████     | 5/10 [09:49<09:49, 117.92s/it][A
 50%|█████     | 5/10 [09:50<09:49, 117.94s/it][A
 50%|█████     | 5/10 [09:50<09:49, 117.96s/it][A
 50%|█████     | 5/10 [09:50<09:49, 117.94s/it][A
 50%|█████     | 5/10 [09:50<09:49, 117.93s/it][A
 50%|█████     | 5/10 [09:49<09:49, 117.92s/it][A
 60%|██████    | 6/10 [11:48<07:52, 118.02s/it][A[2024-05-29 03:10:31,232] [INFO] [logging.py:96:log_dist] [Rank 0] step=176, skipped=0, lr=[1.9999968094611738e-05], mom=[(0.9, 0.999)]
steps: 176 loss: 0.7610 iter time (s): 117.340 samples/sec: 1.091

 60%|██████    | 6/10 [11:47<07:51, 117.98s/it][A
 60%|██████    | 6/10 [11:48<07:51, 118.00s/it][A
 60%|██████    | 6/10 [11:48<07:51, 117.97s/it][A
 60%|██████    | 6/10 [11:48<07:52, 118.01s/it][A
 60%|██████    | 6/10 [11:48<07:51, 117.99s/it][A
 60%|██████    | 6/10 [11:48<07:51, 117.99s/it][A
 60%|██████    | 6/10 [11:48<07:51, 117.98s/it][A
 70%|███████   | 7/10 [13:45<05:53, 117.92s/it][A[2024-05-29 03:12:28,961] [INFO] [logging.py:96:log_dist] [Rank 0] step=177, skipped=0, lr=[1.9999952183312533e-05], mom=[(0.9, 0.999)]
steps: 177 loss: 0.7661 iter time (s): 116.981 samples/sec: 1.094

 70%|███████   | 7/10 [13:45<05:53, 117.94s/it][A
 70%|███████   | 7/10 [13:45<05:53, 117.93s/it][A
 70%|███████   | 7/10 [13:45<05:53, 117.95s/it][A
 70%|███████   | 7/10 [13:46<05:53, 117.95s/it][A
 70%|███████   | 7/10 [13:45<05:53, 117.95s/it][A
 70%|███████   | 7/10 [13:45<05:53, 117.94s/it][A
 70%|███████   | 7/10 [13:46<05:53, 117.96s/it][A
 80%|████████  | 8/10 [15:44<03:56, 118.05s/it][A[2024-05-29 03:14:27,295] [INFO] [logging.py:96:log_dist] [Rank 0] step=178, skipped=0, lr=[1.9999933064101263e-05], mom=[(0.9, 0.999)]
steps: 178 loss: 0.7416 iter time (s): 117.491 samples/sec: 1.089

 80%|████████  | 8/10 [15:44<03:56, 118.06s/it][A
 80%|████████  | 8/10 [15:44<03:56, 118.06s/it][A
 80%|████████  | 8/10 [15:44<03:56, 118.03s/it][A
 80%|████████  | 8/10 [15:44<03:56, 118.03s/it][A
 80%|████████  | 8/10 [15:44<03:56, 118.05s/it][A
 80%|████████  | 8/10 [15:44<03:56, 118.04s/it][A
 80%|████████  | 8/10 [15:44<03:56, 118.05s/it][A
 90%|█████████ | 9/10 [17:41<01:57, 117.96s/it][A[2024-05-29 03:16:25,061] [INFO] [logging.py:96:log_dist] [Rank 0] step=179, skipped=0, lr=[1.9999910736984064e-05], mom=[(0.9, 0.999)]
steps: 179 loss: 0.7558 iter time (s): 116.972 samples/sec: 1.094

 90%|█████████ | 9/10 [17:41<01:57, 117.95s/it][A
 90%|█████████ | 9/10 [17:41<01:57, 117.95s/it][A
 90%|█████████ | 9/10 [17:41<01:57, 117.95s/it][A
 90%|█████████ | 9/10 [17:41<01:57, 117.95s/it][A
 90%|█████████ | 9/10 [17:41<01:57, 117.95s/it][A
 90%|█████████ | 9/10 [17:42<01:57, 117.94s/it][A
 90%|█████████ | 9/10 [17:41<01:57, 117.94s/it][A
100%|██████████| 10/10 [19:39<00:00, 117.81s/it][A100%|██████████| 10/10 [19:39<00:00, 117.94s/it]
  3%|▎         | 18/520 [2:40:38<139:26:37, 1000.00s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 03:18:22,507] [INFO] [logging.py:96:log_dist] [Rank 0] step=180, skipped=0, lr=[1.9999885201968098e-05], mom=[(0.9, 0.999)]
steps: 180 loss: 0.7516 iter time (s): 116.637 samples/sec: 1.097

100%|██████████| 10/10 [19:39<00:00, 117.78s/it][A100%|██████████| 10/10 [19:39<00:00, 117.92s/it]
  3%|▎         | 18/520 [2:40:12<139:21:02, 999.33s/it]
100%|██████████| 10/10 [19:39<00:00, 117.76s/it][A100%|██████████| 10/10 [19:39<00:00, 117.92s/it]
  3%|▎         | 18/520 [2:40:46<139:27:02, 1000.05s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [19:39<00:00, 117.81s/it][A100%|██████████| 10/10 [19:39<00:00, 117.95s/it]
  3%|▎         | 18/520 [2:40:20<139:22:41, 999.53s/it]
100%|██████████| 10/10 [19:39<00:00, 117.79s/it][A100%|██████████| 10/10 [19:39<00:00, 117.94s/it]
  3%|▎         | 18/520 [2:40:03<139:19:52, 999.19s/it]
100%|██████████| 10/10 [19:39<00:00, 117.79s/it][A100%|██████████| 10/10 [19:39<00:00, 117.94s/it]
  3%|▎         | 18/520 [2:40:48<139:27:32, 1000.10s/it]
100%|██████████| 10/10 [19:39<00:00, 117.78s/it][A100%|██████████| 10/10 [19:39<00:00, 117.94s/it]
  3%|▎         | 18/520 [2:40:28<139:24:02, 999.69s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [19:39<00:00, 117.78s/it][A100%|██████████| 10/10 [19:39<00:00, 117.94s/it]
  3%|▎         | 18/520 [2:40:35<139:25:13, 999.83s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_188

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:01<09:09, 61.11s/it][A[2024-05-29 03:19:22,123] [INFO] [logging.py:96:log_dist] [Rank 0] step=181, skipped=0, lr=[1.999985645906156e-05], mom=[(0.9, 0.999)]
steps: 181 loss: 0.6086 iter time (s): 58.586 samples/sec: 2.185

 10%|█         | 1/10 [00:59<08:55, 59.45s/it][A
 10%|█         | 1/10 [00:59<08:55, 59.53s/it][A
 10%|█         | 1/10 [00:59<08:53, 59.25s/it][A
 10%|█         | 1/10 [00:59<08:54, 59.34s/it][A
 10%|█         | 1/10 [00:59<08:52, 59.22s/it][A
 10%|█         | 1/10 [00:59<08:53, 59.27s/it][A
 10%|█         | 1/10 [00:59<08:53, 59.29s/it][A
 20%|██        | 2/10 [01:56<07:43, 57.89s/it][A[2024-05-29 03:20:17,761] [INFO] [logging.py:96:log_dist] [Rank 0] step=182, skipped=0, lr=[1.9999824508273667e-05], mom=[(0.9, 0.999)]
steps: 182 loss: 0.5788 iter time (s): 55.072 samples/sec: 2.324

 20%|██        | 2/10 [01:55<07:37, 57.20s/it][A
 20%|██        | 2/10 [01:55<07:38, 57.27s/it][A
 20%|██        | 2/10 [01:54<07:36, 57.12s/it][A
 20%|██        | 2/10 [01:54<07:37, 57.16s/it][A
 20%|██        | 2/10 [01:54<07:37, 57.13s/it][A
 20%|██        | 2/10 [01:54<07:37, 57.13s/it][A
 20%|██        | 2/10 [01:54<07:37, 57.14s/it][A
 30%|███       | 3/10 [02:52<06:38, 56.97s/it][A[2024-05-29 03:21:13,581] [INFO] [logging.py:96:log_dist] [Rank 0] step=183, skipped=0, lr=[1.999978934961467e-05], mom=[(0.9, 0.999)]
steps: 183 loss: 0.6076 iter time (s): 55.261 samples/sec: 2.316

 30%|███       | 3/10 [02:50<06:35, 56.57s/it][A
 30%|███       | 3/10 [02:50<06:35, 56.57s/it][A
 30%|███       | 3/10 [02:50<06:35, 56.52s/it][A
 30%|███       | 3/10 [02:50<06:35, 56.54s/it][A
 30%|███       | 3/10 [02:50<06:35, 56.53s/it][A
 30%|███       | 3/10 [02:50<06:35, 56.52s/it][A
 30%|███       | 3/10 [02:50<06:35, 56.53s/it][A
 40%|████      | 4/10 [03:51<05:46, 57.80s/it][A[2024-05-29 03:22:12,721] [INFO] [logging.py:96:log_dist] [Rank 0] step=184, skipped=0, lr=[1.9999750983095852e-05], mom=[(0.9, 0.999)]
steps: 184 loss: 0.5289 iter time (s): 58.596 samples/sec: 2.184

 40%|████      | 4/10 [03:50<05:45, 57.62s/it][A
 40%|████      | 4/10 [03:50<05:45, 57.65s/it][A
 40%|████      | 4/10 [03:49<05:45, 57.61s/it][A
 40%|████      | 4/10 [03:50<05:45, 57.64s/it][A
 40%|████      | 4/10 [03:49<05:45, 57.62s/it][A
 40%|████      | 4/10 [03:50<05:45, 57.62s/it][A
 40%|████      | 4/10 [03:50<05:45, 57.63s/it][A
 50%|█████     | 5/10 [04:48<04:47, 57.47s/it][A[2024-05-29 03:23:09,604] [INFO] [logging.py:96:log_dist] [Rank 0] step=185, skipped=0, lr=[1.9999709408729524e-05], mom=[(0.9, 0.999)]
steps: 185 loss: 0.5510 iter time (s): 56.171 samples/sec: 2.279

 50%|█████     | 5/10 [04:46<04:46, 57.33s/it][A
 50%|█████     | 5/10 [04:46<04:46, 57.32s/it][A
 50%|█████     | 5/10 [04:46<04:46, 57.31s/it][A
 50%|█████     | 5/10 [04:46<04:46, 57.32s/it][A
 50%|█████     | 5/10 [04:46<04:46, 57.30s/it][A
 50%|█████     | 5/10 [04:46<04:46, 57.30s/it][A
 50%|█████     | 5/10 [04:46<04:46, 57.30s/it][A
 60%|██████    | 6/10 [05:44<03:48, 57.02s/it][A[2024-05-29 03:24:05,743] [INFO] [logging.py:96:log_dist] [Rank 0] step=186, skipped=0, lr=[1.999966462652902e-05], mom=[(0.9, 0.999)]
steps: 186 loss: 0.5388 iter time (s): 55.646 samples/sec: 2.300

 60%|██████    | 6/10 [05:43<03:47, 56.96s/it][A
 60%|██████    | 6/10 [05:43<03:48, 57.03s/it][A
 60%|██████    | 6/10 [05:43<03:47, 57.00s/it][A
 60%|██████    | 6/10 [05:43<03:47, 56.98s/it][A
 60%|██████    | 6/10 [05:43<03:47, 56.99s/it][A
 60%|██████    | 6/10 [05:43<03:48, 57.06s/it][A
 60%|██████    | 6/10 [05:43<03:48, 57.06s/it][A
 70%|███████   | 7/10 [06:41<02:51, 57.09s/it][A[2024-05-29 03:25:02,967] [INFO] [logging.py:96:log_dist] [Rank 0] step=187, skipped=0, lr=[1.9999616636508703e-05], mom=[(0.9, 0.999)]
steps: 187 loss: 0.5043 iter time (s): 56.195 samples/sec: 2.278

 70%|███████   | 7/10 [06:40<02:51, 57.02s/it][A
 70%|███████   | 7/10 [06:40<02:50, 56.98s/it][A
 70%|███████   | 7/10 [06:40<02:50, 56.98s/it][A
 70%|███████   | 7/10 [06:40<02:50, 56.98s/it][A
 70%|███████   | 7/10 [06:40<02:50, 56.96s/it][A
 70%|███████   | 7/10 [06:40<02:50, 56.98s/it][A
 70%|███████   | 7/10 [06:40<02:50, 56.96s/it][A
 80%|████████  | 8/10 [07:38<01:53, 56.85s/it][A[2024-05-29 03:25:59,302] [INFO] [logging.py:96:log_dist] [Rank 0] step=188, skipped=0, lr=[1.999956543868398e-05], mom=[(0.9, 0.999)]
steps: 188 loss: 0.5318 iter time (s): 55.785 samples/sec: 2.295

 80%|████████  | 8/10 [07:36<01:53, 56.78s/it][A
 80%|████████  | 8/10 [07:36<01:53, 56.78s/it][A
 80%|████████  | 8/10 [07:36<01:53, 56.78s/it][A
 80%|████████  | 8/10 [07:36<01:53, 56.78s/it][A
 80%|████████  | 8/10 [07:36<01:53, 56.77s/it][A
 80%|████████  | 8/10 [07:36<01:53, 56.78s/it][A
 80%|████████  | 8/10 [07:36<01:53, 56.77s/it][A
 90%|█████████ | 9/10 [08:33<00:56, 56.32s/it][A[2024-05-29 03:26:54,458] [INFO] [logging.py:96:log_dist] [Rank 0] step=189, skipped=0, lr=[1.9999511033071267e-05], mom=[(0.9, 0.999)]
steps: 189 loss: 0.5211 iter time (s): 54.619 samples/sec: 2.344

 90%|█████████ | 9/10 [08:31<00:56, 56.29s/it][A
 90%|█████████ | 9/10 [08:31<00:56, 56.28s/it][A
 90%|█████████ | 9/10 [08:31<00:56, 56.28s/it][A
 90%|█████████ | 9/10 [08:31<00:56, 56.26s/it][A
 90%|█████████ | 9/10 [08:31<00:56, 56.29s/it][A
 90%|█████████ | 9/10 [08:31<00:56, 56.28s/it][A
 90%|█████████ | 9/10 [08:31<00:56, 56.27s/it][A
100%|██████████| 10/10 [09:29<00:00, 56.38s/it][A100%|██████████| 10/10 [09:29<00:00, 57.00s/it]
  4%|▎         | 19/520 [2:50:08<123:19:13, 886.14s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 03:27:50,982] [INFO] [logging.py:96:log_dist] [Rank 0] step=190, skipped=0, lr=[1.9999453419688026e-05], mom=[(0.9, 0.999)]
steps: 190 loss: 0.4860 iter time (s): 55.924 samples/sec: 2.289

100%|██████████| 10/10 [09:28<00:00, 56.36s/it][A100%|██████████| 10/10 [09:28<00:00, 56.83s/it]
  4%|▎         | 19/520 [2:49:40<123:11:28, 885.21s/it]
100%|██████████| 10/10 [09:28<00:00, 56.36s/it][A100%|██████████| 10/10 [09:28<00:00, 56.84s/it]
  4%|▎         | 19/520 [2:50:15<123:15:52, 885.73s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:28<00:00, 56.36s/it][A100%|██████████| 10/10 [09:28<00:00, 56.81s/it]
  4%|▎         | 19/520 [2:49:48<123:12:14, 885.30s/it]
100%|██████████| 10/10 [09:28<00:00, 56.34s/it][A100%|██████████| 10/10 [09:28<00:00, 56.82s/it]
  4%|▎         | 19/520 [2:49:32<123:10:10, 885.05s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:28<00:00, 56.35s/it][A100%|██████████| 10/10 [09:28<00:00, 56.81s/it]
  4%|▎         | 19/520 [2:50:16<123:15:52, 885.73s/it] 
100%|██████████| 10/10 [09:28<00:00, 56.35s/it][A100%|██████████| 10/10 [09:28<00:00, 56.81s/it]
  4%|▎         | 19/520 [2:49:56<123:13:15, 885.42s/it]
100%|██████████| 10/10 [09:28<00:00, 56.34s/it][A100%|██████████| 10/10 [09:28<00:00, 56.81s/it]
  4%|▎         | 19/520 [2:50:03<123:14:06, 885.52s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_254

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:24<12:37, 84.17s/it][A[2024-05-29 03:29:16,120] [INFO] [logging.py:96:log_dist] [Rank 0] step=191, skipped=0, lr=[1.9999392598552734e-05], mom=[(0.9, 0.999)]
steps: 191 loss: 0.5988 iter time (s): 84.484 samples/sec: 1.515

 10%|█         | 1/10 [01:25<12:46, 85.15s/it][A
 10%|█         | 1/10 [01:25<12:45, 85.11s/it][A
 10%|█         | 1/10 [01:25<12:47, 85.30s/it][A
 10%|█         | 1/10 [01:25<12:47, 85.30s/it][A
 10%|█         | 1/10 [01:25<12:47, 85.32s/it][A
 10%|█         | 1/10 [01:25<12:48, 85.37s/it][A
 10%|█         | 1/10 [01:25<12:48, 85.38s/it][A
 20%|██        | 2/10 [02:53<11:35, 86.92s/it][A[2024-05-29 03:30:44,970] [INFO] [logging.py:96:log_dist] [Rank 0] step=192, skipped=0, lr=[1.9999328569684907e-05], mom=[(0.9, 0.999)]
steps: 192 loss: 0.6177 iter time (s): 88.057 samples/sec: 1.454

 20%|██        | 2/10 [02:54<11:38, 87.34s/it][A
 20%|██        | 2/10 [02:54<11:39, 87.39s/it][A
 20%|██        | 2/10 [02:54<11:38, 87.35s/it][A
 20%|██        | 2/10 [02:54<11:39, 87.43s/it][A
 20%|██        | 2/10 [02:54<11:39, 87.40s/it][A
 20%|██        | 2/10 [02:54<11:39, 87.43s/it][A
 20%|██        | 2/10 [02:54<11:39, 87.44s/it][A
 30%|███       | 3/10 [04:18<10:03, 86.27s/it][A[2024-05-29 03:32:10,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=193, skipped=0, lr=[1.9999261333105092e-05], mom=[(0.9, 0.999)]
steps: 193 loss: 0.5853 iter time (s): 84.650 samples/sec: 1.512

 30%|███       | 3/10 [04:19<10:05, 86.47s/it][A
 30%|███       | 3/10 [04:19<10:05, 86.46s/it][A
 30%|███       | 3/10 [04:19<10:05, 86.49s/it][A
 30%|███       | 3/10 [04:19<10:05, 86.51s/it][A
 30%|███       | 3/10 [04:19<10:05, 86.51s/it][A
 30%|███       | 3/10 [04:19<10:05, 86.53s/it][A
 30%|███       | 3/10 [04:19<10:05, 86.54s/it][A
 40%|████      | 4/10 [05:45<08:38, 86.39s/it][A[2024-05-29 03:33:37,037] [INFO] [logging.py:96:log_dist] [Rank 0] step=194, skipped=0, lr=[1.9999190888834852e-05], mom=[(0.9, 0.999)]
steps: 194 loss: 0.5601 iter time (s): 85.741 samples/sec: 1.493

 40%|████      | 4/10 [05:46<08:39, 86.51s/it][A
 40%|████      | 4/10 [05:45<08:38, 86.50s/it][A
 40%|████      | 4/10 [05:46<08:39, 86.53s/it][A
 40%|████      | 4/10 [05:46<08:39, 86.53s/it][A
 40%|████      | 4/10 [05:46<08:39, 86.54s/it][A
 40%|████      | 4/10 [05:46<08:39, 86.53s/it][A
 40%|████      | 4/10 [05:46<08:39, 86.54s/it][A
 50%|█████     | 5/10 [07:11<07:11, 86.31s/it][A[2024-05-29 03:35:03,186] [INFO] [logging.py:96:log_dist] [Rank 0] step=195, skipped=0, lr=[1.999911723689679e-05], mom=[(0.9, 0.999)]
steps: 195 loss: 0.5517 iter time (s): 85.332 samples/sec: 1.500

 50%|█████     | 5/10 [07:12<07:11, 86.35s/it][A
 50%|█████     | 5/10 [07:12<07:12, 86.40s/it][A
 50%|█████     | 5/10 [07:12<07:11, 86.40s/it][A
 50%|█████     | 5/10 [07:12<07:12, 86.42s/it][A
 50%|█████     | 5/10 [07:12<07:12, 86.43s/it][A
 50%|█████     | 5/10 [07:12<07:12, 86.41s/it][A
 50%|█████     | 5/10 [07:12<07:12, 86.42s/it][A
 60%|██████    | 6/10 [08:38<05:46, 86.72s/it][A[2024-05-29 03:36:30,727] [INFO] [logging.py:96:log_dist] [Rank 0] step=196, skipped=0, lr=[1.999904037731454e-05], mom=[(0.9, 0.999)]
steps: 196 loss: 0.5311 iter time (s): 86.755 samples/sec: 1.475

 60%|██████    | 6/10 [08:39<05:47, 86.78s/it][A
 60%|██████    | 6/10 [08:39<05:47, 86.79s/it][A
 60%|██████    | 6/10 [08:39<05:47, 86.78s/it][A
 60%|██████    | 6/10 [08:39<05:47, 86.81s/it][A
 60%|██████    | 6/10 [08:39<05:47, 86.81s/it][A
 60%|██████    | 6/10 [08:40<05:47, 86.83s/it][A
 60%|██████    | 6/10 [08:40<05:47, 86.84s/it][A
 70%|███████   | 7/10 [10:05<04:19, 86.61s/it][A[2024-05-29 03:37:57,058] [INFO] [logging.py:96:log_dist] [Rank 0] step=197, skipped=0, lr=[1.9998960310112755e-05], mom=[(0.9, 0.999)]
steps: 197 loss: 0.5158 iter time (s): 85.373 samples/sec: 1.499

 70%|███████   | 7/10 [10:05<04:19, 86.61s/it][A
 70%|███████   | 7/10 [10:06<04:19, 86.64s/it][A
 70%|███████   | 7/10 [10:06<04:19, 86.63s/it][A
 70%|███████   | 7/10 [10:06<04:19, 86.64s/it][A
 70%|███████   | 7/10 [10:06<04:19, 86.63s/it][A
 70%|███████   | 7/10 [10:06<04:19, 86.65s/it][A
 70%|███████   | 7/10 [10:06<04:19, 86.63s/it][A
 80%|████████  | 8/10 [11:31<02:52, 86.41s/it][A[2024-05-29 03:39:23,081] [INFO] [logging.py:96:log_dist] [Rank 0] step=198, skipped=0, lr=[1.999887703531712e-05], mom=[(0.9, 0.999)]
steps: 198 loss: 0.5255 iter time (s): 85.213 samples/sec: 1.502

 80%|████████  | 8/10 [11:32<02:52, 86.47s/it][A
 80%|████████  | 8/10 [11:32<02:52, 86.43s/it][A
 80%|████████  | 8/10 [11:32<02:52, 86.44s/it][A
 80%|████████  | 8/10 [11:32<02:52, 86.45s/it][A
 80%|████████  | 8/10 [11:32<02:52, 86.44s/it][A
 80%|████████  | 8/10 [11:32<02:52, 86.44s/it][A
 80%|████████  | 8/10 [11:32<02:52, 86.44s/it][A
 90%|█████████ | 9/10 [12:58<01:26, 86.66s/it][A[2024-05-29 03:40:50,302] [INFO] [logging.py:96:log_dist] [Rank 0] step=199, skipped=0, lr=[1.9998790552954358e-05], mom=[(0.9, 0.999)]
steps: 199 loss: 0.5088 iter time (s): 86.390 samples/sec: 1.482

 90%|█████████ | 9/10 [12:59<01:26, 86.68s/it][A
 90%|█████████ | 9/10 [12:59<01:26, 86.69s/it][A
 90%|█████████ | 9/10 [12:59<01:26, 86.68s/it][A
 90%|█████████ | 9/10 [12:59<01:26, 86.67s/it][A
 90%|█████████ | 9/10 [12:59<01:26, 86.68s/it][A
 90%|█████████ | 9/10 [12:59<01:26, 86.67s/it][A
 90%|█████████ | 9/10 [12:59<01:26, 86.67s/it][A
100%|██████████| 10/10 [14:23<00:00, 86.20s/it][A100%|██████████| 10/10 [14:23<00:00, 86.35s/it]
[2024-05-29 03:42:15,484] [INFO] [logging.py:96:log_dist] [Rank 0] step=200, skipped=0, lr=[1.9998700863052213e-05], mom=[(0.9, 0.999)]
steps: 200 loss: 0.5070 iter time (s): 84.389 samples/sec: 1.517

100%|██████████| 10/10 [14:24<00:00, 86.22s/it][A100%|██████████| 10/10 [14:24<00:00, 86.45s/it]

100%|██████████| 10/10 [14:24<00:00, 86.22s/it][A100%|██████████| 10/10 [14:24<00:00, 86.45s/it]

100%|██████████| 10/10 [14:24<00:00, 86.23s/it][A100%|██████████| 10/10 [14:24<00:00, 86.46s/it]

100%|██████████| 10/10 [14:24<00:00, 86.22s/it][A100%|██████████| 10/10 [14:24<00:00, 86.47s/it]

100%|██████████| 10/10 [14:24<00:00, 86.23s/it][A100%|██████████| 10/10 [14:24<00:00, 86.48s/it]

100%|██████████| 10/10 [14:24<00:00, 86.25s/it][A100%|██████████| 10/10 [14:24<00:00, 86.48s/it]

100%|██████████| 10/10 [14:24<00:00, 86.24s/it][A100%|██████████| 10/10 [14:24<00:00, 86.48s/it]
Checkpointing at shard 20
[2024-05-29 03:42:20,880] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step200 is about to be saved!
[2024-05-29 03:42:22,180] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_00-model_states.pt...
[2024-05-29 03:42:26,016] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_04-model_states.pt...
[2024-05-29 03:42:26,133] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_02-model_states.pt...
[2024-05-29 03:42:28,026] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_03-model_states.pt...
[2024-05-29 03:42:30,592] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_00-model_states.pt.
[2024-05-29 03:42:35,921] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_08-model_states.pt...
[2024-05-29 03:42:36,296] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_07-model_states.pt...
[2024-05-29 03:42:39,484] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_05-model_states.pt...
[2024-05-29 03:42:39,785] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_06-model_states.pt...
[2024-05-29 03:42:40,409] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_01-model_states.pt...
[2024-05-29 03:52:02,268] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_04-model_states.pt.
[2024-05-29 03:52:02,273] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_02-model_states.pt.
[2024-05-29 03:52:02,346] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_01_model_states.pt
[2024-05-29 03:52:02,346] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_01_model_states.pt...
[2024-05-29 03:52:02,347] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_03_model_states.pt...
[2024-05-29 03:52:04,020] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_01_model_states.pt.
[2024-05-29 03:52:04,020] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step200 is ready now!
[2024-05-29 03:52:04,038] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_03_model_states.pt.
[2024-05-29 03:52:04,038] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step200 is ready now!
[2024-05-29 03:52:04,731] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_01-model_states.pt.
[2024-05-29 03:52:05,469] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_00_model_states.pt
[2024-05-29 03:52:05,469] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_00_model_states.pt...
[2024-05-29 03:52:09,156] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_00_model_states.pt.
[2024-05-29 03:52:09,156] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step200 is ready now!
[2024-05-29 03:52:16,746] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_06-model_states.pt.
[2024-05-29 03:52:17,510] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_05_model_states.pt...
[2024-05-29 03:52:18,759] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_05_model_states.pt.
[2024-05-29 03:52:18,759] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step200 is ready now!
[2024-05-29 03:52:24,019] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_05-model_states.pt.
[2024-05-29 03:52:24,613] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_04_model_states.pt...
[2024-05-29 03:52:25,878] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_04_model_states.pt.
[2024-05-29 03:52:25,879] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step200 is ready now!
[2024-05-29 03:52:54,902] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_07-model_states.pt.
[2024-05-29 03:52:55,327] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_06_model_states.pt...
[2024-05-29 03:52:56,365] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_06_model_states.pt.
[2024-05-29 03:52:56,366] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step200 is ready now!
[2024-05-29 03:53:00,979] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_08-model_states.pt.
[2024-05-29 03:53:01,108] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_09-model_states.pt...
[2024-05-29 03:53:05,374] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_09-model_states.pt.
[2024-05-29 03:53:05,385] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_07_model_states.pt...
[2024-05-29 03:53:06,681] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_07_model_states.pt.
[2024-05-29 03:53:06,681] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step200 is ready now!
[2024-05-29 03:53:31,290] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/layer_03-model_states.pt.
[2024-05-29 03:53:31,450] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_02_model_states.pt...
[2024-05-29 03:53:31,799] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step200/mp_rank_02_model_states.pt.
[2024-05-29 03:53:31,799] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step200 is ready now!
Checkpoint saved using --- 675.3951976299286 seconds ---
  4%|▍         | 20/520 [3:15:50<148:04:34, 1066.15s/it]  4%|▍         | 20/520 [3:15:36<147:56:30, 1065.18s/it]  4%|▍         | 20/520 [3:15:56<147:58:24, 1065.41s/it]  4%|▍         | 20/520 [3:15:43<147:57:05, 1065.25s/it]  4%|▍         | 20/520 [3:15:12<147:54:28, 1064.94s/it]  4%|▍         | 20/520 [3:15:21<147:55:51, 1065.10s/it]  4%|▍         | 20/520 [3:15:28<147:56:01, 1065.12s/it]  4%|▍         | 20/520 [3:15:55<147:58:50, 1065.46s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_192
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A


  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [00:00<?, ?it/s][A[A  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A

  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [00:55<08:21, 55.68s/it][A[2024-05-29 03:54:29,056] [INFO] [logging.py:96:log_dist] [Rank 0] step=201, skipped=0, lr=[1.9998607965639462e-05], mom=[(0.9, 0.999)]
steps: 201 loss: 0.5122 iter time (s): 56.669 samples/sec: 2.259

 10%|█         | 1/10 [00:57<08:33, 57.01s/it][A
 10%|█         | 1/10 [00:57<08:34, 57.14s/it][A
 10%|█         | 1/10 [00:57<08:34, 57.20s/it][A
 10%|█         | 1/10 [00:57<08:35, 57.30s/it][A
 10%|█         | 1/10 [00:57<08:35, 57.32s/it][A
 10%|█         | 1/10 [00:57<08:36, 57.37s/it][A
 10%|█         | 1/10 [00:57<08:36, 57.39s/it][A
 20%|██        | 2/10 [01:52<07:30, 56.36s/it][A[2024-05-29 03:55:25,890] [INFO] [logging.py:96:log_dist] [Rank 0] step=202, skipped=0, lr=[1.9998511860745904e-05], mom=[(0.9, 0.999)]
steps: 202 loss: 0.4844 iter time (s): 56.214 samples/sec: 2.277

 20%|██        | 2/10 [01:53<07:35, 56.92s/it][A
 20%|██        | 2/10 [01:53<07:35, 56.96s/it][A
 20%|██        | 2/10 [01:54<07:35, 56.97s/it][A
 20%|██        | 2/10 [01:54<07:36, 57.01s/it][A
 20%|██        | 2/10 [01:54<07:36, 57.03s/it][A
 20%|██        | 2/10 [01:54<07:36, 57.03s/it][A
 20%|██        | 2/10 [01:54<07:36, 57.04s/it][A
 30%|███       | 3/10 [02:50<06:39, 57.14s/it][A[2024-05-29 03:56:23,963] [INFO] [logging.py:96:log_dist] [Rank 0] step=203, skipped=0, lr=[1.9998412548402372e-05], mom=[(0.9, 0.999)]
steps: 203 loss: 0.5100 iter time (s): 57.499 samples/sec: 2.226

 30%|███       | 3/10 [02:51<06:42, 57.44s/it][A
 30%|███       | 3/10 [02:52<06:42, 57.48s/it][A
 30%|███       | 3/10 [02:52<06:42, 57.49s/it][A
 30%|███       | 3/10 [02:52<06:42, 57.48s/it][A
 30%|███       | 3/10 [02:52<06:42, 57.52s/it][A
 30%|███       | 3/10 [02:52<06:42, 57.53s/it][A
 30%|███       | 3/10 [02:52<06:42, 57.53s/it][A
 40%|████      | 4/10 [03:48<05:45, 57.55s/it][A[2024-05-29 03:57:22,145] [INFO] [logging.py:96:log_dist] [Rank 0] step=204, skipped=0, lr=[1.9998310028640734e-05], mom=[(0.9, 0.999)]
steps: 204 loss: 0.4728 iter time (s): 57.594 samples/sec: 2.222

 40%|████      | 4/10 [03:50<05:46, 57.75s/it][A
 40%|████      | 4/10 [03:50<05:46, 57.75s/it][A
 40%|████      | 4/10 [03:50<05:46, 57.78s/it][A
 40%|████      | 4/10 [03:50<05:46, 57.78s/it][A
 40%|████      | 4/10 [03:50<05:46, 57.79s/it][A
 40%|████      | 4/10 [03:50<05:46, 57.80s/it][A
 40%|████      | 4/10 [03:50<05:46, 57.79s/it][A
 50%|█████     | 5/10 [04:46<04:48, 57.74s/it][A[2024-05-29 03:58:20,214] [INFO] [logging.py:96:log_dist] [Rank 0] step=205, skipped=0, lr=[1.999820430149387e-05], mom=[(0.9, 0.999)]
steps: 205 loss: 0.4818 iter time (s): 57.423 samples/sec: 2.229

 50%|█████     | 5/10 [04:48<04:49, 57.86s/it][A
 50%|█████     | 5/10 [04:48<04:49, 57.84s/it][A
 50%|█████     | 5/10 [04:48<04:49, 57.86s/it][A
 50%|█████     | 5/10 [04:48<04:49, 57.87s/it][A
 50%|█████     | 5/10 [04:48<04:49, 57.86s/it][A
 50%|█████     | 5/10 [04:48<04:49, 57.87s/it][A
 50%|█████     | 5/10 [04:48<04:49, 57.87s/it][A
 60%|██████    | 6/10 [05:44<03:51, 57.82s/it][A[2024-05-29 03:59:18,183] [INFO] [logging.py:96:log_dist] [Rank 0] step=206, skipped=0, lr=[1.999809536699571e-05], mom=[(0.9, 0.999)]
steps: 206 loss: 0.4919 iter time (s): 57.402 samples/sec: 2.230

 60%|██████    | 6/10 [05:46<03:51, 57.89s/it][A
 60%|██████    | 6/10 [05:46<03:51, 57.90s/it][A
 60%|██████    | 6/10 [05:46<03:51, 57.90s/it][A
 60%|██████    | 6/10 [05:46<03:51, 57.91s/it][A
 60%|██████    | 6/10 [05:46<03:51, 57.91s/it][A
 60%|██████    | 6/10 [05:46<03:51, 57.91s/it][A
 60%|██████    | 6/10 [05:46<03:51, 57.92s/it][A
 70%|███████   | 7/10 [06:41<02:52, 57.53s/it][A[2024-05-29 04:00:15,111] [INFO] [logging.py:96:log_dist] [Rank 0] step=207, skipped=0, lr=[1.9997983225181203e-05], mom=[(0.9, 0.999)]
steps: 207 loss: 0.4573 iter time (s): 56.345 samples/sec: 2.272

 70%|███████   | 7/10 [06:43<02:52, 57.58s/it][A
 70%|███████   | 7/10 [06:43<02:52, 57.61s/it][A
 70%|███████   | 7/10 [06:43<02:52, 57.60s/it][A
 70%|███████   | 7/10 [06:43<02:52, 57.61s/it][A
 70%|███████   | 7/10 [06:43<02:52, 57.61s/it][A
 70%|███████   | 7/10 [06:43<02:52, 57.61s/it][A
 70%|███████   | 7/10 [06:43<02:52, 57.61s/it][A
 80%|████████  | 8/10 [07:39<01:55, 57.72s/it][A[2024-05-29 04:01:13,236] [INFO] [logging.py:96:log_dist] [Rank 0] step=208, skipped=0, lr=[1.999786787608632e-05], mom=[(0.9, 0.999)]
steps: 208 loss: 0.4931 iter time (s): 57.453 samples/sec: 2.228

 80%|████████  | 8/10 [07:41<01:55, 57.74s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.74s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.76s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.75s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.75s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.75s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.75s/it][A
 90%|█████████ | 9/10 [08:38<00:57, 57.86s/it][A[2024-05-29 04:02:11,398] [INFO] [logging.py:96:log_dist] [Rank 0] step=209, skipped=0, lr=[1.999774931974807e-05], mom=[(0.9, 0.999)]
steps: 209 loss: 0.4798 iter time (s): 57.590 samples/sec: 2.223

 90%|█████████ | 9/10 [08:39<00:57, 57.88s/it][A
 90%|█████████ | 9/10 [08:39<00:57, 57.88s/it][A
 90%|█████████ | 9/10 [08:39<00:57, 57.87s/it][A
 90%|█████████ | 9/10 [08:39<00:57, 57.89s/it][A
 90%|█████████ | 9/10 [08:39<00:57, 57.88s/it][A
 90%|█████████ | 9/10 [08:39<00:57, 57.88s/it][A
 90%|█████████ | 9/10 [08:39<00:57, 57.88s/it][A
100%|██████████| 10/10 [09:36<00:00, 57.97s/it][A100%|██████████| 10/10 [09:36<00:00, 57.62s/it]
  4%|▍         | 21/520 [3:25:27<128:40:15, 928.29s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 04:03:09,298] [INFO] [logging.py:96:log_dist] [Rank 0] step=210, skipped=0, lr=[1.999762755620449e-05], mom=[(0.9, 0.999)]
steps: 210 loss: 0.5000 iter time (s): 57.292 samples/sec: 2.234

100%|██████████| 10/10 [09:37<00:00, 57.88s/it][A100%|██████████| 10/10 [09:37<00:00, 57.73s/it]
  4%|▍         | 21/520 [3:24:58<128:36:24, 927.82s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:37<00:00, 57.89s/it][A100%|██████████| 10/10 [09:37<00:00, 57.73s/it]
  4%|▍         | 21/520 [3:25:33<128:38:43, 928.10s/it] 
100%|██████████| 10/10 [09:37<00:00, 57.87s/it][A100%|██████████| 10/10 [09:37<00:00, 57.74s/it]
  4%|▍         | 21/520 [3:25:06<128:36:50, 927.88s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:37<00:00, 57.89s/it][A100%|██████████| 10/10 [09:37<00:00, 57.75s/it]
  4%|▍         | 21/520 [3:24:50<128:36:00, 927.78s/it] 
100%|██████████| 10/10 [09:37<00:00, 57.88s/it][A100%|██████████| 10/10 [09:37<00:00, 57.75s/it]
  4%|▍         | 21/520 [3:25:34<128:38:53, 928.12s/it] 
100%|██████████| 10/10 [09:37<00:00, 57.88s/it][A100%|██████████| 10/10 [09:37<00:00, 57.76s/it]
  4%|▍         | 21/520 [3:25:14<128:37:34, 927.96s/it] 
100%|██████████| 10/10 [09:37<00:00, 57.88s/it][A100%|██████████| 10/10 [09:37<00:00, 57.76s/it]
  4%|▍         | 21/520 [3:25:21<128:38:01, 928.02s/it] Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_432

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:05<09:45, 65.03s/it][A[2024-05-29 04:04:14,911] [INFO] [logging.py:96:log_dist] [Rank 0] step=211, skipped=0, lr=[1.9997502585494647e-05], mom=[(0.9, 0.999)]
steps: 211 loss: 0.4866 iter time (s): 64.802 samples/sec: 1.975

 10%|█         | 1/10 [01:05<09:50, 65.64s/it][A
 10%|█         | 1/10 [01:05<09:50, 65.60s/it][A
 10%|█         | 1/10 [01:05<09:50, 65.61s/it][A
 10%|█         | 1/10 [01:05<09:49, 65.48s/it][A
 10%|█         | 1/10 [01:05<09:49, 65.52s/it][A
 10%|█         | 1/10 [01:05<09:50, 65.61s/it][A
 10%|█         | 1/10 [01:05<09:50, 65.57s/it][A
 20%|██        | 2/10 [02:10<08:40, 65.03s/it][A[2024-05-29 04:05:19,952] [INFO] [logging.py:96:log_dist] [Rank 0] step=212, skipped=0, lr=[1.9997374407658633e-05], mom=[(0.9, 0.999)]
steps: 212 loss: 0.5049 iter time (s): 64.326 samples/sec: 1.990

 20%|██        | 2/10 [02:10<08:41, 65.23s/it][A
 20%|██        | 2/10 [02:10<08:41, 65.23s/it][A
 20%|██        | 2/10 [02:10<08:42, 65.26s/it][A
 20%|██        | 2/10 [02:10<08:41, 65.19s/it][A
 20%|██        | 2/10 [02:10<08:41, 65.23s/it][A
 20%|██        | 2/10 [02:10<08:42, 65.25s/it][A
 20%|██        | 2/10 [02:10<08:41, 65.23s/it][A
 30%|███       | 3/10 [03:14<07:34, 64.98s/it][A[2024-05-29 04:06:24,873] [INFO] [logging.py:96:log_dist] [Rank 0] step=213, skipped=0, lr=[1.9997243022737566e-05], mom=[(0.9, 0.999)]
steps: 213 loss: 0.4607 iter time (s): 64.301 samples/sec: 1.991

 30%|███       | 3/10 [03:15<07:35, 65.13s/it][A
 30%|███       | 3/10 [03:15<07:35, 65.08s/it][A
 30%|███       | 3/10 [03:15<07:35, 65.13s/it][A
 30%|███       | 3/10 [03:15<07:35, 65.10s/it][A
 30%|███       | 3/10 [03:15<07:35, 65.09s/it][A
 30%|███       | 3/10 [03:15<07:35, 65.12s/it][A
 30%|███       | 3/10 [03:15<07:35, 65.11s/it][A
 40%|████      | 4/10 [04:19<06:28, 64.82s/it][A[2024-05-29 04:07:29,437] [INFO] [logging.py:96:log_dist] [Rank 0] step=214, skipped=0, lr=[1.9997108430773605e-05], mom=[(0.9, 0.999)]
steps: 214 loss: 0.4157 iter time (s): 63.882 samples/sec: 2.004

 40%|████      | 4/10 [04:20<06:29, 64.94s/it][A
 40%|████      | 4/10 [04:20<06:29, 64.98s/it][A
 40%|████      | 4/10 [04:20<06:29, 64.93s/it][A
 40%|████      | 4/10 [04:20<06:30, 65.00s/it][A
 40%|████      | 4/10 [04:20<06:29, 64.96s/it][A
 40%|████      | 4/10 [04:20<06:29, 64.99s/it][A
 40%|████      | 4/10 [04:20<06:29, 64.98s/it][A
 50%|█████     | 5/10 [05:23<05:23, 64.62s/it][A[2024-05-29 04:08:33,698] [INFO] [logging.py:96:log_dist] [Rank 0] step=215, skipped=0, lr=[1.9996970631809925e-05], mom=[(0.9, 0.999)]
steps: 215 loss: 0.4178 iter time (s): 63.336 samples/sec: 2.021

 50%|█████     | 5/10 [05:24<05:23, 64.65s/it][A
 50%|█████     | 5/10 [05:24<05:23, 64.64s/it][A
 50%|█████     | 5/10 [05:24<05:23, 64.62s/it][A
 50%|█████     | 5/10 [05:24<05:23, 64.63s/it][A
 50%|█████     | 5/10 [05:24<05:23, 64.63s/it][A
 50%|█████     | 5/10 [05:24<05:23, 64.63s/it][A
 50%|█████     | 5/10 [05:24<05:23, 64.62s/it][A
 60%|██████    | 6/10 [06:28<04:18, 64.63s/it][A[2024-05-29 04:09:38,344] [INFO] [logging.py:96:log_dist] [Rank 0] step=216, skipped=0, lr=[1.9996829625890738e-05], mom=[(0.9, 0.999)]
steps: 216 loss: 0.3884 iter time (s): 64.082 samples/sec: 1.997

 60%|██████    | 6/10 [06:29<04:18, 64.71s/it][A
 60%|██████    | 6/10 [06:29<04:18, 64.66s/it][A
 60%|██████    | 6/10 [06:29<04:18, 64.66s/it][A
 60%|██████    | 6/10 [06:29<04:18, 64.69s/it][A
 60%|██████    | 6/10 [06:29<04:18, 64.68s/it][A
 60%|██████    | 6/10 [06:29<04:18, 64.67s/it][A
 60%|██████    | 6/10 [06:29<04:18, 64.68s/it][A
 70%|███████   | 7/10 [07:33<03:14, 64.77s/it][A[2024-05-29 04:10:43,425] [INFO] [logging.py:96:log_dist] [Rank 0] step=217, skipped=0, lr=[1.9996685413061282e-05], mom=[(0.9, 0.999)]
steps: 217 loss: 0.4224 iter time (s): 64.426 samples/sec: 1.987

 70%|███████   | 7/10 [07:34<03:14, 64.82s/it][A
 70%|███████   | 7/10 [07:34<03:14, 64.83s/it][A
 70%|███████   | 7/10 [07:34<03:14, 64.81s/it][A
 70%|███████   | 7/10 [07:34<03:14, 64.82s/it][A
 70%|███████   | 7/10 [07:34<03:14, 64.82s/it][A
 70%|███████   | 7/10 [07:34<03:14, 64.82s/it][A
 70%|███████   | 7/10 [07:34<03:14, 64.82s/it][A
 80%|████████  | 8/10 [08:37<02:09, 64.53s/it][A[2024-05-29 04:11:47,421] [INFO] [logging.py:96:log_dist] [Rank 0] step=218, skipped=0, lr=[1.9996537993367825e-05], mom=[(0.9, 0.999)]
steps: 218 loss: 0.3877 iter time (s): 63.179 samples/sec: 2.026

 80%|████████  | 8/10 [08:38<02:09, 64.51s/it][A
 80%|████████  | 8/10 [08:38<02:09, 64.50s/it][A
 80%|████████  | 8/10 [08:38<02:09, 64.52s/it][A
 80%|████████  | 8/10 [08:38<02:09, 64.52s/it][A
 80%|████████  | 8/10 [08:38<02:09, 64.52s/it][A
 80%|████████  | 8/10 [08:38<02:09, 64.51s/it][A
 80%|████████  | 8/10 [08:38<02:09, 64.52s/it][A
 90%|█████████ | 9/10 [09:42<01:04, 64.73s/it][A[2024-05-29 04:12:52,387] [INFO] [logging.py:96:log_dist] [Rank 0] step=219, skipped=0, lr=[1.9996387366857655e-05], mom=[(0.9, 0.999)]
steps: 219 loss: 0.3736 iter time (s): 64.352 samples/sec: 1.989

 90%|█████████ | 9/10 [09:43<01:04, 64.68s/it][A
 90%|█████████ | 9/10 [09:43<01:04, 64.69s/it][A
 90%|█████████ | 9/10 [09:43<01:04, 64.68s/it][A
 90%|█████████ | 9/10 [09:42<01:04, 64.66s/it][A
 90%|█████████ | 9/10 [09:43<01:04, 64.68s/it][A
 90%|█████████ | 9/10 [09:43<01:04, 64.68s/it][A
 90%|█████████ | 9/10 [09:43<01:04, 64.68s/it][A
100%|██████████| 10/10 [10:47<00:00, 64.61s/it][A100%|██████████| 10/10 [10:47<00:00, 64.71s/it]
  4%|▍         | 22/520 [3:36:14<117:15:07, 847.61s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 04:13:56,931] [INFO] [logging.py:96:log_dist] [Rank 0] step=220, skipped=0, lr=[1.999623353357911e-05], mom=[(0.9, 0.999)]
steps: 220 loss: 0.3555 iter time (s): 63.805 samples/sec: 2.006

100%|██████████| 10/10 [10:47<00:00, 64.61s/it][A100%|██████████| 10/10 [10:47<00:00, 64.76s/it]
  4%|▍         | 22/520 [3:35:46<117:13:34, 847.42s/it]
100%|██████████| 10/10 [10:47<00:00, 64.62s/it][A100%|██████████| 10/10 [10:47<00:00, 64.76s/it]
  4%|▍         | 22/520 [3:36:21<117:15:25, 847.64s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:47<00:00, 64.63s/it][A100%|██████████| 10/10 [10:47<00:00, 64.77s/it]
  4%|▍         | 22/520 [3:35:54<117:14:12, 847.49s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:47<00:00, 64.64s/it][A100%|██████████| 10/10 [10:47<00:00, 64.76s/it]
  4%|▍         | 22/520 [3:35:38<117:13:37, 847.43s/it]
100%|██████████| 10/10 [10:47<00:00, 64.63s/it][A100%|██████████| 10/10 [10:47<00:00, 64.76s/it]
  4%|▍         | 22/520 [3:36:22<117:15:39, 847.67s/it]
100%|██████████| 10/10 [10:47<00:00, 64.62s/it][A100%|██████████| 10/10 [10:47<00:00, 64.76s/it]
  4%|▍         | 22/520 [3:36:02<117:14:40, 847.55s/it]
100%|██████████| 10/10 [10:47<00:00, 64.62s/it][A100%|██████████| 10/10 [10:47<00:00, 64.76s/it]
  4%|▍         | 22/520 [3:36:09<117:14:59, 847.59s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_209

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:00<09:02, 60.23s/it][A[2024-05-29 04:14:57,226] [INFO] [logging.py:96:log_dist] [Rank 0] step=221, skipped=0, lr=[1.9996076493581532e-05], mom=[(0.9, 0.999)]
steps: 221 loss: 1.0621 iter time (s): 59.366 samples/sec: 2.156

 10%|█         | 1/10 [01:00<09:01, 60.11s/it][A
 10%|█         | 1/10 [01:00<09:01, 60.19s/it][A
 10%|█         | 1/10 [01:00<09:01, 60.20s/it][A
 10%|█         | 1/10 [00:59<08:59, 59.97s/it][A
 10%|█         | 1/10 [00:59<08:59, 59.96s/it][A
 10%|█         | 1/10 [01:00<09:00, 60.11s/it][A
 10%|█         | 1/10 [01:00<09:00, 60.09s/it][A
 20%|██        | 2/10 [01:59<07:56, 59.54s/it][A[2024-05-29 04:15:56,283] [INFO] [logging.py:96:log_dist] [Rank 0] step=222, skipped=0, lr=[1.999591624691531e-05], mom=[(0.9, 0.999)]
steps: 222 loss: 0.7293 iter time (s): 58.393 samples/sec: 2.192

 20%|██        | 2/10 [01:59<07:56, 59.51s/it][A
 20%|██        | 2/10 [01:59<07:56, 59.51s/it][A
 20%|██        | 2/10 [01:59<07:56, 59.50s/it][A
 20%|██        | 2/10 [01:58<07:55, 59.41s/it][A
 20%|██        | 2/10 [01:59<07:55, 59.43s/it][A
 20%|██        | 2/10 [01:59<07:55, 59.46s/it][A
 20%|██        | 2/10 [01:59<07:55, 59.46s/it][A
 30%|███       | 3/10 [02:58<06:57, 59.60s/it][A[2024-05-29 04:16:55,956] [INFO] [logging.py:96:log_dist] [Rank 0] step=223, skipped=0, lr=[1.9995752793631858e-05], mom=[(0.9, 0.999)]
steps: 223 loss: 0.6489 iter time (s): 59.083 samples/sec: 2.166

 30%|███       | 3/10 [02:58<06:57, 59.58s/it][A
 30%|███       | 3/10 [02:58<06:57, 59.60s/it][A
 30%|███       | 3/10 [02:59<06:57, 59.64s/it][A
 30%|███       | 3/10 [02:58<06:56, 59.55s/it][A
 30%|███       | 3/10 [02:58<06:56, 59.56s/it][A
 30%|███       | 3/10 [02:58<06:57, 59.59s/it][A
 30%|███       | 3/10 [02:58<06:57, 59.58s/it][A
 40%|████      | 4/10 [03:58<05:56, 59.44s/it][A[2024-05-29 04:17:55,158] [INFO] [logging.py:96:log_dist] [Rank 0] step=224, skipped=0, lr=[1.9995586133783606e-05], mom=[(0.9, 0.999)]
steps: 224 loss: 0.7054 iter time (s): 58.529 samples/sec: 2.187

 40%|████      | 4/10 [03:58<05:56, 59.42s/it][A
 40%|████      | 4/10 [03:58<05:56, 59.42s/it][A
 40%|████      | 4/10 [03:58<05:56, 59.45s/it][A
 40%|████      | 4/10 [03:57<05:56, 59.39s/it][A
 40%|████      | 4/10 [03:57<05:56, 59.40s/it][A
 40%|████      | 4/10 [03:58<05:56, 59.42s/it][A
 40%|████      | 4/10 [03:58<05:56, 59.42s/it][A
 50%|█████     | 5/10 [04:58<04:58, 59.79s/it][A[2024-05-29 04:18:55,556] [INFO] [logging.py:96:log_dist] [Rank 0] step=225, skipped=0, lr=[1.999541626742403e-05], mom=[(0.9, 0.999)]
steps: 225 loss: 0.6255 iter time (s): 59.790 samples/sec: 2.141

 50%|█████     | 5/10 [04:58<04:59, 59.80s/it][A
 50%|█████     | 5/10 [04:58<04:58, 59.79s/it][A
 50%|█████     | 5/10 [04:58<04:59, 59.81s/it][A
 50%|█████     | 5/10 [04:58<04:58, 59.78s/it][A
 50%|█████     | 5/10 [04:58<04:58, 59.79s/it][A
 50%|█████     | 5/10 [04:58<04:58, 59.79s/it][A
 50%|█████     | 5/10 [04:58<04:58, 59.79s/it][A
 60%|██████    | 6/10 [05:57<03:58, 59.64s/it][A[2024-05-29 04:19:54,914] [INFO] [logging.py:96:log_dist] [Rank 0] step=226, skipped=0, lr=[1.9995243194607624e-05], mom=[(0.9, 0.999)]
steps: 226 loss: 0.6407 iter time (s): 58.683 samples/sec: 2.181

 60%|██████    | 6/10 [05:57<03:58, 59.62s/it][A
 60%|██████    | 6/10 [05:57<03:58, 59.63s/it][A
 60%|██████    | 6/10 [05:57<03:58, 59.62s/it][A
 60%|██████    | 6/10 [05:57<03:58, 59.60s/it][A
 60%|██████    | 6/10 [05:57<03:58, 59.60s/it][A
 60%|██████    | 6/10 [05:57<03:58, 59.62s/it][A
 60%|██████    | 6/10 [05:57<03:58, 59.62s/it][A
 70%|███████   | 7/10 [06:56<02:58, 59.44s/it][A[2024-05-29 04:20:53,948] [INFO] [logging.py:96:log_dist] [Rank 0] step=227, skipped=0, lr=[1.999506691538991e-05], mom=[(0.9, 0.999)]
steps: 227 loss: 0.6531 iter time (s): 58.462 samples/sec: 2.189

 70%|███████   | 7/10 [06:56<02:58, 59.46s/it][A
 70%|███████   | 7/10 [06:56<02:58, 59.46s/it][A
 70%|███████   | 7/10 [06:56<02:58, 59.45s/it][A
 70%|███████   | 7/10 [06:56<02:58, 59.45s/it][A
 70%|███████   | 7/10 [06:56<02:58, 59.44s/it][A
 70%|███████   | 7/10 [06:56<02:58, 59.45s/it][A
 70%|███████   | 7/10 [06:56<02:58, 59.45s/it][A
 80%|████████  | 8/10 [07:56<01:59, 59.57s/it][A[2024-05-29 04:21:53,791] [INFO] [logging.py:96:log_dist] [Rank 0] step=228, skipped=0, lr=[1.9994887429827457e-05], mom=[(0.9, 0.999)]
steps: 228 loss: 0.6722 iter time (s): 59.171 samples/sec: 2.163

 80%|████████  | 8/10 [07:56<01:59, 59.62s/it][A
 80%|████████  | 8/10 [07:56<01:59, 59.62s/it][A
 80%|████████  | 8/10 [07:56<01:59, 59.62s/it][A
 80%|████████  | 8/10 [07:57<01:59, 59.67s/it][A
 80%|████████  | 8/10 [07:56<01:59, 59.62s/it][A
 80%|████████  | 8/10 [07:56<01:59, 59.62s/it][A
 80%|████████  | 8/10 [07:56<01:59, 59.62s/it][A
 90%|█████████ | 9/10 [08:55<00:59, 59.22s/it][A[2024-05-29 04:22:52,249] [INFO] [logging.py:96:log_dist] [Rank 0] step=229, skipped=0, lr=[1.9994704737977833e-05], mom=[(0.9, 0.999)]
steps: 229 loss: 0.6958 iter time (s): 57.686 samples/sec: 2.219

 90%|█████████ | 9/10 [08:55<00:59, 59.21s/it][A
 90%|█████████ | 9/10 [08:55<00:59, 59.21s/it][A
 90%|█████████ | 9/10 [08:55<00:59, 59.20s/it][A
 90%|█████████ | 9/10 [08:55<00:59, 59.21s/it][A
 90%|█████████ | 9/10 [08:55<00:59, 59.23s/it][A
 90%|█████████ | 9/10 [08:55<00:59, 59.22s/it][A
 90%|█████████ | 9/10 [08:55<00:59, 59.22s/it][A
100%|██████████| 10/10 [09:53<00:00, 59.02s/it][A100%|██████████| 10/10 [09:53<00:00, 59.38s/it]
  4%|▍         | 23/520 [3:46:08<106:50:21, 773.89s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 04:23:50,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=230, skipped=0, lr=[1.9994518839899658e-05], mom=[(0.9, 0.999)]
steps: 230 loss: 0.6716 iter time (s): 57.867 samples/sec: 2.212

100%|██████████| 10/10 [09:53<00:00, 58.99s/it][A100%|██████████| 10/10 [09:53<00:00, 59.37s/it]
  4%|▍         | 23/520 [3:45:40<106:48:49, 773.70s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:53<00:00, 58.99s/it][A100%|██████████| 10/10 [09:53<00:00, 59.38s/it]
  4%|▍         | 23/520 [3:45:48<106:49:07, 773.74s/it]
100%|██████████| 10/10 [09:53<00:00, 59.02s/it][A100%|██████████| 10/10 [09:53<00:00, 59.38s/it]
  4%|▍         | 23/520 [3:46:15<106:50:15, 773.87s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:53<00:00, 59.00s/it][A100%|██████████| 10/10 [09:53<00:00, 59.36s/it]
  4%|▍         | 23/520 [3:45:32<106:48:40, 773.68s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:53<00:00, 59.00s/it][A100%|██████████| 10/10 [09:53<00:00, 59.36s/it]
  4%|▍         | 23/520 [3:46:16<106:50:10, 773.86s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:53<00:00, 59.01s/it][A100%|██████████| 10/10 [09:53<00:00, 59.37s/it]
  4%|▍         | 23/520 [3:45:56<106:49:36, 773.80s/it]
100%|██████████| 10/10 [09:53<00:00, 59.00s/it][A100%|██████████| 10/10 [09:53<00:00, 59.37s/it]
  4%|▍         | 23/520 [3:46:03<106:49:48, 773.82s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_7
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:41<15:12, 101.39s/it][A[2024-05-29 04:25:33,528] [INFO] [logging.py:96:log_dist] [Rank 0] step=231, skipped=0, lr=[1.9994329735652572e-05], mom=[(0.9, 0.999)]
steps: 231 loss: 0.9583 iter time (s): 101.792 samples/sec: 1.257

 10%|█         | 1/10 [01:42<15:25, 102.79s/it][A
 10%|█         | 1/10 [01:42<15:25, 102.79s/it][A
 10%|█         | 1/10 [01:42<15:26, 102.94s/it][A
 10%|█         | 1/10 [01:42<15:26, 102.97s/it][A
 10%|█         | 1/10 [01:42<15:26, 102.91s/it][A
 10%|█         | 1/10 [01:42<15:25, 102.82s/it][A
 10%|█         | 1/10 [01:42<15:25, 102.87s/it][A
 20%|██        | 2/10 [03:25<13:41, 102.73s/it][A[2024-05-29 04:27:17,225] [INFO] [logging.py:96:log_dist] [Rank 0] step=232, skipped=0, lr=[1.9994137425297242e-05], mom=[(0.9, 0.999)]
steps: 232 loss: 0.9616 iter time (s): 102.770 samples/sec: 1.246

 20%|██        | 2/10 [03:26<13:46, 103.30s/it][A
 20%|██        | 2/10 [03:26<13:46, 103.31s/it][A
 20%|██        | 2/10 [03:26<13:47, 103.38s/it][A
 20%|██        | 2/10 [03:26<13:46, 103.37s/it][A
 20%|██        | 2/10 [03:26<13:46, 103.36s/it][A
 20%|██        | 2/10 [03:26<13:46, 103.29s/it][A
 20%|██        | 2/10 [03:26<13:46, 103.31s/it][A
 30%|███       | 3/10 [05:08<12:01, 103.14s/it][A[2024-05-29 04:29:00,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=233, skipped=0, lr=[1.9993941908895366e-05], mom=[(0.9, 0.999)]
steps: 233 loss: 0.9331 iter time (s): 102.746 samples/sec: 1.246

 30%|███       | 3/10 [05:10<12:04, 103.46s/it][A
 30%|███       | 3/10 [05:10<12:03, 103.42s/it][A
 30%|███       | 3/10 [05:10<12:04, 103.46s/it][A
 30%|███       | 3/10 [05:10<12:04, 103.46s/it][A
 30%|███       | 3/10 [05:10<12:04, 103.47s/it][A
 30%|███       | 3/10 [05:10<12:04, 103.44s/it][A
 30%|███       | 3/10 [05:10<12:04, 103.45s/it][A
 40%|████      | 4/10 [06:51<10:17, 102.84s/it][A[2024-05-29 04:30:43,209] [INFO] [logging.py:96:log_dist] [Rank 0] step=234, skipped=0, lr=[1.9993743186509674e-05], mom=[(0.9, 0.999)]
steps: 234 loss: 0.9167 iter time (s): 101.502 samples/sec: 1.261

 40%|████      | 4/10 [06:52<10:18, 103.02s/it][A
 40%|████      | 4/10 [06:52<10:18, 103.06s/it][A
 40%|████      | 4/10 [06:52<10:18, 103.04s/it][A
 40%|████      | 4/10 [06:52<10:18, 103.07s/it][A
 40%|████      | 4/10 [06:52<10:18, 103.06s/it][A
 40%|████      | 4/10 [06:52<10:18, 103.05s/it][A
 40%|████      | 4/10 [06:52<10:18, 103.05s/it][A
 50%|█████     | 5/10 [08:34<08:34, 102.97s/it][A[2024-05-29 04:32:26,411] [INFO] [logging.py:96:log_dist] [Rank 0] step=235, skipped=0, lr=[1.999354125820392e-05], mom=[(0.9, 0.999)]
steps: 235 loss: 0.9265 iter time (s): 102.239 samples/sec: 1.252

 50%|█████     | 5/10 [08:35<08:35, 103.07s/it][A
 50%|█████     | 5/10 [08:35<08:35, 103.12s/it][A
 50%|█████     | 5/10 [08:36<08:35, 103.19s/it][A
 50%|█████     | 5/10 [08:35<08:35, 103.16s/it][A
 50%|█████     | 5/10 [08:35<08:35, 103.16s/it][A
 50%|█████     | 5/10 [08:35<08:35, 103.16s/it][A
 50%|█████     | 5/10 [08:35<08:35, 103.16s/it][A
 60%|██████    | 6/10 [10:17<06:52, 103.04s/it][A[2024-05-29 04:34:09,602] [INFO] [logging.py:96:log_dist] [Rank 0] step=236, skipped=0, lr=[1.9993336124042885e-05], mom=[(0.9, 0.999)]
steps: 236 loss: 0.9102 iter time (s): 102.131 samples/sec: 1.253

 60%|██████    | 6/10 [10:18<06:52, 103.14s/it][A
 60%|██████    | 6/10 [10:18<06:52, 103.11s/it][A
 60%|██████    | 6/10 [10:18<06:52, 103.11s/it][A
 60%|██████    | 6/10 [10:19<06:52, 103.12s/it][A
 60%|██████    | 6/10 [10:19<06:52, 103.12s/it][A
 60%|██████    | 6/10 [10:18<06:52, 103.12s/it][A
 60%|██████    | 6/10 [10:18<06:52, 103.12s/it][A
 70%|███████   | 7/10 [12:01<05:09, 103.25s/it][A[2024-05-29 04:35:53,264] [INFO] [logging.py:96:log_dist] [Rank 0] step=237, skipped=0, lr=[1.9993127784092383e-05], mom=[(0.9, 0.999)]
steps: 237 loss: 0.9065 iter time (s): 102.727 samples/sec: 1.246

 70%|███████   | 7/10 [12:02<05:09, 103.24s/it][A
 70%|███████   | 7/10 [12:02<05:09, 103.31s/it][A
 70%|███████   | 7/10 [12:02<05:09, 103.28s/it][A
 70%|███████   | 7/10 [12:02<05:09, 103.27s/it][A
 70%|███████   | 7/10 [12:02<05:09, 103.28s/it][A
 70%|███████   | 7/10 [12:02<05:09, 103.26s/it][A
 70%|███████   | 7/10 [12:02<05:09, 103.27s/it][A
 80%|████████  | 8/10 [13:45<03:27, 103.63s/it][A[2024-05-29 04:37:37,738] [INFO] [logging.py:96:log_dist] [Rank 0] step=238, skipped=0, lr=[1.9992916238419253e-05], mom=[(0.9, 0.999)]
steps: 238 loss: 0.9143 iter time (s): 103.592 samples/sec: 1.236

 80%|████████  | 8/10 [13:46<03:27, 103.66s/it][A
 80%|████████  | 8/10 [13:46<03:27, 103.68s/it][A
 80%|████████  | 8/10 [13:47<03:27, 103.65s/it][A
 80%|████████  | 8/10 [13:47<03:27, 103.68s/it][A
 80%|████████  | 8/10 [13:47<03:27, 103.66s/it][A
 80%|████████  | 8/10 [13:46<03:27, 103.65s/it][A
 80%|████████  | 8/10 [13:47<03:27, 103.66s/it][A
 90%|█████████ | 9/10 [15:30<01:43, 103.91s/it][A[2024-05-29 04:39:22,246] [INFO] [logging.py:96:log_dist] [Rank 0] step=239, skipped=0, lr=[1.9992701487091367e-05], mom=[(0.9, 0.999)]
steps: 239 loss: 0.8916 iter time (s): 103.633 samples/sec: 1.235

 90%|█████████ | 9/10 [15:31<01:43, 103.93s/it][A
 90%|█████████ | 9/10 [15:31<01:43, 103.94s/it][A
 90%|█████████ | 9/10 [15:31<01:43, 103.93s/it][A
 90%|█████████ | 9/10 [15:31<01:43, 103.93s/it][A
 90%|█████████ | 9/10 [15:31<01:43, 103.92s/it][A
 90%|█████████ | 9/10 [15:31<01:43, 103.91s/it][A
 90%|█████████ | 9/10 [15:31<01:43, 103.92s/it][A
100%|██████████| 10/10 [17:13<00:00, 103.61s/it][A100%|██████████| 10/10 [17:13<00:00, 103.30s/it]
  5%|▍         | 24/520 [4:03:21<117:06:25, 849.97s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 04:41:05,165] [INFO] [logging.py:96:log_dist] [Rank 0] step=240, skipped=0, lr=[1.999248353017762e-05], mom=[(0.9, 0.999)]
steps: 240 loss: 0.8946 iter time (s): 102.032 samples/sec: 1.255

100%|██████████| 10/10 [17:14<00:00, 103.66s/it][A100%|██████████| 10/10 [17:14<00:00, 103.45s/it]
  5%|▍         | 24/520 [4:02:54<117:08:51, 850.27s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:14<00:00, 103.63s/it][A100%|██████████| 10/10 [17:14<00:00, 103.44s/it]
  5%|▍         | 24/520 [4:03:29<117:09:32, 850.35s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:14<00:00, 103.63s/it][A100%|██████████| 10/10 [17:14<00:00, 103.46s/it]
  5%|▍         | 24/520 [4:02:46<117:08:43, 850.25s/it]
100%|██████████| 10/10 [17:14<00:00, 103.65s/it][A100%|██████████| 10/10 [17:14<00:00, 103.46s/it]
  5%|▍         | 24/520 [4:03:02<117:09:19, 850.32s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:14<00:00, 103.64s/it][A100%|██████████| 10/10 [17:14<00:00, 103.46s/it]
  5%|▍         | 24/520 [4:03:31<117:09:55, 850.39s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:15<00:00, 103.84s/it][A100%|██████████| 10/10 [17:15<00:00, 103.51s/it]
  5%|▍         | 24/520 [4:03:11<117:11:07, 850.54s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:15<00:00, 103.89s/it][A100%|██████████| 10/10 [17:15<00:00, 103.53s/it]
  5%|▍         | 24/520 [4:03:18<117:11:42, 850.61s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_242
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:03<09:28, 63.16s/it][A[2024-05-29 04:42:07,265] [INFO] [logging.py:96:log_dist] [Rank 0] step=241, skipped=0, lr=[1.9992262367747937e-05], mom=[(0.9, 0.999)]
steps: 241 loss: 0.6410 iter time (s): 60.144 samples/sec: 2.128

 10%|█         | 1/10 [01:01<09:16, 61.84s/it][A
 10%|█         | 1/10 [01:01<09:17, 61.91s/it][A
 10%|█         | 1/10 [01:01<09:15, 61.76s/it][A
 10%|█         | 1/10 [01:01<09:16, 61.82s/it][A
 10%|█         | 1/10 [01:01<09:15, 61.74s/it][A
 10%|█         | 1/10 [01:01<09:10, 61.17s/it][A
 10%|█         | 1/10 [01:00<09:08, 60.93s/it][A
 20%|██        | 2/10 [02:03<08:13, 61.64s/it][A[2024-05-29 04:43:07,666] [INFO] [logging.py:96:log_dist] [Rank 0] step=242, skipped=0, lr=[1.999203799987328e-05], mom=[(0.9, 0.999)]
steps: 242 loss: 0.6853 iter time (s): 59.717 samples/sec: 2.143

 20%|██        | 2/10 [02:02<08:08, 61.05s/it][A
 20%|██        | 2/10 [02:02<08:08, 61.03s/it][A
 20%|██        | 2/10 [02:02<08:07, 60.96s/it][A
 20%|██        | 2/10 [02:02<08:07, 60.96s/it][A
 20%|██        | 2/10 [02:02<08:07, 60.94s/it][A
 20%|██        | 2/10 [02:01<08:05, 60.72s/it][A
 20%|██        | 2/10 [02:01<08:04, 60.61s/it][A
 30%|███       | 3/10 [03:04<07:07, 61.14s/it][A[2024-05-29 04:44:08,523] [INFO] [logging.py:96:log_dist] [Rank 0] step=243, skipped=0, lr=[1.999181042662562e-05], mom=[(0.9, 0.999)]
steps: 243 loss: 0.6423 iter time (s): 60.165 samples/sec: 2.127

 30%|███       | 3/10 [03:03<07:06, 60.92s/it][A
 30%|███       | 3/10 [03:03<07:06, 60.91s/it][A
 30%|███       | 3/10 [03:03<07:06, 60.91s/it][A
 30%|███       | 3/10 [03:03<07:06, 60.91s/it][A
 30%|███       | 3/10 [03:02<07:06, 60.88s/it][A
 30%|███       | 3/10 [03:02<07:05, 60.75s/it][A
 30%|███       | 3/10 [03:02<07:04, 60.70s/it][A
 40%|████      | 4/10 [04:05<06:05, 60.97s/it][A[2024-05-29 04:45:09,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=244, skipped=0, lr=[1.999157964807798e-05], mom=[(0.9, 0.999)]
steps: 244 loss: 0.6268 iter time (s): 60.129 samples/sec: 2.129

 40%|████      | 4/10 [04:03<06:05, 60.86s/it][A
 40%|████      | 4/10 [04:03<06:05, 60.90s/it][A
 40%|████      | 4/10 [04:03<06:05, 60.84s/it][A
 40%|████      | 4/10 [04:03<06:05, 60.86s/it][A
 40%|████      | 4/10 [04:03<06:05, 60.85s/it][A
 40%|████      | 4/10 [04:03<06:04, 60.77s/it][A
 40%|████      | 4/10 [04:02<06:04, 60.73s/it][A
 50%|█████     | 5/10 [05:04<05:01, 60.32s/it][A[2024-05-29 04:46:08,402] [INFO] [logging.py:96:log_dist] [Rank 0] step=245, skipped=0, lr=[1.999134566430439e-05], mom=[(0.9, 0.999)]
steps: 245 loss: 0.6885 iter time (s): 58.454 samples/sec: 2.190

 50%|█████     | 5/10 [05:02<05:01, 60.23s/it][A
 50%|█████     | 5/10 [05:03<05:01, 60.24s/it][A
 50%|█████     | 5/10 [05:02<05:01, 60.21s/it][A
 50%|█████     | 5/10 [05:02<05:01, 60.23s/it][A
 50%|█████     | 5/10 [05:02<05:01, 60.20s/it][A
 50%|█████     | 5/10 [05:02<05:00, 60.16s/it][A
 50%|█████     | 5/10 [05:01<05:00, 60.14s/it][A
 60%|██████    | 6/10 [06:05<04:02, 60.57s/it][A[2024-05-29 04:47:09,477] [INFO] [logging.py:96:log_dist] [Rank 0] step=246, skipped=0, lr=[1.9991108475379922e-05], mom=[(0.9, 0.999)]
steps: 246 loss: 0.5794 iter time (s): 60.422 samples/sec: 2.118

 60%|██████    | 6/10 [06:04<04:02, 60.53s/it][A
 60%|██████    | 6/10 [06:04<04:02, 60.53s/it][A
 60%|██████    | 6/10 [06:03<04:01, 60.49s/it][A
 60%|██████    | 6/10 [06:03<04:02, 60.50s/it][A
 60%|██████    | 6/10 [06:03<04:02, 60.51s/it][A
 60%|██████    | 6/10 [06:03<04:01, 60.46s/it][A
 60%|██████    | 6/10 [06:03<04:01, 60.49s/it][A
 70%|███████   | 7/10 [07:04<03:00, 60.31s/it][A[2024-05-29 04:48:09,256] [INFO] [logging.py:96:log_dist] [Rank 0] step=247, skipped=0, lr=[1.9990868081380674e-05], mom=[(0.9, 0.999)]
steps: 247 loss: 0.6577 iter time (s): 59.153 samples/sec: 2.164

 70%|███████   | 7/10 [07:03<03:00, 60.29s/it][A
 70%|███████   | 7/10 [07:03<03:00, 60.28s/it][A
 70%|███████   | 7/10 [07:03<03:00, 60.28s/it][A
 70%|███████   | 7/10 [07:03<03:00, 60.28s/it][A
 70%|███████   | 7/10 [07:03<03:00, 60.27s/it][A
 70%|███████   | 7/10 [07:03<03:00, 60.25s/it][A
 70%|███████   | 7/10 [07:02<03:00, 60.24s/it][A
 80%|████████  | 8/10 [08:05<02:00, 60.22s/it][A[2024-05-29 04:49:09,275] [INFO] [logging.py:96:log_dist] [Rank 0] step=248, skipped=0, lr=[1.9990624482383763e-05], mom=[(0.9, 0.999)]
steps: 248 loss: 0.6498 iter time (s): 59.367 samples/sec: 2.156

 80%|████████  | 8/10 [08:03<02:00, 60.19s/it][A
 80%|████████  | 8/10 [08:03<02:00, 60.18s/it][A
 80%|████████  | 8/10 [08:03<02:00, 60.20s/it][A
 80%|████████  | 8/10 [08:03<02:00, 60.20s/it][A
 80%|████████  | 8/10 [08:03<02:00, 60.17s/it][A
 80%|████████  | 8/10 [08:03<02:00, 60.20s/it][A
 80%|████████  | 8/10 [08:02<02:00, 60.17s/it][A
 90%|█████████ | 9/10 [09:04<00:59, 59.99s/it][A[2024-05-29 04:50:08,763] [INFO] [logging.py:96:log_dist] [Rank 0] step=249, skipped=0, lr=[1.999037767846735e-05], mom=[(0.9, 0.999)]
steps: 249 loss: 0.6245 iter time (s): 58.810 samples/sec: 2.176

 90%|█████████ | 9/10 [09:03<00:59, 59.95s/it][A
 90%|█████████ | 9/10 [09:03<00:59, 59.97s/it][A
 90%|█████████ | 9/10 [09:03<00:59, 59.96s/it][A
 90%|█████████ | 9/10 [09:03<00:59, 59.95s/it][A
 90%|█████████ | 9/10 [09:03<00:59, 59.96s/it][A
 90%|█████████ | 9/10 [09:02<00:59, 59.95s/it][A
 90%|█████████ | 9/10 [09:02<00:59, 59.94s/it][A
100%|██████████| 10/10 [10:05<00:00, 60.20s/it][A100%|██████████| 10/10 [10:05<00:00, 60.52s/it]
  5%|▍         | 25/520 [4:13:27<106:56:16, 777.73s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 04:51:09,425] [INFO] [logging.py:96:log_dist] [Rank 0] step=250, skipped=0, lr=[1.9990127669710612e-05], mom=[(0.9, 0.999)]
steps: 250 loss: 0.5879 iter time (s): 60.067 samples/sec: 2.131

100%|██████████| 10/10 [10:04<00:00, 60.22s/it][A100%|██████████| 10/10 [10:04<00:00, 60.41s/it]
  5%|▍         | 25/520 [4:12:59<106:54:53, 777.56s/it]
100%|██████████| 10/10 [10:04<00:00, 60.19s/it][A100%|██████████| 10/10 [10:04<00:00, 60.40s/it]
  5%|▍         | 25/520 [4:13:33<106:55:15, 777.61s/it]
100%|██████████| 10/10 [10:03<00:00, 60.18s/it][A100%|██████████| 10/10 [10:03<00:00, 60.39s/it]
  5%|▍         | 25/520 [4:13:06<106:54:46, 777.55s/it]
100%|██████████| 10/10 [10:03<00:00, 60.19s/it][A100%|██████████| 10/10 [10:03<00:00, 60.39s/it]
  5%|▍         | 25/520 [4:12:50<106:54:33, 777.52s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:03<00:00, 60.19s/it][A100%|██████████| 10/10 [10:03<00:00, 60.38s/it]
  5%|▍         | 25/520 [4:13:35<106:55:16, 777.61s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:03<00:00, 60.18s/it][A100%|██████████| 10/10 [10:03<00:00, 60.33s/it]
  5%|▍         | 25/520 [4:13:15<106:54:27, 777.51s/it]
100%|██████████| 10/10 [10:03<00:00, 60.18s/it][A
100%|██████████| 10/10 [10:03<00:00, 60.30s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A  5%|▍         | 25/520 [4:13:21<106:54:26, 777.51s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_21
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:41<15:17, 101.97s/it][A[2024-05-29 04:52:52,520] [INFO] [logging.py:96:log_dist] [Rank 0] step=251, skipped=0, lr=[1.998987445619376e-05], mom=[(0.9, 0.999)]
steps: 251 loss: 0.8840 iter time (s): 102.281 samples/sec: 1.251

 10%|█         | 1/10 [01:42<15:25, 102.88s/it][A
 10%|█         | 1/10 [01:42<15:26, 103.00s/it][A
 10%|█         | 1/10 [01:43<15:28, 103.12s/it][A
 10%|█         | 1/10 [01:43<15:28, 103.11s/it][A
 10%|█         | 1/10 [01:43<15:28, 103.19s/it][A
 10%|█         | 1/10 [01:43<15:29, 103.23s/it][A
 10%|█         | 1/10 [01:43<15:29, 103.27s/it][A
 20%|██        | 2/10 [03:24<13:38, 102.28s/it][A[2024-05-29 04:54:35,033] [INFO] [logging.py:96:log_dist] [Rank 0] step=252, skipped=0, lr=[1.9989618037998025e-05], mom=[(0.9, 0.999)]
steps: 252 loss: 0.8759 iter time (s): 101.587 samples/sec: 1.260

 20%|██        | 2/10 [03:25<13:41, 102.71s/it][A
 20%|██        | 2/10 [03:25<13:42, 102.82s/it][A
 20%|██        | 2/10 [03:25<13:42, 102.83s/it][A
 20%|██        | 2/10 [03:25<13:42, 102.79s/it][A
 20%|██        | 2/10 [03:25<13:42, 102.80s/it][A
 20%|██        | 2/10 [03:25<13:42, 102.82s/it][A
 20%|██        | 2/10 [03:25<13:42, 102.85s/it][A
 30%|███       | 3/10 [05:05<11:52, 101.78s/it][A[2024-05-29 04:56:16,246] [INFO] [logging.py:96:log_dist] [Rank 0] step=253, skipped=0, lr=[1.998935841520568e-05], mom=[(0.9, 0.999)]
steps: 253 loss: 0.8717 iter time (s): 100.276 samples/sec: 1.276

 30%|███       | 3/10 [05:06<11:54, 102.08s/it][A
 30%|███       | 3/10 [05:06<11:54, 102.09s/it][A
 30%|███       | 3/10 [05:06<11:54, 102.10s/it][A
 30%|███       | 3/10 [05:06<11:54, 102.11s/it][A
 30%|███       | 3/10 [05:07<11:55, 102.16s/it][A
 30%|███       | 3/10 [05:07<11:55, 102.15s/it][A
 30%|███       | 3/10 [05:07<11:55, 102.16s/it][A
 40%|████      | 4/10 [06:48<10:12, 102.07s/it][A[2024-05-29 04:57:58,730] [INFO] [logging.py:96:log_dist] [Rank 0] step=254, skipped=0, lr=[1.9989095587900017e-05], mom=[(0.9, 0.999)]
steps: 254 loss: 0.8728 iter time (s): 101.411 samples/sec: 1.262

 40%|████      | 4/10 [06:49<10:12, 102.16s/it][A
 40%|████      | 4/10 [06:49<10:12, 102.16s/it][A
 40%|████      | 4/10 [06:49<10:13, 102.21s/it][A
 40%|████      | 4/10 [06:49<10:13, 102.21s/it][A
 40%|████      | 4/10 [06:49<10:13, 102.20s/it][A
 40%|████      | 4/10 [06:49<10:13, 102.20s/it][A
 40%|████      | 4/10 [06:49<10:13, 102.20s/it][A
 50%|█████     | 5/10 [08:30<08:30, 102.13s/it][A[2024-05-29 04:59:40,975] [INFO] [logging.py:96:log_dist] [Rank 0] step=255, skipped=0, lr=[1.9988829556165354e-05], mom=[(0.9, 0.999)]
steps: 255 loss: 0.8675 iter time (s): 101.423 samples/sec: 1.262

 50%|█████     | 5/10 [08:31<08:31, 102.21s/it][A
 50%|█████     | 5/10 [08:31<08:30, 102.20s/it][A
 50%|█████     | 5/10 [08:31<08:31, 102.21s/it][A
 50%|█████     | 5/10 [08:31<08:31, 102.23s/it][A
 50%|█████     | 5/10 [08:31<08:31, 102.22s/it][A
 50%|█████     | 5/10 [08:31<08:31, 102.23s/it][A
 50%|█████     | 5/10 [08:31<08:31, 102.24s/it][A
 60%|██████    | 6/10 [10:13<06:50, 102.62s/it][A[2024-05-29 05:01:24,523] [INFO] [logging.py:96:log_dist] [Rank 0] step=256, skipped=0, lr=[1.9988560320087043e-05], mom=[(0.9, 0.999)]
steps: 256 loss: 0.8599 iter time (s): 102.653 samples/sec: 1.247

 60%|██████    | 6/10 [10:14<06:50, 102.68s/it][A
 60%|██████    | 6/10 [10:15<06:50, 102.67s/it][A
 60%|██████    | 6/10 [10:15<06:50, 102.69s/it][A
 60%|██████    | 6/10 [10:15<06:50, 102.69s/it][A
 60%|██████    | 6/10 [10:15<06:50, 102.70s/it][A
 60%|██████    | 6/10 [10:15<06:50, 102.70s/it][A
 60%|██████    | 6/10 [10:15<06:50, 102.70s/it][A
 70%|███████   | 7/10 [11:55<05:07, 102.42s/it][A[2024-05-29 05:03:06,532] [INFO] [logging.py:96:log_dist] [Rank 0] step=257, skipped=0, lr=[1.9988287879751463e-05], mom=[(0.9, 0.999)]
steps: 257 loss: 0.8690 iter time (s): 101.040 samples/sec: 1.267

 70%|███████   | 7/10 [11:56<05:07, 102.43s/it][A
 70%|███████   | 7/10 [11:57<05:07, 102.46s/it][A
 70%|███████   | 7/10 [11:57<05:07, 102.48s/it][A
 70%|███████   | 7/10 [11:57<05:07, 102.45s/it][A
 70%|███████   | 7/10 [11:57<05:07, 102.45s/it][A
 70%|███████   | 7/10 [11:57<05:07, 102.47s/it][A
 70%|███████   | 7/10 [11:57<05:07, 102.46s/it][A
 80%|████████  | 8/10 [13:38<03:25, 102.51s/it][A[2024-05-29 05:04:49,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=258, skipped=0, lr=[1.9988012235246012e-05], mom=[(0.9, 0.999)]
steps: 258 loss: 0.8797 iter time (s): 101.801 samples/sec: 1.257

 80%|████████  | 8/10 [13:39<03:25, 102.52s/it][A
 80%|████████  | 8/10 [13:39<03:25, 102.54s/it][A
 80%|████████  | 8/10 [13:39<03:25, 102.56s/it][A
 80%|████████  | 8/10 [13:39<03:25, 102.54s/it][A
 80%|████████  | 8/10 [13:39<03:25, 102.54s/it][A
 80%|████████  | 8/10 [13:39<03:25, 102.54s/it][A
 80%|████████  | 8/10 [13:40<03:25, 102.54s/it][A
 90%|█████████ | 9/10 [15:21<01:42, 102.63s/it][A[2024-05-29 05:06:32,133] [INFO] [logging.py:96:log_dist] [Rank 0] step=259, skipped=0, lr=[1.9987733386659135e-05], mom=[(0.9, 0.999)]
steps: 259 loss: 0.8806 iter time (s): 101.926 samples/sec: 1.256

 90%|█████████ | 9/10 [15:22<01:42, 102.63s/it][A
 90%|█████████ | 9/10 [15:22<01:42, 102.63s/it][A
 90%|█████████ | 9/10 [15:22<01:42, 102.62s/it][A
 90%|█████████ | 9/10 [15:22<01:42, 102.63s/it][A
 90%|█████████ | 9/10 [15:22<01:42, 102.64s/it][A
 90%|█████████ | 9/10 [15:22<01:42, 102.63s/it][A
 90%|█████████ | 9/10 [15:22<01:42, 102.63s/it][A
100%|██████████| 10/10 [17:05<00:00, 103.04s/it][A100%|██████████| 10/10 [17:05<00:00, 102.55s/it]
  5%|▌         | 26/520 [4:30:32<116:48:49, 851.27s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 05:08:16,119] [INFO] [logging.py:96:log_dist] [Rank 0] step=260, skipped=0, lr=[1.9987451334080285e-05], mom=[(0.9, 0.999)]
steps: 260 loss: 0.8763 iter time (s): 103.144 samples/sec: 1.241

100%|██████████| 10/10 [17:06<00:00, 103.04s/it][A100%|██████████| 10/10 [17:06<00:00, 102.64s/it]
  5%|▌         | 26/520 [4:30:05<116:50:35, 851.49s/it]
100%|██████████| 10/10 [17:06<00:00, 103.05s/it][A100%|██████████| 10/10 [17:06<00:00, 102.66s/it]
  5%|▌         | 26/520 [4:30:40<116:51:11, 851.56s/it]
100%|██████████| 10/10 [17:06<00:00, 103.04s/it][A100%|██████████| 10/10 [17:06<00:00, 102.67s/it]
  5%|▌         | 26/520 [4:30:13<116:50:58, 851.54s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:06<00:00, 103.06s/it][A100%|██████████| 10/10 [17:06<00:00, 102.67s/it]
  5%|▌         | 26/520 [4:29:57<116:50:56, 851.53s/it]
100%|██████████| 10/10 [17:06<00:00, 103.05s/it][A100%|██████████| 10/10 [17:06<00:00, 102.68s/it]
  5%|▌         | 26/520 [4:30:42<116:51:22, 851.58s/it]
100%|██████████| 10/10 [17:06<00:00, 103.06s/it][A100%|██████████| 10/10 [17:06<00:00, 102.68s/it]
  5%|▌         | 26/520 [4:30:22<116:50:51, 851.52s/it]
100%|██████████| 10/10 [17:06<00:00, 103.05s/it][A100%|██████████| 10/10 [17:06<00:00, 102.68s/it]
  5%|▌         | 26/520 [4:30:28<116:50:52, 851.52s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_50

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:08<10:15, 68.37s/it][A[2024-05-29 05:09:23,747] [INFO] [logging.py:96:log_dist] [Rank 0] step=261, skipped=0, lr=[1.9987166077599955e-05], mom=[(0.9, 0.999)]
steps: 261 loss: 1.3625 iter time (s): 66.477 samples/sec: 1.925

 10%|█         | 1/10 [01:07<10:05, 67.29s/it][A
 10%|█         | 1/10 [01:07<10:06, 67.38s/it][A
 10%|█         | 1/10 [01:07<10:06, 67.38s/it][A
 10%|█         | 1/10 [01:07<10:08, 67.65s/it][A
 10%|█         | 1/10 [01:07<10:07, 67.47s/it][A
 10%|█         | 1/10 [01:07<10:06, 67.43s/it][A
 10%|█         | 1/10 [01:07<10:07, 67.48s/it][A
 20%|██        | 2/10 [02:16<09:04, 68.02s/it][A[2024-05-29 05:10:31,521] [INFO] [logging.py:96:log_dist] [Rank 0] step=262, skipped=0, lr=[1.9986877617309664e-05], mom=[(0.9, 0.999)]
steps: 262 loss: 1.3330 iter time (s): 66.885 samples/sec: 1.914

 20%|██        | 2/10 [02:14<09:00, 67.52s/it][A
 20%|██        | 2/10 [02:15<09:00, 67.60s/it][A
 20%|██        | 2/10 [02:15<09:00, 67.60s/it][A
 20%|██        | 2/10 [02:15<09:00, 67.59s/it][A
 20%|██        | 2/10 [02:15<09:00, 67.59s/it][A
 20%|██        | 2/10 [02:15<09:00, 67.54s/it][A
 20%|██        | 2/10 [02:15<09:00, 67.55s/it][A
 30%|███       | 3/10 [03:24<07:56, 68.05s/it][A[2024-05-29 05:11:39,602] [INFO] [logging.py:96:log_dist] [Rank 0] step=263, skipped=0, lr=[1.998658595330195e-05], mom=[(0.9, 0.999)]
steps: 263 loss: 1.3463 iter time (s): 67.359 samples/sec: 1.900

 30%|███       | 3/10 [03:23<07:54, 67.79s/it][A
 30%|███       | 3/10 [03:23<07:54, 67.80s/it][A
 30%|███       | 3/10 [03:23<07:54, 67.79s/it][A
 30%|███       | 3/10 [03:23<07:54, 67.78s/it][A
 30%|███       | 3/10 [03:23<07:54, 67.81s/it][A
 30%|███       | 3/10 [03:23<07:54, 67.77s/it][A
 30%|███       | 3/10 [03:23<07:54, 67.79s/it][A
 40%|████      | 4/10 [04:32<06:48, 68.15s/it][A[2024-05-29 05:12:47,915] [INFO] [logging.py:96:log_dist] [Rank 0] step=264, skipped=0, lr=[1.9986291085670394e-05], mom=[(0.9, 0.999)]
steps: 264 loss: 1.3340 iter time (s): 67.655 samples/sec: 1.892

 40%|████      | 4/10 [04:31<06:47, 67.99s/it][A
 40%|████      | 4/10 [04:31<06:48, 68.00s/it][A
 40%|████      | 4/10 [04:31<06:48, 68.01s/it][A
 40%|████      | 4/10 [04:31<06:47, 68.00s/it][A
 40%|████      | 4/10 [04:31<06:48, 68.02s/it][A
 40%|████      | 4/10 [04:31<06:48, 68.00s/it][A
 40%|████      | 4/10 [04:31<06:48, 68.01s/it][A
 50%|█████     | 5/10 [05:37<05:35, 67.18s/it][A[2024-05-29 05:13:53,367] [INFO] [logging.py:96:log_dist] [Rank 0] step=265, skipped=0, lr=[1.9985993014509595e-05], mom=[(0.9, 0.999)]
steps: 265 loss: 1.3144 iter time (s): 64.763 samples/sec: 1.976

 50%|█████     | 5/10 [05:36<05:35, 67.09s/it][A
 50%|█████     | 5/10 [05:37<05:35, 67.11s/it][A
 50%|█████     | 5/10 [05:37<05:35, 67.10s/it][A
 50%|█████     | 5/10 [05:36<05:35, 67.10s/it][A
 50%|█████     | 5/10 [05:36<05:35, 67.10s/it][A
 50%|█████     | 5/10 [05:36<05:35, 67.09s/it][A
 50%|█████     | 5/10 [05:36<05:35, 67.09s/it][A
 60%|██████    | 6/10 [06:44<04:27, 66.93s/it][A[2024-05-29 05:14:59,819] [INFO] [logging.py:96:log_dist] [Rank 0] step=266, skipped=0, lr=[1.9985691739915178e-05], mom=[(0.9, 0.999)]
steps: 266 loss: 1.3180 iter time (s): 65.703 samples/sec: 1.948

 60%|██████    | 6/10 [06:43<04:27, 66.86s/it][A
 60%|██████    | 6/10 [06:43<04:27, 66.87s/it][A
 60%|██████    | 6/10 [06:43<04:27, 66.87s/it][A
 60%|██████    | 6/10 [06:43<04:27, 66.86s/it][A
 60%|██████    | 6/10 [06:43<04:27, 66.87s/it][A
 60%|██████    | 6/10 [06:43<04:27, 66.85s/it][A
 60%|██████    | 6/10 [06:43<04:27, 66.86s/it][A
 70%|███████   | 7/10 [07:51<03:21, 67.08s/it][A[2024-05-29 05:16:06,980] [INFO] [logging.py:96:log_dist] [Rank 0] step=267, skipped=0, lr=[1.9985387261983802e-05], mom=[(0.9, 0.999)]
steps: 267 loss: 1.2957 iter time (s): 66.536 samples/sec: 1.924

 70%|███████   | 7/10 [07:50<03:20, 66.97s/it][A
 70%|███████   | 7/10 [07:50<03:20, 66.98s/it][A
 70%|███████   | 7/10 [07:50<03:20, 66.97s/it][A
 70%|███████   | 7/10 [07:50<03:20, 66.96s/it][A
 70%|███████   | 7/10 [07:50<03:20, 66.98s/it][A
 70%|███████   | 7/10 [07:50<03:20, 66.98s/it][A
 70%|███████   | 7/10 [07:50<03:20, 66.98s/it][A
 80%|████████  | 8/10 [08:58<02:13, 66.98s/it][A[2024-05-29 05:17:13,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=268, skipped=0, lr=[1.998507958081315e-05], mom=[(0.9, 0.999)]
steps: 268 loss: 1.2888 iter time (s): 66.250 samples/sec: 1.932

 80%|████████  | 8/10 [08:57<02:13, 66.99s/it][A
 80%|████████  | 8/10 [08:57<02:13, 66.96s/it][A
 80%|████████  | 8/10 [08:57<02:13, 66.98s/it][A
 80%|████████  | 8/10 [08:57<02:13, 66.97s/it][A
 80%|████████  | 8/10 [08:57<02:13, 66.97s/it][A
 80%|████████  | 8/10 [08:57<02:13, 66.96s/it][A
 80%|████████  | 8/10 [08:57<02:13, 66.97s/it][A
 90%|█████████ | 9/10 [10:05<01:06, 66.91s/it][A[2024-05-29 05:18:20,726] [INFO] [logging.py:96:log_dist] [Rank 0] step=269, skipped=0, lr=[1.998476869650194e-05], mom=[(0.9, 0.999)]
steps: 269 loss: 1.2806 iter time (s): 66.070 samples/sec: 1.937

 90%|█████████ | 9/10 [10:04<01:06, 66.91s/it][A
 90%|█████████ | 9/10 [10:04<01:06, 66.91s/it][A
 90%|█████████ | 9/10 [10:04<01:06, 66.92s/it][A
 90%|█████████ | 9/10 [10:04<01:06, 66.90s/it][A
 90%|█████████ | 9/10 [10:04<01:06, 66.92s/it][A
 90%|█████████ | 9/10 [10:04<01:06, 66.91s/it][A
 90%|█████████ | 9/10 [10:04<01:06, 66.91s/it][A
100%|██████████| 10/10 [11:13<00:00, 67.23s/it][A100%|██████████| 10/10 [11:13<00:00, 67.33s/it]
  5%|▌         | 27/520 [4:41:46<109:19:42, 798.34s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 05:19:28,686] [INFO] [logging.py:96:log_dist] [Rank 0] step=270, skipped=0, lr=[1.9984454609149903e-05], mom=[(0.9, 0.999)]
steps: 270 loss: 1.2704 iter time (s): 67.198 samples/sec: 1.905

100%|██████████| 10/10 [11:12<00:00, 67.21s/it][A100%|██████████| 10/10 [11:12<00:00, 67.21s/it]
  5%|▌         | 27/520 [4:41:18<109:18:30, 798.20s/it]
100%|██████████| 10/10 [11:12<00:00, 67.21s/it][A100%|██████████| 10/10 [11:12<00:00, 67.22s/it]
  5%|▌         | 27/520 [4:41:53<109:18:46, 798.23s/it]
100%|██████████| 10/10 [11:12<00:00, 67.20s/it][A100%|██████████| 10/10 [11:12<00:00, 67.23s/it]
  5%|▌         | 27/520 [4:41:26<109:18:23, 798.18s/it]
  0%|          | 0/10 [00:00<?, ?it/s]
[A  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:12<00:00, 67.21s/it][A100%|██████████| 10/10 [11:12<00:00, 67.22s/it]
  5%|▌         | 27/520 [4:41:10<109:18:25, 798.19s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:12<00:00, 67.22s/it][A100%|██████████| 10/10 [11:12<00:00, 67.22s/it]
  5%|▌         | 27/520 [4:41:34<109:18:23, 798.18s/it]
100%|██████████| 10/10 [11:12<00:00, 67.24s/it][A100%|██████████| 10/10 [11:12<00:00, 67.23s/it]
  5%|▌         | 27/520 [4:41:54<109:18:53, 798.24s/it]
100%|██████████| 10/10 [11:12<00:00, 67.22s/it][A100%|██████████| 10/10 [11:12<00:00, 67.22s/it]
  5%|▌         | 27/520 [4:41:41<109:18:25, 798.18s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_96

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:18<11:42, 78.03s/it][A[2024-05-29 05:20:46,996] [INFO] [logging.py:96:log_dist] [Rank 0] step=271, skipped=0, lr=[1.9984137318857806e-05], mom=[(0.9, 0.999)]
steps: 271 loss: 1.1467 iter time (s): 77.374 samples/sec: 1.654

 10%|█         | 1/10 [01:18<11:43, 78.18s/it][A
 10%|█         | 1/10 [01:18<11:44, 78.30s/it][A
 10%|█         | 1/10 [01:18<11:45, 78.39s/it][A
 10%|█         | 1/10 [01:18<11:44, 78.24s/it][A
 10%|█         | 1/10 [01:18<11:43, 78.22s/it][A
 10%|█         | 1/10 [01:18<11:43, 78.21s/it][A
 10%|█         | 1/10 [01:18<11:43, 78.20s/it][A
 20%|██        | 2/10 [02:36<10:24, 78.09s/it][A[2024-05-29 05:22:05,130] [INFO] [logging.py:96:log_dist] [Rank 0] step=272, skipped=0, lr=[1.998381682572745e-05], mom=[(0.9, 0.999)]
steps: 272 loss: 1.1519 iter time (s): 77.450 samples/sec: 1.653

 20%|██        | 2/10 [02:36<10:25, 78.13s/it][A
 20%|██        | 2/10 [02:36<10:25, 78.24s/it][A
 20%|██        | 2/10 [02:36<10:25, 78.24s/it][A
 20%|██        | 2/10 [02:36<10:26, 78.36s/it][A
 20%|██        | 2/10 [02:36<10:26, 78.27s/it][A
 20%|██        | 2/10 [02:36<10:27, 78.47s/it][A
 20%|██        | 2/10 [02:36<10:27, 78.48s/it][A
 30%|███       | 3/10 [03:54<09:08, 78.30s/it][A[2024-05-29 05:23:23,690] [INFO] [logging.py:96:log_dist] [Rank 0] step=273, skipped=0, lr=[1.9983493129861654e-05], mom=[(0.9, 0.999)]
steps: 273 loss: 1.1352 iter time (s): 77.338 samples/sec: 1.655

 30%|███       | 3/10 [03:55<09:08, 78.39s/it][A
 30%|███       | 3/10 [03:55<09:09, 78.45s/it][A
 30%|███       | 3/10 [03:55<09:09, 78.47s/it][A
 30%|███       | 3/10 [03:55<09:09, 78.46s/it][A
 30%|███       | 3/10 [03:55<09:09, 78.44s/it][A
 30%|███       | 3/10 [03:55<09:08, 78.38s/it][A
 30%|███       | 3/10 [03:55<09:08, 78.38s/it][A
 40%|████      | 4/10 [05:12<07:48, 78.02s/it][A[2024-05-29 05:24:41,286] [INFO] [logging.py:96:log_dist] [Rank 0] step=274, skipped=0, lr=[1.9983166231364267e-05], mom=[(0.9, 0.999)]
steps: 274 loss: 1.1438 iter time (s): 76.666 samples/sec: 1.670

 40%|████      | 4/10 [05:12<07:48, 78.01s/it][A
 40%|████      | 4/10 [05:12<07:48, 78.04s/it][A
 40%|████      | 4/10 [05:12<07:48, 78.02s/it][A
 40%|████      | 4/10 [05:12<07:48, 78.04s/it][A
 40%|████      | 4/10 [05:12<07:48, 78.02s/it][A
 40%|████      | 4/10 [05:12<07:47, 77.99s/it][A
 40%|████      | 4/10 [05:12<07:47, 77.99s/it][A
 50%|█████     | 5/10 [06:29<06:28, 77.76s/it][A[2024-05-29 05:25:58,566] [INFO] [logging.py:96:log_dist] [Rank 0] step=275, skipped=0, lr=[1.9982836130340166e-05], mom=[(0.9, 0.999)]
steps: 275 loss: 1.1276 iter time (s): 76.520 samples/sec: 1.673

 50%|█████     | 5/10 [06:29<06:28, 77.78s/it][A
 50%|█████     | 5/10 [06:29<06:28, 77.77s/it][A
 50%|█████     | 5/10 [06:30<06:28, 77.80s/it][A
 50%|█████     | 5/10 [06:29<06:28, 77.77s/it][A
 50%|█████     | 5/10 [06:29<06:28, 77.75s/it][A
 50%|█████     | 5/10 [06:29<06:28, 77.74s/it][A
 50%|█████     | 5/10 [06:29<06:28, 77.74s/it][A
 60%|██████    | 6/10 [07:49<05:13, 78.36s/it][A[2024-05-29 05:27:18,092] [INFO] [logging.py:96:log_dist] [Rank 0] step=276, skipped=0, lr=[1.9982502826895257e-05], mom=[(0.9, 0.999)]
steps: 276 loss: 1.1606 iter time (s): 78.857 samples/sec: 1.623

 60%|██████    | 6/10 [07:49<05:13, 78.36s/it][A
 60%|██████    | 6/10 [07:49<05:13, 78.43s/it][A
 60%|██████    | 6/10 [07:49<05:13, 78.38s/it][A
 60%|██████    | 6/10 [07:49<05:13, 78.37s/it][A
 60%|██████    | 6/10 [07:49<05:13, 78.37s/it][A
 60%|██████    | 6/10 [07:49<05:13, 78.36s/it][A
 60%|██████    | 6/10 [07:49<05:13, 78.36s/it][A
 70%|███████   | 7/10 [09:05<03:53, 77.78s/it][A[2024-05-29 05:28:34,672] [INFO] [logging.py:96:log_dist] [Rank 0] step=277, skipped=0, lr=[1.9982166321136472e-05], mom=[(0.9, 0.999)]
steps: 277 loss: 1.1247 iter time (s): 75.847 samples/sec: 1.688

 70%|███████   | 7/10 [09:05<03:53, 77.78s/it][A
 70%|███████   | 7/10 [09:06<03:53, 77.79s/it][A
 70%|███████   | 7/10 [09:06<03:53, 77.80s/it][A
 70%|███████   | 7/10 [09:06<03:53, 77.80s/it][A
 70%|███████   | 7/10 [09:06<03:53, 77.80s/it][A
 70%|███████   | 7/10 [09:05<03:53, 77.78s/it][A
 70%|███████   | 7/10 [09:05<03:53, 77.78s/it][A
 80%|████████  | 8/10 [10:24<02:35, 77.98s/it][A[2024-05-29 05:29:53,109] [INFO] [logging.py:96:log_dist] [Rank 0] step=278, skipped=0, lr=[1.9981826613171765e-05], mom=[(0.9, 0.999)]
steps: 278 loss: 1.1123 iter time (s): 77.649 samples/sec: 1.648

 80%|████████  | 8/10 [10:24<02:35, 77.97s/it][A
 80%|████████  | 8/10 [10:24<02:35, 77.99s/it][A
 80%|████████  | 8/10 [10:24<02:36, 78.00s/it][A
 80%|████████  | 8/10 [10:24<02:35, 77.99s/it][A
 80%|████████  | 8/10 [10:24<02:35, 77.97s/it][A
 80%|████████  | 8/10 [10:24<02:35, 77.98s/it][A
 80%|████████  | 8/10 [10:24<02:35, 77.98s/it][A
 90%|█████████ | 9/10 [11:41<01:17, 77.85s/it][A[2024-05-29 05:31:10,643] [INFO] [logging.py:96:log_dist] [Rank 0] step=279, skipped=0, lr=[1.9981483703110132e-05], mom=[(0.9, 0.999)]
steps: 279 loss: 1.1257 iter time (s): 76.806 samples/sec: 1.667

 90%|█████████ | 9/10 [11:41<01:17, 77.86s/it][A
 90%|█████████ | 9/10 [11:42<01:17, 77.85s/it][A
 90%|█████████ | 9/10 [11:42<01:17, 77.84s/it][A
 90%|█████████ | 9/10 [11:41<01:17, 77.86s/it][A
 90%|█████████ | 9/10 [11:41<01:17, 77.85s/it][A
 90%|█████████ | 9/10 [11:41<01:17, 77.84s/it][A
 90%|█████████ | 9/10 [11:41<01:17, 77.84s/it][A
100%|██████████| 10/10 [12:59<00:00, 77.83s/it][A100%|██████████| 10/10 [12:59<00:00, 77.95s/it]
  5%|▌         | 28/520 [4:54:45<108:20:17, 792.72s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 05:32:28,442] [INFO] [logging.py:96:log_dist] [Rank 0] step=280, skipped=0, lr=[1.9981137591061585e-05], mom=[(0.9, 0.999)]
steps: 280 loss: 1.1012 iter time (s): 77.041 samples/sec: 1.661

100%|██████████| 10/10 [12:59<00:00, 77.84s/it][A100%|██████████| 10/10 [12:59<00:00, 77.97s/it]
  5%|▌         | 28/520 [4:54:18<108:20:21, 792.73s/it]
100%|██████████| 10/10 [12:59<00:00, 77.81s/it][A100%|██████████| 10/10 [12:59<00:00, 77.97s/it]
  5%|▌         | 28/520 [4:54:52<108:20:20, 792.72s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:59<00:00, 77.81s/it][A100%|██████████| 10/10 [12:59<00:00, 77.98s/it]
  5%|▌         | 28/520 [4:54:25<108:20:13, 792.71s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:59<00:00, 77.83s/it][A100%|██████████| 10/10 [12:59<00:00, 77.98s/it]
  5%|▌         | 28/520 [4:54:09<108:20:11, 792.71s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:59<00:00, 77.83s/it][A100%|██████████| 10/10 [12:59<00:00, 77.97s/it]
  5%|▌         | 28/520 [4:54:54<108:20:27, 792.74s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:59<00:00, 77.82s/it][A100%|██████████| 10/10 [12:59<00:00, 77.97s/it]
  5%|▌         | 28/520 [4:54:34<108:20:09, 792.70s/it]
100%|██████████| 10/10 [12:59<00:00, 77.82s/it][A100%|██████████| 10/10 [12:59<00:00, 77.97s/it]
  5%|▌         | 28/520 [4:54:41<108:20:11, 792.71s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_196
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [00:59<08:58, 59.87s/it][A[2024-05-29 05:33:28,090] [INFO] [logging.py:96:log_dist] [Rank 0] step=281, skipped=0, lr=[1.9980788277137157e-05], mom=[(0.9, 0.999)]
steps: 281 loss: 0.7312 iter time (s): 58.698 samples/sec: 2.181

 10%|█         | 1/10 [00:59<08:54, 59.41s/it][A
 10%|█         | 1/10 [00:59<08:55, 59.52s/it][A
 10%|█         | 1/10 [00:59<08:55, 59.48s/it][A
 10%|█         | 1/10 [00:59<08:56, 59.56s/it][A
 10%|█         | 1/10 [00:59<08:55, 59.53s/it][A
 10%|█         | 1/10 [00:59<08:55, 59.46s/it][A
 10%|█         | 1/10 [00:59<08:54, 59.42s/it][A
 20%|██        | 2/10 [02:00<08:01, 60.17s/it][A[2024-05-29 05:34:28,467] [INFO] [logging.py:96:log_dist] [Rank 0] step=282, skipped=0, lr=[1.9980435761448926e-05], mom=[(0.9, 0.999)]
steps: 282 loss: 0.6369 iter time (s): 59.743 samples/sec: 2.143

 20%|██        | 2/10 [01:59<07:59, 59.98s/it][A
 20%|██        | 2/10 [01:59<08:00, 60.01s/it][A
 20%|██        | 2/10 [01:59<08:00, 60.00s/it][A
 20%|██        | 2/10 [01:59<08:00, 60.04s/it][A
 20%|██        | 2/10 [01:59<08:00, 60.07s/it][A
 20%|██        | 2/10 [01:59<07:59, 59.99s/it][A
 20%|██        | 2/10 [01:59<08:00, 60.02s/it][A
 30%|███       | 3/10 [03:01<07:03, 60.54s/it][A[2024-05-29 05:35:29,301] [INFO] [logging.py:96:log_dist] [Rank 0] step=283, skipped=0, lr=[1.9980080044109983e-05], mom=[(0.9, 0.999)]
steps: 283 loss: 0.6868 iter time (s): 60.152 samples/sec: 2.128

 30%|███       | 3/10 [03:00<07:02, 60.35s/it][A
 30%|███       | 3/10 [03:00<07:02, 60.38s/it][A
 30%|███       | 3/10 [03:00<07:02, 60.39s/it][A
 30%|███       | 3/10 [03:00<07:02, 60.37s/it][A
 30%|███       | 3/10 [03:00<07:02, 60.38s/it][A
 30%|███       | 3/10 [03:00<07:02, 60.35s/it][A
 30%|███       | 3/10 [03:00<07:02, 60.37s/it][A
 40%|████      | 4/10 [04:02<06:04, 60.70s/it][A[2024-05-29 05:36:30,405] [INFO] [logging.py:96:log_dist] [Rank 0] step=284, skipped=0, lr=[1.997972112523445e-05], mom=[(0.9, 0.999)]
steps: 284 loss: 0.6733 iter time (s): 60.486 samples/sec: 2.116

 40%|████      | 4/10 [04:01<06:03, 60.65s/it][A
 40%|████      | 4/10 [04:01<06:04, 60.69s/it][A
 40%|████      | 4/10 [04:01<06:04, 60.69s/it][A
 40%|████      | 4/10 [04:01<06:03, 60.67s/it][A
 40%|████      | 4/10 [04:01<06:04, 60.69s/it][A
 40%|████      | 4/10 [04:01<06:04, 60.67s/it][A
 40%|████      | 4/10 [04:01<06:04, 60.67s/it][A
 50%|█████     | 5/10 [05:02<05:02, 60.51s/it][A[2024-05-29 05:37:30,570] [INFO] [logging.py:96:log_dist] [Rank 0] step=285, skipped=0, lr=[1.9979359004937486e-05], mom=[(0.9, 0.999)]
steps: 285 loss: 0.7067 iter time (s): 59.514 samples/sec: 2.151

 50%|█████     | 5/10 [05:01<05:02, 60.48s/it][A
 50%|█████     | 5/10 [05:01<05:02, 60.48s/it][A
 50%|█████     | 5/10 [05:01<05:02, 60.46s/it][A
 50%|█████     | 5/10 [05:02<05:02, 60.49s/it][A
 50%|█████     | 5/10 [05:02<05:02, 60.49s/it][A
 50%|█████     | 5/10 [05:01<05:02, 60.48s/it][A
 50%|█████     | 5/10 [05:01<05:02, 60.48s/it][A
 60%|██████    | 6/10 [06:03<04:02, 60.68s/it][A[2024-05-29 05:38:31,565] [INFO] [logging.py:96:log_dist] [Rank 0] step=286, skipped=0, lr=[1.9978993683335252e-05], mom=[(0.9, 0.999)]
steps: 286 loss: 0.6476 iter time (s): 60.319 samples/sec: 2.122

 60%|██████    | 6/10 [06:02<04:02, 60.65s/it][A
 60%|██████    | 6/10 [06:02<04:02, 60.64s/it][A
 60%|██████    | 6/10 [06:02<04:02, 60.65s/it][A
 60%|██████    | 6/10 [06:03<04:02, 60.66s/it][A
 60%|██████    | 6/10 [06:02<04:02, 60.64s/it][A
 60%|██████    | 6/10 [06:03<04:02, 60.67s/it][A
 60%|██████    | 6/10 [06:02<04:02, 60.65s/it][A
 70%|███████   | 7/10 [07:03<03:01, 60.38s/it][A[2024-05-29 05:39:31,345] [INFO] [logging.py:96:log_dist] [Rank 0] step=287, skipped=0, lr=[1.9978625160544965e-05], mom=[(0.9, 0.999)]
steps: 287 loss: 0.6889 iter time (s): 59.154 samples/sec: 2.164

 70%|███████   | 7/10 [07:02<03:01, 60.38s/it][A
 70%|███████   | 7/10 [07:02<03:01, 60.37s/it][A
 70%|███████   | 7/10 [07:02<03:01, 60.37s/it][A
 70%|███████   | 7/10 [07:02<03:01, 60.35s/it][A
 70%|███████   | 7/10 [07:02<03:01, 60.36s/it][A
 70%|███████   | 7/10 [07:02<03:01, 60.36s/it][A
 70%|███████   | 7/10 [07:02<03:01, 60.36s/it][A
 80%|████████  | 8/10 [08:02<02:00, 60.09s/it][A[2024-05-29 05:40:30,810] [INFO] [logging.py:96:log_dist] [Rank 0] step=288, skipped=0, lr=[1.9978253436684857e-05], mom=[(0.9, 0.999)]
steps: 288 loss: 0.6576 iter time (s): 58.865 samples/sec: 2.174

 80%|████████  | 8/10 [08:02<02:00, 60.08s/it][A
 80%|████████  | 8/10 [08:02<02:00, 60.08s/it][A
 80%|████████  | 8/10 [08:02<02:00, 60.10s/it][A
 80%|████████  | 8/10 [08:02<02:00, 60.09s/it][A
 80%|████████  | 8/10 [08:02<02:00, 60.08s/it][A
 80%|████████  | 8/10 [08:02<02:00, 60.08s/it][A
 80%|████████  | 8/10 [08:02<02:00, 60.08s/it][A
 90%|█████████ | 9/10 [09:01<00:59, 59.70s/it][A[2024-05-29 05:41:29,664] [INFO] [logging.py:96:log_dist] [Rank 0] step=289, skipped=0, lr=[1.997787851187418e-05], mom=[(0.9, 0.999)]
steps: 289 loss: 0.5995 iter time (s): 58.189 samples/sec: 2.200

 90%|█████████ | 9/10 [09:00<00:59, 59.69s/it][A
 90%|█████████ | 9/10 [09:01<00:59, 59.68s/it][A
 90%|█████████ | 9/10 [09:01<00:59, 59.70s/it][A
 90%|█████████ | 9/10 [09:01<00:59, 59.71s/it][A
 90%|█████████ | 9/10 [09:00<00:59, 59.69s/it][A
 90%|█████████ | 9/10 [09:01<00:59, 59.70s/it][A
 90%|█████████ | 9/10 [09:01<00:59, 59.69s/it][A
100%|██████████| 10/10 [10:00<00:00, 59.63s/it][A100%|██████████| 10/10 [10:00<00:00, 60.09s/it]
  6%|▌         | 29/520 [5:04:46<100:18:36, 735.47s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 05:42:29,126] [INFO] [logging.py:96:log_dist] [Rank 0] step=290, skipped=0, lr=[1.997750038623322e-05], mom=[(0.9, 0.999)]
steps: 290 loss: 0.6687 iter time (s): 58.841 samples/sec: 2.175

100%|██████████| 10/10 [10:00<00:00, 59.65s/it][A100%|██████████| 10/10 [10:00<00:00, 60.05s/it]
  6%|▌         | 29/520 [5:04:18<100:17:19, 735.31s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:00<00:00, 59.64s/it][A100%|██████████| 10/10 [10:00<00:00, 60.06s/it]
  6%|▌         | 29/520 [5:04:53<100:17:27, 735.33s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:00<00:00, 59.64s/it][A100%|██████████| 10/10 [10:00<00:00, 60.06s/it]
  6%|▌         | 29/520 [5:04:26<100:17:19, 735.31s/it]
100%|██████████| 10/10 [10:00<00:00, 59.63s/it][A100%|██████████| 10/10 [10:00<00:00, 60.06s/it]
  6%|▌         | 29/520 [5:04:10<100:17:05, 735.29s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:00<00:00, 59.62s/it][A100%|██████████| 10/10 [10:00<00:00, 60.06s/it]
  6%|▌         | 29/520 [5:04:54<100:17:13, 735.30s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:00<00:00, 59.63s/it][A100%|██████████| 10/10 [10:00<00:00, 60.04s/it]
  6%|▌         | 29/520 [5:04:34<100:17:04, 735.28s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:00<00:00, 59.63s/it][A100%|██████████| 10/10 [10:00<00:00, 60.05s/it]
  6%|▌         | 29/520 [5:04:41<100:17:04, 735.28s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_288

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:22<12:26, 82.96s/it][A[2024-05-29 05:43:52,852] [INFO] [logging.py:96:log_dist] [Rank 0] step=291, skipped=0, lr=[1.9977119059883292e-05], mom=[(0.9, 0.999)]
steps: 291 loss: 0.6332 iter time (s): 82.896 samples/sec: 1.544

 10%|█         | 1/10 [01:23<12:33, 83.78s/it][A
 10%|█         | 1/10 [01:23<12:34, 83.87s/it][A
 10%|█         | 1/10 [01:23<12:34, 83.84s/it][A
 10%|█         | 1/10 [01:23<12:35, 83.90s/it][A
 10%|█         | 1/10 [01:23<12:34, 83.87s/it][A
 10%|█         | 1/10 [01:23<12:34, 83.82s/it][A
 10%|█         | 1/10 [01:23<12:34, 83.83s/it][A
 20%|██        | 2/10 [02:46<11:08, 83.59s/it][A[2024-05-29 05:45:16,891] [INFO] [logging.py:96:log_dist] [Rank 0] step=292, skipped=0, lr=[1.997673453294673e-05], mom=[(0.9, 0.999)]
steps: 292 loss: 0.6377 iter time (s): 83.161 samples/sec: 1.539

 20%|██        | 2/10 [02:47<11:11, 83.92s/it][A
 20%|██        | 2/10 [02:47<11:11, 83.89s/it][A
 20%|██        | 2/10 [02:47<11:11, 83.90s/it][A
 20%|██        | 2/10 [02:47<11:11, 83.94s/it][A
 20%|██        | 2/10 [02:47<11:11, 83.97s/it][A
 20%|██        | 2/10 [02:47<11:11, 83.92s/it][A
 20%|██        | 2/10 [02:47<11:11, 83.93s/it][A
 30%|███       | 3/10 [04:12<09:51, 84.56s/it][A[2024-05-29 05:46:42,605] [INFO] [logging.py:96:log_dist] [Rank 0] step=293, skipped=0, lr=[1.9976346805546906e-05], mom=[(0.9, 0.999)]
steps: 293 loss: 0.6433 iter time (s): 84.865 samples/sec: 1.508

 30%|███       | 3/10 [04:13<09:53, 84.73s/it][A
 30%|███       | 3/10 [04:13<09:53, 84.73s/it][A
 30%|███       | 3/10 [04:13<09:53, 84.75s/it][A
 30%|███       | 3/10 [04:13<09:53, 84.80s/it][A
 30%|███       | 3/10 [04:13<09:53, 84.79s/it][A
 30%|███       | 3/10 [04:13<09:53, 84.79s/it][A
 30%|███       | 3/10 [04:13<09:53, 84.79s/it][A
 40%|████      | 4/10 [05:38<08:29, 84.97s/it][A[2024-05-29 05:48:07,887] [INFO] [logging.py:96:log_dist] [Rank 0] step=294, skipped=0, lr=[1.9975955877808212e-05], mom=[(0.9, 0.999)]
steps: 294 loss: 0.6305 iter time (s): 84.357 samples/sec: 1.517

 40%|████      | 4/10 [05:38<08:29, 84.96s/it][A
 40%|████      | 4/10 [05:38<08:29, 84.98s/it][A
 40%|████      | 4/10 [05:38<08:29, 84.98s/it][A
 40%|████      | 4/10 [05:38<08:29, 84.98s/it][A
 40%|████      | 4/10 [05:38<08:29, 84.97s/it][A
 40%|████      | 4/10 [05:38<08:29, 84.95s/it][A
 40%|████      | 4/10 [05:38<08:29, 84.96s/it][A
 50%|█████     | 5/10 [07:05<07:08, 85.75s/it][A[2024-05-29 05:49:35,332] [INFO] [logging.py:96:log_dist] [Rank 0] step=295, skipped=0, lr=[1.9975561749856065e-05], mom=[(0.9, 0.999)]
steps: 295 loss: 0.6348 iter time (s): 86.574 samples/sec: 1.479

 50%|█████     | 5/10 [07:06<07:09, 85.86s/it][A
 50%|█████     | 5/10 [07:06<07:09, 85.86s/it][A
 50%|█████     | 5/10 [07:06<07:09, 85.83s/it][A
 50%|█████     | 5/10 [07:06<07:09, 85.83s/it][A
 50%|█████     | 5/10 [07:06<07:09, 85.84s/it][A
 50%|█████     | 5/10 [07:06<07:09, 85.84s/it][A
 50%|█████     | 5/10 [07:06<07:09, 85.84s/it][A
 60%|██████    | 6/10 [08:35<05:48, 87.17s/it][A[2024-05-29 05:51:05,259] [INFO] [logging.py:96:log_dist] [Rank 0] step=296, skipped=0, lr=[1.9975164421816905e-05], mom=[(0.9, 0.999)]
steps: 296 loss: 0.6108 iter time (s): 89.078 samples/sec: 1.437

 60%|██████    | 6/10 [08:36<05:48, 87.24s/it][A
 60%|██████    | 6/10 [08:36<05:49, 87.28s/it][A
 60%|██████    | 6/10 [08:36<05:49, 87.30s/it][A
 60%|██████    | 6/10 [08:36<05:49, 87.30s/it][A
 60%|██████    | 6/10 [08:36<05:49, 87.40s/it][A
 60%|██████    | 6/10 [08:36<05:49, 87.45s/it][A
 60%|██████    | 6/10 [08:37<05:50, 87.57s/it][A
 70%|███████   | 7/10 [10:07<04:26, 88.78s/it][A[2024-05-29 05:52:37,369] [INFO] [logging.py:96:log_dist] [Rank 0] step=297, skipped=0, lr=[1.9974763893818215e-05], mom=[(0.9, 0.999)]
steps: 297 loss: 0.5945 iter time (s): 90.240 samples/sec: 1.418

 70%|███████   | 7/10 [10:08<04:26, 88.81s/it][A
 70%|███████   | 7/10 [10:08<04:26, 88.81s/it][A
 70%|███████   | 7/10 [10:08<04:26, 88.79s/it][A
 70%|███████   | 7/10 [10:08<04:26, 88.80s/it][A
 70%|███████   | 7/10 [10:08<04:26, 88.82s/it][A
 70%|███████   | 7/10 [10:08<04:26, 88.74s/it][A
 70%|███████   | 7/10 [10:08<04:26, 88.72s/it][A
 80%|████████  | 8/10 [11:32<02:55, 87.51s/it][A[2024-05-29 05:54:02,138] [INFO] [logging.py:96:log_dist] [Rank 0] step=298, skipped=0, lr=[1.997436016598849e-05], mom=[(0.9, 0.999)]
steps: 298 loss: 0.5901 iter time (s): 83.977 samples/sec: 1.524

 80%|████████  | 8/10 [11:33<02:55, 87.56s/it][A
 80%|████████  | 8/10 [11:33<02:55, 87.53s/it][A
 80%|████████  | 8/10 [11:33<02:55, 87.53s/it][A
 80%|████████  | 8/10 [11:33<02:55, 87.53s/it][A
 80%|████████  | 8/10 [11:33<02:54, 87.49s/it][A
 80%|████████  | 8/10 [11:33<02:55, 87.54s/it][A
 80%|████████  | 8/10 [11:33<02:54, 87.48s/it][A
 90%|█████████ | 9/10 [12:57<01:26, 86.67s/it][A[2024-05-29 05:55:26,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=299, skipped=0, lr=[1.9973953238457254e-05], mom=[(0.9, 0.999)]
steps: 299 loss: 0.5905 iter time (s): 83.990 samples/sec: 1.524

 90%|█████████ | 9/10 [12:57<01:26, 86.69s/it][A
 90%|█████████ | 9/10 [12:57<01:26, 86.66s/it][A
 90%|█████████ | 9/10 [12:57<01:26, 86.66s/it][A
 90%|█████████ | 9/10 [12:57<01:26, 86.67s/it][A
 90%|█████████ | 9/10 [12:57<01:26, 86.67s/it][A
 90%|█████████ | 9/10 [12:57<01:26, 86.66s/it][A
 90%|█████████ | 9/10 [12:57<01:26, 86.64s/it][A
100%|██████████| 10/10 [14:22<00:00, 86.43s/it][A100%|██████████| 10/10 [14:22<00:00, 86.30s/it]
[2024-05-29 05:56:52,851] [INFO] [logging.py:96:log_dist] [Rank 0] step=300, skipped=0, lr=[1.9973543111355067e-05], mom=[(0.9, 0.999)]
steps: 300 loss: 0.5860 iter time (s): 85.049 samples/sec: 1.505

100%|██████████| 10/10 [14:23<00:00, 86.42s/it][A100%|██████████| 10/10 [14:23<00:00, 86.37s/it]

100%|██████████| 10/10 [14:23<00:00, 86.45s/it][A100%|██████████| 10/10 [14:23<00:00, 86.38s/it]

100%|██████████| 10/10 [14:23<00:00, 86.43s/it][A100%|██████████| 10/10 [14:23<00:00, 86.38s/it]

100%|██████████| 10/10 [14:23<00:00, 86.43s/it][A100%|██████████| 10/10 [14:23<00:00, 86.38s/it]

100%|██████████| 10/10 [14:23<00:00, 86.43s/it][A100%|██████████| 10/10 [14:23<00:00, 86.38s/it]

100%|██████████| 10/10 [14:23<00:00, 86.43s/it][A100%|██████████| 10/10 [14:23<00:00, 86.38s/it]

100%|██████████| 10/10 [14:23<00:00, 86.41s/it][A100%|██████████| 10/10 [14:23<00:00, 86.38s/it]
Checkpointing at shard 30
[2024-05-29 05:56:53,723] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step300 is about to be saved!
[2024-05-29 05:56:54,699] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_00-model_states.pt...
[2024-05-29 05:56:58,415] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_04-model_states.pt...
[2024-05-29 05:56:58,502] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_02-model_states.pt...
[2024-05-29 05:56:59,146] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_03-model_states.pt...
[2024-05-29 05:57:02,160] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_00-model_states.pt.
[2024-05-29 05:57:06,880] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_08-model_states.pt...
[2024-05-29 05:57:06,994] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_07-model_states.pt...
[2024-05-29 05:57:10,246] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_01-model_states.pt...
[2024-05-29 05:57:14,534] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_05-model_states.pt...
[2024-05-29 05:57:14,661] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_06-model_states.pt...
[2024-05-29 06:06:27,121] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_03-model_states.pt.
[2024-05-29 06:06:27,176] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_02_model_states.pt...
[2024-05-29 06:06:28,362] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_04-model_states.pt.
[2024-05-29 06:06:28,398] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_03_model_states.pt...
[2024-05-29 06:06:28,521] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_02_model_states.pt.
[2024-05-29 06:06:28,522] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step300 is ready now!
[2024-05-29 06:06:29,422] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_03_model_states.pt.
[2024-05-29 06:06:29,422] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step300 is ready now!
[2024-05-29 06:06:36,095] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_02-model_states.pt.
[2024-05-29 06:06:36,135] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_01_model_states.pt
[2024-05-29 06:06:36,135] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_01_model_states.pt...
[2024-05-29 06:06:37,700] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_01_model_states.pt.
[2024-05-29 06:06:37,700] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step300 is ready now!
[2024-05-29 06:06:39,473] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_06-model_states.pt.
[2024-05-29 06:06:39,901] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_05_model_states.pt...
[2024-05-29 06:06:40,883] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_05_model_states.pt.
[2024-05-29 06:06:40,883] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step300 is ready now!
[2024-05-29 06:06:47,990] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_05-model_states.pt.
[2024-05-29 06:06:48,444] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_04_model_states.pt...
[2024-05-29 06:06:49,723] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_04_model_states.pt.
[2024-05-29 06:06:49,723] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step300 is ready now!
[2024-05-29 06:07:53,913] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_01-model_states.pt.
[2024-05-29 06:07:54,608] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_00_model_states.pt
[2024-05-29 06:07:54,608] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_00_model_states.pt...
[2024-05-29 06:07:58,396] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_00_model_states.pt.
[2024-05-29 06:07:58,396] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step300 is ready now!
[2024-05-29 06:08:17,664] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_08-model_states.pt.
[2024-05-29 06:08:17,838] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_07-model_states.pt.
[2024-05-29 06:08:18,123] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_09-model_states.pt...
[2024-05-29 06:08:18,285] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_06_model_states.pt...
[2024-05-29 06:08:18,974] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_06_model_states.pt.
[2024-05-29 06:08:18,974] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step300 is ready now!
[2024-05-29 06:08:20,036] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/layer_09-model_states.pt.
[2024-05-29 06:08:20,040] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_07_model_states.pt...
[2024-05-29 06:08:20,503] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step300/mp_rank_07_model_states.pt.
[2024-05-29 06:08:20,503] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step300 is ready now!
  6%|▌         | 30/520 [5:30:39<133:22:49, 979.94s/it]  6%|▌         | 30/520 [5:30:09<133:18:20, 979.39s/it]  6%|▌         | 30/520 [5:30:45<133:17:37, 979.30s/it]  6%|▌         | 30/520 [5:30:25<133:17:25, 979.28s/it]  6%|▌         | 30/520 [5:30:01<133:17:38, 979.30s/it]  6%|▌         | 30/520 [5:30:17<133:17:53, 979.33s/it]  6%|▌         | 30/520 [5:30:44<133:18:13, 979.37s/it]Checkpoint saved using --- 686.7885069847107 seconds ---
  6%|▌         | 30/520 [5:30:32<133:17:21, 979.27s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_293


  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [00:00<?, ?it/s][A

  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [00:00<?, ?it/s][A[ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A

  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:21<12:17, 81.92s/it][A[2024-05-29 06:09:44,597] [INFO] [logging.py:96:log_dist] [Rank 0] step=301, skipped=0, lr=[1.9973129784813498e-05], mom=[(0.9, 0.999)]
steps: 301 loss: 0.6420 iter time (s): 83.603 samples/sec: 1.531

 10%|█         | 1/10 [01:24<12:36, 84.01s/it][A
 10%|█         | 1/10 [01:24<12:37, 84.17s/it][A
 10%|█         | 1/10 [01:24<12:37, 84.21s/it][A
 10%|█         | 1/10 [01:24<12:39, 84.35s/it][A
 10%|█         | 1/10 [01:24<12:39, 84.43s/it][A
 10%|█         | 1/10 [01:24<12:40, 84.45s/it][A
 10%|█         | 1/10 [01:24<12:40, 84.49s/it][A
 20%|██        | 2/10 [02:45<11:05, 83.15s/it][A[2024-05-29 06:11:08,620] [INFO] [logging.py:96:log_dist] [Rank 0] step=302, skipped=0, lr=[1.9972713258965157e-05], mom=[(0.9, 0.999)]
steps: 302 loss: 0.6333 iter time (s): 83.284 samples/sec: 1.537

 20%|██        | 2/10 [02:48<11:12, 84.09s/it][A
 20%|██        | 2/10 [02:48<11:12, 84.10s/it][A
 20%|██        | 2/10 [02:48<11:13, 84.17s/it][A
 20%|██        | 2/10 [02:48<11:13, 84.22s/it][A
 20%|██        | 2/10 [02:48<11:14, 84.25s/it][A
 20%|██        | 2/10 [02:48<11:14, 84.26s/it][A
 20%|██        | 2/10 [02:48<11:14, 84.27s/it][A
 30%|███       | 3/10 [04:09<09:44, 83.53s/it][A[2024-05-29 06:12:32,595] [INFO] [logging.py:96:log_dist] [Rank 0] step=303, skipped=0, lr=[1.9972293533943674e-05], mom=[(0.9, 0.999)]
steps: 303 loss: 0.6261 iter time (s): 83.132 samples/sec: 1.540

 30%|███       | 3/10 [04:12<09:48, 84.07s/it][A
 30%|███       | 3/10 [04:12<09:48, 84.09s/it][A
 30%|███       | 3/10 [04:12<09:48, 84.09s/it][A
 30%|███       | 3/10 [04:12<09:49, 84.16s/it][A
 30%|███       | 3/10 [04:12<09:49, 84.16s/it][A
 30%|███       | 3/10 [04:12<09:49, 84.17s/it][A
 30%|███       | 3/10 [04:12<09:49, 84.19s/it][A
 40%|████      | 4/10 [05:33<08:22, 83.74s/it][A[2024-05-29 06:13:56,639] [INFO] [logging.py:96:log_dist] [Rank 0] step=304, skipped=0, lr=[1.9971870609883714e-05], mom=[(0.9, 0.999)]
steps: 304 loss: 0.6317 iter time (s): 83.047 samples/sec: 1.541

 40%|████      | 4/10 [05:36<08:24, 84.02s/it][A
 40%|████      | 4/10 [05:36<08:24, 84.04s/it][A
 40%|████      | 4/10 [05:36<08:24, 84.05s/it][A
 40%|████      | 4/10 [05:36<08:24, 84.07s/it][A
 40%|████      | 4/10 [05:36<08:24, 84.07s/it][A
 40%|████      | 4/10 [05:36<08:24, 84.07s/it][A
 40%|████      | 4/10 [05:36<08:24, 84.08s/it][A
 50%|█████     | 5/10 [06:57<06:57, 83.57s/it][A[2024-05-29 06:15:19,930] [INFO] [logging.py:96:log_dist] [Rank 0] step=305, skipped=0, lr=[1.9971444486920952e-05], mom=[(0.9, 0.999)]
steps: 305 loss: 0.6223 iter time (s): 82.469 samples/sec: 1.552

 50%|█████     | 5/10 [06:59<06:58, 83.73s/it][A
 50%|█████     | 5/10 [06:59<06:58, 83.77s/it][A
 50%|█████     | 5/10 [06:59<06:58, 83.79s/it][A
 50%|█████     | 5/10 [06:59<06:58, 83.77s/it][A
 50%|█████     | 5/10 [06:59<06:58, 83.80s/it][A
 50%|█████     | 5/10 [06:59<06:58, 83.80s/it][A
 50%|█████     | 5/10 [06:59<06:58, 83.80s/it][A
 60%|██████    | 6/10 [08:21<05:35, 83.79s/it][A[2024-05-29 06:16:44,137] [INFO] [logging.py:96:log_dist] [Rank 0] step=306, skipped=0, lr=[1.9971015165192106e-05], mom=[(0.9, 0.999)]
steps: 306 loss: 0.6374 iter time (s): 83.417 samples/sec: 1.534

 60%|██████    | 6/10 [08:23<05:35, 83.94s/it][A
 60%|██████    | 6/10 [08:23<05:35, 83.94s/it][A
 60%|██████    | 6/10 [08:23<05:35, 83.93s/it][A
 60%|██████    | 6/10 [08:24<05:35, 83.94s/it][A
 60%|██████    | 6/10 [08:24<05:35, 83.96s/it][A
 60%|██████    | 6/10 [08:24<05:35, 83.95s/it][A
 60%|██████    | 6/10 [08:24<05:35, 83.95s/it][A
 70%|███████   | 7/10 [09:46<04:12, 84.26s/it][A[2024-05-29 06:18:09,366] [INFO] [logging.py:96:log_dist] [Rank 0] step=307, skipped=0, lr=[1.997058264483491e-05], mom=[(0.9, 0.999)]
steps: 307 loss: 0.6097 iter time (s): 84.353 samples/sec: 1.517

 70%|███████   | 7/10 [09:48<04:12, 84.32s/it][A
 70%|███████   | 7/10 [09:49<04:13, 84.36s/it][A
 70%|███████   | 7/10 [09:49<04:13, 84.35s/it][A
 70%|███████   | 7/10 [09:49<04:13, 84.34s/it][A
 70%|███████   | 7/10 [09:49<04:13, 84.36s/it][A
 70%|███████   | 7/10 [09:49<04:13, 84.35s/it][A
 70%|███████   | 7/10 [09:49<04:13, 84.35s/it][A
 80%|████████  | 8/10 [11:11<02:48, 84.44s/it][A[2024-05-29 06:19:34,180] [INFO] [logging.py:96:log_dist] [Rank 0] step=308, skipped=0, lr=[1.9970146925988127e-05], mom=[(0.9, 0.999)]
steps: 308 loss: 0.6081 iter time (s): 83.978 samples/sec: 1.524

 80%|████████  | 8/10 [11:13<02:48, 84.48s/it][A
 80%|████████  | 8/10 [11:13<02:48, 84.49s/it][A
 80%|████████  | 8/10 [11:13<02:49, 84.51s/it][A
 80%|████████  | 8/10 [11:13<02:48, 84.49s/it][A
 80%|████████  | 8/10 [11:14<02:49, 84.50s/it][A
 80%|████████  | 8/10 [11:14<02:49, 84.50s/it][A
 80%|████████  | 8/10 [11:14<02:48, 84.50s/it][A
 90%|█████████ | 9/10 [12:35<01:24, 84.40s/it][A[2024-05-29 06:20:58,508] [INFO] [logging.py:96:log_dist] [Rank 0] step=309, skipped=0, lr=[1.9969708008791543e-05], mom=[(0.9, 0.999)]
steps: 309 loss: 0.6080 iter time (s): 83.567 samples/sec: 1.532

 90%|█████████ | 9/10 [12:38<01:24, 84.48s/it][A
 90%|█████████ | 9/10 [12:38<01:24, 84.45s/it][A
 90%|█████████ | 9/10 [12:38<01:24, 84.45s/it][A
 90%|█████████ | 9/10 [12:38<01:24, 84.45s/it][A
 90%|█████████ | 9/10 [12:38<01:24, 84.46s/it][A
 90%|█████████ | 9/10 [12:38<01:24, 84.46s/it][A
 90%|█████████ | 9/10 [12:38<01:24, 84.46s/it][A
100%|██████████| 10/10 [14:01<00:00, 84.70s/it][A100%|██████████| 10/10 [14:01<00:00, 84.12s/it]
  6%|▌         | 31/520 [5:44:40<127:28:51, 938.51s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 06:22:23,875] [INFO] [logging.py:96:log_dist] [Rank 0] step=310, skipped=0, lr=[1.996926589338598e-05], mom=[(0.9, 0.999)]
steps: 310 loss: 0.6094 iter time (s): 84.505 samples/sec: 1.515

100%|██████████| 10/10 [14:03<00:00, 84.72s/it][A100%|██████████| 10/10 [14:03<00:00, 84.34s/it]
  6%|▌         | 31/520 [5:44:13<127:31:00, 938.77s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:03<00:00, 84.71s/it][A100%|██████████| 10/10 [14:03<00:00, 84.35s/it]
  6%|▌         | 31/520 [5:44:48<127:31:09, 938.79s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:03<00:00, 84.74s/it][A100%|██████████| 10/10 [14:03<00:00, 84.36s/it]
  6%|▌         | 31/520 [5:44:21<127:31:22, 938.82s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:03<00:00, 84.73s/it][A100%|██████████| 10/10 [14:03<00:00, 84.37s/it]
  6%|▌         | 31/520 [5:44:05<127:31:23, 938.82s/it]
100%|██████████| 10/10 [14:03<00:00, 84.73s/it][A100%|██████████| 10/10 [14:03<00:00, 84.38s/it]
  6%|▌         | 31/520 [5:44:49<127:31:33, 938.84s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:03<00:00, 84.73s/it][A100%|██████████| 10/10 [14:03<00:00, 84.38s/it]
  6%|▌         | 31/520 [5:44:29<127:31:27, 938.83s/it]
100%|██████████| 10/10 [14:03<00:00, 84.73s/it][A100%|██████████| 10/10 [14:03<00:00, 84.38s/it]
  6%|▌         | 31/520 [5:44:36<127:31:29, 938.83s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_plain_texts/shard_15

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:06<18:58, 126.46s/it][A[2024-05-29 06:24:31,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=311, skipped=0, lr=[1.9968820579913283e-05], mom=[(0.9, 0.999)]
steps: 311 loss: 0.8788 iter time (s): 126.803 samples/sec: 1.009

 10%|█         | 1/10 [02:07<19:11, 127.92s/it][A
 10%|█         | 1/10 [02:08<19:12, 128.03s/it][A
 10%|█         | 1/10 [02:07<19:10, 127.86s/it][A
 10%|█         | 1/10 [02:08<19:12, 128.07s/it][A
 10%|█         | 1/10 [02:07<19:11, 127.90s/it][A
 10%|█         | 1/10 [02:07<19:11, 127.97s/it][A
 10%|█         | 1/10 [02:07<19:11, 127.95s/it][A
 20%|██        | 2/10 [04:14<16:58, 127.27s/it][A[2024-05-29 06:26:39,317] [INFO] [logging.py:96:log_dist] [Rank 0] step=312, skipped=0, lr=[1.9968372068516306e-05], mom=[(0.9, 0.999)]
steps: 312 loss: 0.8403 iter time (s): 126.894 samples/sec: 1.009

 20%|██        | 2/10 [04:15<17:03, 127.93s/it][A
 20%|██        | 2/10 [04:16<17:03, 128.00s/it][A
 20%|██        | 2/10 [04:15<17:03, 127.96s/it][A
 20%|██        | 2/10 [04:16<17:04, 128.03s/it][A
 20%|██        | 2/10 [04:15<17:03, 127.96s/it][A
 20%|██        | 2/10 [04:15<17:03, 127.99s/it][A
 20%|██        | 2/10 [04:16<17:04, 128.02s/it][A
 30%|███       | 3/10 [06:22<14:52, 127.47s/it][A[2024-05-29 06:28:47,026] [INFO] [logging.py:96:log_dist] [Rank 0] step=313, skipped=0, lr=[1.9967920359338956e-05], mom=[(0.9, 0.999)]
steps: 313 loss: 0.9220 iter time (s): 126.562 samples/sec: 1.011

 30%|███       | 3/10 [06:23<14:54, 127.74s/it][A
 30%|███       | 3/10 [06:23<14:54, 127.79s/it][A
 30%|███       | 3/10 [06:23<14:54, 127.72s/it][A
 30%|███       | 3/10 [06:23<14:54, 127.79s/it][A
 30%|███       | 3/10 [06:23<14:54, 127.74s/it][A
 30%|███       | 3/10 [06:23<14:54, 127.78s/it][A
 30%|███       | 3/10 [06:23<14:54, 127.77s/it][A
 40%|████      | 4/10 [08:29<12:45, 127.56s/it][A[2024-05-29 06:30:54,719] [INFO] [logging.py:96:log_dist] [Rank 0] step=314, skipped=0, lr=[1.996746545252614e-05], mom=[(0.9, 0.999)]
steps: 314 loss: 0.9472 iter time (s): 126.825 samples/sec: 1.009

 40%|████      | 4/10 [08:31<12:46, 127.75s/it][A
 40%|████      | 4/10 [08:31<12:46, 127.71s/it][A
 40%|████      | 4/10 [08:31<12:46, 127.73s/it][A
 40%|████      | 4/10 [08:31<12:46, 127.70s/it][A
 40%|████      | 4/10 [08:31<12:46, 127.70s/it][A
 40%|████      | 4/10 [08:31<12:46, 127.71s/it][A
 40%|████      | 4/10 [08:31<12:46, 127.71s/it][A
 50%|█████     | 5/10 [10:37<10:37, 127.58s/it][A[2024-05-29 06:33:02,334] [INFO] [logging.py:96:log_dist] [Rank 0] step=315, skipped=0, lr=[1.9967007348223816e-05], mom=[(0.9, 0.999)]
steps: 315 loss: 0.8839 iter time (s): 126.751 samples/sec: 1.010

 50%|█████     | 5/10 [10:38<10:38, 127.67s/it][A
 50%|█████     | 5/10 [10:38<10:38, 127.69s/it][A
 50%|█████     | 5/10 [10:38<10:38, 127.66s/it][A
 50%|█████     | 5/10 [10:38<10:38, 127.65s/it][A
 50%|█████     | 5/10 [10:38<10:38, 127.64s/it][A
 50%|█████     | 5/10 [10:38<10:38, 127.64s/it][A
 50%|█████     | 5/10 [10:38<10:38, 127.65s/it][A
 60%|██████    | 6/10 [12:44<08:30, 127.60s/it][A[2024-05-29 06:35:09,965] [INFO] [logging.py:96:log_dist] [Rank 0] step=316, skipped=0, lr=[1.996654604657895e-05], mom=[(0.9, 0.999)]
steps: 316 loss: 0.8970 iter time (s): 126.845 samples/sec: 1.009

 60%|██████    | 6/10 [12:46<08:30, 127.72s/it][A
 60%|██████    | 6/10 [12:46<08:30, 127.68s/it][A
 60%|██████    | 6/10 [12:46<08:30, 127.67s/it][A
 60%|██████    | 6/10 [12:46<08:30, 127.71s/it][A
 60%|██████    | 6/10 [12:46<08:30, 127.69s/it][A
 60%|██████    | 6/10 [12:46<08:30, 127.69s/it][A
 60%|██████    | 6/10 [12:46<08:30, 127.70s/it][A
 70%|███████   | 7/10 [14:52<06:23, 127.70s/it][A[2024-05-29 06:37:17,860] [INFO] [logging.py:96:log_dist] [Rank 0] step=317, skipped=0, lr=[1.9966081547739534e-05], mom=[(0.9, 0.999)]
steps: 317 loss: 0.8759 iter time (s): 127.011 samples/sec: 1.008

 70%|███████   | 7/10 [14:54<06:23, 127.75s/it][A
 70%|███████   | 7/10 [14:54<06:23, 127.77s/it][A
 70%|███████   | 7/10 [14:54<06:23, 127.74s/it][A
 70%|███████   | 7/10 [14:54<06:23, 127.76s/it][A
 70%|███████   | 7/10 [14:54<06:23, 127.73s/it][A
 70%|███████   | 7/10 [14:54<06:23, 127.74s/it][A
 70%|███████   | 7/10 [14:54<06:23, 127.74s/it][A
 80%|████████  | 8/10 [17:00<04:15, 127.64s/it][A[2024-05-29 06:39:25,385] [INFO] [logging.py:96:log_dist] [Rank 0] step=318, skipped=0, lr=[1.99656138518546e-05], mom=[(0.9, 0.999)]
steps: 318 loss: 0.8910 iter time (s): 126.625 samples/sec: 1.011

 80%|████████  | 8/10 [17:01<04:15, 127.64s/it][A
 80%|████████  | 8/10 [17:01<04:15, 127.63s/it][A
 80%|████████  | 8/10 [17:01<04:15, 127.65s/it][A
 80%|████████  | 8/10 [17:01<04:15, 127.67s/it][A
 80%|████████  | 8/10 [17:01<04:15, 127.66s/it][A
 80%|████████  | 8/10 [17:01<04:15, 127.67s/it][A
 80%|████████  | 8/10 [17:01<04:15, 127.67s/it][A
 90%|█████████ | 9/10 [19:07<02:07, 127.63s/it][A[2024-05-29 06:41:33,010] [INFO] [logging.py:96:log_dist] [Rank 0] step=319, skipped=0, lr=[1.9965142959074188e-05], mom=[(0.9, 0.999)]
steps: 319 loss: 0.8850 iter time (s): 126.730 samples/sec: 1.010

 90%|█████████ | 9/10 [19:09<02:07, 127.67s/it][A
 90%|█████████ | 9/10 [19:09<02:07, 127.63s/it][A
 90%|█████████ | 9/10 [19:09<02:07, 127.62s/it][A
 90%|█████████ | 9/10 [19:09<02:07, 127.62s/it][A
 90%|█████████ | 9/10 [19:09<02:07, 127.62s/it][A
 90%|█████████ | 9/10 [19:09<02:07, 127.63s/it][A
 90%|█████████ | 9/10 [19:09<02:07, 127.63s/it][A
100%|██████████| 10/10 [21:15<00:00, 127.54s/it][A100%|██████████| 10/10 [21:15<00:00, 127.53s/it]
  6%|▌         | 32/520 [6:05:56<140:54:16, 1039.46s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 06:43:40,344] [INFO] [logging.py:96:log_dist] [Rank 0] step=320, skipped=0, lr=[1.9964668869549378e-05], mom=[(0.9, 0.999)]
steps: 320 loss: 0.8670 iter time (s): 126.569 samples/sec: 1.011

100%|██████████| 10/10 [21:16<00:00, 127.53s/it][A100%|██████████| 10/10 [21:16<00:00, 127.66s/it]
  6%|▌         | 32/520 [6:05:30<140:58:50, 1040.02s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:16<00:00, 127.54s/it][A100%|██████████| 10/10 [21:16<00:00, 127.67s/it]
  6%|▌         | 32/520 [6:06:05<140:59:02, 1040.05s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:16<00:00, 127.54s/it][A100%|██████████| 10/10 [21:16<00:00, 127.67s/it]
  6%|▌         | 32/520 [6:05:38<140:59:02, 1040.05s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:16<00:00, 127.54s/it][A100%|██████████| 10/10 [21:16<00:00, 127.66s/it]
  6%|▌         | 32/520 [6:05:22<140:59:04, 1040.05s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:16<00:00, 127.55s/it][A100%|██████████| 10/10 [21:16<00:00, 127.66s/it]
  6%|▌         | 32/520 [6:06:06<140:59:15, 1040.07s/it]
100%|██████████| 10/10 [21:16<00:00, 127.54s/it][A100%|██████████| 10/10 [21:16<00:00, 127.67s/it]
  6%|▌         | 32/520 [6:05:46<140:59:09, 1040.06s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:16<00:00, 127.55s/it][A100%|██████████| 10/10 [21:16<00:00, 127.66s/it]
  6%|▌         | 32/520 [6:05:53<140:59:10, 1040.06s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_203
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [00:57<08:39, 57.77s/it][A[2024-05-29 06:44:36,432] [INFO] [logging.py:96:log_dist] [Rank 0] step=321, skipped=0, lr=[1.9964191583432265e-05], mom=[(0.9, 0.999)]
steps: 321 loss: 0.6824 iter time (s): 54.980 samples/sec: 2.328

 10%|█         | 1/10 [00:55<08:21, 55.69s/it][A
 10%|█         | 1/10 [00:55<08:21, 55.74s/it][A
 10%|█         | 1/10 [00:55<08:21, 55.68s/it][A
 10%|█         | 1/10 [00:55<08:20, 55.59s/it][A
 10%|█         | 1/10 [00:55<08:20, 55.60s/it][A
 10%|█         | 1/10 [00:55<08:20, 55.66s/it][A
 10%|█         | 1/10 [00:55<08:20, 55.64s/it][A
 20%|██        | 2/10 [01:54<07:35, 56.89s/it][A[2024-05-29 06:45:32,716] [INFO] [logging.py:96:log_dist] [Rank 0] step=322, skipped=0, lr=[1.9963711100875983e-05], mom=[(0.9, 0.999)]
steps: 322 loss: 0.6779 iter time (s): 55.630 samples/sec: 2.301

 20%|██        | 2/10 [01:52<07:28, 56.06s/it][A
 20%|██        | 2/10 [01:51<07:28, 56.03s/it][A
 20%|██        | 2/10 [01:51<07:28, 56.02s/it][A
 20%|██        | 2/10 [01:51<07:28, 56.03s/it][A
 20%|██        | 2/10 [01:51<07:28, 56.02s/it][A
 20%|██        | 2/10 [01:51<07:28, 56.02s/it][A
 20%|██        | 2/10 [01:51<07:28, 56.03s/it][A
 30%|███       | 3/10 [02:49<06:34, 56.34s/it][A[2024-05-29 06:46:28,383] [INFO] [logging.py:96:log_dist] [Rank 0] step=323, skipped=0, lr=[1.996322742203467e-05], mom=[(0.9, 0.999)]
steps: 323 loss: 0.6849 iter time (s): 55.009 samples/sec: 2.327

 30%|███       | 3/10 [02:47<06:31, 55.88s/it][A
 30%|███       | 3/10 [02:47<06:31, 55.87s/it][A
 30%|███       | 3/10 [02:47<06:31, 55.86s/it][A
 30%|███       | 3/10 [02:47<06:30, 55.85s/it][A
 30%|███       | 3/10 [02:47<06:30, 55.84s/it][A
 30%|███       | 3/10 [02:47<06:30, 55.84s/it][A
 30%|███       | 3/10 [02:47<06:30, 55.84s/it][A
 40%|████      | 4/10 [03:45<05:37, 56.20s/it][A[2024-05-29 06:47:24,382] [INFO] [logging.py:96:log_dist] [Rank 0] step=324, skipped=0, lr=[1.996274054706351e-05], mom=[(0.9, 0.999)]
steps: 324 loss: 0.6086 iter time (s): 55.380 samples/sec: 2.311

 40%|████      | 4/10 [03:43<05:35, 55.92s/it][A
 40%|████      | 4/10 [03:43<05:35, 55.91s/it][A
 40%|████      | 4/10 [03:43<05:35, 55.92s/it][A
 40%|████      | 4/10 [03:43<05:35, 55.90s/it][A
 40%|████      | 4/10 [03:43<05:35, 55.94s/it][A
 40%|████      | 4/10 [03:43<05:35, 55.92s/it][A
 40%|████      | 4/10 [03:43<05:35, 55.92s/it][A
 50%|█████     | 5/10 [04:40<04:38, 55.67s/it][A[2024-05-29 06:48:19,105] [INFO] [logging.py:96:log_dist] [Rank 0] step=325, skipped=0, lr=[1.9962250476118704e-05], mom=[(0.9, 0.999)]
steps: 325 loss: 0.5875 iter time (s): 54.069 samples/sec: 2.367

 50%|█████     | 5/10 [04:38<04:37, 55.48s/it][A
 50%|█████     | 5/10 [04:38<04:37, 55.48s/it][A
 50%|█████     | 5/10 [04:38<04:37, 55.50s/it][A
 50%|█████     | 5/10 [04:38<04:37, 55.48s/it][A
 50%|█████     | 5/10 [04:38<04:37, 55.49s/it][A
 50%|█████     | 5/10 [04:38<04:37, 55.49s/it][A
 50%|█████     | 5/10 [04:38<04:37, 55.48s/it][A
 60%|██████    | 6/10 [05:35<03:41, 55.49s/it][A[2024-05-29 06:49:14,247] [INFO] [logging.py:96:log_dist] [Rank 0] step=326, skipped=0, lr=[1.9961757209357476e-05], mom=[(0.9, 0.999)]
steps: 326 loss: 0.6657 iter time (s): 54.517 samples/sec: 2.348

 60%|██████    | 6/10 [05:33<03:41, 55.40s/it][A
 60%|██████    | 6/10 [05:33<03:41, 55.39s/it][A
 60%|██████    | 6/10 [05:33<03:41, 55.38s/it][A
 60%|██████    | 6/10 [05:33<03:41, 55.37s/it][A
 60%|██████    | 6/10 [05:33<03:41, 55.38s/it][A
 60%|██████    | 6/10 [05:33<03:41, 55.38s/it][A
 60%|██████    | 6/10 [05:33<03:41, 55.38s/it][A
 70%|███████   | 7/10 [06:31<02:47, 55.70s/it][A[2024-05-29 06:50:10,381] [INFO] [logging.py:96:log_dist] [Rank 0] step=327, skipped=0, lr=[1.9961260746938083e-05], mom=[(0.9, 0.999)]
steps: 327 loss: 0.6407 iter time (s): 55.462 samples/sec: 2.308

 70%|███████   | 7/10 [06:29<02:46, 55.62s/it][A
 70%|███████   | 7/10 [06:29<02:46, 55.61s/it][A
 70%|███████   | 7/10 [06:29<02:46, 55.63s/it][A
 70%|███████   | 7/10 [06:29<02:46, 55.60s/it][A
 70%|███████   | 7/10 [06:29<02:46, 55.62s/it][A
 70%|███████   | 7/10 [06:29<02:46, 55.62s/it][A
 70%|███████   | 7/10 [06:29<02:46, 55.62s/it][A
 80%|████████  | 8/10 [07:28<01:52, 56.18s/it][A[2024-05-29 06:51:07,356] [INFO] [logging.py:96:log_dist] [Rank 0] step=328, skipped=0, lr=[1.9960761089019802e-05], mom=[(0.9, 0.999)]
steps: 328 loss: 0.5813 iter time (s): 56.315 samples/sec: 2.273

 80%|████████  | 8/10 [07:26<01:52, 56.05s/it][A
 80%|████████  | 8/10 [07:26<01:52, 56.07s/it][A
 80%|████████  | 8/10 [07:26<01:52, 56.04s/it][A
 80%|████████  | 8/10 [07:26<01:52, 56.06s/it][A
 80%|████████  | 8/10 [07:26<01:52, 56.05s/it][A
 80%|████████  | 8/10 [07:26<01:52, 56.05s/it][A
 80%|████████  | 8/10 [07:26<01:52, 56.05s/it][A
 90%|█████████ | 9/10 [08:26<00:56, 56.72s/it][A[2024-05-29 06:52:05,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=329, skipped=0, lr=[1.996025823576293e-05], mom=[(0.9, 0.999)]
steps: 329 loss: 0.6489 iter time (s): 57.492 samples/sec: 2.226

 90%|█████████ | 9/10 [08:24<00:56, 56.70s/it][A
 90%|█████████ | 9/10 [08:24<00:56, 56.74s/it][A
 90%|█████████ | 9/10 [08:24<00:56, 56.75s/it][A
 90%|█████████ | 9/10 [08:24<00:56, 56.72s/it][A
 90%|█████████ | 9/10 [08:24<00:56, 56.73s/it][A
 90%|█████████ | 9/10 [08:25<00:56, 56.88s/it][A
 90%|█████████ | 9/10 [08:25<00:56, 56.89s/it][A
100%|██████████| 10/10 [09:22<00:00, 56.48s/it][A100%|██████████| 10/10 [09:22<00:00, 56.28s/it]
  6%|▋         | 33/520 [6:15:19<121:17:15, 896.58s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 06:53:01,425] [INFO] [logging.py:96:log_dist] [Rank 0] step=330, skipped=0, lr=[1.99597521873288e-05], mom=[(0.9, 0.999)]
steps: 330 loss: 0.6663 iter time (s): 54.671 samples/sec: 2.341

100%|██████████| 10/10 [09:20<00:00, 56.47s/it][A100%|██████████| 10/10 [09:20<00:00, 56.07s/it]
  6%|▋         | 33/520 [6:14:50<121:15:33, 896.37s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:20<00:00, 56.44s/it][A100%|██████████| 10/10 [09:20<00:00, 56.07s/it]
  6%|▋         | 33/520 [6:15:25<121:15:28, 896.36s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:20<00:00, 56.47s/it][A100%|██████████| 10/10 [09:20<00:00, 56.08s/it]
  6%|▋         | 33/520 [6:14:58<121:15:42, 896.39s/it] 
100%|██████████| 10/10 [09:20<00:00, 56.45s/it][A100%|██████████| 10/10 [09:20<00:00, 56.06s/it]
  6%|▋         | 33/520 [6:14:42<121:15:32, 896.37s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:20<00:00, 56.47s/it][A100%|██████████| 10/10 [09:20<00:00, 56.06s/it]
  6%|▋         | 33/520 [6:15:27<121:15:34, 896.37s/it] 
100%|██████████| 10/10 [09:20<00:00, 56.41s/it][A100%|██████████| 10/10 [09:20<00:00, 56.06s/it]
  6%|▋         | 33/520 [6:15:13<121:15:29, 896.36s/it] Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_59

100%|██████████| 10/10 [09:20<00:00, 56.42s/it][A100%|██████████| 10/10 [09:20<00:00, 56.07s/it]
  6%|▋         | 33/520 [6:15:07<121:15:33, 896.37s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:05<09:47, 65.28s/it][A[2024-05-29 06:54:06,672] [INFO] [logging.py:96:log_dist] [Rank 0] step=331, skipped=0, lr=[1.9959242943879762e-05], mom=[(0.9, 0.999)]
steps: 331 loss: 1.3197 iter time (s): 64.455 samples/sec: 1.986

 10%|█         | 1/10 [01:05<09:46, 65.22s/it][A
 10%|█         | 1/10 [01:05<09:47, 65.31s/it][A
 10%|█         | 1/10 [01:05<09:46, 65.19s/it][A
 10%|█         | 1/10 [01:05<09:47, 65.26s/it][A
 10%|█         | 1/10 [01:05<09:47, 65.26s/it][A
 10%|█         | 1/10 [01:05<09:47, 65.29s/it][A
 10%|█         | 1/10 [01:05<09:47, 65.32s/it][A
 20%|██        | 2/10 [02:09<08:38, 64.76s/it][A[2024-05-29 06:55:11,326] [INFO] [logging.py:96:log_dist] [Rank 0] step=332, skipped=0, lr=[1.9958730505579195e-05], mom=[(0.9, 0.999)]
steps: 332 loss: 1.3026 iter time (s): 63.925 samples/sec: 2.002

 20%|██        | 2/10 [02:09<08:39, 64.91s/it][A
 20%|██        | 2/10 [02:09<08:39, 64.90s/it][A
 20%|██        | 2/10 [02:09<08:38, 64.87s/it][A
 20%|██        | 2/10 [02:09<08:38, 64.87s/it][A
 20%|██        | 2/10 [02:09<08:39, 64.89s/it][A
 20%|██        | 2/10 [02:09<08:39, 64.90s/it][A
 20%|██        | 2/10 [02:09<08:39, 64.92s/it][A
 30%|███       | 3/10 [03:13<07:29, 64.23s/it][A[2024-05-29 06:56:14,940] [INFO] [logging.py:96:log_dist] [Rank 0] step=333, skipped=0, lr=[1.9958214872591502e-05], mom=[(0.9, 0.999)]
steps: 333 loss: 1.2940 iter time (s): 62.885 samples/sec: 2.035

 30%|███       | 3/10 [03:13<07:30, 64.32s/it][A
 30%|███       | 3/10 [03:13<07:30, 64.31s/it][A
 30%|███       | 3/10 [03:13<07:29, 64.27s/it][A
 30%|███       | 3/10 [03:13<07:30, 64.31s/it][A
 30%|███       | 3/10 [03:13<07:30, 64.32s/it][A
 30%|███       | 3/10 [03:13<07:30, 64.33s/it][A
 30%|███       | 3/10 [03:13<07:30, 64.32s/it][A
 40%|████      | 4/10 [04:17<06:25, 64.28s/it][A[2024-05-29 06:57:19,292] [INFO] [logging.py:96:log_dist] [Rank 0] step=334, skipped=0, lr=[1.995769604508211e-05], mom=[(0.9, 0.999)]
steps: 334 loss: 1.2925 iter time (s): 63.631 samples/sec: 2.012

 40%|████      | 4/10 [04:17<06:25, 64.31s/it][A
 40%|████      | 4/10 [04:17<06:25, 64.33s/it][A
 40%|████      | 4/10 [04:17<06:25, 64.33s/it][A
 40%|████      | 4/10 [04:17<06:25, 64.33s/it][A
 40%|████      | 4/10 [04:17<06:25, 64.32s/it][A
 40%|████      | 4/10 [04:17<06:25, 64.32s/it][A
 40%|████      | 4/10 [04:17<06:25, 64.33s/it][A
 50%|█████     | 5/10 [05:21<05:20, 64.02s/it][A[2024-05-29 06:58:22,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=335, skipped=0, lr=[1.9957174023217473e-05], mom=[(0.9, 0.999)]
steps: 335 loss: 1.2726 iter time (s): 62.838 samples/sec: 2.037

 50%|█████     | 5/10 [05:21<05:20, 64.07s/it][A
 50%|█████     | 5/10 [05:21<05:20, 64.07s/it][A
 50%|█████     | 5/10 [05:21<05:20, 64.01s/it][A
 50%|█████     | 5/10 [05:21<05:20, 64.06s/it][A
 50%|█████     | 5/10 [05:21<05:20, 64.05s/it][A
 50%|█████     | 5/10 [05:21<05:20, 64.06s/it][A
 50%|█████     | 5/10 [05:21<05:20, 64.05s/it][A
 60%|██████    | 6/10 [06:24<04:14, 63.67s/it][A[2024-05-29 06:59:25,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=336, skipped=0, lr=[1.9956648807165074e-05], mom=[(0.9, 0.999)]
steps: 336 loss: 1.2752 iter time (s): 62.259 samples/sec: 2.056

 60%|██████    | 6/10 [06:24<04:14, 63.69s/it][A
 60%|██████    | 6/10 [06:24<04:14, 63.71s/it][A
 60%|██████    | 6/10 [06:24<04:14, 63.67s/it][A
 60%|██████    | 6/10 [06:24<04:14, 63.68s/it][A
 60%|██████    | 6/10 [06:24<04:14, 63.69s/it][A
 60%|██████    | 6/10 [06:24<04:14, 63.68s/it][A
 60%|██████    | 6/10 [06:24<04:14, 63.69s/it][A
 70%|███████   | 7/10 [07:27<03:10, 63.63s/it][A[2024-05-29 07:00:29,387] [INFO] [logging.py:96:log_dist] [Rank 0] step=337, skipped=0, lr=[1.99561203970934e-05], mom=[(0.9, 0.999)]
steps: 337 loss: 1.2750 iter time (s): 62.850 samples/sec: 2.037

 70%|███████   | 7/10 [07:28<03:11, 63.69s/it][A
 70%|███████   | 7/10 [07:28<03:11, 63.69s/it][A
 70%|███████   | 7/10 [07:27<03:10, 63.65s/it][A
 70%|███████   | 7/10 [07:28<03:11, 63.70s/it][A
 70%|███████   | 7/10 [07:28<03:11, 63.68s/it][A
 70%|███████   | 7/10 [07:28<03:11, 63.69s/it][A
 70%|███████   | 7/10 [07:28<03:11, 63.69s/it][A
 80%|████████  | 8/10 [08:31<02:07, 63.76s/it][A[2024-05-29 07:01:33,415] [INFO] [logging.py:96:log_dist] [Rank 0] step=338, skipped=0, lr=[1.9955588793171995e-05], mom=[(0.9, 0.999)]
steps: 338 loss: 1.2638 iter time (s): 63.172 samples/sec: 2.026

 80%|████████  | 8/10 [08:31<02:07, 63.75s/it][A
 80%|████████  | 8/10 [08:32<02:07, 63.77s/it][A
 80%|████████  | 8/10 [08:31<02:07, 63.75s/it][A
 80%|████████  | 8/10 [08:31<02:07, 63.76s/it][A
 80%|████████  | 8/10 [08:31<02:07, 63.75s/it][A
 80%|████████  | 8/10 [08:31<02:07, 63.74s/it][A
 80%|████████  | 8/10 [08:32<02:07, 63.75s/it][A
 90%|█████████ | 9/10 [09:37<01:04, 64.34s/it][A[2024-05-29 07:02:39,018] [INFO] [logging.py:96:log_dist] [Rank 0] step=339, skipped=0, lr=[1.9955053995571402e-05], mom=[(0.9, 0.999)]
steps: 339 loss: 1.2242 iter time (s): 64.884 samples/sec: 1.973

 90%|█████████ | 9/10 [09:37<01:04, 64.34s/it][A
 90%|█████████ | 9/10 [09:37<01:04, 64.35s/it][A
 90%|█████████ | 9/10 [09:37<01:04, 64.33s/it][A
 90%|█████████ | 9/10 [09:37<01:04, 64.32s/it][A
 90%|█████████ | 9/10 [09:37<01:04, 64.36s/it][A
 90%|█████████ | 9/10 [09:37<01:04, 64.34s/it][A
 90%|█████████ | 9/10 [09:37<01:04, 64.33s/it][A
100%|██████████| 10/10 [10:42<00:00, 64.45s/it][A100%|██████████| 10/10 [10:42<00:00, 64.21s/it]
  7%|▋         | 34/520 [6:26:01<110:44:16, 820.28s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 07:03:43,732] [INFO] [logging.py:96:log_dist] [Rank 0] step=340, skipped=0, lr=[1.9954516004463197e-05], mom=[(0.9, 0.999)]
steps: 340 loss: 1.2513 iter time (s): 63.999 samples/sec: 2.000

100%|██████████| 10/10 [10:42<00:00, 64.45s/it][A100%|██████████| 10/10 [10:42<00:00, 64.23s/it]
  7%|▋         | 34/520 [6:25:33<110:43:41, 820.21s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:42<00:00, 64.43s/it][A100%|██████████| 10/10 [10:42<00:00, 64.23s/it]
  7%|▋         | 34/520 [6:26:08<110:43:41, 820.21s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:42<00:00, 64.45s/it][A100%|██████████| 10/10 [10:42<00:00, 64.22s/it]
  7%|▋         | 34/520 [6:25:41<110:43:37, 820.20s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:42<00:00, 64.45s/it][A100%|██████████| 10/10 [10:42<00:00, 64.23s/it]
  7%|▋         | 34/520 [6:25:25<110:43:40, 820.21s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:42<00:00, 64.44s/it][A100%|██████████| 10/10 [10:42<00:00, 64.23s/it]
  7%|▋         | 34/520 [6:26:09<110:43:37, 820.20s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:42<00:00, 64.43s/it][A100%|██████████| 10/10 [10:42<00:00, 64.23s/it]
  7%|▋         | 34/520 [6:25:49<110:43:35, 820.20s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:42<00:00, 64.43s/it][A100%|██████████| 10/10 [10:42<00:00, 64.23s/it]
  7%|▋         | 34/520 [6:25:56<110:43:36, 820.20s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_284
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:18<11:47, 78.59s/it][A[2024-05-29 07:05:02,747] [INFO] [logging.py:96:log_dist] [Rank 0] step=341, skipped=0, lr=[1.9953974820019984e-05], mom=[(0.9, 0.999)]
steps: 341 loss: 0.5741 iter time (s): 78.236 samples/sec: 1.636

 10%|█         | 1/10 [01:18<11:50, 78.99s/it][A
 10%|█         | 1/10 [01:19<11:51, 79.03s/it][A
 10%|█         | 1/10 [01:19<11:51, 79.03s/it][A
 10%|█         | 1/10 [01:18<11:50, 78.99s/it][A
 10%|█         | 1/10 [01:19<11:51, 79.08s/it][A
 10%|█         | 1/10 [01:19<11:51, 79.09s/it][A
 10%|█         | 1/10 [01:19<11:51, 79.08s/it][A
 20%|██        | 2/10 [02:36<10:25, 78.21s/it][A[2024-05-29 07:06:20,686] [INFO] [logging.py:96:log_dist] [Rank 0] step=342, skipped=0, lr=[1.9953430442415384e-05], mom=[(0.9, 0.999)]
steps: 342 loss: 0.5697 iter time (s): 77.198 samples/sec: 1.658

 20%|██        | 2/10 [02:36<10:27, 78.40s/it][A
 20%|██        | 2/10 [02:37<10:27, 78.44s/it][A
 20%|██        | 2/10 [02:36<10:27, 78.38s/it][A
 20%|██        | 2/10 [02:37<10:27, 78.43s/it][A
 20%|██        | 2/10 [02:37<10:27, 78.44s/it][A
 20%|██        | 2/10 [02:37<10:27, 78.43s/it][A
 20%|██        | 2/10 [02:37<10:27, 78.43s/it][A
 30%|███       | 3/10 [03:54<09:07, 78.28s/it][A[2024-05-29 07:07:39,055] [INFO] [logging.py:96:log_dist] [Rank 0] step=343, skipped=0, lr=[1.9952882871824054e-05], mom=[(0.9, 0.999)]
steps: 343 loss: 0.5778 iter time (s): 77.588 samples/sec: 1.650

 30%|███       | 3/10 [03:55<09:08, 78.36s/it][A
 30%|███       | 3/10 [03:55<09:08, 78.37s/it][A
 30%|███       | 3/10 [03:55<09:08, 78.36s/it][A
 30%|███       | 3/10 [03:55<09:08, 78.37s/it][A
 30%|███       | 3/10 [03:55<09:08, 78.36s/it][A
 30%|███       | 3/10 [03:55<09:08, 78.37s/it][A
 30%|███       | 3/10 [03:55<09:08, 78.37s/it][A
 40%|████      | 4/10 [05:14<07:51, 78.63s/it][A[2024-05-29 07:08:58,228] [INFO] [logging.py:96:log_dist] [Rank 0] step=344, skipped=0, lr=[1.995233210842166e-05], mom=[(0.9, 0.999)]
steps: 344 loss: 0.5592 iter time (s): 78.459 samples/sec: 1.631

 40%|████      | 4/10 [05:14<07:52, 78.67s/it][A
 40%|████      | 4/10 [05:14<07:52, 78.71s/it][A
 40%|████      | 4/10 [05:14<07:52, 78.71s/it][A
 40%|████      | 4/10 [05:14<07:52, 78.71s/it][A
 40%|████      | 4/10 [05:14<07:52, 78.71s/it][A
 40%|████      | 4/10 [05:14<07:52, 78.70s/it][A
 40%|████      | 4/10 [05:14<07:52, 78.71s/it][A
 50%|█████     | 5/10 [06:34<06:35, 79.18s/it][A[2024-05-29 07:10:18,408] [INFO] [logging.py:96:log_dist] [Rank 0] step=345, skipped=0, lr=[1.9951778152384908e-05], mom=[(0.9, 0.999)]
steps: 345 loss: 0.5898 iter time (s): 79.420 samples/sec: 1.612

 50%|█████     | 5/10 [06:34<06:36, 79.22s/it][A
 50%|█████     | 5/10 [06:34<06:36, 79.24s/it][A
 50%|█████     | 5/10 [06:34<06:36, 79.24s/it][A
 50%|█████     | 5/10 [06:34<06:36, 79.22s/it][A
 50%|█████     | 5/10 [06:34<06:36, 79.23s/it][A
 50%|█████     | 5/10 [06:34<06:36, 79.23s/it][A
 50%|█████     | 5/10 [06:34<06:36, 79.23s/it][A
 60%|██████    | 6/10 [07:53<05:17, 79.33s/it][A[2024-05-29 07:11:38,006] [INFO] [logging.py:96:log_dist] [Rank 0] step=346, skipped=0, lr=[1.9951221003891517e-05], mom=[(0.9, 0.999)]
steps: 346 loss: 0.5724 iter time (s): 78.861 samples/sec: 1.623

 60%|██████    | 6/10 [07:54<05:17, 79.38s/it][A
 60%|██████    | 6/10 [07:54<05:17, 79.37s/it][A
 60%|██████    | 6/10 [07:54<05:17, 79.36s/it][A
 60%|██████    | 6/10 [07:54<05:17, 79.38s/it][A
 60%|██████    | 6/10 [07:54<05:17, 79.37s/it][A
 60%|██████    | 6/10 [07:54<05:17, 79.38s/it][A
 60%|██████    | 6/10 [07:54<05:17, 79.38s/it][A
 70%|███████   | 7/10 [09:13<03:58, 79.39s/it][A[2024-05-29 07:12:57,532] [INFO] [logging.py:96:log_dist] [Rank 0] step=347, skipped=0, lr=[1.9950660663120237e-05], mom=[(0.9, 0.999)]
steps: 347 loss: 0.5713 iter time (s): 78.702 samples/sec: 1.626

 70%|███████   | 7/10 [09:13<03:58, 79.41s/it][A
 70%|███████   | 7/10 [09:13<03:58, 79.40s/it][A
 70%|███████   | 7/10 [09:13<03:58, 79.42s/it][A
 70%|███████   | 7/10 [09:13<03:58, 79.43s/it][A
 70%|███████   | 7/10 [09:13<03:58, 79.43s/it][A
 70%|███████   | 7/10 [09:13<03:58, 79.43s/it][A
 70%|███████   | 7/10 [09:13<03:58, 79.43s/it][A
 80%|████████  | 8/10 [10:33<02:39, 79.69s/it][A[2024-05-29 07:14:17,873] [INFO] [logging.py:96:log_dist] [Rank 0] step=348, skipped=0, lr=[1.995009713025083e-05], mom=[(0.9, 0.999)]
steps: 348 loss: 0.5817 iter time (s): 79.511 samples/sec: 1.610

 80%|████████  | 8/10 [10:34<02:39, 79.72s/it][A
 80%|████████  | 8/10 [10:34<02:39, 79.71s/it][A
 80%|████████  | 8/10 [10:34<02:39, 79.71s/it][A
 80%|████████  | 8/10 [10:34<02:39, 79.71s/it][A
 80%|████████  | 8/10 [10:34<02:39, 79.72s/it][A
 80%|████████  | 8/10 [10:34<02:39, 79.71s/it][A
 80%|████████  | 8/10 [10:34<02:39, 79.72s/it][A
 90%|█████████ | 9/10 [11:54<01:19, 79.92s/it][A[2024-05-29 07:15:38,304] [INFO] [logging.py:96:log_dist] [Rank 0] step=349, skipped=0, lr=[1.9949530405464102e-05], mom=[(0.9, 0.999)]
steps: 349 loss: 0.5737 iter time (s): 79.611 samples/sec: 1.608

 90%|█████████ | 9/10 [11:54<01:19, 79.94s/it][A
 90%|█████████ | 9/10 [11:54<01:19, 79.94s/it][A
 90%|█████████ | 9/10 [11:54<01:19, 79.94s/it][A
 90%|█████████ | 9/10 [11:54<01:19, 79.95s/it][A
 90%|█████████ | 9/10 [11:54<01:19, 79.95s/it][A
 90%|█████████ | 9/10 [11:54<01:19, 79.94s/it][A
 90%|█████████ | 9/10 [11:54<01:19, 79.95s/it][A
100%|██████████| 10/10 [13:14<00:00, 79.93s/it][A100%|██████████| 10/10 [13:14<00:00, 79.41s/it]
  7%|▋         | 35/520 [6:39:15<109:27:05, 812.42s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 07:16:58,252] [INFO] [logging.py:96:log_dist] [Rank 0] step=350, skipped=0, lr=[1.994896048894187e-05], mom=[(0.9, 0.999)]
steps: 350 loss: 0.5530 iter time (s): 79.113 samples/sec: 1.618

100%|██████████| 10/10 [13:14<00:00, 79.95s/it][A100%|██████████| 10/10 [13:14<00:00, 79.46s/it]
  7%|▋         | 35/520 [6:38:47<109:27:54, 812.52s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:14<00:00, 79.96s/it][A100%|██████████| 10/10 [13:14<00:00, 79.47s/it]
  7%|▋         | 35/520 [6:39:22<109:28:08, 812.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:14<00:00, 79.94s/it][A100%|██████████| 10/10 [13:14<00:00, 79.46s/it]
  7%|▋         | 35/520 [6:38:55<109:27:50, 812.52s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:14<00:00, 79.95s/it][A100%|██████████| 10/10 [13:14<00:00, 79.46s/it]
  7%|▋         | 35/520 [6:38:39<109:28:03, 812.54s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:14<00:00, 79.96s/it][A100%|██████████| 10/10 [13:14<00:00, 79.47s/it]
  7%|▋         | 35/520 [6:39:24<109:28:07, 812.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:14<00:00, 79.96s/it][A100%|██████████| 10/10 [13:14<00:00, 79.47s/it]
  7%|▋         | 35/520 [6:39:04<109:28:08, 812.55s/it]
100%|██████████| 10/10 [13:14<00:00, 79.95s/it][A100%|██████████| 10/10 [13:14<00:00, 79.47s/it]
  7%|▋         | 35/520 [6:39:10<109:28:07, 812.55s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_397

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:43<15:32, 103.59s/it][A[2024-05-29 07:18:42,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=351, skipped=0, lr=[1.9948387380866977e-05], mom=[(0.9, 0.999)]
steps: 351 loss: 0.8468 iter time (s): 103.316 samples/sec: 1.239

 10%|█         | 1/10 [01:44<15:37, 104.16s/it][A
 10%|█         | 1/10 [01:44<15:38, 104.23s/it][A
 10%|█         | 1/10 [01:44<15:39, 104.33s/it][A
 10%|█         | 1/10 [01:44<15:38, 104.23s/it][A
 10%|█         | 1/10 [01:44<15:38, 104.30s/it][A
 10%|█         | 1/10 [01:44<15:39, 104.37s/it][A
 10%|█         | 1/10 [01:44<15:39, 104.39s/it][A
 20%|██        | 2/10 [03:27<13:48, 103.61s/it][A[2024-05-29 07:20:25,963] [INFO] [logging.py:96:log_dist] [Rank 0] step=352, skipped=0, lr=[1.9947811081423287e-05], mom=[(0.9, 0.999)]
steps: 352 loss: 0.8196 iter time (s): 102.479 samples/sec: 1.249

 20%|██        | 2/10 [03:27<13:50, 103.76s/it][A
 20%|██        | 2/10 [03:27<13:50, 103.75s/it][A
 20%|██        | 2/10 [03:27<13:50, 103.77s/it][A
 20%|██        | 2/10 [03:27<13:49, 103.74s/it][A
 20%|██        | 2/10 [03:27<13:49, 103.72s/it][A
 20%|██        | 2/10 [03:27<13:49, 103.72s/it][A
 20%|██        | 2/10 [03:27<13:49, 103.73s/it][A
 30%|███       | 3/10 [05:10<12:02, 103.28s/it][A[2024-05-29 07:22:08,772] [INFO] [logging.py:96:log_dist] [Rank 0] step=353, skipped=0, lr=[1.994723159079569e-05], mom=[(0.9, 0.999)]
steps: 353 loss: 0.8018 iter time (s): 102.023 samples/sec: 1.255

 30%|███       | 3/10 [05:10<12:03, 103.32s/it][A
 30%|███       | 3/10 [05:10<12:03, 103.32s/it][A
 30%|███       | 3/10 [05:10<12:03, 103.32s/it][A
 30%|███       | 3/10 [05:10<12:03, 103.31s/it][A
 30%|███       | 3/10 [05:10<12:03, 103.32s/it][A
 30%|███       | 3/10 [05:10<12:03, 103.31s/it][A
 30%|███       | 3/10 [05:10<12:03, 103.32s/it][A
 40%|████      | 4/10 [06:52<10:16, 102.81s/it][A[2024-05-29 07:23:51,102] [INFO] [logging.py:96:log_dist] [Rank 0] step=354, skipped=0, lr=[1.994664890917011e-05], mom=[(0.9, 0.999)]
steps: 354 loss: 0.7899 iter time (s): 101.528 samples/sec: 1.261

 40%|████      | 4/10 [06:52<10:17, 102.93s/it][A
 40%|████      | 4/10 [06:52<10:17, 102.94s/it][A
 40%|████      | 4/10 [06:52<10:17, 102.96s/it][A
 40%|████      | 4/10 [06:52<10:17, 102.94s/it][A
 40%|████      | 4/10 [06:52<10:17, 102.93s/it][A
 40%|████      | 4/10 [06:52<10:17, 102.93s/it][A
 40%|████      | 4/10 [06:52<10:17, 102.93s/it][A
 50%|█████     | 5/10 [08:34<08:32, 102.49s/it][A[2024-05-29 07:25:33,029] [INFO] [logging.py:96:log_dist] [Rank 0] step=355, skipped=0, lr=[1.9946063036733475e-05], mom=[(0.9, 0.999)]
steps: 355 loss: 0.7556 iter time (s): 101.117 samples/sec: 1.266

 50%|█████     | 5/10 [08:34<08:32, 102.59s/it][A
 50%|█████     | 5/10 [08:34<08:32, 102.53s/it][A
 50%|█████     | 5/10 [08:34<08:32, 102.59s/it][A
 50%|█████     | 5/10 [08:34<08:32, 102.59s/it][A
 50%|█████     | 5/10 [08:34<08:32, 102.59s/it][A
 50%|█████     | 5/10 [08:34<08:32, 102.58s/it][A
 50%|█████     | 5/10 [08:34<08:32, 102.58s/it][A
 60%|██████    | 6/10 [10:15<06:48, 102.11s/it][A[2024-05-29 07:27:14,421] [INFO] [logging.py:96:log_dist] [Rank 0] step=356, skipped=0, lr=[1.9945473973673758e-05], mom=[(0.9, 0.999)]
steps: 356 loss: 0.7690 iter time (s): 100.553 samples/sec: 1.273

 60%|██████    | 6/10 [10:16<06:48, 102.15s/it][A
 60%|██████    | 6/10 [10:16<06:48, 102.15s/it][A
 60%|██████    | 6/10 [10:16<06:48, 102.17s/it][A
 60%|██████    | 6/10 [10:16<06:48, 102.17s/it][A
 60%|██████    | 6/10 [10:16<06:48, 102.17s/it][A
 60%|██████    | 6/10 [10:16<06:48, 102.16s/it][A
 60%|██████    | 6/10 [10:16<06:48, 102.17s/it][A
 70%|███████   | 7/10 [11:57<05:05, 102.00s/it][A[2024-05-29 07:28:56,174] [INFO] [logging.py:96:log_dist] [Rank 0] step=357, skipped=0, lr=[1.9944881720179935e-05], mom=[(0.9, 0.999)]
steps: 357 loss: 0.7367 iter time (s): 100.945 samples/sec: 1.268

 70%|███████   | 7/10 [11:57<05:06, 102.02s/it][A
 70%|███████   | 7/10 [11:57<05:06, 102.05s/it][A
 70%|███████   | 7/10 [11:57<05:06, 102.04s/it][A
 70%|███████   | 7/10 [11:57<05:06, 102.02s/it][A
 70%|███████   | 7/10 [11:57<05:06, 102.03s/it][A
 70%|███████   | 7/10 [11:57<05:06, 102.02s/it][A
 70%|███████   | 7/10 [11:57<05:06, 102.03s/it][A
 80%|████████  | 8/10 [13:39<03:23, 101.94s/it][A[2024-05-29 07:30:37,976] [INFO] [logging.py:96:log_dist] [Rank 0] step=358, skipped=0, lr=[1.9944286276442023e-05], mom=[(0.9, 0.999)]
steps: 358 loss: 0.7418 iter time (s): 101.000 samples/sec: 1.267

 80%|████████  | 8/10 [13:39<03:23, 101.98s/it][A
 80%|████████  | 8/10 [13:39<03:23, 101.97s/it][A
 80%|████████  | 8/10 [13:39<03:23, 101.95s/it][A
 80%|████████  | 8/10 [13:39<03:23, 102.00s/it][A
 80%|████████  | 8/10 [13:39<03:23, 101.99s/it][A
 80%|████████  | 8/10 [13:39<03:24, 102.02s/it][A
 80%|████████  | 8/10 [13:39<03:24, 102.02s/it][A
 90%|█████████ | 9/10 [15:22<01:42, 102.27s/it][A[2024-05-29 07:32:20,967] [INFO] [logging.py:96:log_dist] [Rank 0] step=359, skipped=0, lr=[1.994368764265105e-05], mom=[(0.9, 0.999)]
steps: 359 loss: 0.7237 iter time (s): 101.994 samples/sec: 1.255

 90%|█████████ | 9/10 [15:22<01:42, 102.25s/it][A
 90%|█████████ | 9/10 [15:22<01:42, 102.27s/it][A
 90%|█████████ | 9/10 [15:22<01:42, 102.26s/it][A
 90%|█████████ | 9/10 [15:22<01:42, 102.30s/it][A
 90%|█████████ | 9/10 [15:22<01:42, 102.27s/it][A
 90%|█████████ | 9/10 [15:22<01:42, 102.25s/it][A
 90%|█████████ | 9/10 [15:22<01:42, 102.25s/it][A
100%|██████████| 10/10 [17:02<00:00, 101.81s/it][A100%|██████████| 10/10 [17:02<00:00, 102.28s/it]
  7%|▋         | 36/520 [6:56:18<117:42:41, 875.54s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 07:34:01,743] [INFO] [logging.py:96:log_dist] [Rank 0] step=360, skipped=0, lr=[1.994308581899908e-05], mom=[(0.9, 0.999)]
steps: 360 loss: 0.7035 iter time (s): 100.010 samples/sec: 1.280

100%|██████████| 10/10 [17:03<00:00, 101.84s/it][A100%|██████████| 10/10 [17:03<00:00, 102.35s/it]
  7%|▋         | 36/520 [6:55:51<117:44:44, 875.79s/it]
100%|██████████| 10/10 [17:03<00:00, 101.80s/it][A100%|██████████| 10/10 [17:03<00:00, 102.33s/it]
  7%|▋         | 36/520 [6:56:26<117:44:32, 875.77s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:03<00:00, 101.80s/it][A100%|██████████| 10/10 [17:03<00:00, 102.35s/it]
  7%|▋         | 36/520 [6:55:59<117:44:39, 875.78s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:03<00:00, 101.79s/it][A100%|██████████| 10/10 [17:03<00:00, 102.33s/it]
  7%|▋         | 36/520 [6:55:43<117:44:31, 875.77s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:03<00:00, 101.78s/it][A100%|██████████| 10/10 [17:03<00:00, 102.33s/it]
  7%|▋         | 36/520 [6:56:27<117:44:34, 875.77s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:03<00:00, 101.78s/it][A100%|██████████| 10/10 [17:03<00:00, 102.34s/it]
  7%|▋         | 36/520 [6:56:07<117:44:35, 875.78s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:03<00:00, 101.78s/it][A100%|██████████| 10/10 [17:03<00:00, 102.34s/it]
  7%|▋         | 36/520 [6:56:14<117:44:34, 875.77s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_132
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:42<15:26, 102.98s/it][A[2024-05-29 07:35:44,788] [INFO] [logging.py:96:log_dist] [Rank 0] step=361, skipped=0, lr=[1.9942480805679182e-05], mom=[(0.9, 0.999)]
steps: 361 loss: 0.6081 iter time (s): 102.239 samples/sec: 1.252

 10%|█         | 1/10 [01:42<15:26, 102.96s/it][A
 10%|█         | 1/10 [01:43<15:27, 103.08s/it][A
 10%|█         | 1/10 [01:43<15:27, 103.04s/it][A
 10%|█         | 1/10 [01:43<15:27, 103.08s/it][A
 10%|█         | 1/10 [01:43<15:27, 103.09s/it][A
 10%|█         | 1/10 [01:43<15:27, 103.10s/it][A
 10%|█         | 1/10 [01:43<15:28, 103.11s/it][A
 20%|██        | 2/10 [03:26<13:44, 103.01s/it][A[2024-05-29 07:37:27,831] [INFO] [logging.py:96:log_dist] [Rank 0] step=362, skipped=0, lr=[1.9941872602885468e-05], mom=[(0.9, 0.999)]
steps: 362 loss: 0.6151 iter time (s): 102.269 samples/sec: 1.252

 20%|██        | 2/10 [03:25<13:43, 102.98s/it][A
 20%|██        | 2/10 [03:26<13:44, 103.06s/it][A
 20%|██        | 2/10 [03:26<13:44, 103.02s/it][A
 20%|██        | 2/10 [03:26<13:44, 103.05s/it][A
 20%|██        | 2/10 [03:26<13:44, 103.04s/it][A
 20%|██        | 2/10 [03:26<13:44, 103.04s/it][A
 20%|██        | 2/10 [03:26<13:44, 103.04s/it][A
 30%|███       | 3/10 [05:10<12:04, 103.51s/it][A[2024-05-29 07:39:11,955] [INFO] [logging.py:96:log_dist] [Rank 0] step=363, skipped=0, lr=[1.9941261210813058e-05], mom=[(0.9, 0.999)]
steps: 363 loss: 0.6001 iter time (s): 103.391 samples/sec: 1.238

 30%|███       | 3/10 [05:10<12:04, 103.51s/it][A
 30%|███       | 3/10 [05:10<12:04, 103.57s/it][A
 30%|███       | 3/10 [05:10<12:05, 103.58s/it][A
 30%|███       | 3/10 [05:10<12:04, 103.57s/it][A
 30%|███       | 3/10 [05:10<12:04, 103.55s/it][A
 30%|███       | 3/10 [05:10<12:04, 103.55s/it][A
 30%|███       | 3/10 [05:10<12:04, 103.55s/it][A
 40%|████      | 4/10 [06:53<10:20, 103.37s/it][A[2024-05-29 07:40:55,100] [INFO] [logging.py:96:log_dist] [Rank 0] step=364, skipped=0, lr=[1.9940646629658112e-05], mom=[(0.9, 0.999)]
steps: 364 loss: 0.6115 iter time (s): 102.378 samples/sec: 1.250

 40%|████      | 4/10 [06:53<10:20, 103.39s/it][A
 40%|████      | 4/10 [06:53<10:20, 103.38s/it][A
 40%|████      | 4/10 [06:53<10:20, 103.38s/it][A
 40%|████      | 4/10 [06:53<10:20, 103.41s/it][A
 40%|████      | 4/10 [06:53<10:20, 103.41s/it][A
 40%|████      | 4/10 [06:53<10:20, 103.39s/it][A
 40%|████      | 4/10 [06:53<10:20, 103.40s/it][A
 50%|█████     | 5/10 [08:38<08:39, 103.98s/it][A[2024-05-29 07:42:40,160] [INFO] [logging.py:96:log_dist] [Rank 0] step=365, skipped=0, lr=[1.9940028859617792e-05], mom=[(0.9, 0.999)]
steps: 365 loss: 0.6181 iter time (s): 104.304 samples/sec: 1.227

 50%|█████     | 5/10 [08:38<08:39, 104.00s/it][A
 50%|█████     | 5/10 [08:38<08:39, 103.94s/it][A
 50%|█████     | 5/10 [08:38<08:39, 104.00s/it][A
 50%|█████     | 5/10 [08:38<08:39, 103.96s/it][A
 50%|█████     | 5/10 [08:38<08:39, 103.99s/it][A
 50%|█████     | 5/10 [08:38<08:39, 103.97s/it][A
 50%|█████     | 5/10 [08:38<08:39, 103.98s/it][A
 60%|██████    | 6/10 [10:22<06:55, 103.94s/it][A[2024-05-29 07:44:24,011] [INFO] [logging.py:96:log_dist] [Rank 0] step=366, skipped=0, lr=[1.99394079008903e-05], mom=[(0.9, 0.999)]
steps: 366 loss: 0.5727 iter time (s): 103.133 samples/sec: 1.241

 60%|██████    | 6/10 [10:22<06:55, 103.94s/it][A
 60%|██████    | 6/10 [10:22<06:55, 103.95s/it][A
 60%|██████    | 6/10 [10:22<06:55, 103.94s/it][A
 60%|██████    | 6/10 [10:22<06:55, 103.96s/it][A
 60%|██████    | 6/10 [10:22<06:55, 103.95s/it][A
 60%|██████    | 6/10 [10:22<06:55, 103.97s/it][A
 60%|██████    | 6/10 [10:22<06:55, 103.96s/it][A
 70%|███████   | 7/10 [12:05<05:10, 103.59s/it][A[2024-05-29 07:46:06,877] [INFO] [logging.py:96:log_dist] [Rank 0] step=367, skipped=0, lr=[1.993878375367485e-05], mom=[(0.9, 0.999)]
steps: 367 loss: 0.5814 iter time (s): 102.071 samples/sec: 1.254

 70%|███████   | 7/10 [12:05<05:10, 103.58s/it][A
 70%|███████   | 7/10 [12:05<05:10, 103.58s/it][A
 70%|███████   | 7/10 [12:05<05:10, 103.58s/it][A
 70%|███████   | 7/10 [12:05<05:10, 103.57s/it][A
 70%|███████   | 7/10 [12:05<05:10, 103.59s/it][A
 70%|███████   | 7/10 [12:05<05:10, 103.58s/it][A
 70%|███████   | 7/10 [12:05<05:10, 103.58s/it][A
 80%|████████  | 8/10 [13:49<03:27, 103.90s/it][A[2024-05-29 07:47:51,450] [INFO] [logging.py:96:log_dist] [Rank 0] step=368, skipped=0, lr=[1.993815641817169e-05], mom=[(0.9, 0.999)]
steps: 368 loss: 0.5731 iter time (s): 103.835 samples/sec: 1.233

 80%|████████  | 8/10 [13:49<03:27, 103.89s/it][A
 80%|████████  | 8/10 [13:49<03:27, 103.91s/it][A
 80%|████████  | 8/10 [13:49<03:27, 103.92s/it][A
 80%|████████  | 8/10 [13:49<03:27, 103.90s/it][A
 80%|████████  | 8/10 [13:49<03:27, 103.90s/it][A
 80%|████████  | 8/10 [13:49<03:27, 103.89s/it][A
 80%|████████  | 8/10 [13:49<03:27, 103.89s/it][A
 90%|█████████ | 9/10 [15:33<01:43, 103.94s/it][A[2024-05-29 07:49:35,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=369, skipped=0, lr=[1.9937525894582082e-05], mom=[(0.9, 0.999)]
steps: 369 loss: 0.5902 iter time (s): 103.324 samples/sec: 1.239

 90%|█████████ | 9/10 [15:33<01:43, 103.94s/it][A
 90%|█████████ | 9/10 [15:33<01:43, 103.93s/it][A
 90%|█████████ | 9/10 [15:33<01:43, 103.94s/it][A
 90%|█████████ | 9/10 [15:33<01:43, 103.94s/it][A
 90%|█████████ | 9/10 [15:33<01:43, 103.94s/it][A
 90%|█████████ | 9/10 [15:33<01:43, 103.94s/it][A
 90%|█████████ | 9/10 [15:33<01:43, 103.94s/it][A
100%|██████████| 10/10 [17:17<00:00, 103.96s/it][A100%|██████████| 10/10 [17:17<00:00, 103.77s/it]
  7%|▋         | 37/520 [7:13:35<123:59:43, 924.19s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 07:51:19,499] [INFO] [logging.py:96:log_dist] [Rank 0] step=370, skipped=0, lr=[1.9936892183108313e-05], mom=[(0.9, 0.999)]
steps: 370 loss: 0.5857 iter time (s): 103.299 samples/sec: 1.239

100%|██████████| 10/10 [17:17<00:00, 103.98s/it][A100%|██████████| 10/10 [17:17<00:00, 103.77s/it]
  7%|▋         | 37/520 [7:13:09<124:01:04, 924.36s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:17<00:00, 103.96s/it][A100%|██████████| 10/10 [17:17<00:00, 103.78s/it]
  7%|▋         | 37/520 [7:13:43<124:01:08, 924.36s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:17<00:00, 103.96s/it][A100%|██████████| 10/10 [17:17<00:00, 103.77s/it]
  7%|▋         | 37/520 [7:13:16<124:01:04, 924.36s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:17<00:00, 103.94s/it][A100%|██████████| 10/10 [17:17<00:00, 103.77s/it]
  7%|▋         | 37/520 [7:13:00<124:01:00, 924.35s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:17<00:00, 103.96s/it][A100%|██████████| 10/10 [17:17<00:00, 103.78s/it]
  7%|▋         | 37/520 [7:13:45<124:01:05, 924.36s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:17<00:00, 103.96s/it][A100%|██████████| 10/10 [17:17<00:00, 103.77s/it]
  7%|▋         | 37/520 [7:13:25<124:01:04, 924.36s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:17<00:00, 103.96s/it][A100%|██████████| 10/10 [17:17<00:00, 103.78s/it]
  7%|▋         | 37/520 [7:13:32<124:01:06, 924.36s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_144
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:42<24:20, 162.23s/it][A[2024-05-29 07:54:03,613] [INFO] [logging.py:96:log_dist] [Rank 0] step=371, skipped=0, lr=[1.9936255283953695e-05], mom=[(0.9, 0.999)]
steps: 371 loss: 0.5897 iter time (s): 163.304 samples/sec: 0.784

 10%|█         | 1/10 [02:43<24:30, 163.44s/it][A
 10%|█         | 1/10 [02:44<24:36, 164.05s/it][A
 10%|█         | 1/10 [02:44<24:36, 164.10s/it][A
 10%|█         | 1/10 [02:44<24:37, 164.17s/it][A
 10%|█         | 1/10 [02:44<24:37, 164.13s/it][A
 10%|█         | 1/10 [02:44<24:36, 164.05s/it][A
 10%|█         | 1/10 [02:44<24:36, 164.05s/it][A
 20%|██        | 2/10 [05:23<21:34, 161.85s/it][A[2024-05-29 07:56:45,069] [INFO] [logging.py:96:log_dist] [Rank 0] step=372, skipped=0, lr=[1.9935615197322563e-05], mom=[(0.9, 0.999)]
steps: 372 loss: 0.5802 iter time (s): 161.402 samples/sec: 0.793

 20%|██        | 2/10 [05:25<21:40, 162.52s/it][A
 20%|██        | 2/10 [05:25<21:40, 162.55s/it][A
 20%|██        | 2/10 [05:25<21:40, 162.56s/it][A
 20%|██        | 2/10 [05:25<21:40, 162.56s/it][A
 20%|██        | 2/10 [05:25<21:40, 162.56s/it][A
 20%|██        | 2/10 [05:25<21:41, 162.64s/it][A
 20%|██        | 2/10 [05:25<21:40, 162.55s/it][A
 30%|███       | 3/10 [08:05<18:52, 161.77s/it][A[2024-05-29 07:59:26,744] [INFO] [logging.py:96:log_dist] [Rank 0] step=373, skipped=0, lr=[1.9934971923420264e-05], mom=[(0.9, 0.999)]
steps: 373 loss: 0.5602 iter time (s): 161.005 samples/sec: 0.795

 30%|███       | 3/10 [08:07<18:55, 162.20s/it][A
 30%|███       | 3/10 [08:07<18:55, 162.16s/it][A
 30%|███       | 3/10 [08:07<18:55, 162.18s/it][A
 30%|███       | 3/10 [08:07<18:55, 162.26s/it][A
 30%|███       | 3/10 [08:07<18:55, 162.25s/it][A
 30%|███       | 3/10 [08:07<18:55, 162.25s/it][A
 30%|███       | 3/10 [08:07<18:56, 162.30s/it][A
 40%|████      | 4/10 [10:52<16:22, 163.71s/it][A[2024-05-29 08:02:13,570] [INFO] [logging.py:96:log_dist] [Rank 0] step=374, skipped=0, lr=[1.9934325462453184e-05], mom=[(0.9, 0.999)]
steps: 374 loss: 0.5494 iter time (s): 165.925 samples/sec: 0.771

 40%|████      | 4/10 [10:53<16:22, 163.74s/it][A
 40%|████      | 4/10 [10:54<16:23, 163.97s/it][A
 40%|████      | 4/10 [10:54<16:23, 163.98s/it][A
 40%|████      | 4/10 [10:53<16:23, 163.91s/it][A
 40%|████      | 4/10 [10:53<16:23, 163.94s/it][A
 40%|████      | 4/10 [10:53<16:23, 163.91s/it][A
 40%|████      | 4/10 [10:53<16:23, 163.91s/it][A 40%|████      | 4/10 [13:18<19:57, 199.64s/it]
  7%|▋         | 37/520 [7:26:50<97:13:08, 724.61s/it] 
Traceback (most recent call last):
  File "llava/train_parallel_deepspeed_mixtral_lora.py", line 384, in <module>
    main()
  File "llava/train_parallel_deepspeed_mixtral_lora.py", line 362, in main
    loss = engine.train_batch(data_iter=training_dataloader)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/pipe/engine.py", line 373, in train_batch
    self._exec_schedule(sched)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/pipe/engine.py", line 1373, in _exec_schedule
    self._exec_instr(**cmd.kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/pipe/engine.py", line 789, in _exec_backward_pass
    torch.autograd.backward(tensors=out_tensors, grad_tensors=grad_tensors)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/autograd/__init__.py", line 266, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 122.00 MiB. GPU 0 has a total capacity of 79.14 GiB of which 70.75 MiB is free. Including non-PyTorch memory, this process has 79.06 GiB memory in use. Of the allocated memory 69.61 GiB is allocated by PyTorch, and 4.83 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[2024-05-29 08:05:01,874] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3980491
[2024-05-29 08:05:01,895] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3980492
[2024-05-29 08:05:02,947] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3980493
[2024-05-29 08:05:03,953] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3980494
[2024-05-29 08:05:04,958] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3980495
[2024-05-29 08:05:06,892] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3980496
[2024-05-29 08:05:08,944] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3980497
[2024-05-29 08:05:09,906] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 3980498
[2024-05-29 08:05:10,905] [ERROR] [launch.py:322:sigkill_handler] ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=7', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=10', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint'] exits with return code = 1
