[2024-05-29 21:50:50,613] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:50:54,464] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-05-29 21:50:54,464] [INFO] [runner.py:568:main] cmd = /home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgMywgNCwgNSwgNiwgN119 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None llava/train_parallel_deepspeed_mixtral_lora.py --num_stages=8 --lora_r=256 --lora_alpha=512 --save_model_shard=10 --skip_shard=40 --checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint
[2024-05-29 21:50:57,653] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:50:59,320] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]}
[2024-05-29 21:50:59,320] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=8, node_rank=0
[2024-05-29 21:50:59,320] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]})
[2024-05-29 21:50:59,320] [INFO] [launch.py:163:main] dist_world_size=8
[2024-05-29 21:50:59,320] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
[2024-05-29 21:50:59,334] [INFO] [launch.py:253:main] process 1794366 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=0', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=40', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:50:59,344] [INFO] [launch.py:253:main] process 1794367 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=1', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=40', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:50:59,355] [INFO] [launch.py:253:main] process 1794368 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=2', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=40', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:50:59,367] [INFO] [launch.py:253:main] process 1794369 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=3', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=40', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:50:59,376] [INFO] [launch.py:253:main] process 1794370 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=4', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=40', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:50:59,386] [INFO] [launch.py:253:main] process 1794371 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=5', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=40', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:50:59,404] [INFO] [launch.py:253:main] process 1794372 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=6', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=40', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:50:59,421] [INFO] [launch.py:253:main] process 1794373 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=7', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=40', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint']
[2024-05-29 21:51:05,428] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:51:06,204] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:51:11,373] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:51:11,986] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:51:12,071] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:51:12,692] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:51:15,999] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:51:16,371] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:51:16,629] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:51:16,735] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:51:16,811] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-05-29 21:51:17,110] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:51:17,335] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:51:17,510] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-05-29 21:51:17,510] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:24,  1.27s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:23,  1.22s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:24,  1.28s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:24,  1.29s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:25,  1.34s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:29,  1.58s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:25,  1.40s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:25,  1.40s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:25,  1.40s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:02<00:26,  1.47s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:29,  1.66s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:28,  1.58s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:23,  1.41s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:25,  1.48s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:24,  1.45s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:25,  1.53s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:28,  1.68s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:05<00:22,  1.43s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:27,  1.62s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:05<00:23,  1.45s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:05<00:23,  1.49s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:05<00:23,  1.45s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:06<00:27,  1.73s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:07<00:21,  1.43s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:07<00:21,  1.45s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:07<00:21,  1.44s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:06<00:26,  1.66s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:07<00:22,  1.53s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:08<00:19,  1.37s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:08<00:20,  1.46s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:08<00:26,  1.75s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:08<00:20,  1.48s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:09<00:23,  1.65s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:08<00:27,  1.82s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:09<00:17,  1.31s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:10<00:19,  1.53s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:10<00:20,  1.55s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:10<00:24,  1.78s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:10<00:21,  1.63s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:10<00:25,  1.79s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:11<00:17,  1.45s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:12<00:19,  1.59s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:12<00:19,  1.60s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:11<00:22,  1.72s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:12<00:15,  1.42s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:12<00:19,  1.66s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:11<00:22,  1.73s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:13<00:17,  1.58s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:13<00:17,  1.60s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:13<00:20,  1.71s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:14<00:17,  1.63s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:14<00:14,  1.46s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:13<00:20,  1.71s/it][2024-05-29 21:51:36,615] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Loading checkpoint shards:  50%|█████     | 10/20 [00:15<00:15,  1.55s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:15<00:15,  1.59s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:15<00:18,  1.66s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:15<00:12,  1.44s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:15<00:16,  1.65s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:15<00:18,  1.69s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:16<00:14,  1.57s/it][2024-05-29 21:51:38,358] [INFO] [comm.py:637:init_distributed] cdb=None
Loading checkpoint shards:  50%|█████     | 10/20 [00:16<00:16,  1.60s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:16<00:14,  1.61s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:16<00:11,  1.39s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:16<00:15,  1.56s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:17<00:15,  1.70s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:18<00:10,  1.56s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:18<00:14,  1.75s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:19<00:14,  1.81s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:19<00:16,  1.85s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:19<00:16,  1.87s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:20<00:16,  2.00s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:21<00:13,  1.88s/it]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:  70%|███████   | 14/20 [00:21<00:10,  1.83s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:21<00:15,  1.92s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:21<00:13,  1.93s/it]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:  60%|██████    | 12/20 [00:20<00:14,  1.85s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:28,  1.48s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:22<00:14,  2.12s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:29,  1.54s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:23<00:09,  1.87s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:23<00:12,  2.05s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:23<00:14,  2.10s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:24<00:12,  2.14s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:23<00:13,  1.96s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:33,  1.85s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:25<00:12,  2.15s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:35,  1.99s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:25<00:09,  1.94s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:25<00:08,  2.03s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:24<00:11,  1.92s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:26<00:10,  2.16s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:26<00:13,  2.30s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:33,  1.96s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:27<00:10,  2.13s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:27<00:05,  2.00s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:06<00:37,  2.22s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:26<00:09,  1.89s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:28<00:08,  2.04s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:28<00:09,  2.31s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:28<00:11,  2.31s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:31,  1.97s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:29<00:08,  2.21s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:08<00:35,  2.20s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:30<00:06,  2.08s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:29<00:08,  2.09s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:30<00:04,  2.22s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:30<00:07,  2.38s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:30,  2.04s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:31<00:09,  2.40s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:32<00:07,  2.43s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:11<00:35,  2.39s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:33<00:04,  2.34s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:32<00:07,  2.34s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:29,  2.13s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:33<00:07,  2.44s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:34<00:02,  2.72s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:34<00:05,  2.67s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:13<00:34,  2.45s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:35<00:05,  2.51s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:14<00:26,  2.06s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:35<00:00,  2.32s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:35<00:00,  1.78s/it]
Loading checkpoint shards:  90%|█████████ | 18/20 [00:34<00:04,  2.40s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:35<00:02,  2.44s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:36<00:04,  2.44s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:36<00:02,  2.58s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:37<00:00,  2.12s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:37<00:00,  1.86s/it]
Loading checkpoint shards:  35%|███▌      | 7/20 [00:15<00:30,  2.35s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:37<00:00,  1.98s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:37<00:00,  1.86s/it]
Loading checkpoint shards:  95%|█████████▌| 19/20 [00:36<00:02,  2.15s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:37<00:02,  2.44s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:16<00:25,  2.15s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:37<00:00,  1.70s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:37<00:00,  1.85s/it]
Loading checkpoint shards: 100%|██████████| 20/20 [00:38<00:00,  1.89s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:38<00:00,  1.90s/it]
Loading checkpoint shards:  45%|████▌     | 9/20 [00:18<00:22,  2.07s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:18<00:29,  2.48s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:40<00:02,  2.94s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:41<00:00,  2.36s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:41<00:00,  2.07s/it]
Loading checkpoint shards:  50%|█████     | 10/20 [00:20<00:20,  2.09s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:21<00:28,  2.56s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:22<00:19,  2.20s/it]Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
Loading checkpoint shards:  50%|█████     | 10/20 [00:24<00:26,  2.66s/it]Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
Loading checkpoint shards:  60%|██████    | 12/20 [00:24<00:17,  2.17s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:26<00:21,  2.43s/it]Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
Loading checkpoint shards:  65%|██████▌   | 13/20 [00:27<00:15,  2.16s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:27<00:16,  2.12s/it]Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
Loading checkpoint shards:  70%|███████   | 14/20 [00:28<00:11,  1.95s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:28<00:12,  1.85s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:29<00:08,  1.65s/it]Rank 1 initialized with CUDA_MEM (60717531136, 84974239744)
Deepspeed engine initializing at --- RANK 1 --- ...
Loading checkpoint shards:  70%|███████   | 14/20 [00:29<00:09,  1.59s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:30<00:05,  1.40s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:30<00:06,  1.38s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:31<00:03,  1.26s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:31<00:05,  1.26s/it]Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Loading checkpoint shards:  90%|█████████ | 18/20 [00:32<00:02,  1.17s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:32<00:03,  1.17s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:33<00:01,  1.10s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:33<00:00,  1.22it/s]Loading checkpoint shards: 100%|██████████| 20/20 [00:33<00:00,  1.67s/it]
Loading checkpoint shards:  90%|█████████ | 18/20 [00:33<00:02,  1.07s/it]Rank 4 initialized with CUDA_MEM (60717531136, 84974239744)
Deepspeed engine initializing at --- RANK 4 --- ...
Loading checkpoint shards:  95%|█████████▌| 19/20 [00:34<00:00,  1.06it/s]Loading checkpoint shards: 100%|██████████| 20/20 [00:34<00:00,  1.35it/s]Loading checkpoint shards: 100%|██████████| 20/20 [00:34<00:00,  1.72s/it]
Rank 2 initialized with CUDA_MEM (60717531136, 84974239744)
Deepspeed engine initializing at --- RANK 2 --- ...
Rank 5 initialized with CUDA_MEM (60717531136, 84974239744)
Deepspeed engine initializing at --- RANK 5 --- ...
Rank 6 initialized with CUDA_MEM (60717531136, 84974239744)
Deepspeed engine initializing at --- RANK 6 --- ...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Rank 3 initialized with CUDA_MEM (60717531136, 84974239744)
Deepspeed engine initializing at --- RANK 3 --- ...
Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
SEED_LAYERS=False BASE_SEED=1234 SEED_FN=None
Using topology: {ProcessCoord(pipe=0, data=0): 0, ProcessCoord(pipe=1, data=0): 1, ProcessCoord(pipe=2, data=0): 2, ProcessCoord(pipe=3, data=0): 3, ProcessCoord(pipe=4, data=0): 4, ProcessCoord(pipe=5, data=0): 5, ProcessCoord(pipe=6, data=0): 6, ProcessCoord(pipe=7, data=0): 7}
[2024-05-29 21:52:19,095] [INFO] [module.py:375:_partition_layers] Partitioning pipeline stages with method type:LanguageModelLayerWrapper
stage=0 layers=2
     0: LlavaMultiModalModuleWrapper
     1: LanguageModelLayerWrapper
stage=1 layers=1
     2: LanguageModelLayerWrapper
stage=2 layers=1
     3: LanguageModelLayerWrapper
stage=3 layers=1
     4: LanguageModelLayerWrapper
stage=4 layers=1
     5: LanguageModelLayerWrapper
stage=5 layers=1
     6: LanguageModelLayerWrapper
stage=6 layers=1
     7: LanguageModelLayerWrapper
stage=7 layers=2
     8: LanguageModelLayerWrapper
     9: LanguageModelFinalWrapper
  loss: loss_fn
Print trainable params: 151011328 || all params: 47182493696 || trainable%: 0.32
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Rank 7 initialized with CUDA_MEM (60191145984, 84974239744)
Deepspeed engine initializing at --- RANK 7 --- ...
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 4.087140083312988 seconds
Rank 0 initialized with CUDA_MEM (58697973760, 84974239744)
[2024-05-29 21:52:23,006] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Deepspeed engine initializing at --- RANK 0 --- ...
[2024-05-29 21:52:23,011] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.14.0, git-hash=unknown, git-branch=unknown
Loading extension module fused_adam...
Time to load fused_adam op: 3.309488534927368 seconds
[2024-05-29 21:52:23,031] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 8.439688682556152 seconds
[2024-05-29 21:52:23,056] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 3.008934736251831 seconds
Loading extension module fused_adam...
Time to load fused_adam op: 2.2069826126098633 seconds
[2024-05-29 21:52:23,071] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
[2024-05-29 21:52:23,075] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 3.308924674987793 seconds
[2024-05-29 21:52:23,086] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
[2024-05-29 21:52:23,305] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Using /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/hpc/b207dd/b207dd11/.cache/torch_extensions/py38_cu121/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 9.620094537734985 seconds
[2024-05-29 21:52:34,109] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
Loading extension module fused_adam...
Time to load fused_adam op: 8.620893001556396 seconds
[2024-05-29 21:52:34,146] [INFO] [logging.py:96:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adam as basic optimizer
[2024-05-29 21:52:34,146] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-05-29 21:52:34,153] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-05-29 21:52:34,153] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2024-05-29 21:52:34,153] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = WarmupCosineLR
[2024-05-29 21:52:34,153] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupCosineLR object at 0x149050fb8e20>
[2024-05-29 21:52:34,153] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[2e-05], mom=[(0.9, 0.999)]
[2024-05-29 21:52:34,154] [INFO] [config.py:996:print] DeepSpeedEngine configuration:
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   amp_enabled .................. False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   amp_params ................... False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   bfloat16_enabled ............. False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   bfloat16_immediate_grad_update  False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   checkpoint_parallel_write_pipeline  False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   checkpoint_tag_validation_enabled  True
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   checkpoint_tag_validation_fail  False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x149050fb8970>
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   communication_data_type ...... None
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   compile_config ............... enabled=False backend='inductor' kwargs={}
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   curriculum_enabled_legacy .... False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   curriculum_params_legacy ..... False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   data_efficiency_enabled ...... False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   dataloader_drop_last ......... False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   disable_allgather ............ False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   dump_state ................... False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   dynamic_loss_scale_args ...... None
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   eigenvalue_enabled ........... False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   eigenvalue_gas_boundary_resolution  1
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   eigenvalue_layer_num ......... 0
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   eigenvalue_max_iter .......... 100
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   eigenvalue_stability ......... 1e-06
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   eigenvalue_tol ............... 0.01
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   eigenvalue_verbose ........... False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   elasticity_enabled ........... False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   fp16_auto_cast ............... None
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   fp16_enabled ................. False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   fp16_master_weights_and_gradients  False
[2024-05-29 21:52:34,155] [INFO] [config.py:1000:print]   global_rank .................. 0
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   grad_accum_dtype ............. None
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   gradient_accumulation_steps .. 128
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   gradient_clipping ............ 0.0
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   gradient_predivide_factor .... 1.0
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   graph_harvesting ............. False
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   initial_dynamic_scale ........ 65536
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   load_universal_checkpoint .... False
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   loss_scale ................... 0
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   memory_breakdown ............. False
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   mics_hierarchial_params_gather  False
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   mics_shard_size .............. -1
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=True, output_path='/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint', job_name='deepspeed_monitor_logs') enabled=True
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   optimizer_legacy_fusion ...... False
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   optimizer_name ............... adam
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   optimizer_params ............. {'lr': 2e-05}
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True, 'use_reentrant': False}
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   pld_enabled .................. False
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   pld_params ................... False
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   prescale_gradients ........... False
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   scheduler_name ............... WarmupCosineLR
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   scheduler_params ............. {'total_num_steps': 5718, 'warmup_min_ratio': 0.1, 'warmup_num_steps': 171.54}
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   seq_parallel_communication_data_type  torch.float32
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   sparse_attention ............. None
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   sparse_gradients_enabled ..... False
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   steps_per_print .............. 1
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   train_batch_size ............. 128
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   train_micro_batch_size_per_gpu  1
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   use_data_before_expert_parallel_  False
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   use_node_local_storage ....... False
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   wall_clock_breakdown ......... False
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   weight_quantization_config ... None
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   world_size ................... 1
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   zero_allow_untested_optimizer  False
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   zero_enabled ................. False
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   zero_force_ds_cpu_optimizer .. True
[2024-05-29 21:52:34,156] [INFO] [config.py:1000:print]   zero_optimization_stage ...... 0
[2024-05-29 21:52:34,156] [INFO] [config.py:986:print_user_config]   json = {
    "train_batch_size": 128, 
    "train_micro_batch_size_per_gpu": 1, 
    "gradient_accumulation_steps": 128, 
    "steps_per_print": 1, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 2e-05
        }
    }, 
    "scheduler": {
        "type": "WarmupCosineLR", 
        "params": {
            "total_num_steps": 5.718000e+03, 
            "warmup_min_ratio": 0.1, 
            "warmup_num_steps": 171.54
        }
    }, 
    "pipeline": {
        "use_reentrant": false
    }, 
    "csv_monitor": {
        "enabled": true, 
        "output_path": "/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint", 
        "job_name": "deepspeed_monitor_logs"
    }
}
[2024-05-29 21:52:34,156] [INFO] [engine.py:101:__init__] CONFIG: micro_batches=128 micro_batch_size=1
[2024-05-29 21:52:34,156] [INFO] [engine.py:141:__init__] is_pipe_partitioned= False is_grad_partitioned= False
[2024-05-29 21:52:38,643] [INFO] [engine.py:160:__init__] RANK=4 STAGE=4 LAYERS=1 [5, 6) STAGE_PARAMS=13631488 (13.631M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
[2024-05-29 21:52:38,644] [INFO] [engine.py:160:__init__] RANK=5 STAGE=5 LAYERS=1 [6, 7) STAGE_PARAMS=13631488 (13.631M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
[2024-05-29 21:52:38,644] [INFO] [engine.py:160:__init__] RANK=2 STAGE=2 LAYERS=1 [3, 4) STAGE_PARAMS=13631488 (13.631M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
[2024-05-29 21:52:38,644] [INFO] [engine.py:160:__init__] RANK=0 STAGE=0 LAYERS=2 [0, 2) STAGE_PARAMS=55590912 (55.591M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
[2024-05-29 21:52:38,644] [INFO] [engine.py:160:__init__] RANK=1 STAGE=1 LAYERS=1 [2, 3) STAGE_PARAMS=13631488 (13.631M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
[2024-05-29 21:52:38,644] [INFO] [engine.py:160:__init__] RANK=6 STAGE=6 LAYERS=1 [7, 8) STAGE_PARAMS=13631488 (13.631M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
[2024-05-29 21:52:38,644] [INFO] [engine.py:160:__init__] RANK=7 STAGE=7 LAYERS=2 [8, 10) STAGE_PARAMS=13631488 (13.631M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
[2024-05-29 21:52:38,644] [INFO] [engine.py:160:__init__] RANK=3 STAGE=3 LAYERS=1 [4, 5) STAGE_PARAMS=13631488 (13.631M) TOTAL_PARAMS=151011328 (151.011M) UNIQUE_PARAMS=151011328 (151.011M)
Deepspeed engine successfully initialized at --- RANK 0 --- hosting 24 of 136 trainable parameters
Loading latest model checkpoint at shard 40
[2024-05-29 21:52:41,357] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt...
Deepspeed engine successfully initialized at --- RANK 7 --- hosting 16 of 136 trainable parameters
[2024-05-29 21:52:41,980] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt...
Deepspeed engine successfully initialized at --- RANK 2 --- hosting 16 of 136 trainable parameters
Deepspeed engine successfully initialized at --- RANK 1 --- hosting 16 of 136 trainable parameters
[2024-05-29 21:52:43,624] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt...
[2024-05-29 21:52:43,624] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt...
Deepspeed engine successfully initialized at --- RANK 4 --- hosting 16 of 136 trainable parameters
Deepspeed engine successfully initialized at --- RANK 3 --- hosting 16 of 136 trainable parameters
[2024-05-29 21:52:43,834] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt...
[2024-05-29 21:52:43,836] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt...
Deepspeed engine successfully initialized at --- RANK 6 --- hosting 16 of 136 trainable parameters
Deepspeed engine successfully initialized at --- RANK 5 --- hosting 16 of 136 trainable parameters
[2024-05-29 21:52:43,926] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt...
[2024-05-29 21:52:43,926] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt...
[2024-05-29 21:52:51,705] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt.
[2024-05-29 21:52:51,705] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt...
[2024-05-29 21:52:51,706] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt.
[2024-05-29 21:52:51,706] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt.
[2024-05-29 21:52:51,706] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt.
[2024-05-29 21:52:51,706] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt.
[2024-05-29 21:52:51,706] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt.
[2024-05-29 21:52:51,706] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt.
[2024-05-29 21:52:51,706] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_01_model_states.pt...
[2024-05-29 21:52:51,706] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_05_model_states.pt...
[2024-05-29 21:52:51,706] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_02_model_states.pt...
[2024-05-29 21:52:51,706] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_06_model_states.pt...
[2024-05-29 21:52:51,706] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_04_model_states.pt...
[2024-05-29 21:52:51,706] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_07_model_states.pt...
[2024-05-29 21:52:51,706] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt.
[2024-05-29 21:52:51,707] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_03_model_states.pt...
[2024-05-29 21:52:51,726] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_02_model_states.pt.
[2024-05-29 21:52:51,727] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_03-model_states.pt...
[2024-05-29 21:52:51,730] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_06_model_states.pt.
[2024-05-29 21:52:51,730] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_07-model_states.pt...
[2024-05-29 21:52:51,731] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_04_model_states.pt.
[2024-05-29 21:52:51,732] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_05-model_states.pt...
[2024-05-29 21:52:51,784] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_00_model_states.pt.
[2024-05-29 21:52:51,784] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_00-model_states.pt...
[2024-05-29 21:52:52,204] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_00-model_states.pt.
[2024-05-29 21:52:52,205] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_00-model_states.pt...
[2024-05-29 21:52:52,499] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_01_model_states.pt.
[2024-05-29 21:52:52,500] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_02-model_states.pt...
[2024-05-29 21:52:52,538] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_00-model_states.pt.
[2024-05-29 21:52:52,716] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_01-model_states.pt...
[2024-05-29 21:52:52,751] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_05_model_states.pt.
[2024-05-29 21:52:52,751] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_06-model_states.pt...
[2024-05-29 21:52:54,268] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_07_model_states.pt.
[2024-05-29 21:52:54,269] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_08-model_states.pt...
[2024-05-29 21:52:55,080] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/mp_rank_03_model_states.pt.
[2024-05-29 21:52:55,081] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_04-model_states.pt...
[2024-05-29 21:53:00,649] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_05-model_states.pt.
[2024-05-29 21:53:01,013] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_05-model_states.pt...
[2024-05-29 21:53:02,653] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_06-model_states.pt.
[2024-05-29 21:53:03,238] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_06-model_states.pt...
[2024-05-29 21:53:05,112] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_08-model_states.pt.
[2024-05-29 21:53:05,678] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_08-model_states.pt...
[2024-05-29 21:53:09,038] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_05-model_states.pt.
[2024-05-29 21:53:09,249] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_06-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 21:53:13,910] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_08-model_states.pt.
[2024-05-29 21:53:17,151] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_09-model_states.pt...
[2024-05-29 21:53:17,428] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_09-model_states.pt.
[2024-05-29 21:53:17,453] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_09-model_states.pt...
[2024-05-29 21:53:17,785] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_09-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 21:53:27,137] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_03-model_states.pt.
[2024-05-29 21:53:27,595] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_03-model_states.pt...
[2024-05-29 21:53:34,207] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_03-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 21:54:04,118] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_04-model_states.pt.
[2024-05-29 21:54:05,140] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_04-model_states.pt...
[2024-05-29 21:54:15,433] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_04-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 21:54:36,265] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_02-model_states.pt.
[2024-05-29 21:54:37,202] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_02-model_states.pt...
[2024-05-29 21:54:45,926] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_02-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 21:55:22,882] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_07-model_states.pt.
[2024-05-29 21:55:23,441] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_07-model_states.pt...
[2024-05-29 21:55:31,214] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_07-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 21:57:46,114] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_01-model_states.pt.
[2024-05-29 21:57:47,150] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_01-model_states.pt...
[2024-05-29 21:57:57,419] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step400/layer_01-model_states.pt.
  0%|          | 0/520 [00:00<?, ?it/s]Shard 0 / 40 skipped
Shard 1 / 40 skipped
Shard 2 / 40 skipped
Shard 3 / 40 skipped
Shard 4 / 40 skipped
Shard 5 / 40 skipped
Shard 6 / 40 skipped
Shard 7 / 40 skipped
Shard 8 / 40 skipped
Shard 9 / 40 skipped
Shard 10 / 40 skipped
Shard 11 / 40 skipped
Shard 12 / 40 skipped
Shard 13 / 40 skipped
Shard 14 / 40 skipped
Shard 15 / 40 skipped
Shard 16 / 40 skipped
Shard 17 / 40 skipped
Shard 18 / 40 skipped
Shard 19 / 40 skipped
Shard 20 / 40 skipped
Shard 21 / 40 skipped
Shard 22 / 40 skipped
Shard 23 / 40 skipped
Shard 24 / 40 skipped
Shard 25 / 40 skipped
Shard 26 / 40 skipped
Shard 27 / 40 skipped
Shard 28 / 40 skipped
Shard 29 / 40 skipped
Shard 30 / 40 skipped
Shard 31 / 40 skipped
Shard 32 / 40 skipped
Shard 33 / 40 skipped
Shard 34 / 40 skipped
Shard 35 / 40 skipped
Shard 36 / 40 skipped
Shard 37 / 40 skipped
Shard 38 / 40 skipped
Shard 39 / 40 skipped
Shard 40 in [40]: file /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_184 skipped to avoid exceeding cuda memory
Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_218
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 21:58:59,000] [INFO] [logging.py:96:log_dist] [Rank 0] step=401, skipped=0, lr=[1.9915667087971767e-05], mom=[(0.9, 0.999)]
steps: 401 loss: 0.7271 iter time (s): 63.920 samples/sec: 2.003

 10%|█         | 1/10 [05:45<51:50, 345.64s/it][A
 10%|█         | 1/10 [03:31<31:42, 211.41s/it][A
 10%|█         | 1/10 [05:52<52:54, 352.68s/it][A
 10%|█         | 1/10 [05:51<52:46, 351.83s/it][A
 10%|█         | 1/10 [04:45<42:49, 285.48s/it][A
 10%|█         | 1/10 [05:27<49:08, 327.65s/it][A
 10%|█         | 1/10 [04:14<38:12, 254.77s/it][A
 10%|█         | 1/10 [01:04<09:40, 64.51s/it][A
 20%|██        | 2/10 [06:42<23:25, 175.71s/it][A[2024-05-29 22:00:01,995] [INFO] [logging.py:96:log_dist] [Rank 0] step=402, skipped=0, lr=[1.9914931477129762e-05], mom=[(0.9, 0.999)]
steps: 402 loss: 0.7338 iter time (s): 57.390 samples/sec: 2.230

 20%|██        | 2/10 [04:29<16:08, 121.12s/it][A
 20%|██        | 2/10 [06:50<23:54, 179.31s/it][A
 20%|██        | 2/10 [06:49<23:51, 178.97s/it][A
 20%|██        | 2/10 [05:43<20:13, 151.65s/it][A
 20%|██        | 2/10 [06:25<22:32, 169.01s/it][A
 20%|██        | 2/10 [05:12<18:32, 139.01s/it][A
 20%|██        | 2/10 [02:02<08:05, 60.67s/it][A
 30%|███       | 3/10 [07:38<14:08, 121.20s/it][A[2024-05-29 22:00:58,089] [INFO] [logging.py:96:log_dist] [Rank 0] step=403, skipped=0, lr=[1.991419268565245e-05], mom=[(0.9, 0.999)]
steps: 403 loss: 0.7020 iter time (s): 55.501 samples/sec: 2.306

 30%|███       | 3/10 [05:25<10:39, 91.42s/it] [A
 30%|███       | 3/10 [07:46<14:21, 123.02s/it][A
 30%|███       | 3/10 [07:45<14:19, 122.83s/it][A
 30%|███       | 3/10 [06:39<12:36, 108.00s/it][A
 30%|███       | 3/10 [07:21<13:42, 117.44s/it][A
 30%|███       | 3/10 [06:08<11:47, 101.13s/it][A
 30%|███       | 3/10 [02:58<06:49, 58.57s/it][A
 40%|████      | 4/10 [08:34<09:31, 95.23s/it] [A[2024-05-29 22:01:53,746] [INFO] [logging.py:96:log_dist] [Rank 0] step=404, skipped=0, lr=[1.9913450713776848e-05], mom=[(0.9, 0.999)]
steps: 404 loss: 0.6252 iter time (s): 55.079 samples/sec: 2.324

 40%|████      | 4/10 [06:21<07:43, 77.29s/it][A
 40%|████      | 4/10 [08:42<09:38, 96.45s/it] [A
 40%|████      | 4/10 [08:41<09:38, 96.33s/it] [A
 40%|████      | 4/10 [07:35<08:44, 87.34s/it] [A
 40%|████      | 4/10 [08:17<09:18, 93.04s/it] [A
 40%|████      | 4/10 [07:04<08:19, 83.18s/it] [A
 40%|████      | 4/10 [03:54<05:44, 57.41s/it][A
 50%|█████     | 5/10 [09:29<06:44, 80.89s/it][A[2024-05-29 22:02:49,210] [INFO] [logging.py:96:log_dist] [Rank 0] step=405, skipped=0, lr=[1.9912705561741002e-05], mom=[(0.9, 0.999)]
steps: 405 loss: 0.7169 iter time (s): 54.909 samples/sec: 2.331

 50%|█████     | 5/10 [07:16<05:47, 69.40s/it][A
 50%|█████     | 5/10 [09:37<06:48, 81.67s/it][A
 50%|█████     | 5/10 [09:37<06:47, 81.60s/it][A
 50%|█████     | 5/10 [08:30<06:19, 75.84s/it][A
 50%|█████     | 5/10 [09:12<06:37, 79.49s/it][A
 50%|█████     | 5/10 [07:59<06:05, 73.19s/it][A
 50%|█████     | 5/10 [04:49<04:43, 56.71s/it][A
 60%|██████    | 6/10 [10:25<04:49, 72.32s/it][A[2024-05-29 22:03:44,905] [INFO] [logging.py:96:log_dist] [Rank 0] step=406, skipped=0, lr=[1.9911957229783973e-05], mom=[(0.9, 0.999)]
steps: 406 loss: 0.6637 iter time (s): 55.117 samples/sec: 2.322

 60%|██████    | 6/10 [08:12<04:19, 64.78s/it][A
 60%|██████    | 6/10 [10:33<04:51, 72.84s/it][A
 60%|██████    | 6/10 [10:32<04:51, 72.80s/it][A
 60%|██████    | 6/10 [09:26<04:36, 69.01s/it][A
 60%|██████    | 6/10 [10:08<04:45, 71.42s/it][A
 60%|██████    | 6/10 [08:55<04:28, 67.24s/it][A
 60%|██████    | 6/10 [05:45<03:45, 56.37s/it][A
 70%|███████   | 7/10 [11:20<03:20, 66.74s/it][A[2024-05-29 22:04:40,143] [INFO] [logging.py:96:log_dist] [Rank 0] step=407, skipped=0, lr=[1.9911205718145846e-05], mom=[(0.9, 0.999)]
steps: 407 loss: 0.5985 iter time (s): 54.648 samples/sec: 2.342

 70%|███████   | 7/10 [09:07<03:04, 61.64s/it][A
 70%|███████   | 7/10 [11:28<03:21, 67.08s/it][A
 70%|███████   | 7/10 [11:27<03:21, 67.06s/it][A
 70%|███████   | 7/10 [10:21<03:13, 64.50s/it][A
 70%|███████   | 7/10 [11:03<03:18, 66.12s/it][A
 70%|███████   | 7/10 [09:50<03:09, 63.32s/it][A
 70%|███████   | 7/10 [06:40<02:48, 56.00s/it][A
 80%|████████  | 8/10 [12:17<02:07, 63.61s/it][A[2024-05-29 22:05:37,063] [INFO] [logging.py:96:log_dist] [Rank 0] step=408, skipped=0, lr=[1.991045102706772e-05], mom=[(0.9, 0.999)]
steps: 408 loss: 0.6213 iter time (s): 56.328 samples/sec: 2.272

 80%|████████  | 8/10 [10:04<02:00, 60.15s/it][A
 80%|████████  | 8/10 [12:25<02:07, 63.87s/it][A
 80%|████████  | 8/10 [12:24<02:07, 63.82s/it][A
 80%|████████  | 8/10 [12:00<02:06, 63.19s/it][A
 80%|████████  | 8/10 [11:18<02:04, 62.10s/it][A
 80%|████████  | 8/10 [10:47<02:02, 61.28s/it][A
 80%|████████  | 8/10 [07:37<01:52, 56.29s/it][A
 90%|█████████ | 9/10 [13:13<01:01, 61.25s/it][A[2024-05-29 22:06:33,112] [INFO] [logging.py:96:log_dist] [Rank 0] step=409, skipped=0, lr=[1.9909693156791736e-05], mom=[(0.9, 0.999)]
steps: 409 loss: 0.6252 iter time (s): 55.467 samples/sec: 2.308

 90%|█████████ | 9/10 [11:00<00:58, 58.86s/it][A
 90%|█████████ | 9/10 [13:21<01:01, 61.40s/it][A
 90%|█████████ | 9/10 [13:20<01:01, 61.39s/it][A
 90%|█████████ | 9/10 [12:14<01:00, 60.18s/it][A
 90%|█████████ | 9/10 [12:56<01:00, 60.96s/it][A
 90%|█████████ | 9/10 [11:43<00:59, 59.64s/it][A
 90%|█████████ | 9/10 [08:33<00:56, 56.22s/it][A
100%|██████████| 10/10 [14:09<00:00, 59.49s/it][A100%|██████████| 10/10 [14:09<00:00, 84.91s/it]
  8%|▊         | 42/520 [14:09<2:41:03, 20.22s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 22:07:28,675] [INFO] [logging.py:96:log_dist] [Rank 0] step=410, skipped=0, lr=[1.9908932107561017e-05], mom=[(0.9, 0.999)]
steps: 410 loss: 0.6738 iter time (s): 54.980 samples/sec: 2.328

100%|██████████| 10/10 [11:56<00:00, 57.89s/it][A100%|██████████| 10/10 [11:56<00:00, 71.61s/it]
  8%|▊         | 42/520 [11:56<2:15:50, 17.05s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:17<00:00, 59.62s/it][A100%|██████████| 10/10 [14:17<00:00, 85.74s/it]
  8%|▊         | 42/520 [14:17<2:42:37, 20.41s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:16<00:00, 59.62s/it][A100%|██████████| 10/10 [14:16<00:00, 85.66s/it]
  8%|▊         | 42/520 [14:16<2:42:28, 20.39s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:52<00:00, 59.32s/it][A100%|██████████| 10/10 [13:52<00:00, 83.24s/it]
  8%|▊         | 42/520 [13:52<2:37:53, 19.82s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:10<00:00, 58.82s/it][A100%|██████████| 10/10 [13:10<00:00, 79.03s/it]
  8%|▊         | 42/520 [13:10<2:29:54, 18.82s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:39<00:00, 58.43s/it][A100%|██████████| 10/10 [12:39<00:00, 75.95s/it]
  8%|▊         | 42/520 [12:39<2:24:04, 18.08s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:29<00:00, 56.06s/it][A100%|██████████| 10/10 [09:29<00:00, 56.93s/it]
  8%|▊         | 42/520 [09:29<1:47:59, 13.55s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_267
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:19<11:53, 79.29s/it][A[2024-05-29 22:08:48,653] [INFO] [logging.py:96:log_dist] [Rank 0] step=411, skipped=0, lr=[1.9908167879619734e-05], mom=[(0.9, 0.999)]
steps: 411 loss: 0.4825 iter time (s): 79.200 samples/sec: 1.616

 10%|█         | 1/10 [01:19<11:59, 79.97s/it][A
 10%|█         | 1/10 [01:20<12:00, 80.03s/it][A
 10%|█         | 1/10 [01:20<12:01, 80.14s/it][A
 10%|█         | 1/10 [01:20<12:00, 80.05s/it][A
 10%|█         | 1/10 [01:20<12:01, 80.18s/it][A
 10%|█         | 1/10 [01:20<12:01, 80.20s/it][A
 10%|█         | 1/10 [01:20<12:01, 80.20s/it][A
 20%|██        | 2/10 [02:40<10:43, 80.47s/it][A[2024-05-29 22:10:09,968] [INFO] [logging.py:96:log_dist] [Rank 0] step=412, skipped=0, lr=[1.990740047321307e-05], mom=[(0.9, 0.999)]
steps: 412 loss: 0.5136 iter time (s): 80.361 samples/sec: 1.593

 20%|██        | 2/10 [02:41<10:46, 80.78s/it][A
 20%|██        | 2/10 [02:41<10:46, 80.78s/it][A
 20%|██        | 2/10 [02:41<10:46, 80.76s/it][A
 20%|██        | 2/10 [02:41<10:45, 80.74s/it][A
 20%|██        | 2/10 [02:41<10:46, 80.76s/it][A
 20%|██        | 2/10 [02:41<10:45, 80.74s/it][A
 20%|██        | 2/10 [02:41<10:45, 80.75s/it][A
 30%|███       | 3/10 [04:02<09:27, 81.09s/it][A[2024-05-29 22:11:31,786] [INFO] [logging.py:96:log_dist] [Rank 0] step=413, skipped=0, lr=[1.990662988858723e-05], mom=[(0.9, 0.999)]
steps: 413 loss: 0.4724 iter time (s): 81.065 samples/sec: 1.579

 30%|███       | 3/10 [04:03<09:28, 81.24s/it][A
 30%|███       | 3/10 [04:03<09:28, 81.28s/it][A
 30%|███       | 3/10 [04:03<09:28, 81.23s/it][A
 30%|███       | 3/10 [04:03<09:28, 81.21s/it][A
 30%|███       | 3/10 [04:03<09:28, 81.25s/it][A
 30%|███       | 3/10 [04:03<09:28, 81.25s/it][A
 30%|███       | 3/10 [04:03<09:28, 81.24s/it][A
 40%|████      | 4/10 [05:24<08:08, 81.36s/it][A[2024-05-29 22:12:53,582] [INFO] [logging.py:96:log_dist] [Rank 0] step=414, skipped=0, lr=[1.9905856125989437e-05], mom=[(0.9, 0.999)]
steps: 414 loss: 0.4857 iter time (s): 81.039 samples/sec: 1.579

 40%|████      | 4/10 [05:24<08:08, 81.41s/it][A
 40%|████      | 4/10 [05:24<08:08, 81.46s/it][A
 40%|████      | 4/10 [05:24<08:08, 81.44s/it][A
 40%|████      | 4/10 [05:24<08:08, 81.47s/it][A
 40%|████      | 4/10 [05:24<08:08, 81.46s/it][A
 40%|████      | 4/10 [05:24<08:08, 81.46s/it][A
 40%|████      | 4/10 [05:24<08:08, 81.46s/it][A
 50%|█████     | 5/10 [06:47<06:50, 82.06s/it][A[2024-05-29 22:14:16,883] [INFO] [logging.py:96:log_dist] [Rank 0] step=415, skipped=0, lr=[1.990507918566793e-05], mom=[(0.9, 0.999)]
steps: 415 loss: 0.4842 iter time (s): 82.507 samples/sec: 1.551

 50%|█████     | 5/10 [06:48<06:50, 82.13s/it][A
 50%|█████     | 5/10 [06:48<06:50, 82.15s/it][A
 50%|█████     | 5/10 [06:48<06:50, 82.16s/it][A
 50%|█████     | 5/10 [06:48<06:50, 82.13s/it][A
 50%|█████     | 5/10 [06:48<06:50, 82.14s/it][A
 50%|█████     | 5/10 [06:48<06:50, 82.13s/it][A
 50%|█████     | 5/10 [06:48<06:50, 82.13s/it][A
 60%|██████    | 6/10 [08:09<05:28, 82.16s/it][A[2024-05-29 22:15:39,224] [INFO] [logging.py:96:log_dist] [Rank 0] step=416, skipped=0, lr=[1.990429906787197e-05], mom=[(0.9, 0.999)]
steps: 416 loss: 0.4924 iter time (s): 81.559 samples/sec: 1.569

 60%|██████    | 6/10 [08:10<05:28, 82.16s/it][A
 60%|██████    | 6/10 [08:10<05:28, 82.17s/it][A
 60%|██████    | 6/10 [08:10<05:28, 82.21s/it][A
 60%|██████    | 6/10 [08:10<05:28, 82.20s/it][A
 60%|██████    | 6/10 [08:10<05:28, 82.19s/it][A
 60%|██████    | 6/10 [08:10<05:28, 82.18s/it][A
 60%|██████    | 6/10 [08:10<05:28, 82.19s/it][A
 70%|███████   | 7/10 [09:32<04:06, 82.17s/it][A[2024-05-29 22:17:01,405] [INFO] [logging.py:96:log_dist] [Rank 0] step=417, skipped=0, lr=[1.9903515772851843e-05], mom=[(0.9, 0.999)]
steps: 417 loss: 0.4871 iter time (s): 81.430 samples/sec: 1.572

 70%|███████   | 7/10 [09:32<04:06, 82.18s/it][A
 70%|███████   | 7/10 [09:32<04:06, 82.18s/it][A
 70%|███████   | 7/10 [09:32<04:06, 82.17s/it][A
 70%|███████   | 7/10 [09:32<04:06, 82.18s/it][A
 70%|███████   | 7/10 [09:32<04:06, 82.17s/it][A
 70%|███████   | 7/10 [09:32<04:06, 82.17s/it][A
 70%|███████   | 7/10 [09:32<04:06, 82.17s/it][A
 80%|████████  | 8/10 [10:54<02:44, 82.17s/it][A[2024-05-29 22:18:23,579] [INFO] [logging.py:96:log_dist] [Rank 0] step=418, skipped=0, lr=[1.9902729300858847e-05], mom=[(0.9, 0.999)]
steps: 418 loss: 0.4773 iter time (s): 81.480 samples/sec: 1.571

 80%|████████  | 8/10 [10:54<02:44, 82.20s/it][A
 80%|████████  | 8/10 [10:54<02:44, 82.16s/it][A
 80%|████████  | 8/10 [10:54<02:44, 82.17s/it][A
 80%|████████  | 8/10 [10:54<02:44, 82.16s/it][A
 80%|████████  | 8/10 [10:54<02:44, 82.16s/it][A
 80%|████████  | 8/10 [10:54<02:44, 82.17s/it][A
 80%|████████  | 8/10 [10:54<02:44, 82.17s/it][A
 90%|█████████ | 9/10 [12:16<01:22, 82.12s/it][A[2024-05-29 22:19:45,595] [INFO] [logging.py:96:log_dist] [Rank 0] step=419, skipped=0, lr=[1.9901939652145303e-05], mom=[(0.9, 0.999)]
steps: 419 loss: 0.4649 iter time (s): 81.321 samples/sec: 1.574

 90%|█████████ | 9/10 [12:17<01:22, 82.19s/it][A
 90%|█████████ | 9/10 [12:17<01:22, 82.15s/it][A
 90%|█████████ | 9/10 [12:16<01:22, 82.16s/it][A
 90%|█████████ | 9/10 [12:16<01:22, 82.14s/it][A
 90%|█████████ | 9/10 [12:17<01:22, 82.17s/it][A
 90%|█████████ | 9/10 [12:17<01:22, 82.17s/it][A
 90%|█████████ | 9/10 [12:17<01:22, 82.17s/it][A
100%|██████████| 10/10 [13:38<00:00, 82.07s/it][A100%|██████████| 10/10 [13:38<00:00, 81.82s/it]
  8%|▊         | 43/520 [27:47<6:09:23, 46.46s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 22:21:06,951] [INFO] [logging.py:96:log_dist] [Rank 0] step=420, skipped=0, lr=[1.9901146826964545e-05], mom=[(0.9, 0.999)]
steps: 420 loss: 0.4922 iter time (s): 80.511 samples/sec: 1.590

100%|██████████| 10/10 [13:38<00:00, 81.86s/it][A100%|██████████| 10/10 [13:38<00:00, 81.82s/it]
  8%|▊         | 43/520 [25:34<5:45:03, 43.40s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:38<00:00, 81.88s/it][A100%|██████████| 10/10 [13:38<00:00, 81.83s/it]
  8%|▊         | 43/520 [27:55<6:10:57, 46.66s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:38<00:00, 81.90s/it][A100%|██████████| 10/10 [13:38<00:00, 81.83s/it]
  8%|▊         | 43/520 [27:54<6:10:48, 46.64s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:38<00:00, 81.89s/it][A100%|██████████| 10/10 [13:38<00:00, 81.82s/it]
  8%|▊         | 43/520 [26:48<5:58:39, 45.11s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:38<00:00, 81.89s/it][A100%|██████████| 10/10 [13:38<00:00, 81.83s/it]
  8%|▊         | 43/520 [27:30<6:06:22, 46.09s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:38<00:00, 81.88s/it][A100%|██████████| 10/10 [13:38<00:00, 81.83s/it]
  8%|▊         | 43/520 [26:17<5:53:02, 44.41s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:38<00:00, 81.88s/it][A100%|██████████| 10/10 [13:38<00:00, 81.83s/it]
  8%|▊         | 43/520 [23:07<5:18:12, 40.03s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_213
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [00:55<08:21, 55.72s/it][A[2024-05-29 22:22:02,580] [INFO] [logging.py:96:log_dist] [Rank 0] step=421, skipped=0, lr=[1.9900350825570938e-05], mom=[(0.9, 0.999)]
steps: 421 loss: 0.6197 iter time (s): 54.873 samples/sec: 2.333

 10%|█         | 1/10 [00:55<08:20, 55.60s/it][A
 10%|█         | 1/10 [00:55<08:20, 55.56s/it][A
 10%|█         | 1/10 [00:55<08:19, 55.52s/it][A
 10%|█         | 1/10 [00:55<08:19, 55.52s/it][A
 10%|█         | 1/10 [00:55<08:19, 55.50s/it][A
 10%|█         | 1/10 [00:55<08:19, 55.50s/it][A
 10%|█         | 1/10 [00:55<08:19, 55.48s/it][A
 20%|██        | 2/10 [01:51<07:25, 55.69s/it][A[2024-05-29 22:22:58,230] [INFO] [logging.py:96:log_dist] [Rank 0] step=422, skipped=0, lr=[1.989955164821985e-05], mom=[(0.9, 0.999)]
steps: 422 loss: 0.5934 iter time (s): 55.096 samples/sec: 2.323

 20%|██        | 2/10 [01:51<07:24, 55.62s/it][A
 20%|██        | 2/10 [01:51<07:25, 55.63s/it][A
 20%|██        | 2/10 [01:51<07:24, 55.58s/it][A
 20%|██        | 2/10 [01:51<07:24, 55.60s/it][A
 20%|██        | 2/10 [01:51<07:24, 55.57s/it][A
 20%|██        | 2/10 [01:51<07:24, 55.60s/it][A
 20%|██        | 2/10 [01:51<07:24, 55.58s/it][A
 30%|███       | 3/10 [02:47<06:30, 55.72s/it][A[2024-05-29 22:23:53,991] [INFO] [logging.py:96:log_dist] [Rank 0] step=423, skipped=0, lr=[1.989874929516769e-05], mom=[(0.9, 0.999)]
steps: 423 loss: 0.6093 iter time (s): 55.168 samples/sec: 2.320

 30%|███       | 3/10 [02:47<06:29, 55.70s/it][A
 30%|███       | 3/10 [02:46<06:29, 55.64s/it][A
 30%|███       | 3/10 [02:46<06:29, 55.66s/it][A
 30%|███       | 3/10 [02:46<06:29, 55.63s/it][A
 30%|███       | 3/10 [02:46<06:29, 55.64s/it][A
 30%|███       | 3/10 [02:46<06:29, 55.64s/it][A
 30%|███       | 3/10 [02:46<06:29, 55.64s/it][A
 40%|████      | 4/10 [03:42<05:33, 55.58s/it][A[2024-05-29 22:24:49,358] [INFO] [logging.py:96:log_dist] [Rank 0] step=424, skipped=0, lr=[1.9897943766671857e-05], mom=[(0.9, 0.999)]
steps: 424 loss: 0.6401 iter time (s): 54.835 samples/sec: 2.334

 40%|████      | 4/10 [03:42<05:33, 55.54s/it][A
 40%|████      | 4/10 [03:42<05:33, 55.54s/it][A
 40%|████      | 4/10 [03:42<05:33, 55.53s/it][A
 40%|████      | 4/10 [03:42<05:33, 55.53s/it][A
 40%|████      | 4/10 [03:42<05:33, 55.52s/it][A
 40%|████      | 4/10 [03:42<05:33, 55.54s/it][A
 40%|████      | 4/10 [03:42<05:33, 55.52s/it][A
 50%|█████     | 5/10 [04:37<04:36, 55.22s/it][A[2024-05-29 22:25:43,954] [INFO] [logging.py:96:log_dist] [Rank 0] step=425, skipped=0, lr=[1.9897135062990803e-05], mom=[(0.9, 0.999)]
steps: 425 loss: 0.6056 iter time (s): 54.081 samples/sec: 2.367

 50%|█████     | 5/10 [04:37<04:36, 55.23s/it][A
 50%|█████     | 5/10 [04:36<04:36, 55.20s/it][A
 50%|█████     | 5/10 [04:36<04:36, 55.21s/it][A
 50%|█████     | 5/10 [04:36<04:35, 55.20s/it][A
 50%|█████     | 5/10 [04:36<04:36, 55.20s/it][A
 50%|█████     | 5/10 [04:36<04:36, 55.21s/it][A
 50%|█████     | 5/10 [04:36<04:36, 55.21s/it][A
 60%|██████    | 6/10 [05:33<03:41, 55.48s/it][A[2024-05-29 22:26:39,936] [INFO] [logging.py:96:log_dist] [Rank 0] step=426, skipped=0, lr=[1.9896323184383962e-05], mom=[(0.9, 0.999)]
steps: 426 loss: 0.6161 iter time (s): 55.406 samples/sec: 2.310

 60%|██████    | 6/10 [05:32<03:41, 55.47s/it][A
 60%|██████    | 6/10 [05:32<03:41, 55.46s/it][A
 60%|██████    | 6/10 [05:32<03:41, 55.45s/it][A
 60%|██████    | 6/10 [05:32<03:41, 55.45s/it][A
 60%|██████    | 6/10 [05:32<03:41, 55.46s/it][A
 60%|██████    | 6/10 [05:32<03:41, 55.45s/it][A
 60%|██████    | 6/10 [05:32<03:41, 55.46s/it][A
 70%|███████   | 7/10 [06:29<02:47, 55.70s/it][A[2024-05-29 22:27:36,082] [INFO] [logging.py:96:log_dist] [Rank 0] step=427, skipped=0, lr=[1.9895508131111815e-05], mom=[(0.9, 0.999)]
steps: 427 loss: 0.5995 iter time (s): 55.621 samples/sec: 2.301

 70%|███████   | 7/10 [06:29<02:47, 55.69s/it][A
 70%|███████   | 7/10 [06:28<02:47, 55.68s/it][A
 70%|███████   | 7/10 [06:28<02:47, 55.69s/it][A
 70%|███████   | 7/10 [06:28<02:47, 55.69s/it][A
 70%|███████   | 7/10 [06:28<02:47, 55.69s/it][A
 70%|███████   | 7/10 [06:29<02:47, 55.71s/it][A
 70%|███████   | 7/10 [06:29<02:47, 55.72s/it][A
 80%|████████  | 8/10 [07:24<01:50, 55.46s/it][A[2024-05-29 22:28:31,026] [INFO] [logging.py:96:log_dist] [Rank 0] step=428, skipped=0, lr=[1.9894689903435852e-05], mom=[(0.9, 0.999)]
steps: 428 loss: 0.6447 iter time (s): 54.327 samples/sec: 2.356

 80%|████████  | 8/10 [07:24<01:50, 55.45s/it][A
 80%|████████  | 8/10 [07:23<01:50, 55.46s/it][A
 80%|████████  | 8/10 [07:23<01:50, 55.46s/it][A
 80%|████████  | 8/10 [07:23<01:50, 55.44s/it][A
 80%|████████  | 8/10 [07:23<01:50, 55.45s/it][A
 80%|████████  | 8/10 [07:23<01:50, 55.44s/it][A
 80%|████████  | 8/10 [07:23<01:50, 55.45s/it][A
 90%|█████████ | 9/10 [08:19<00:55, 55.35s/it][A[2024-05-29 22:29:26,145] [INFO] [logging.py:96:log_dist] [Rank 0] step=429, skipped=0, lr=[1.9893868501618575e-05], mom=[(0.9, 0.999)]
steps: 429 loss: 0.6297 iter time (s): 54.572 samples/sec: 2.346

 90%|█████████ | 9/10 [08:19<00:55, 55.34s/it][A
 90%|█████████ | 9/10 [08:18<00:55, 55.32s/it][A
 90%|█████████ | 9/10 [08:19<00:55, 55.35s/it][A
 90%|█████████ | 9/10 [08:19<00:55, 55.35s/it][A
 90%|█████████ | 9/10 [08:19<00:55, 55.35s/it][A
 90%|█████████ | 9/10 [08:19<00:55, 55.34s/it][A
 90%|█████████ | 9/10 [08:19<00:55, 55.34s/it][A
100%|██████████| 10/10 [09:15<00:00, 55.52s/it][A100%|██████████| 10/10 [09:15<00:00, 55.52s/it]
  8%|▊         | 44/520 [37:02<9:09:45, 69.30s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 22:30:22,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=430, skipped=0, lr=[1.989304392592351e-05], mom=[(0.9, 0.999)]
steps: 430 loss: 0.6388 iter time (s): 55.348 samples/sec: 2.313

100%|██████████| 10/10 [09:15<00:00, 55.53s/it][A100%|██████████| 10/10 [09:15<00:00, 55.51s/it]
  8%|▊         | 44/520 [34:49<8:46:31, 66.37s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:15<00:00, 55.53s/it][A100%|██████████| 10/10 [09:15<00:00, 55.50s/it]
  8%|▊         | 44/520 [37:10<9:11:11, 69.48s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:14<00:00, 55.53s/it][A100%|██████████| 10/10 [09:14<00:00, 55.50s/it]
  8%|▊         | 44/520 [37:09<9:11:01, 69.46s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:14<00:00, 55.54s/it][A100%|██████████| 10/10 [09:14<00:00, 55.50s/it]
  8%|▊         | 44/520 [36:03<8:59:27, 68.00s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:14<00:00, 55.53s/it][A100%|██████████| 10/10 [09:14<00:00, 55.50s/it]
  8%|▊         | 44/520 [36:45<9:06:48, 68.93s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:14<00:00, 55.52s/it][A100%|██████████| 10/10 [09:14<00:00, 55.49s/it]
  8%|▊         | 44/520 [35:32<8:54:05, 67.32s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:14<00:00, 55.53s/it][A100%|██████████| 10/10 [09:14<00:00, 55.50s/it]
  8%|▊         | 44/520 [32:22<8:20:53, 63.14s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_164
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:09<19:24, 129.40s/it][A[2024-05-29 22:32:33,542] [INFO] [logging.py:96:log_dist] [Rank 0] step=431, skipped=0, lr=[1.989221617661521e-05], mom=[(0.9, 0.999)]
steps: 431 loss: 0.6215 iter time (s): 130.891 samples/sec: 0.978

 10%|█         | 1/10 [02:11<19:44, 131.56s/it][A
 10%|█         | 1/10 [02:11<19:44, 131.61s/it][A
 10%|█         | 1/10 [02:11<19:44, 131.64s/it][A
 10%|█         | 1/10 [02:11<19:44, 131.65s/it][A
 10%|█         | 1/10 [02:11<19:44, 131.63s/it][A
 10%|█         | 1/10 [02:11<19:44, 131.65s/it][A
 10%|█         | 1/10 [02:11<19:44, 131.64s/it][A
 20%|██        | 2/10 [04:21<17:25, 130.72s/it][A[2024-05-29 22:34:45,198] [INFO] [logging.py:96:log_dist] [Rank 0] step=432, skipped=0, lr=[1.989138525395923e-05], mom=[(0.9, 0.999)]
steps: 432 loss: 0.6116 iter time (s): 130.937 samples/sec: 0.978

 20%|██        | 2/10 [04:23<17:32, 131.60s/it][A
 20%|██        | 2/10 [04:23<17:32, 131.62s/it][A
 20%|██        | 2/10 [04:23<17:32, 131.60s/it][A
 20%|██        | 2/10 [04:23<17:32, 131.57s/it][A
 20%|██        | 2/10 [04:23<17:32, 131.61s/it][A
 20%|██        | 2/10 [04:23<17:32, 131.62s/it][A
 20%|██        | 2/10 [04:23<17:32, 131.60s/it][A
 30%|███       | 3/10 [06:32<15:18, 131.22s/it][A[2024-05-29 22:36:56,994] [INFO] [logging.py:96:log_dist] [Rank 0] step=433, skipped=0, lr=[1.989055115822215e-05], mom=[(0.9, 0.999)]
steps: 433 loss: 0.6130 iter time (s): 131.158 samples/sec: 0.976

 30%|███       | 3/10 [06:34<15:21, 131.67s/it][A
 30%|███       | 3/10 [06:34<15:21, 131.68s/it][A
 30%|███       | 3/10 [06:35<15:21, 131.70s/it][A
 30%|███       | 3/10 [06:34<15:21, 131.69s/it][A
 30%|███       | 3/10 [06:35<15:21, 131.70s/it][A
 30%|███       | 3/10 [06:35<15:21, 131.70s/it][A
 30%|███       | 3/10 [06:35<15:21, 131.69s/it][A
 40%|████      | 4/10 [08:44<13:09, 131.58s/it][A[2024-05-29 22:39:08,587] [INFO] [logging.py:96:log_dist] [Rank 0] step=434, skipped=0, lr=[1.9889713889671575e-05], mom=[(0.9, 0.999)]
steps: 434 loss: 0.6021 iter time (s): 130.933 samples/sec: 0.978

 40%|████      | 4/10 [08:46<13:09, 131.64s/it][A
 40%|████      | 4/10 [08:46<13:09, 131.63s/it][A
 40%|████      | 4/10 [08:46<13:09, 131.64s/it][A
 40%|████      | 4/10 [08:46<13:09, 131.62s/it][A
 40%|████      | 4/10 [08:46<13:09, 131.62s/it][A
 40%|████      | 4/10 [08:46<13:09, 131.62s/it][A
 40%|████      | 4/10 [08:46<13:09, 131.62s/it][A
 50%|█████     | 5/10 [10:56<10:57, 131.45s/it][A[2024-05-29 22:41:20,345] [INFO] [logging.py:96:log_dist] [Rank 0] step=435, skipped=0, lr=[1.9888873448576114e-05], mom=[(0.9, 0.999)]
steps: 435 loss: 0.5975 iter time (s): 131.157 samples/sec: 0.976

 50%|█████     | 5/10 [10:58<10:58, 131.69s/it][A
 50%|█████     | 5/10 [10:58<10:58, 131.68s/it][A
 50%|█████     | 5/10 [10:58<10:58, 131.69s/it][A
 50%|█████     | 5/10 [10:58<10:58, 131.68s/it][A
 50%|█████     | 5/10 [10:58<10:58, 131.70s/it][A
 50%|█████     | 5/10 [10:58<10:58, 131.71s/it][A
 50%|█████     | 5/10 [10:58<10:58, 131.70s/it][A
 60%|██████    | 6/10 [13:07<08:45, 131.46s/it][A[2024-05-29 22:43:31,844] [INFO] [logging.py:96:log_dist] [Rank 0] step=436, skipped=0, lr=[1.988802983520541e-05], mom=[(0.9, 0.999)]
steps: 436 loss: 0.5873 iter time (s): 130.852 samples/sec: 0.978

 60%|██████    | 6/10 [13:09<08:46, 131.64s/it][A
 60%|██████    | 6/10 [13:09<08:46, 131.66s/it][A
 60%|██████    | 6/10 [13:10<08:46, 131.68s/it][A
 60%|██████    | 6/10 [13:09<08:46, 131.65s/it][A
 60%|██████    | 6/10 [13:09<08:46, 131.67s/it][A
 60%|██████    | 6/10 [13:09<08:46, 131.67s/it][A
 60%|██████    | 6/10 [13:09<08:46, 131.66s/it][A
 70%|███████   | 7/10 [15:19<06:34, 131.43s/it][A[2024-05-29 22:45:43,193] [INFO] [logging.py:96:log_dist] [Rank 0] step=437, skipped=0, lr=[1.9887183049830106e-05], mom=[(0.9, 0.999)]
steps: 437 loss: 0.5787 iter time (s): 130.579 samples/sec: 0.980

 70%|███████   | 7/10 [15:21<06:34, 131.51s/it][A
 70%|███████   | 7/10 [15:21<06:34, 131.51s/it][A
 70%|███████   | 7/10 [15:21<06:34, 131.51s/it][A
 70%|███████   | 7/10 [15:21<06:34, 131.51s/it][A
 70%|███████   | 7/10 [15:21<06:34, 131.51s/it][A
 70%|███████   | 7/10 [15:21<06:34, 131.51s/it][A
 70%|███████   | 7/10 [15:21<06:34, 131.51s/it][A
 80%|████████  | 8/10 [17:30<04:22, 131.41s/it][A[2024-05-29 22:47:54,563] [INFO] [logging.py:96:log_dist] [Rank 0] step=438, skipped=0, lr=[1.9886333092721878e-05], mom=[(0.9, 0.999)]
steps: 438 loss: 0.5631 iter time (s): 130.803 samples/sec: 0.979

 80%|████████  | 8/10 [17:32<04:22, 131.49s/it][A
 80%|████████  | 8/10 [17:32<04:22, 131.49s/it][A
 80%|████████  | 8/10 [17:32<04:22, 131.47s/it][A
 80%|████████  | 8/10 [17:32<04:22, 131.46s/it][A
 80%|████████  | 8/10 [17:32<04:22, 131.49s/it][A
 80%|████████  | 8/10 [17:32<04:22, 131.48s/it][A
 80%|████████  | 8/10 [17:32<04:22, 131.48s/it][A
 90%|█████████ | 9/10 [19:41<02:11, 131.34s/it][A[2024-05-29 22:50:05,745] [INFO] [logging.py:96:log_dist] [Rank 0] step=439, skipped=0, lr=[1.988547996415341e-05], mom=[(0.9, 0.999)]
steps: 439 loss: 0.5965 iter time (s): 130.519 samples/sec: 0.981

 90%|█████████ | 9/10 [19:43<02:11, 131.37s/it][A
 90%|█████████ | 9/10 [19:43<02:11, 131.37s/it][A
 90%|█████████ | 9/10 [19:43<02:11, 131.38s/it][A
 90%|█████████ | 9/10 [19:43<02:11, 131.38s/it][A
 90%|█████████ | 9/10 [19:43<02:11, 131.38s/it][A
 90%|█████████ | 9/10 [19:43<02:11, 131.38s/it][A
 90%|█████████ | 9/10 [19:43<02:11, 131.38s/it][A
100%|██████████| 10/10 [21:52<00:00, 131.34s/it][A100%|██████████| 10/10 [21:52<00:00, 131.29s/it]
  9%|▊         | 45/520 [58:55<19:01:52, 144.24s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 22:52:16,975] [INFO] [logging.py:96:log_dist] [Rank 0] step=440, skipped=0, lr=[1.9884623664398406e-05], mom=[(0.9, 0.999)]
steps: 440 loss: 0.5877 iter time (s): 130.645 samples/sec: 0.980

100%|██████████| 10/10 [21:54<00:00, 131.35s/it][A100%|██████████| 10/10 [21:54<00:00, 131.50s/it]
  9%|▊         | 45/520 [56:44<18:41:02, 141.60s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:54<00:00, 131.34s/it][A100%|██████████| 10/10 [21:54<00:00, 131.50s/it]
  9%|▊         | 45/520 [59:05<19:04:09, 144.53s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:55<00:00, 131.36s/it][A100%|██████████| 10/10 [21:55<00:00, 131.50s/it]
  9%|▊         | 45/520 [59:04<19:04:02, 144.51s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:54<00:00, 131.35s/it][A100%|██████████| 10/10 [21:54<00:00, 131.50s/it]
  9%|▊         | 45/520 [57:58<18:53:09, 143.14s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:55<00:00, 131.34s/it][A100%|██████████| 10/10 [21:55<00:00, 131.50s/it]
  9%|▊         | 45/520 [57:27<18:48:08, 142.50s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:55<00:00, 131.35s/it][A100%|██████████| 10/10 [21:55<00:00, 131.50s/it]
  9%|▊         | 45/520 [58:40<19:00:05, 144.01s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:55<00:00, 131.35s/it][A100%|██████████| 10/10 [21:55<00:00, 131.50s/it]
  9%|▊         | 45/520 [54:17<18:17:01, 138.57s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_312
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:22<12:24, 82.69s/it][A[2024-05-29 22:53:38,436] [INFO] [logging.py:96:log_dist] [Rank 0] step=441, skipped=0, lr=[1.9883764193731593e-05], mom=[(0.9, 0.999)]
steps: 441 loss: 0.6212 iter time (s): 80.735 samples/sec: 1.585

 10%|█         | 1/10 [01:21<12:13, 81.45s/it][A
 10%|█         | 1/10 [01:21<12:13, 81.49s/it][A
 10%|█         | 1/10 [01:21<12:12, 81.40s/it][A
 10%|█         | 1/10 [01:21<12:13, 81.48s/it][A
 10%|█         | 1/10 [01:21<12:13, 81.46s/it][A
 10%|█         | 1/10 [01:21<12:13, 81.50s/it][A
 10%|█         | 1/10 [01:21<12:13, 81.47s/it][A
 20%|██        | 2/10 [02:43<10:55, 81.88s/it][A[2024-05-29 22:54:59,735] [INFO] [logging.py:96:log_dist] [Rank 0] step=442, skipped=0, lr=[1.988290155242871e-05], mom=[(0.9, 0.999)]
steps: 442 loss: 0.6198 iter time (s): 80.652 samples/sec: 1.587

 20%|██        | 2/10 [02:42<10:51, 81.40s/it][A
 20%|██        | 2/10 [02:42<10:51, 81.43s/it][A
 20%|██        | 2/10 [02:42<10:50, 81.36s/it][A
 20%|██        | 2/10 [02:42<10:51, 81.42s/it][A
 20%|██        | 2/10 [02:42<10:51, 81.42s/it][A
 20%|██        | 2/10 [02:42<10:51, 81.42s/it][A
 20%|██        | 2/10 [02:42<10:51, 81.42s/it][A
 30%|███       | 3/10 [04:05<09:30, 81.55s/it][A[2024-05-29 22:56:20,905] [INFO] [logging.py:96:log_dist] [Rank 0] step=443, skipped=0, lr=[1.9882035740766504e-05], mom=[(0.9, 0.999)]
steps: 443 loss: 0.6270 iter time (s): 80.413 samples/sec: 1.592

 30%|███       | 3/10 [04:03<09:28, 81.25s/it][A
 30%|███       | 3/10 [04:03<09:29, 81.29s/it][A
 30%|███       | 3/10 [04:03<09:28, 81.25s/it][A
 30%|███       | 3/10 [04:03<09:28, 81.28s/it][A
 30%|███       | 3/10 [04:03<09:28, 81.25s/it][A
 30%|███       | 3/10 [04:03<09:28, 81.27s/it][A
 30%|███       | 3/10 [04:03<09:28, 81.27s/it][A
 40%|████      | 4/10 [05:26<08:08, 81.43s/it][A[2024-05-29 22:57:42,127] [INFO] [logging.py:96:log_dist] [Rank 0] step=444, skipped=0, lr=[1.9881166759022764e-05], mom=[(0.9, 0.999)]
steps: 444 loss: 0.6178 iter time (s): 80.493 samples/sec: 1.590

 40%|████      | 4/10 [05:25<08:07, 81.27s/it][A
 40%|████      | 4/10 [05:25<08:07, 81.24s/it][A
 40%|████      | 4/10 [05:25<08:07, 81.25s/it][A
 40%|████      | 4/10 [05:25<08:07, 81.25s/it][A
 40%|████      | 4/10 [05:25<08:07, 81.25s/it][A
 40%|████      | 4/10 [05:25<08:07, 81.25s/it][A
 40%|████      | 4/10 [05:25<08:07, 81.25s/it][A
 50%|█████     | 5/10 [06:47<06:46, 81.32s/it][A[2024-05-29 22:59:03,247] [INFO] [logging.py:96:log_dist] [Rank 0] step=445, skipped=0, lr=[1.988029460747627e-05], mom=[(0.9, 0.999)]
steps: 445 loss: 0.6098 iter time (s): 80.409 samples/sec: 1.592

 50%|█████     | 5/10 [06:46<06:45, 81.18s/it][A
 50%|█████     | 5/10 [06:46<06:45, 81.19s/it][A
 50%|█████     | 5/10 [06:46<06:45, 81.19s/it][A
 50%|█████     | 5/10 [06:46<06:45, 81.19s/it][A
 50%|█████     | 5/10 [06:46<06:45, 81.18s/it][A
 50%|█████     | 5/10 [06:46<06:45, 81.19s/it][A
 50%|█████     | 5/10 [06:46<06:45, 81.19s/it][A
 60%|██████    | 6/10 [08:08<05:25, 81.29s/it][A[2024-05-29 23:00:24,496] [INFO] [logging.py:96:log_dist] [Rank 0] step=446, skipped=0, lr=[1.9879419286406834e-05], mom=[(0.9, 0.999)]
steps: 446 loss: 0.5976 iter time (s): 80.575 samples/sec: 1.589

 60%|██████    | 6/10 [08:07<05:24, 81.22s/it][A
 60%|██████    | 6/10 [08:07<05:24, 81.22s/it][A
 60%|██████    | 6/10 [08:07<05:24, 81.22s/it][A
 60%|██████    | 6/10 [08:07<05:24, 81.21s/it][A
 60%|██████    | 6/10 [08:07<05:24, 81.22s/it][A
 60%|██████    | 6/10 [08:07<05:24, 81.22s/it][A
 60%|██████    | 6/10 [08:07<05:24, 81.21s/it][A
 70%|███████   | 7/10 [09:29<04:03, 81.26s/it][A[2024-05-29 23:01:45,705] [INFO] [logging.py:96:log_dist] [Rank 0] step=447, skipped=0, lr=[1.9878540796095278e-05], mom=[(0.9, 0.999)]
steps: 447 loss: 0.5916 iter time (s): 80.516 samples/sec: 1.590

 70%|███████   | 7/10 [09:28<04:03, 81.21s/it][A
 70%|███████   | 7/10 [09:28<04:03, 81.22s/it][A
 70%|███████   | 7/10 [09:28<04:03, 81.23s/it][A
 70%|███████   | 7/10 [09:28<04:03, 81.23s/it][A
 70%|███████   | 7/10 [09:28<04:03, 81.23s/it][A
 70%|███████   | 7/10 [09:28<04:03, 81.22s/it][A
 70%|███████   | 7/10 [09:28<04:03, 81.23s/it][A
 80%|████████  | 8/10 [10:52<02:43, 81.60s/it][A[2024-05-29 23:03:07,733] [INFO] [logging.py:96:log_dist] [Rank 0] step=448, skipped=0, lr=[1.9877659136823447e-05], mom=[(0.9, 0.999)]
steps: 448 loss: 0.5949 iter time (s): 81.293 samples/sec: 1.575

 80%|████████  | 8/10 [10:50<02:42, 81.48s/it][A
 80%|████████  | 8/10 [10:50<02:43, 81.51s/it][A
 80%|████████  | 8/10 [10:50<02:42, 81.49s/it][A
 80%|████████  | 8/10 [10:50<02:42, 81.47s/it][A
 80%|████████  | 8/10 [10:50<02:42, 81.48s/it][A
 80%|████████  | 8/10 [10:50<02:42, 81.49s/it][A
 80%|████████  | 8/10 [10:50<02:42, 81.48s/it][A
 90%|█████████ | 9/10 [12:14<01:21, 81.69s/it][A[2024-05-29 23:04:29,907] [INFO] [logging.py:96:log_dist] [Rank 0] step=449, skipped=0, lr=[1.9876774308874198e-05], mom=[(0.9, 0.999)]
steps: 449 loss: 0.6027 iter time (s): 81.434 samples/sec: 1.572

 90%|█████████ | 9/10 [12:12<01:21, 81.70s/it][A
 90%|█████████ | 9/10 [12:12<01:21, 81.68s/it][A
 90%|█████████ | 9/10 [12:12<01:21, 81.69s/it][A
 90%|█████████ | 9/10 [12:12<01:21, 81.68s/it][A
 90%|█████████ | 9/10 [12:13<01:21, 81.71s/it][A
 90%|█████████ | 9/10 [12:12<01:21, 81.69s/it][A
 90%|█████████ | 9/10 [12:12<01:21, 81.69s/it][A
100%|██████████| 10/10 [13:36<00:00, 81.89s/it][A100%|██████████| 10/10 [13:36<00:00, 81.65s/it]
  9%|▉         | 46/520 [1:12:31<26:00:25, 197.52s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 23:05:52,262] [INFO] [logging.py:96:log_dist] [Rank 0] step=450, skipped=0, lr=[1.9875886312531406e-05], mom=[(0.9, 0.999)]
steps: 450 loss: 0.6055 iter time (s): 81.665 samples/sec: 1.567

100%|██████████| 10/10 [13:35<00:00, 81.90s/it][A100%|██████████| 10/10 [13:35<00:00, 81.53s/it]
  9%|▉         | 46/520 [1:10:19<25:40:29, 195.00s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:35<00:00, 81.89s/it][A100%|██████████| 10/10 [13:35<00:00, 81.53s/it]
  9%|▉         | 46/520 [1:12:41<26:01:45, 197.69s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:35<00:00, 81.88s/it][A100%|██████████| 10/10 [13:35<00:00, 81.52s/it]
  9%|▉         | 46/520 [1:12:40<26:01:35, 197.67s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:35<00:00, 81.90s/it][A100%|██████████| 10/10 [13:35<00:00, 81.53s/it]
  9%|▉         | 46/520 [1:11:33<25:51:39, 196.41s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:35<00:00, 81.90s/it][A100%|██████████| 10/10 [13:35<00:00, 81.53s/it]
  9%|▉         | 46/520 [1:12:16<25:58:00, 197.22s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:35<00:00, 81.90s/it][A100%|██████████| 10/10 [13:35<00:00, 81.53s/it]
  9%|▉         | 46/520 [1:11:03<25:47:03, 195.83s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:35<00:00, 81.90s/it][A100%|██████████| 10/10 [13:35<00:00, 81.53s/it]
  9%|▉         | 46/520 [1:07:52<25:18:26, 192.21s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_428
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:01<09:10, 61.19s/it][A[2024-05-29 23:06:52,932] [INFO] [logging.py:96:log_dist] [Rank 0] step=451, skipped=0, lr=[1.9874995148079958e-05], mom=[(0.9, 0.999)]
steps: 451 loss: 0.3660 iter time (s): 59.869 samples/sec: 2.138

 10%|█         | 1/10 [01:00<09:05, 60.59s/it][A
 10%|█         | 1/10 [01:00<09:04, 60.54s/it][A
 10%|█         | 1/10 [01:00<09:04, 60.55s/it][A
 10%|█         | 1/10 [01:00<09:04, 60.52s/it][A
 10%|█         | 1/10 [01:00<09:04, 60.51s/it][A
 10%|█         | 1/10 [01:00<09:04, 60.50s/it][A
 10%|█         | 1/10 [01:00<09:04, 60.50s/it][A
 20%|██        | 2/10 [02:01<08:03, 60.47s/it][A[2024-05-29 23:07:52,891] [INFO] [logging.py:96:log_dist] [Rank 0] step=452, skipped=0, lr=[1.9874100815805766e-05], mom=[(0.9, 0.999)]
steps: 452 loss: 0.3361 iter time (s): 59.378 samples/sec: 2.156

 20%|██        | 2/10 [02:00<08:01, 60.24s/it][A
 20%|██        | 2/10 [02:00<08:01, 60.20s/it][A
 20%|██        | 2/10 [02:00<08:01, 60.22s/it][A
 20%|██        | 2/10 [02:00<08:01, 60.19s/it][A
 20%|██        | 2/10 [02:00<08:01, 60.18s/it][A
 20%|██        | 2/10 [02:00<08:01, 60.19s/it][A
 20%|██        | 2/10 [02:00<08:01, 60.18s/it][A
 30%|███       | 3/10 [03:01<07:03, 60.45s/it][A[2024-05-29 23:08:53,307] [INFO] [logging.py:96:log_dist] [Rank 0] step=453, skipped=0, lr=[1.9873203315995758e-05], mom=[(0.9, 0.999)]
steps: 453 loss: 0.3185 iter time (s): 59.833 samples/sec: 2.139

 30%|███       | 3/10 [03:00<07:02, 60.31s/it][A
 30%|███       | 3/10 [03:00<07:01, 60.29s/it][A
 30%|███       | 3/10 [03:00<07:02, 60.29s/it][A
 30%|███       | 3/10 [03:00<07:02, 60.30s/it][A
 30%|███       | 3/10 [03:00<07:01, 60.28s/it][A
 30%|███       | 3/10 [03:00<07:01, 60.28s/it][A
 30%|███       | 3/10 [03:00<07:01, 60.29s/it][A
 40%|████      | 4/10 [04:03<06:05, 60.88s/it][A[2024-05-29 23:09:54,847] [INFO] [logging.py:96:log_dist] [Rank 0] step=454, skipped=0, lr=[1.9872302648937865e-05], mom=[(0.9, 0.999)]
steps: 454 loss: 0.3187 iter time (s): 60.965 samples/sec: 2.100

 40%|████      | 4/10 [04:02<06:04, 60.79s/it][A
 40%|████      | 4/10 [04:02<06:04, 60.80s/it][A
 40%|████      | 4/10 [04:02<06:04, 60.77s/it][A
 40%|████      | 4/10 [04:02<06:04, 60.83s/it][A
 40%|████      | 4/10 [04:02<06:04, 60.79s/it][A
 40%|████      | 4/10 [04:02<06:04, 60.79s/it][A
 40%|████      | 4/10 [04:02<06:04, 60.79s/it][A
 50%|█████     | 5/10 [05:04<05:04, 60.94s/it][A[2024-05-29 23:10:55,902] [INFO] [logging.py:96:log_dist] [Rank 0] step=455, skipped=0, lr=[1.987139881492105e-05], mom=[(0.9, 0.999)]
steps: 455 loss: 0.3287 iter time (s): 60.461 samples/sec: 2.117

 50%|█████     | 5/10 [05:03<05:04, 60.88s/it][A
 50%|█████     | 5/10 [05:03<05:04, 60.89s/it][A
 50%|█████     | 5/10 [05:03<05:04, 60.89s/it][A
 50%|█████     | 5/10 [05:03<05:04, 60.87s/it][A
 50%|█████     | 5/10 [05:03<05:04, 60.87s/it][A
 50%|█████     | 5/10 [05:03<05:04, 60.87s/it][A
 50%|█████     | 5/10 [05:03<05:04, 60.87s/it][A
 60%|██████    | 6/10 [06:04<04:03, 60.85s/it][A[2024-05-29 23:11:56,571] [INFO] [logging.py:96:log_dist] [Rank 0] step=456, skipped=0, lr=[1.9870491814235284e-05], mom=[(0.9, 0.999)]
steps: 456 loss: 0.3141 iter time (s): 60.110 samples/sec: 2.129

 60%|██████    | 6/10 [06:04<04:03, 60.82s/it][A
 60%|██████    | 6/10 [06:04<04:03, 60.80s/it][A
 60%|██████    | 6/10 [06:04<04:03, 60.78s/it][A
 60%|██████    | 6/10 [06:04<04:03, 60.82s/it][A
 60%|██████    | 6/10 [06:04<04:03, 60.79s/it][A
 60%|██████    | 6/10 [06:04<04:03, 60.79s/it][A
 60%|██████    | 6/10 [06:04<04:03, 60.79s/it][A
 70%|███████   | 7/10 [07:05<03:02, 60.88s/it][A[2024-05-29 23:12:57,523] [INFO] [logging.py:96:log_dist] [Rank 0] step=457, skipped=0, lr=[1.9869581647171554e-05], mom=[(0.9, 0.999)]
steps: 457 loss: 0.2948 iter time (s): 60.423 samples/sec: 2.118

 70%|███████   | 7/10 [07:05<03:02, 60.84s/it][A
 70%|███████   | 7/10 [07:05<03:02, 60.85s/it][A
 70%|███████   | 7/10 [07:05<03:02, 60.85s/it][A
 70%|███████   | 7/10 [07:05<03:02, 60.86s/it][A
 70%|███████   | 7/10 [07:05<03:02, 60.86s/it][A
 70%|███████   | 7/10 [07:05<03:02, 60.86s/it][A
 70%|███████   | 7/10 [07:05<03:02, 60.86s/it][A
 80%|████████  | 8/10 [08:06<02:01, 60.82s/it][A[2024-05-29 23:13:58,209] [INFO] [logging.py:96:log_dist] [Rank 0] step=458, skipped=0, lr=[1.986866831402186e-05], mom=[(0.9, 0.999)]
steps: 458 loss: 0.3131 iter time (s): 60.117 samples/sec: 2.129

 80%|████████  | 8/10 [08:05<02:01, 60.80s/it][A
 80%|████████  | 8/10 [08:05<02:01, 60.79s/it][A
 80%|████████  | 8/10 [08:05<02:01, 60.77s/it][A
 80%|████████  | 8/10 [08:05<02:01, 60.79s/it][A
 80%|████████  | 8/10 [08:05<02:01, 60.78s/it][A
 80%|████████  | 8/10 [08:05<02:01, 60.79s/it][A
 80%|████████  | 8/10 [08:05<02:01, 60.79s/it][A
 90%|█████████ | 9/10 [09:07<01:00, 60.75s/it][A[2024-05-29 23:14:58,805] [INFO] [logging.py:96:log_dist] [Rank 0] step=459, skipped=0, lr=[1.986775181507923e-05], mom=[(0.9, 0.999)]
steps: 459 loss: 0.3306 iter time (s): 60.068 samples/sec: 2.131

 90%|█████████ | 9/10 [09:06<01:00, 60.74s/it][A
 90%|█████████ | 9/10 [09:06<01:00, 60.74s/it][A
 90%|█████████ | 9/10 [09:06<01:00, 60.75s/it][A
 90%|█████████ | 9/10 [09:06<01:00, 60.74s/it][A
 90%|█████████ | 9/10 [09:06<01:00, 60.75s/it][A
 90%|█████████ | 9/10 [09:06<01:00, 60.78s/it][A
 90%|█████████ | 9/10 [09:06<01:00, 60.78s/it][A
100%|██████████| 10/10 [10:06<00:00, 60.48s/it][A100%|██████████| 10/10 [10:06<00:00, 60.70s/it]
  9%|▉         | 47/520 [1:22:38<31:25:26, 239.17s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 23:15:58,676] [INFO] [logging.py:96:log_dist] [Rank 0] step=460, skipped=0, lr=[1.98668321506377e-05], mom=[(0.9, 0.999)]
steps: 460 loss: 0.2940 iter time (s): 59.194 samples/sec: 2.162

100%|██████████| 10/10 [10:06<00:00, 60.48s/it][A100%|██████████| 10/10 [10:06<00:00, 60.63s/it]
  9%|▉         | 47/520 [1:20:26<31:07:03, 236.84s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:06<00:00, 60.47s/it][A100%|██████████| 10/10 [10:06<00:00, 60.63s/it]
  9%|▉         | 47/520 [1:22:47<31:26:04, 239.25s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:06<00:00, 60.48s/it][A100%|██████████| 10/10 [10:06<00:00, 60.64s/it]
  9%|▉         | 47/520 [1:22:46<31:25:59, 239.24s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:06<00:00, 60.48s/it][A100%|██████████| 10/10 [10:06<00:00, 60.63s/it]
  9%|▉         | 47/520 [1:21:40<31:17:00, 238.10s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:06<00:00, 60.45s/it][A100%|██████████| 10/10 [10:06<00:00, 60.62s/it]
  9%|▉         | 47/520 [1:21:09<31:12:49, 237.57s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:06<00:00, 60.48s/it][A100%|██████████| 10/10 [10:06<00:00, 60.63s/it]
  9%|▉         | 47/520 [1:22:22<31:22:42, 238.82s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:06<00:00, 60.47s/it][A100%|██████████| 10/10 [10:06<00:00, 60.62s/it]
  9%|▉         | 47/520 [1:17:59<30:47:13, 234.32s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_plain_texts/shard_23
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:05<18:45, 125.08s/it][A[2024-05-29 23:18:05,365] [INFO] [logging.py:96:log_dist] [Rank 0] step=461, skipped=0, lr=[1.9865909320992317e-05], mom=[(0.9, 0.999)]
steps: 461 loss: 0.8953 iter time (s): 126.354 samples/sec: 1.013

 10%|█         | 1/10 [02:07<19:04, 127.14s/it][A
 10%|█         | 1/10 [02:07<19:05, 127.27s/it][A
 10%|█         | 1/10 [02:07<19:04, 127.18s/it][A
 10%|█         | 1/10 [02:07<19:05, 127.26s/it][A
 10%|█         | 1/10 [02:07<19:05, 127.28s/it][A
 10%|█         | 1/10 [02:07<19:05, 127.24s/it][A
 10%|█         | 1/10 [02:07<19:05, 127.24s/it][A
 20%|██        | 2/10 [04:12<16:50, 126.36s/it][A[2024-05-29 23:20:12,603] [INFO] [logging.py:96:log_dist] [Rank 0] step=462, skipped=0, lr=[1.9864983326439143e-05], mom=[(0.9, 0.999)]
steps: 462 loss: 0.8746 iter time (s): 126.376 samples/sec: 1.013

 20%|██        | 2/10 [04:14<16:56, 127.11s/it][A
 20%|██        | 2/10 [04:14<16:57, 127.13s/it][A
 20%|██        | 2/10 [04:14<16:56, 127.10s/it][A
 20%|██        | 2/10 [04:14<16:56, 127.07s/it][A
 20%|██        | 2/10 [04:14<16:56, 127.07s/it][A
 20%|██        | 2/10 [04:14<16:56, 127.10s/it][A
 20%|██        | 2/10 [04:14<16:57, 127.13s/it][A
 30%|███       | 3/10 [06:19<14:46, 126.61s/it][A[2024-05-29 23:22:19,498] [INFO] [logging.py:96:log_dist] [Rank 0] step=463, skipped=0, lr=[1.986405416727527e-05], mom=[(0.9, 0.999)]
steps: 463 loss: 0.8535 iter time (s): 126.262 samples/sec: 1.014

 30%|███       | 3/10 [06:21<14:49, 127.00s/it][A
 30%|███       | 3/10 [06:21<14:49, 127.04s/it][A
 30%|███       | 3/10 [06:21<14:49, 127.07s/it][A
 30%|███       | 3/10 [06:21<14:49, 127.07s/it][A
 30%|███       | 3/10 [06:21<14:49, 127.09s/it][A
 30%|███       | 3/10 [06:21<14:49, 127.08s/it][A
 30%|███       | 3/10 [06:21<14:49, 127.10s/it][A
 40%|████      | 4/10 [08:26<12:40, 126.73s/it][A[2024-05-29 23:24:26,418] [INFO] [logging.py:96:log_dist] [Rank 0] step=464, skipped=0, lr=[1.9863121843798786e-05], mom=[(0.9, 0.999)]
steps: 464 loss: 0.8569 iter time (s): 126.147 samples/sec: 1.015

 40%|████      | 4/10 [08:28<12:42, 127.02s/it][A
 40%|████      | 4/10 [08:28<12:42, 127.02s/it][A
 40%|████      | 4/10 [08:28<12:42, 127.06s/it][A
 40%|████      | 4/10 [08:28<12:42, 127.04s/it][A
 40%|████      | 4/10 [08:28<12:42, 127.03s/it][A
 40%|████      | 4/10 [08:28<12:42, 127.03s/it][A
 40%|████      | 4/10 [08:28<12:42, 127.05s/it][A
 50%|█████     | 5/10 [10:33<10:34, 126.88s/it][A[2024-05-29 23:26:33,551] [INFO] [logging.py:96:log_dist] [Rank 0] step=465, skipped=0, lr=[1.9862186356308813e-05], mom=[(0.9, 0.999)]
steps: 465 loss: 0.8816 iter time (s): 126.327 samples/sec: 1.013

 50%|█████     | 5/10 [10:35<10:35, 127.04s/it][A
 50%|█████     | 5/10 [10:35<10:35, 127.07s/it][A
 50%|█████     | 5/10 [10:35<10:35, 127.06s/it][A
 50%|█████     | 5/10 [10:35<10:35, 127.06s/it][A
 50%|█████     | 5/10 [10:35<10:35, 127.06s/it][A
 50%|█████     | 5/10 [10:35<10:35, 127.06s/it][A
 50%|█████     | 5/10 [10:35<10:35, 127.06s/it][A
 60%|██████    | 6/10 [12:40<08:27, 126.92s/it][A[2024-05-29 23:28:40,543] [INFO] [logging.py:96:log_dist] [Rank 0] step=466, skipped=0, lr=[1.986124770510547e-05], mom=[(0.9, 0.999)]
steps: 466 loss: 0.8286 iter time (s): 126.194 samples/sec: 1.014

 60%|██████    | 6/10 [12:42<08:28, 127.04s/it][A
 60%|██████    | 6/10 [12:42<08:28, 127.09s/it][A
 60%|██████    | 6/10 [12:42<08:28, 127.02s/it][A
 60%|██████    | 6/10 [12:42<08:28, 127.04s/it][A
 60%|██████    | 6/10 [12:42<08:28, 127.03s/it][A
 60%|██████    | 6/10 [12:42<08:28, 127.04s/it][A
 60%|██████    | 6/10 [12:42<08:28, 127.05s/it][A
 70%|███████   | 7/10 [14:47<06:20, 126.96s/it][A[2024-05-29 23:30:47,597] [INFO] [logging.py:96:log_dist] [Rank 0] step=467, skipped=0, lr=[1.9860305890489905e-05], mom=[(0.9, 0.999)]
steps: 467 loss: 0.8405 iter time (s): 126.258 samples/sec: 1.014

 70%|███████   | 7/10 [14:49<06:20, 126.98s/it][A
 70%|███████   | 7/10 [14:49<06:20, 127.00s/it][A
 70%|███████   | 7/10 [14:49<06:20, 126.95s/it][A
 70%|███████   | 7/10 [14:49<06:20, 126.97s/it][A
 70%|███████   | 7/10 [14:49<06:20, 126.98s/it][A
 70%|███████   | 7/10 [14:49<06:20, 126.99s/it][A
 70%|███████   | 7/10 [14:49<06:20, 126.99s/it][A
 80%|████████  | 8/10 [16:53<04:13, 126.82s/it][A[2024-05-29 23:32:54,562] [INFO] [logging.py:96:log_dist] [Rank 0] step=468, skipped=0, lr=[1.985936091276427e-05], mom=[(0.9, 0.999)]
steps: 468 loss: 0.7945 iter time (s): 126.063 samples/sec: 1.015

 80%|████████  | 8/10 [16:55<04:13, 126.70s/it][A
 80%|████████  | 8/10 [16:55<04:13, 126.91s/it][A
 80%|████████  | 8/10 [16:56<04:13, 126.94s/it][A
 80%|████████  | 8/10 [16:55<04:13, 126.93s/it][A
 80%|████████  | 8/10 [16:55<04:13, 126.90s/it][A
 80%|████████  | 8/10 [16:55<04:13, 126.90s/it][A
 80%|████████  | 8/10 [16:56<04:13, 126.90s/it][A
 90%|█████████ | 9/10 [19:00<02:06, 126.74s/it][A[2024-05-29 23:35:00,725] [INFO] [logging.py:96:log_dist] [Rank 0] step=469, skipped=0, lr=[1.9858412772231748e-05], mom=[(0.9, 0.999)]
steps: 469 loss: 0.9013 iter time (s): 126.449 samples/sec: 1.012

 90%|█████████ | 9/10 [19:02<02:06, 126.81s/it][A
 90%|█████████ | 9/10 [19:02<02:06, 126.80s/it][A
 90%|█████████ | 9/10 [19:02<02:06, 126.82s/it][A
 90%|█████████ | 9/10 [19:02<02:06, 126.81s/it][A
 90%|█████████ | 9/10 [19:02<02:06, 126.81s/it][A
 90%|█████████ | 9/10 [19:02<02:06, 126.82s/it][A
 90%|█████████ | 9/10 [19:02<02:06, 126.87s/it][A
100%|██████████| 10/10 [21:08<00:00, 127.05s/it][A100%|██████████| 10/10 [21:08<00:00, 126.82s/it]
  9%|▉         | 48/520 [1:43:47<48:28:26, 369.72s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 23:37:07,892] [INFO] [logging.py:96:log_dist] [Rank 0] step=470, skipped=0, lr=[1.9857461469196517e-05], mom=[(0.9, 0.999)]
steps: 470 loss: 0.8491 iter time (s): 126.389 samples/sec: 1.013

100%|██████████| 10/10 [21:09<00:00, 126.88s/it][A100%|██████████| 10/10 [21:09<00:00, 126.96s/it]
  9%|▉         | 48/520 [1:41:35<48:13:47, 367.86s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:09<00:00, 126.93s/it][A100%|██████████| 10/10 [21:09<00:00, 126.98s/it]
  9%|▉         | 48/520 [1:43:57<48:30:32, 369.98s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:09<00:00, 126.91s/it][A100%|██████████| 10/10 [21:09<00:00, 126.97s/it]
  9%|▉         | 48/520 [1:43:56<48:30:24, 369.97s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:09<00:00, 126.92s/it][A100%|██████████| 10/10 [21:09<00:00, 126.97s/it]
  9%|▉         | 48/520 [1:42:49<48:22:36, 368.97s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:09<00:00, 126.92s/it][A100%|██████████| 10/10 [21:09<00:00, 126.97s/it]
  9%|▉         | 48/520 [1:43:32<48:27:33, 369.61s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:09<00:00, 126.96s/it][A100%|██████████| 10/10 [21:09<00:00, 126.97s/it]
  9%|▉         | 48/520 [1:39:08<47:56:38, 365.68s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_170
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:09<00:00, 126.92s/it][A100%|██████████| 10/10 [21:09<00:00, 126.98s/it]
  9%|▉         | 48/520 [1:42:19<48:19:02, 368.52s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:06<18:59, 126.64s/it][A[2024-05-29 23:39:15,394] [INFO] [logging.py:96:log_dist] [Rank 0] step=471, skipped=0, lr=[1.9856507003963777e-05], mom=[(0.9, 0.999)]
steps: 471 loss: 0.5743 iter time (s): 126.406 samples/sec: 1.013

 10%|█         | 1/10 [02:07<19:03, 127.09s/it][A
 10%|█         | 1/10 [02:07<19:03, 127.01s/it][A
 10%|█         | 1/10 [02:07<19:03, 127.09s/it][A
 10%|█         | 1/10 [02:07<19:03, 127.04s/it][A
 10%|█         | 1/10 [02:07<19:03, 127.06s/it][A
 10%|█         | 1/10 [02:07<19:03, 127.03s/it][A
 10%|█         | 1/10 [02:07<19:03, 127.08s/it][A
 20%|██        | 2/10 [04:13<16:55, 126.94s/it][A[2024-05-29 23:41:22,556] [INFO] [logging.py:96:log_dist] [Rank 0] step=472, skipped=0, lr=[1.9855549376839748e-05], mom=[(0.9, 0.999)]
steps: 472 loss: 0.5654 iter time (s): 126.489 samples/sec: 1.012

 20%|██        | 2/10 [04:14<16:57, 127.16s/it][A
 20%|██        | 2/10 [04:14<16:56, 127.11s/it][A
 20%|██        | 2/10 [04:14<16:56, 127.12s/it][A
 20%|██        | 2/10 [04:14<16:57, 127.13s/it][A
 20%|██        | 2/10 [04:14<16:56, 127.11s/it][A
 20%|██        | 2/10 [04:14<16:56, 127.10s/it][A
 20%|██        | 2/10 [04:14<16:56, 127.12s/it][A
 30%|███       | 3/10 [06:21<14:50, 127.27s/it][A[2024-05-29 23:43:30,205] [INFO] [logging.py:96:log_dist] [Rank 0] step=473, skipped=0, lr=[1.9854588588131664e-05], mom=[(0.9, 0.999)]
steps: 473 loss: 0.5638 iter time (s): 126.987 samples/sec: 1.008

 30%|███       | 3/10 [06:21<14:51, 127.38s/it][A
 30%|███       | 3/10 [06:21<14:51, 127.35s/it][A
 30%|███       | 3/10 [06:21<14:51, 127.36s/it][A
 30%|███       | 3/10 [06:21<14:51, 127.36s/it][A
 30%|███       | 3/10 [06:21<14:51, 127.35s/it][A
 30%|███       | 3/10 [06:21<14:51, 127.34s/it][A
 30%|███       | 3/10 [06:21<14:51, 127.36s/it][A
 40%|████      | 4/10 [08:28<12:44, 127.37s/it][A[2024-05-29 23:45:37,768] [INFO] [logging.py:96:log_dist] [Rank 0] step=474, skipped=0, lr=[1.9853624638147766e-05], mom=[(0.9, 0.999)]
steps: 474 loss: 0.5866 iter time (s): 126.916 samples/sec: 1.009

 40%|████      | 4/10 [08:29<12:44, 127.46s/it][A
 40%|████      | 4/10 [08:29<12:44, 127.44s/it][A
 40%|████      | 4/10 [08:29<12:44, 127.42s/it][A
 40%|████      | 4/10 [08:29<12:44, 127.44s/it][A
 40%|████      | 4/10 [08:29<12:44, 127.43s/it][A
 40%|████      | 4/10 [08:29<12:44, 127.43s/it][A
 40%|████      | 4/10 [08:29<12:44, 127.44s/it][A
 50%|█████     | 5/10 [10:36<10:37, 127.44s/it][A[2024-05-29 23:47:45,302] [INFO] [logging.py:96:log_dist] [Rank 0] step=475, skipped=0, lr=[1.985265752719731e-05], mom=[(0.9, 0.999)]
steps: 475 loss: 0.5842 iter time (s): 126.881 samples/sec: 1.009

 50%|█████     | 5/10 [10:37<10:37, 127.51s/it][A
 50%|█████     | 5/10 [10:37<10:37, 127.52s/it][A
 50%|█████     | 5/10 [10:37<10:37, 127.50s/it][A
 50%|█████     | 5/10 [10:37<10:37, 127.49s/it][A
 50%|█████     | 5/10 [10:37<10:37, 127.51s/it][A
 50%|█████     | 5/10 [10:36<10:37, 127.50s/it][A
 50%|█████     | 5/10 [10:37<10:37, 127.50s/it][A
 60%|██████    | 6/10 [12:43<08:29, 127.34s/it][A[2024-05-29 23:49:52,473] [INFO] [logging.py:96:log_dist] [Rank 0] step=476, skipped=0, lr=[1.985168725559058e-05], mom=[(0.9, 0.999)]
steps: 476 loss: 0.5751 iter time (s): 126.438 samples/sec: 1.012

 60%|██████    | 6/10 [12:44<08:29, 127.38s/it][A
 60%|██████    | 6/10 [12:44<08:29, 127.35s/it][A
 60%|██████    | 6/10 [12:44<08:29, 127.35s/it][A
 60%|██████    | 6/10 [12:44<08:29, 127.35s/it][A
 60%|██████    | 6/10 [12:44<08:29, 127.34s/it][A
 60%|██████    | 6/10 [12:44<08:29, 127.36s/it][A
 60%|██████    | 6/10 [12:44<08:29, 127.35s/it][A
 70%|███████   | 7/10 [14:50<06:21, 127.30s/it][A[2024-05-29 23:51:59,669] [INFO] [logging.py:96:log_dist] [Rank 0] step=477, skipped=0, lr=[1.985071382363885e-05], mom=[(0.9, 0.999)]
steps: 477 loss: 0.5610 iter time (s): 126.585 samples/sec: 1.011

 70%|███████   | 7/10 [14:51<06:21, 127.30s/it][A
 70%|███████   | 7/10 [14:51<06:21, 127.31s/it][A
 70%|███████   | 7/10 [14:51<06:21, 127.31s/it][A
 70%|███████   | 7/10 [14:51<06:21, 127.31s/it][A
 70%|███████   | 7/10 [14:51<06:21, 127.30s/it][A
 70%|███████   | 7/10 [14:51<06:21, 127.30s/it][A
 70%|███████   | 7/10 [14:51<06:21, 127.31s/it][A
 80%|████████  | 8/10 [16:58<04:14, 127.35s/it][A[2024-05-29 23:54:07,121] [INFO] [logging.py:96:log_dist] [Rank 0] step=478, skipped=0, lr=[1.9849737231654426e-05], mom=[(0.9, 0.999)]
steps: 478 loss: 0.5805 iter time (s): 126.820 samples/sec: 1.009

 80%|████████  | 8/10 [16:58<04:14, 127.36s/it][A
 80%|████████  | 8/10 [16:58<04:14, 127.36s/it][A
 80%|████████  | 8/10 [16:58<04:14, 127.36s/it][A
 80%|████████  | 8/10 [16:58<04:14, 127.36s/it][A
 80%|████████  | 8/10 [16:58<04:14, 127.35s/it][A
 80%|████████  | 8/10 [16:58<04:14, 127.35s/it][A
 80%|████████  | 8/10 [16:58<04:14, 127.35s/it][A
 90%|█████████ | 9/10 [19:05<02:07, 127.17s/it][A[2024-05-29 23:56:13,888] [INFO] [logging.py:96:log_dist] [Rank 0] step=479, skipped=0, lr=[1.9848757479950624e-05], mom=[(0.9, 0.999)]
steps: 479 loss: 0.5452 iter time (s): 126.135 samples/sec: 1.015

 90%|█████████ | 9/10 [19:05<02:07, 127.18s/it][A
 90%|█████████ | 9/10 [19:05<02:07, 127.18s/it][A
 90%|█████████ | 9/10 [19:05<02:07, 127.17s/it][A
 90%|█████████ | 9/10 [19:05<02:07, 127.17s/it][A
 90%|█████████ | 9/10 [19:05<02:07, 127.17s/it][A
 90%|█████████ | 9/10 [19:05<02:07, 127.17s/it][A
 90%|█████████ | 9/10 [19:05<02:07, 127.17s/it][A
100%|██████████| 10/10 [21:12<00:00, 127.11s/it][A100%|██████████| 10/10 [21:12<00:00, 127.21s/it]
  9%|▉         | 49/520 [2:04:59<66:29:08, 508.17s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-29 23:58:20,862] [INFO] [logging.py:96:log_dist] [Rank 0] step=480, skipped=0, lr=[1.9847774568841773e-05], mom=[(0.9, 0.999)]
steps: 480 loss: 0.5826 iter time (s): 126.338 samples/sec: 1.013

100%|██████████| 10/10 [21:12<00:00, 127.09s/it][A100%|██████████| 10/10 [21:12<00:00, 127.26s/it]
  9%|▉         | 49/520 [2:02:48<66:17:19, 506.66s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:12<00:00, 127.08s/it][A100%|██████████| 10/10 [21:12<00:00, 127.24s/it]
  9%|▉         | 49/520 [2:05:09<66:31:16, 508.44s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:12<00:00, 127.08s/it][A100%|██████████| 10/10 [21:12<00:00, 127.24s/it]
  9%|▉         | 49/520 [2:04:02<66:24:33, 507.59s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:12<00:00, 127.11s/it][A100%|██████████| 10/10 [21:12<00:00, 127.25s/it]
  9%|▉         | 49/520 [2:05:08<66:31:18, 508.45s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:12<00:00, 127.10s/it][A100%|██████████| 10/10 [21:12<00:00, 127.25s/it]
  9%|▉         | 49/520 [2:04:44<66:28:49, 508.13s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:12<00:00, 127.11s/it][A100%|██████████| 10/10 [21:12<00:00, 127.24s/it]
  9%|▉         | 49/520 [2:03:31<66:21:37, 507.21s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [21:12<00:00, 127.11s/it][A100%|██████████| 10/10 [21:12<00:00, 127.25s/it]
  9%|▉         | 49/520 [2:00:21<66:02:45, 504.81s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_139
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:41<15:10, 101.22s/it][A[2024-05-30 00:00:01,382] [INFO] [logging.py:96:log_dist] [Rank 0] step=481, skipped=0, lr=[1.9846788498643216e-05], mom=[(0.9, 0.999)]
steps: 481 loss: 0.5511 iter time (s): 99.798 samples/sec: 1.283

 10%|█         | 1/10 [01:40<15:04, 100.53s/it][A
 10%|█         | 1/10 [01:40<15:05, 100.61s/it][A
 10%|█         | 1/10 [01:40<15:04, 100.53s/it][A
 10%|█         | 1/10 [01:40<15:05, 100.64s/it][A
 10%|█         | 1/10 [01:40<15:05, 100.59s/it][A
 10%|█         | 1/10 [01:40<15:05, 100.56s/it][A
 10%|█         | 1/10 [01:40<15:05, 100.56s/it][A
 20%|██        | 2/10 [03:22<13:29, 101.20s/it][A[2024-05-30 00:01:42,550] [INFO] [logging.py:96:log_dist] [Rank 0] step=482, skipped=0, lr=[1.984579926967131e-05], mom=[(0.9, 0.999)]
steps: 482 loss: 0.5640 iter time (s): 100.497 samples/sec: 1.274

 20%|██        | 2/10 [03:21<13:27, 100.92s/it][A
 20%|██        | 2/10 [03:21<13:27, 100.93s/it][A
 20%|██        | 2/10 [03:21<13:27, 100.89s/it][A
 20%|██        | 2/10 [03:21<13:27, 100.92s/it][A
 20%|██        | 2/10 [03:21<13:27, 100.91s/it][A
 20%|██        | 2/10 [03:21<13:27, 100.90s/it][A
 20%|██        | 2/10 [03:21<13:27, 100.90s/it][A
 30%|███       | 3/10 [05:02<11:46, 100.89s/it][A[2024-05-30 00:03:23,072] [INFO] [logging.py:96:log_dist] [Rank 0] step=483, skipped=0, lr=[1.984480688224342e-05], mom=[(0.9, 0.999)]
steps: 483 loss: 0.5385 iter time (s): 99.878 samples/sec: 1.282

 30%|███       | 3/10 [05:02<11:45, 100.75s/it][A
 30%|███       | 3/10 [05:02<11:45, 100.73s/it][A
 30%|███       | 3/10 [05:02<11:44, 100.70s/it][A
 30%|███       | 3/10 [05:02<11:45, 100.73s/it][A
 30%|███       | 3/10 [05:02<11:45, 100.72s/it][A
 30%|███       | 3/10 [05:02<11:45, 100.73s/it][A
 30%|███       | 3/10 [05:02<11:45, 100.73s/it][A
 40%|████      | 4/10 [06:44<10:06, 101.07s/it][A[2024-05-30 00:05:04,384] [INFO] [logging.py:96:log_dist] [Rank 0] step=484, skipped=0, lr=[1.984381133667793e-05], mom=[(0.9, 0.999)]
steps: 484 loss: 0.5635 iter time (s): 100.672 samples/sec: 1.271

 40%|████      | 4/10 [06:43<10:05, 100.98s/it][A
 40%|████      | 4/10 [06:43<10:06, 101.01s/it][A
 40%|████      | 4/10 [06:43<10:05, 100.96s/it][A
 40%|████      | 4/10 [06:43<10:06, 101.02s/it][A
 40%|████      | 4/10 [06:43<10:06, 101.01s/it][A
 40%|████      | 4/10 [06:43<10:06, 101.11s/it][A
 40%|████      | 4/10 [06:44<10:06, 101.16s/it][A
 50%|█████     | 5/10 [08:25<08:26, 101.22s/it][A[2024-05-30 00:06:45,898] [INFO] [logging.py:96:log_dist] [Rank 0] step=485, skipped=0, lr=[1.9842812633294234e-05], mom=[(0.9, 0.999)]
steps: 485 loss: 0.5726 iter time (s): 100.485 samples/sec: 1.274

 50%|█████     | 5/10 [08:25<08:25, 101.15s/it][A
 50%|█████     | 5/10 [08:25<08:25, 101.15s/it][A
 50%|█████     | 5/10 [08:25<08:25, 101.16s/it][A
 50%|█████     | 5/10 [08:25<08:25, 101.15s/it][A
 50%|█████     | 5/10 [08:25<08:25, 101.14s/it][A
 50%|█████     | 5/10 [08:25<08:25, 101.10s/it][A
 50%|█████     | 5/10 [08:25<08:25, 101.11s/it][A
 60%|██████    | 6/10 [10:07<06:45, 101.44s/it][A[2024-05-30 00:08:27,758] [INFO] [logging.py:96:log_dist] [Rank 0] step=486, skipped=0, lr=[1.984181077241274e-05], mom=[(0.9, 0.999)]
steps: 486 loss: 0.5547 iter time (s): 101.228 samples/sec: 1.264

 60%|██████    | 6/10 [10:06<06:45, 101.42s/it][A
 60%|██████    | 6/10 [10:07<06:45, 101.42s/it][A
 60%|██████    | 6/10 [10:06<06:45, 101.41s/it][A
 60%|██████    | 6/10 [10:07<06:45, 101.43s/it][A
 60%|██████    | 6/10 [10:06<06:45, 101.41s/it][A
 60%|██████    | 6/10 [10:06<06:45, 101.38s/it][A
 60%|██████    | 6/10 [10:06<06:45, 101.39s/it][A
 70%|███████   | 7/10 [11:49<05:05, 101.68s/it][A[2024-05-30 00:10:09,953] [INFO] [logging.py:96:log_dist] [Rank 0] step=487, skipped=0, lr=[1.984080575435488e-05], mom=[(0.9, 0.999)]
steps: 487 loss: 0.5411 iter time (s): 101.510 samples/sec: 1.261

 70%|███████   | 7/10 [11:49<05:04, 101.66s/it][A
 70%|███████   | 7/10 [11:49<05:04, 101.65s/it][A
 70%|███████   | 7/10 [11:49<05:04, 101.65s/it][A
 70%|███████   | 7/10 [11:49<05:04, 101.64s/it][A
 70%|███████   | 7/10 [11:49<05:04, 101.64s/it][A
 70%|███████   | 7/10 [11:49<05:04, 101.63s/it][A
 70%|███████   | 7/10 [11:49<05:04, 101.63s/it][A
 80%|████████  | 8/10 [13:30<03:22, 101.38s/it][A[2024-05-30 00:11:50,693] [INFO] [logging.py:96:log_dist] [Rank 0] step=488, skipped=0, lr=[1.9839797579443077e-05], mom=[(0.9, 0.999)]
steps: 488 loss: 0.5541 iter time (s): 100.108 samples/sec: 1.279

 80%|████████  | 8/10 [13:29<03:22, 101.36s/it][A
 80%|████████  | 8/10 [13:29<03:22, 101.35s/it][A
 80%|████████  | 8/10 [13:29<03:22, 101.37s/it][A
 80%|████████  | 8/10 [13:29<03:22, 101.37s/it][A
 80%|████████  | 8/10 [13:29<03:22, 101.38s/it][A
 80%|████████  | 8/10 [13:29<03:22, 101.36s/it][A
 80%|████████  | 8/10 [13:29<03:22, 101.36s/it][A
 90%|█████████ | 9/10 [15:11<01:41, 101.27s/it][A[2024-05-30 00:13:31,766] [INFO] [logging.py:96:log_dist] [Rank 0] step=489, skipped=0, lr=[1.9838786248000787e-05], mom=[(0.9, 0.999)]
steps: 489 loss: 0.5686 iter time (s): 100.400 samples/sec: 1.275

 90%|█████████ | 9/10 [15:10<01:41, 101.26s/it][A
 90%|█████████ | 9/10 [15:10<01:41, 101.25s/it][A
 90%|█████████ | 9/10 [15:10<01:41, 101.28s/it][A
 90%|█████████ | 9/10 [15:11<01:41, 101.28s/it][A
 90%|█████████ | 9/10 [15:10<01:41, 101.27s/it][A
 90%|█████████ | 9/10 [15:10<01:41, 101.25s/it][A
 90%|█████████ | 9/10 [15:10<01:41, 101.26s/it][A
100%|██████████| 10/10 [16:52<00:00, 101.25s/it][A100%|██████████| 10/10 [16:52<00:00, 101.28s/it]
[2024-05-30 00:15:12,911] [INFO] [logging.py:96:log_dist] [Rank 0] step=490, skipped=0, lr=[1.9837771760352463e-05], mom=[(0.9, 0.999)]
steps: 490 loss: 0.5468 iter time (s): 100.503 samples/sec: 1.274

100%|██████████| 10/10 [16:52<00:00, 101.24s/it][A100%|██████████| 10/10 [16:52<00:00, 101.21s/it]

100%|██████████| 10/10 [16:52<00:00, 101.23s/it][A100%|██████████| 10/10 [16:52<00:00, 101.21s/it]

100%|██████████| 10/10 [16:52<00:00, 101.26s/it][A100%|██████████| 10/10 [16:52<00:00, 101.21s/it]

100%|██████████| 10/10 [16:52<00:00, 101.25s/it][A100%|██████████| 10/10 [16:52<00:00, 101.22s/it]

100%|██████████| 10/10 [16:52<00:00, 101.24s/it][A100%|██████████| 10/10 [16:52<00:00, 101.21s/it]

100%|██████████| 10/10 [16:52<00:00, 101.24s/it][A100%|██████████| 10/10 [16:52<00:00, 101.21s/it]

100%|██████████| 10/10 [16:52<00:00, 101.24s/it][A100%|██████████| 10/10 [16:52<00:00, 101.21s/it]
Checkpointing at shard 50
[2024-05-30 00:15:18,500] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step490 is about to be saved!
[2024-05-30 00:15:19,515] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_00-model_states.pt...
[2024-05-30 00:15:21,814] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_00-model_states.pt.
[2024-05-30 00:15:27,131] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_02-model_states.pt...
[2024-05-30 00:15:29,729] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_08-model_states.pt...
[2024-05-30 00:15:29,803] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_04-model_states.pt...
[2024-05-30 00:15:29,844] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_06-model_states.pt...
[2024-05-30 00:15:29,871] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_03-model_states.pt...
[2024-05-30 00:15:30,246] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_05-model_states.pt...
[2024-05-30 00:15:31,539] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_07-model_states.pt...
[2024-05-30 00:15:33,611] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_01-model_states.pt...
[2024-05-30 00:20:46,360] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_05-model_states.pt.
[2024-05-30 00:20:47,131] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_04_model_states.pt...
[2024-05-30 00:20:47,396] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_04_model_states.pt.
[2024-05-30 00:20:47,396] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step490 is ready now!
[2024-05-30 00:20:50,313] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_06-model_states.pt.
[2024-05-30 00:20:51,135] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_05_model_states.pt...
[2024-05-30 00:20:51,540] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_05_model_states.pt.
[2024-05-30 00:20:51,540] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step490 is ready now!
[2024-05-30 00:20:53,747] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_03-model_states.pt.
[2024-05-30 00:20:54,496] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_02_model_states.pt...
[2024-05-30 00:20:55,437] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_02_model_states.pt.
[2024-05-30 00:20:55,438] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step490 is ready now!
[2024-05-30 00:20:57,213] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_04-model_states.pt.
[2024-05-30 00:20:57,755] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_08-model_states.pt.
[2024-05-30 00:20:58,124] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_03_model_states.pt...
[2024-05-30 00:20:58,678] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_09-model_states.pt...
[2024-05-30 00:20:58,831] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_03_model_states.pt.
[2024-05-30 00:20:58,831] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step490 is ready now!
[2024-05-30 00:21:00,495] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_09-model_states.pt.
[2024-05-30 00:21:00,506] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_07_model_states.pt...
[2024-05-30 00:21:00,768] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_07_model_states.pt.
[2024-05-30 00:21:00,768] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step490 is ready now!
[2024-05-30 00:21:05,341] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_07-model_states.pt.
[2024-05-30 00:21:05,344] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_01-model_states.pt.
[2024-05-30 00:21:05,384] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/layer_02-model_states.pt.
[2024-05-30 00:21:06,452] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_01_model_states.pt
[2024-05-30 00:21:06,452] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_01_model_states.pt...
[2024-05-30 00:21:06,688] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_01_model_states.pt.
[2024-05-30 00:21:06,688] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step490 is ready now!
[2024-05-30 00:21:06,786] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_06_model_states.pt...
[2024-05-30 00:21:06,865] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_00_model_states.pt
[2024-05-30 00:21:06,865] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_00_model_states.pt...
[2024-05-30 00:21:06,941] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_06_model_states.pt.
[2024-05-30 00:21:06,941] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step490 is ready now!
[2024-05-30 00:21:07,705] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step490/mp_rank_00_model_states.pt.
[2024-05-30 00:21:07,706] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step490 is ready now!
Checkpoint saved using --- 354.1238250732422 seconds ---
 10%|▉         | 50/520 [2:26:17<86:22:54, 661.65s/it] 10%|▉         | 50/520 [2:27:30<86:28:51, 662.41s/it] 10%|▉         | 50/520 [2:26:48<86:25:32, 661.98s/it] 10%|▉         | 50/520 [2:27:49<86:34:16, 663.10s/it] 10%|▉         | 50/520 [2:23:07<86:07:26, 659.67s/it] 10%|▉         | 50/520 [2:25:34<86:19:55, 661.27s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_89
 10%|▉         | 50/520 [2:27:56<86:31:13, 662.71s/it] 10%|▉         | 50/520 [2:27:55<86:30:58, 662.68s/it]Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:12<10:52, 72.47s/it][A[2024-05-30 00:22:21,819] [INFO] [logging.py:96:log_dist] [Rank 0] step=491, skipped=0, lr=[1.983675411682358e-05], mom=[(0.9, 0.999)]
steps: 491 loss: 1.2027 iter time (s): 74.068 samples/sec: 1.728

 10%|█         | 1/10 [01:14<11:09, 74.38s/it][A
 10%|█         | 1/10 [01:14<11:10, 74.50s/it][A
 10%|█         | 1/10 [01:14<11:12, 74.67s/it][A
 10%|█         | 1/10 [01:14<11:12, 74.72s/it][A
 10%|█         | 1/10 [01:14<11:12, 74.75s/it][A
 10%|█         | 1/10 [01:14<11:12, 74.78s/it][A
 10%|█         | 1/10 [01:14<11:13, 74.79s/it][A
 20%|██        | 2/10 [02:26<09:45, 73.13s/it][A[2024-05-30 00:23:35,389] [INFO] [logging.py:96:log_dist] [Rank 0] step=492, skipped=0, lr=[1.9835733317740626e-05], mom=[(0.9, 0.999)]
steps: 492 loss: 1.1782 iter time (s): 72.876 samples/sec: 1.756

 20%|██        | 2/10 [02:27<09:51, 73.91s/it][A
 20%|██        | 2/10 [02:28<09:51, 73.94s/it][A
 20%|██        | 2/10 [02:28<09:51, 73.96s/it][A
 20%|██        | 2/10 [02:28<09:52, 74.03s/it][A
 20%|██        | 2/10 [02:28<09:52, 74.05s/it][A
 20%|██        | 2/10 [02:28<09:52, 74.06s/it][A
 20%|██        | 2/10 [02:28<09:52, 74.07s/it][A
 30%|███       | 3/10 [03:41<08:39, 74.27s/it][A[2024-05-30 00:24:51,025] [INFO] [logging.py:96:log_dist] [Rank 0] step=493, skipped=0, lr=[1.98347093634311e-05], mom=[(0.9, 0.999)]
steps: 493 loss: 1.1499 iter time (s): 74.958 samples/sec: 1.708

 30%|███       | 3/10 [03:43<08:42, 74.67s/it][A
 30%|███       | 3/10 [03:43<08:42, 74.71s/it][A
 30%|███       | 3/10 [03:43<08:43, 74.76s/it][A
 30%|███       | 3/10 [03:43<08:43, 74.74s/it][A
 30%|███       | 3/10 [03:43<08:43, 74.75s/it][A
 30%|███       | 3/10 [03:43<08:43, 74.77s/it][A
 30%|███       | 3/10 [03:43<08:43, 74.77s/it][A
 40%|████      | 4/10 [04:56<07:27, 74.60s/it][A[2024-05-30 00:26:06,112] [INFO] [logging.py:96:log_dist] [Rank 0] step=494, skipped=0, lr=[1.983368225422351e-05], mom=[(0.9, 0.999)]
steps: 494 loss: 1.1559 iter time (s): 74.448 samples/sec: 1.719

 40%|████      | 4/10 [04:58<07:29, 74.85s/it][A
 40%|████      | 4/10 [04:58<07:29, 74.86s/it][A
 40%|████      | 4/10 [04:58<07:29, 74.87s/it][A
 40%|████      | 4/10 [04:58<07:29, 74.90s/it][A
 40%|████      | 4/10 [04:58<07:29, 74.89s/it][A
 40%|████      | 4/10 [04:59<07:29, 74.89s/it][A
 40%|████      | 4/10 [04:59<07:29, 74.90s/it][A
 50%|█████     | 5/10 [06:11<06:13, 74.74s/it][A[2024-05-30 00:27:21,122] [INFO] [logging.py:96:log_dist] [Rank 0] step=495, skipped=0, lr=[1.9832651990447372e-05], mom=[(0.9, 0.999)]
steps: 495 loss: 1.1623 iter time (s): 74.370 samples/sec: 1.721

 50%|█████     | 5/10 [06:13<06:14, 74.90s/it][A
 50%|█████     | 5/10 [06:13<06:14, 74.91s/it][A
 50%|█████     | 5/10 [06:13<06:14, 74.91s/it][A
 50%|█████     | 5/10 [06:13<06:14, 74.92s/it][A
 50%|█████     | 5/10 [06:14<06:14, 74.95s/it][A
 50%|█████     | 5/10 [06:14<06:14, 74.95s/it][A
 50%|█████     | 5/10 [06:14<06:14, 74.95s/it][A
 60%|██████    | 6/10 [07:27<04:59, 74.90s/it][A[2024-05-30 00:28:36,344] [INFO] [logging.py:96:log_dist] [Rank 0] step=496, skipped=0, lr=[1.9831618572433225e-05], mom=[(0.9, 0.999)]
steps: 496 loss: 1.1396 iter time (s): 74.686 samples/sec: 1.714

 60%|██████    | 6/10 [07:29<05:00, 75.06s/it][A
 60%|██████    | 6/10 [07:29<05:00, 75.08s/it][A
 60%|██████    | 6/10 [07:29<05:00, 75.08s/it][A
 60%|██████    | 6/10 [07:29<05:00, 75.08s/it][A
 60%|██████    | 6/10 [07:29<05:00, 75.10s/it][A
 60%|██████    | 6/10 [07:29<05:00, 75.09s/it][A
 60%|██████    | 6/10 [07:29<05:00, 75.09s/it][A
 70%|███████   | 7/10 [08:41<03:43, 74.66s/it][A[2024-05-30 00:29:50,489] [INFO] [logging.py:96:log_dist] [Rank 0] step=497, skipped=0, lr=[1.9830582000512618e-05], mom=[(0.9, 0.999)]
steps: 497 loss: 1.1031 iter time (s): 73.403 samples/sec: 1.744

 70%|███████   | 7/10 [08:43<03:44, 74.74s/it][A
 70%|███████   | 7/10 [08:43<03:44, 74.76s/it][A
 70%|███████   | 7/10 [08:43<03:44, 74.74s/it][A
 70%|███████   | 7/10 [08:43<03:44, 74.77s/it][A
 70%|███████   | 7/10 [08:43<03:44, 74.76s/it][A
 70%|███████   | 7/10 [08:43<03:44, 74.75s/it][A
 70%|███████   | 7/10 [08:43<03:44, 74.76s/it][A
 80%|████████  | 8/10 [09:55<02:28, 74.46s/it][A[2024-05-30 00:31:04,503] [INFO] [logging.py:96:log_dist] [Rank 0] step=498, skipped=0, lr=[1.9829542275018105e-05], mom=[(0.9, 0.999)]
steps: 498 loss: 1.1230 iter time (s): 73.274 samples/sec: 1.747

 80%|████████  | 8/10 [09:57<02:29, 74.53s/it][A
 80%|████████  | 8/10 [09:57<02:28, 74.49s/it][A
 80%|████████  | 8/10 [09:57<02:29, 74.52s/it][A
 80%|████████  | 8/10 [09:57<02:29, 74.55s/it][A
 80%|████████  | 8/10 [09:57<02:29, 74.54s/it][A
 80%|████████  | 8/10 [09:57<02:29, 74.65s/it][A
 80%|████████  | 8/10 [09:58<02:29, 74.82s/it][A
 90%|█████████ | 9/10 [11:11<01:14, 74.91s/it][A[2024-05-30 00:32:20,413] [INFO] [logging.py:96:log_dist] [Rank 0] step=499, skipped=0, lr=[1.9828499396283262e-05], mom=[(0.9, 0.999)]
steps: 499 loss: 1.0954 iter time (s): 74.234 samples/sec: 1.724

 90%|█████████ | 9/10 [11:12<01:14, 74.93s/it][A
 90%|█████████ | 9/10 [11:13<01:14, 74.93s/it][A
 90%|█████████ | 9/10 [11:13<01:14, 74.93s/it][A
 90%|█████████ | 9/10 [11:13<01:14, 74.93s/it][A
 90%|█████████ | 9/10 [11:13<01:14, 74.94s/it][A
 90%|█████████ | 9/10 [11:13<01:14, 74.85s/it][A
 90%|█████████ | 9/10 [11:13<01:14, 74.91s/it][A
100%|██████████| 10/10 [12:26<00:00, 75.10s/it][A100%|██████████| 10/10 [12:26<00:00, 74.66s/it]
 10%|▉         | 51/520 [2:40:15<88:36:38, 680.17s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 00:33:35,946] [INFO] [logging.py:96:log_dist] [Rank 0] step=500, skipped=0, lr=[1.982745336464266e-05], mom=[(0.9, 0.999)]
steps: 500 loss: 1.0854 iter time (s): 74.852 samples/sec: 1.710

100%|██████████| 10/10 [12:28<00:00, 75.12s/it][A100%|██████████| 10/10 [12:28<00:00, 74.85s/it]
 10%|▉         | 51/520 [2:38:03<88:28:19, 679.10s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:28<00:00, 75.14s/it][A100%|██████████| 10/10 [12:28<00:00, 74.87s/it]
 10%|▉         | 51/520 [2:40:24<88:37:34, 680.29s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:28<00:00, 75.13s/it][A100%|██████████| 10/10 [12:28<00:00, 74.88s/it]
 10%|▉         | 51/520 [2:40:23<88:37:31, 680.28s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:28<00:00, 75.12s/it][A100%|██████████| 10/10 [12:28<00:00, 74.88s/it]
 10%|▉         | 51/520 [2:39:17<88:33:15, 679.73s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:28<00:00, 75.12s/it][A100%|██████████| 10/10 [12:28<00:00, 74.89s/it]
 10%|▉         | 51/520 [2:39:59<88:35:59, 680.09s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:28<00:00, 75.10s/it][A100%|██████████| 10/10 [12:28<00:00, 74.89s/it]
 10%|▉         | 51/520 [2:38:46<88:31:18, 679.49s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:28<00:00, 75.07s/it][A100%|██████████| 10/10 [12:28<00:00, 74.90s/it]
 10%|▉         | 51/520 [2:35:36<88:19:05, 677.92s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_322
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:21<12:13, 81.51s/it][A[2024-05-30 00:34:57,692] [INFO] [logging.py:96:log_dist] [Rank 0] step=501, skipped=0, lr=[1.9826404180431897e-05], mom=[(0.9, 0.999)]
steps: 501 loss: 0.6044 iter time (s): 80.993 samples/sec: 1.580

 10%|█         | 1/10 [01:21<12:16, 81.81s/it][A
 10%|█         | 1/10 [01:21<12:15, 81.74s/it][A
 10%|█         | 1/10 [01:21<12:16, 81.79s/it][A
 10%|█         | 1/10 [01:21<12:16, 81.82s/it][A
 10%|█         | 1/10 [01:21<12:16, 81.84s/it][A
 10%|█         | 1/10 [01:21<12:16, 81.84s/it][A
 10%|█         | 1/10 [01:21<12:16, 81.81s/it][A
 20%|██        | 2/10 [02:43<10:54, 81.86s/it][A[2024-05-30 00:36:19,808] [INFO] [logging.py:96:log_dist] [Rank 0] step=502, skipped=0, lr=[1.9825351843987584e-05], mom=[(0.9, 0.999)]
steps: 502 loss: 0.5961 iter time (s): 81.331 samples/sec: 1.574

 20%|██        | 2/10 [02:44<10:56, 82.04s/it][A
 20%|██        | 2/10 [02:44<10:56, 82.06s/it][A
 20%|██        | 2/10 [02:43<10:55, 82.00s/it][A
 20%|██        | 2/10 [02:44<10:56, 82.06s/it][A
 20%|██        | 2/10 [02:44<10:56, 82.06s/it][A
 20%|██        | 2/10 [02:44<10:56, 82.07s/it][A
 20%|██        | 2/10 [02:44<10:56, 82.08s/it][A
 30%|███       | 3/10 [04:05<09:32, 81.74s/it][A[2024-05-30 00:37:41,403] [INFO] [logging.py:96:log_dist] [Rank 0] step=503, skipped=0, lr=[1.9824296355647327e-05], mom=[(0.9, 0.999)]
steps: 503 loss: 0.5966 iter time (s): 80.688 samples/sec: 1.586

 30%|███       | 3/10 [04:05<09:32, 81.80s/it][A
 30%|███       | 3/10 [04:05<09:32, 81.77s/it][A
 30%|███       | 3/10 [04:05<09:32, 81.79s/it][A
 30%|███       | 3/10 [04:05<09:32, 81.78s/it][A
 30%|███       | 3/10 [04:05<09:32, 81.78s/it][A
 30%|███       | 3/10 [04:05<09:32, 81.79s/it][A
 30%|███       | 3/10 [04:05<09:32, 81.79s/it][A
 40%|████      | 4/10 [05:26<08:09, 81.63s/it][A[2024-05-30 00:39:02,837] [INFO] [logging.py:96:log_dist] [Rank 0] step=504, skipped=0, lr=[1.9823237715749754e-05], mom=[(0.9, 0.999)]
steps: 504 loss: 0.5926 iter time (s): 80.692 samples/sec: 1.586

 40%|████      | 4/10 [05:26<08:09, 81.65s/it][A
 40%|████      | 4/10 [05:26<08:09, 81.63s/it][A
 40%|████      | 4/10 [05:26<08:10, 81.67s/it][A
 40%|████      | 4/10 [05:27<08:10, 81.68s/it][A
 40%|████      | 4/10 [05:26<08:09, 81.66s/it][A
 40%|████      | 4/10 [05:27<08:10, 81.67s/it][A
 40%|████      | 4/10 [05:26<08:09, 81.66s/it][A
 50%|█████     | 5/10 [06:48<06:48, 81.69s/it][A[2024-05-30 00:40:24,666] [INFO] [logging.py:96:log_dist] [Rank 0] step=505, skipped=0, lr=[1.9822175924634507e-05], mom=[(0.9, 0.999)]
steps: 505 loss: 0.5924 iter time (s): 81.015 samples/sec: 1.580

 50%|█████     | 5/10 [06:48<06:48, 81.69s/it][A
 50%|█████     | 5/10 [06:48<06:48, 81.70s/it][A
 50%|█████     | 5/10 [06:48<06:48, 81.69s/it][A
 50%|█████     | 5/10 [06:48<06:48, 81.71s/it][A
 50%|█████     | 5/10 [06:48<06:48, 81.71s/it][A
 50%|█████     | 5/10 [06:48<06:48, 81.71s/it][A
 50%|█████     | 5/10 [06:48<06:48, 81.73s/it][A
 60%|██████    | 6/10 [08:09<05:26, 81.61s/it][A[2024-05-30 00:41:46,102] [INFO] [logging.py:96:log_dist] [Rank 0] step=506, skipped=0, lr=[1.9821110982642234e-05], mom=[(0.9, 0.999)]
steps: 506 loss: 0.5923 iter time (s): 80.638 samples/sec: 1.587

 60%|██████    | 6/10 [08:10<05:26, 81.58s/it][A
 60%|██████    | 6/10 [08:10<05:26, 81.60s/it][A
 60%|██████    | 6/10 [08:10<05:26, 81.61s/it][A
 60%|██████    | 6/10 [08:10<05:26, 81.62s/it][A
 60%|██████    | 6/10 [08:10<05:26, 81.59s/it][A
 60%|██████    | 6/10 [08:10<05:26, 81.61s/it][A
 60%|██████    | 6/10 [08:10<05:26, 81.59s/it][A
 70%|███████   | 7/10 [09:31<04:04, 81.48s/it][A[2024-05-30 00:43:06,751] [INFO] [logging.py:96:log_dist] [Rank 0] step=507, skipped=0, lr=[1.9820042890114596e-05], mom=[(0.9, 0.999)]
steps: 507 loss: 0.5857 iter time (s): 79.925 samples/sec: 1.602

 70%|███████   | 7/10 [09:30<04:03, 81.29s/it][A
 70%|███████   | 7/10 [09:30<04:03, 81.30s/it][A
 70%|███████   | 7/10 [09:30<04:03, 81.27s/it][A
 70%|███████   | 7/10 [09:30<04:03, 81.28s/it][A
 70%|███████   | 7/10 [09:30<04:03, 81.27s/it][A
 70%|███████   | 7/10 [09:30<04:03, 81.29s/it][A
 70%|███████   | 7/10 [09:30<04:03, 81.28s/it][A
 80%|████████  | 8/10 [10:51<02:42, 81.06s/it][A[2024-05-30 00:44:27,473] [INFO] [logging.py:96:log_dist] [Rank 0] step=508, skipped=0, lr=[1.981897164739426e-05], mom=[(0.9, 0.999)]
steps: 508 loss: 0.5960 iter time (s): 80.013 samples/sec: 1.600

 80%|████████  | 8/10 [10:51<02:42, 81.11s/it][A
 80%|████████  | 8/10 [10:51<02:42, 81.13s/it][A
 80%|████████  | 8/10 [10:51<02:42, 81.13s/it][A
 80%|████████  | 8/10 [10:51<02:42, 81.12s/it][A
 80%|████████  | 8/10 [10:51<02:42, 81.11s/it][A
 80%|████████  | 8/10 [10:51<02:42, 81.12s/it][A
 80%|████████  | 8/10 [10:51<02:42, 81.13s/it][A
 90%|█████████ | 9/10 [12:12<01:20, 80.97s/it][A[2024-05-30 00:45:48,250] [INFO] [logging.py:96:log_dist] [Rank 0] step=509, skipped=0, lr=[1.981789725482491e-05], mom=[(0.9, 0.999)]
steps: 509 loss: 0.5993 iter time (s): 79.989 samples/sec: 1.600

 90%|█████████ | 9/10 [12:12<01:21, 81.01s/it][A
 90%|█████████ | 9/10 [12:12<01:21, 81.02s/it][A
 90%|█████████ | 9/10 [12:12<01:21, 81.02s/it][A
 90%|█████████ | 9/10 [12:12<01:21, 81.01s/it][A
 90%|█████████ | 9/10 [12:12<01:21, 81.01s/it][A
 90%|█████████ | 9/10 [12:12<01:21, 81.02s/it][A
 90%|█████████ | 9/10 [12:12<01:21, 81.02s/it][A
100%|██████████| 10/10 [13:33<00:00, 81.08s/it][A100%|██████████| 10/10 [13:33<00:00, 81.34s/it]
 10%|█         | 52/520 [2:53:49<92:20:11, 710.28s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 00:47:09,551] [INFO] [logging.py:96:log_dist] [Rank 0] step=510, skipped=0, lr=[1.9816819712751234e-05], mom=[(0.9, 0.999)]
steps: 510 loss: 0.5933 iter time (s): 80.668 samples/sec: 1.587

100%|██████████| 10/10 [13:33<00:00, 81.15s/it][A100%|██████████| 10/10 [13:33<00:00, 81.38s/it]
 10%|█         | 52/520 [2:51:37<92:14:22, 709.53s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:33<00:00, 81.13s/it][A100%|██████████| 10/10 [13:33<00:00, 81.37s/it]
 10%|█         | 52/520 [2:53:58<92:21:23, 710.44s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:33<00:00, 81.15s/it][A100%|██████████| 10/10 [13:33<00:00, 81.38s/it]
 10%|█         | 52/520 [2:53:57<92:21:27, 710.44s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:33<00:00, 81.15s/it][A100%|██████████| 10/10 [13:33<00:00, 81.38s/it]
 10%|█         | 52/520 [2:52:51<92:18:15, 710.03s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:33<00:00, 81.15s/it][A100%|██████████| 10/10 [13:33<00:00, 81.38s/it]
 10%|█         | 52/520 [2:53:33<92:20:21, 710.30s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:33<00:00, 81.15s/it][A100%|██████████| 10/10 [13:33<00:00, 81.38s/it]
 10%|█         | 52/520 [2:52:20<92:16:47, 709.84s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:33<00:00, 81.15s/it][A100%|██████████| 10/10 [13:33<00:00, 81.38s/it]
 10%|█         | 52/520 [2:49:10<92:07:19, 708.63s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_266
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:21<12:17, 81.91s/it][A[2024-05-30 00:48:31,886] [INFO] [logging.py:96:log_dist] [Rank 0] step=511, skipped=0, lr=[1.981573902151894e-05], mom=[(0.9, 0.999)]
steps: 511 loss: 0.4930 iter time (s): 81.334 samples/sec: 1.574

 10%|█         | 1/10 [01:22<12:19, 82.20s/it][A
 10%|█         | 1/10 [01:22<12:19, 82.15s/it][A
 10%|█         | 1/10 [01:22<12:18, 82.10s/it][A
 10%|█         | 1/10 [01:22<12:19, 82.13s/it][A
 10%|█         | 1/10 [01:22<12:19, 82.14s/it][A
 10%|█         | 1/10 [01:22<12:19, 82.16s/it][A
 10%|█         | 1/10 [01:22<12:19, 82.15s/it][A
 20%|██        | 2/10 [02:43<10:54, 81.76s/it][A[2024-05-30 00:49:53,542] [INFO] [logging.py:96:log_dist] [Rank 0] step=512, skipped=0, lr=[1.9814655181474738e-05], mom=[(0.9, 0.999)]
steps: 512 loss: 0.4974 iter time (s): 80.882 samples/sec: 1.583

 20%|██        | 2/10 [02:43<10:55, 81.89s/it][A
 20%|██        | 2/10 [02:43<10:55, 81.91s/it][A
 20%|██        | 2/10 [02:43<10:55, 81.88s/it][A
 20%|██        | 2/10 [02:43<10:55, 81.90s/it][A
 20%|██        | 2/10 [02:43<10:55, 81.88s/it][A
 20%|██        | 2/10 [02:43<10:55, 81.94s/it][A
 20%|██        | 2/10 [02:43<10:55, 81.95s/it][A
 30%|███       | 3/10 [04:06<09:37, 82.51s/it][A[2024-05-30 00:51:16,848] [INFO] [logging.py:96:log_dist] [Rank 0] step=513, skipped=0, lr=[1.981356819296635e-05], mom=[(0.9, 0.999)]
steps: 513 loss: 0.4699 iter time (s): 82.426 samples/sec: 1.553

 30%|███       | 3/10 [04:07<09:37, 82.55s/it][A
 30%|███       | 3/10 [04:07<09:37, 82.54s/it][A
 30%|███       | 3/10 [04:07<09:37, 82.57s/it][A
 30%|███       | 3/10 [04:07<09:37, 82.55s/it][A
 30%|███       | 3/10 [04:07<09:37, 82.55s/it][A
 30%|███       | 3/10 [04:07<09:37, 82.54s/it][A
 30%|███       | 3/10 [04:07<09:37, 82.54s/it][A
 40%|████      | 4/10 [05:29<08:15, 82.52s/it][A[2024-05-30 00:52:39,457] [INFO] [logging.py:96:log_dist] [Rank 0] step=514, skipped=0, lr=[1.9812478056342504e-05], mom=[(0.9, 0.999)]
steps: 514 loss: 0.4953 iter time (s): 81.763 samples/sec: 1.565

 40%|████      | 4/10 [05:29<08:15, 82.55s/it][A
 40%|████      | 4/10 [05:29<08:15, 82.56s/it][A
 40%|████      | 4/10 [05:29<08:15, 82.57s/it][A
 40%|████      | 4/10 [05:29<08:15, 82.56s/it][A
 40%|████      | 4/10 [05:29<08:15, 82.55s/it][A
 40%|████      | 4/10 [05:29<08:15, 82.54s/it][A
 40%|████      | 4/10 [05:29<08:15, 82.54s/it][A
 50%|█████     | 5/10 [06:52<06:52, 82.60s/it][A[2024-05-30 00:54:02,203] [INFO] [logging.py:96:log_dist] [Rank 0] step=515, skipped=0, lr=[1.9811384771952954e-05], mom=[(0.9, 0.999)]
steps: 515 loss: 0.4776 iter time (s): 81.967 samples/sec: 1.562

 50%|█████     | 5/10 [06:52<06:53, 82.61s/it][A
 50%|█████     | 5/10 [06:52<06:53, 82.62s/it][A
 50%|█████     | 5/10 [06:52<06:53, 82.62s/it][A
 50%|█████     | 5/10 [06:52<06:53, 82.61s/it][A
 50%|█████     | 5/10 [06:52<06:53, 82.61s/it][A
 50%|█████     | 5/10 [06:52<06:53, 82.61s/it][A
 50%|█████     | 5/10 [06:52<06:53, 82.61s/it][A
 60%|██████    | 6/10 [08:14<05:30, 82.52s/it][A[2024-05-30 00:55:24,538] [INFO] [logging.py:96:log_dist] [Rank 0] step=516, skipped=0, lr=[1.9810288340148445e-05], mom=[(0.9, 0.999)]
steps: 516 loss: 0.4846 iter time (s): 81.566 samples/sec: 1.569

 60%|██████    | 6/10 [08:14<05:30, 82.53s/it][A
 60%|██████    | 6/10 [08:14<05:30, 82.53s/it][A
 60%|██████    | 6/10 [08:14<05:30, 82.54s/it][A
 60%|██████    | 6/10 [08:14<05:30, 82.55s/it][A
 60%|██████    | 6/10 [08:14<05:30, 82.53s/it][A
 60%|██████    | 6/10 [08:14<05:30, 82.52s/it][A
 60%|██████    | 6/10 [08:14<05:30, 82.53s/it][A
 70%|███████   | 7/10 [09:38<04:09, 83.04s/it][A[2024-05-30 00:56:48,669] [INFO] [logging.py:96:log_dist] [Rank 0] step=517, skipped=0, lr=[1.9809188761280738e-05], mom=[(0.9, 0.999)]
steps: 517 loss: 0.4772 iter time (s): 83.327 samples/sec: 1.536

 70%|███████   | 7/10 [09:38<04:09, 83.04s/it][A
 70%|███████   | 7/10 [09:38<04:09, 83.05s/it][A
 70%|███████   | 7/10 [09:38<04:09, 83.04s/it][A
 70%|███████   | 7/10 [09:38<04:09, 83.05s/it][A
 70%|███████   | 7/10 [09:38<04:09, 83.07s/it][A
 70%|███████   | 7/10 [09:38<04:09, 83.05s/it][A
 70%|███████   | 7/10 [09:38<04:09, 83.05s/it][A
 80%|████████  | 8/10 [11:00<02:45, 82.74s/it][A[2024-05-30 00:58:10,765] [INFO] [logging.py:96:log_dist] [Rank 0] step=518, skipped=0, lr=[1.9808086035702618e-05], mom=[(0.9, 0.999)]
steps: 518 loss: 0.4816 iter time (s): 81.307 samples/sec: 1.574

 80%|████████  | 8/10 [11:01<02:45, 82.75s/it][A
 80%|████████  | 8/10 [11:01<02:45, 82.77s/it][A
 80%|████████  | 8/10 [11:01<02:45, 82.75s/it][A
 80%|████████  | 8/10 [11:01<02:45, 82.75s/it][A
 80%|████████  | 8/10 [11:01<02:45, 82.76s/it][A
 80%|████████  | 8/10 [11:01<02:45, 82.74s/it][A
 80%|████████  | 8/10 [11:01<02:45, 82.75s/it][A
 90%|█████████ | 9/10 [12:25<01:23, 83.20s/it][A[2024-05-30 00:59:35,012] [INFO] [logging.py:96:log_dist] [Rank 0] step=519, skipped=0, lr=[1.9806980163767848e-05], mom=[(0.9, 0.999)]
steps: 519 loss: 0.4665 iter time (s): 83.538 samples/sec: 1.532

 90%|█████████ | 9/10 [12:25<01:23, 83.23s/it][A
 90%|█████████ | 9/10 [12:25<01:23, 83.24s/it][A
 90%|█████████ | 9/10 [12:25<01:23, 83.25s/it][A
 90%|█████████ | 9/10 [12:25<01:23, 83.23s/it][A
 90%|█████████ | 9/10 [12:25<01:23, 83.25s/it][A
 90%|█████████ | 9/10 [12:25<01:23, 83.24s/it][A
 90%|█████████ | 9/10 [12:25<01:23, 83.24s/it][A
100%|██████████| 10/10 [13:49<00:00, 83.65s/it][A100%|██████████| 10/10 [13:49<00:00, 82.97s/it]
 10%|█         | 53/520 [3:07:39<95:55:55, 739.52s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 01:00:59,618] [INFO] [logging.py:96:log_dist] [Rank 0] step=520, skipped=0, lr=[1.9805871145831233e-05], mom=[(0.9, 0.999)]
steps: 520 loss: 0.4640 iter time (s): 83.789 samples/sec: 1.528

100%|██████████| 10/10 [13:50<00:00, 83.69s/it][A100%|██████████| 10/10 [13:50<00:00, 83.01s/it]
 10%|█         | 53/520 [3:05:27<95:51:29, 738.95s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:50<00:00, 83.72s/it][A100%|██████████| 10/10 [13:50<00:00, 83.02s/it]
 10%|█         | 53/520 [3:07:48<95:57:02, 739.66s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:50<00:00, 83.71s/it][A100%|██████████| 10/10 [13:50<00:00, 83.02s/it]
 10%|█         | 53/520 [3:07:47<95:57:01, 739.66s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:50<00:00, 83.72s/it][A100%|██████████| 10/10 [13:50<00:00, 83.02s/it]
 10%|█         | 53/520 [3:06:41<95:54:38, 739.35s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:50<00:00, 83.70s/it][A100%|██████████| 10/10 [13:50<00:00, 83.01s/it]
 10%|█         | 53/520 [3:07:23<95:56:09, 739.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:50<00:00, 83.71s/it][A100%|██████████| 10/10 [13:50<00:00, 83.01s/it]
 10%|█         | 53/520 [3:06:10<95:53:26, 739.20s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:50<00:00, 83.71s/it][A100%|██████████| 10/10 [13:50<00:00, 83.01s/it]
 10%|█         | 53/520 [3:03:00<95:46:19, 738.29s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_426
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:12<10:49, 72.22s/it][A[2024-05-30 01:02:11,714] [INFO] [logging.py:96:log_dist] [Rank 0] step=521, skipped=0, lr=[1.980475898224857e-05], mom=[(0.9, 0.999)]
steps: 521 loss: 0.3273 iter time (s): 70.982 samples/sec: 1.803

 10%|█         | 1/10 [01:11<10:47, 71.90s/it][A
 10%|█         | 1/10 [01:11<10:45, 71.74s/it][A
 10%|█         | 1/10 [01:11<10:45, 71.76s/it][A
 10%|█         | 1/10 [01:11<10:45, 71.75s/it][A
 10%|█         | 1/10 [01:11<10:45, 71.76s/it][A
 10%|█         | 1/10 [01:11<10:45, 71.76s/it][A
 10%|█         | 1/10 [01:11<10:45, 71.74s/it][A
 20%|██        | 2/10 [02:24<09:38, 72.36s/it][A[2024-05-30 01:03:24,202] [INFO] [logging.py:96:log_dist] [Rank 0] step=522, skipped=0, lr=[1.9803643673376667e-05], mom=[(0.9, 0.999)]
steps: 522 loss: 0.3060 iter time (s): 71.817 samples/sec: 1.782

 20%|██        | 2/10 [02:24<09:37, 72.23s/it][A
 20%|██        | 2/10 [02:24<09:37, 72.19s/it][A
 20%|██        | 2/10 [02:24<09:37, 72.18s/it][A
 20%|██        | 2/10 [02:24<09:37, 72.19s/it][A
 20%|██        | 2/10 [02:24<09:37, 72.21s/it][A
 20%|██        | 2/10 [02:24<09:37, 72.19s/it][A
 20%|██        | 2/10 [02:24<09:37, 72.19s/it][A
 30%|███       | 3/10 [03:32<08:12, 70.40s/it][A[2024-05-30 01:04:32,274] [INFO] [logging.py:96:log_dist] [Rank 0] step=523, skipped=0, lr=[1.9802525219573343e-05], mom=[(0.9, 0.999)]
steps: 523 loss: 0.3040 iter time (s): 67.385 samples/sec: 1.900

 30%|███       | 3/10 [03:32<08:12, 70.34s/it][A
 30%|███       | 3/10 [03:32<08:12, 70.30s/it][A
 30%|███       | 3/10 [03:32<08:11, 70.28s/it][A
 30%|███       | 3/10 [03:32<08:12, 70.32s/it][A
 30%|███       | 3/10 [03:32<08:12, 70.31s/it][A
 30%|███       | 3/10 [03:32<08:12, 70.31s/it][A
 30%|███       | 3/10 [03:32<08:12, 70.31s/it][A
 40%|████      | 4/10 [04:39<06:53, 68.90s/it][A[2024-05-30 01:05:38,875] [INFO] [logging.py:96:log_dist] [Rank 0] step=524, skipped=0, lr=[1.9801403621197427e-05], mom=[(0.9, 0.999)]
steps: 524 loss: 0.3049 iter time (s): 65.933 samples/sec: 1.941

 40%|████      | 4/10 [04:39<06:53, 68.86s/it][A
 40%|████      | 4/10 [04:38<06:52, 68.83s/it][A
 40%|████      | 4/10 [04:38<06:53, 68.84s/it][A
 40%|████      | 4/10 [04:38<06:53, 68.84s/it][A
 40%|████      | 4/10 [04:38<06:53, 68.84s/it][A
 40%|████      | 4/10 [04:38<06:53, 68.84s/it][A
 40%|████      | 4/10 [04:38<06:53, 68.84s/it][A
 50%|█████     | 5/10 [05:50<05:48, 69.68s/it][A[2024-05-30 01:06:49,940] [INFO] [logging.py:96:log_dist] [Rank 0] step=525, skipped=0, lr=[1.980027887860875e-05], mom=[(0.9, 0.999)]
steps: 525 loss: 0.3043 iter time (s): 70.404 samples/sec: 1.818

 50%|█████     | 5/10 [05:50<05:48, 69.66s/it][A
 50%|█████     | 5/10 [05:49<05:48, 69.66s/it][A
 50%|█████     | 5/10 [05:50<05:48, 69.65s/it][A
 50%|█████     | 5/10 [05:49<05:48, 69.63s/it][A
 50%|█████     | 5/10 [05:49<05:48, 69.65s/it][A
 50%|█████     | 5/10 [05:49<05:48, 69.64s/it][A
 50%|█████     | 5/10 [05:49<05:48, 69.64s/it][A
 60%|██████    | 6/10 [06:59<04:38, 69.51s/it][A[2024-05-30 01:07:59,135] [INFO] [logging.py:96:log_dist] [Rank 0] step=526, skipped=0, lr=[1.979915099216817e-05], mom=[(0.9, 0.999)]
steps: 526 loss: 0.3007 iter time (s): 68.517 samples/sec: 1.868

 60%|██████    | 6/10 [06:59<04:37, 69.48s/it][A
 60%|██████    | 6/10 [06:59<04:37, 69.49s/it][A
 60%|██████    | 6/10 [06:59<04:37, 69.46s/it][A
 60%|██████    | 6/10 [06:59<04:37, 69.46s/it][A
 60%|██████    | 6/10 [06:59<04:37, 69.48s/it][A
 60%|██████    | 6/10 [06:59<04:37, 69.48s/it][A
 60%|██████    | 6/10 [06:59<04:37, 69.47s/it][A
 70%|███████   | 7/10 [08:05<03:24, 68.19s/it][A[2024-05-30 01:09:04,491] [INFO] [logging.py:96:log_dist] [Rank 0] step=527, skipped=0, lr=[1.9798019962237527e-05], mom=[(0.9, 0.999)]
steps: 527 loss: 0.2979 iter time (s): 64.777 samples/sec: 1.976

 70%|███████   | 7/10 [08:04<03:24, 68.21s/it][A
 70%|███████   | 7/10 [08:04<03:24, 68.20s/it][A
 70%|███████   | 7/10 [08:04<03:24, 68.18s/it][A
 70%|███████   | 7/10 [08:04<03:24, 68.19s/it][A
 70%|███████   | 7/10 [08:04<03:24, 68.22s/it][A
 70%|███████   | 7/10 [08:05<03:24, 68.32s/it][A
 70%|███████   | 7/10 [08:05<03:25, 68.50s/it][A
 80%|████████  | 8/10 [09:11<02:15, 67.53s/it][A[2024-05-30 01:10:10,720] [INFO] [logging.py:96:log_dist] [Rank 0] step=528, skipped=0, lr=[1.979688578917969e-05], mom=[(0.9, 0.999)]
steps: 528 loss: 0.3012 iter time (s): 64.486 samples/sec: 1.985

 80%|████████  | 8/10 [09:10<02:15, 67.51s/it][A
 80%|████████  | 8/10 [09:10<02:15, 67.52s/it][A
 80%|████████  | 8/10 [09:10<02:15, 67.54s/it][A
 80%|████████  | 8/10 [09:10<02:15, 67.52s/it][A
 80%|████████  | 8/10 [09:10<02:14, 67.49s/it][A
 80%|████████  | 8/10 [09:10<02:15, 67.53s/it][A
 80%|████████  | 8/10 [09:10<02:14, 67.44s/it][A
 90%|█████████ | 9/10 [10:17<01:07, 67.09s/it][A[2024-05-30 01:11:16,856] [INFO] [logging.py:96:log_dist] [Rank 0] step=529, skipped=0, lr=[1.9795748473358537e-05], mom=[(0.9, 0.999)]
steps: 529 loss: 0.3081 iter time (s): 65.440 samples/sec: 1.956

 90%|█████████ | 9/10 [10:17<01:07, 67.09s/it][A
 90%|█████████ | 9/10 [10:16<01:07, 67.09s/it][A
 90%|█████████ | 9/10 [10:16<01:07, 67.09s/it][A
 90%|█████████ | 9/10 [10:16<01:07, 67.08s/it][A
 90%|█████████ | 9/10 [10:16<01:07, 67.09s/it][A
 90%|█████████ | 9/10 [10:16<01:07, 67.07s/it][A
 90%|█████████ | 9/10 [10:16<01:07, 67.03s/it][A
100%|██████████| 10/10 [11:22<00:00, 66.49s/it][A100%|██████████| 10/10 [11:22<00:00, 68.24s/it]
 10%|█         | 54/520 [3:19:02<93:49:40, 724.85s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 01:12:21,980] [INFO] [logging.py:96:log_dist] [Rank 0] step=530, skipped=0, lr=[1.9794608015138936e-05], mom=[(0.9, 0.999)]
steps: 530 loss: 0.2780 iter time (s): 64.430 samples/sec: 1.987

100%|██████████| 10/10 [11:22<00:00, 66.47s/it][A100%|██████████| 10/10 [11:22<00:00, 68.21s/it]
 10%|█         | 54/520 [3:16:49<93:45:09, 724.27s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:22<00:00, 66.50s/it][A100%|██████████| 10/10 [11:22<00:00, 68.21s/it]
 10%|█         | 54/520 [3:19:10<93:49:07, 724.78s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:22<00:00, 66.48s/it][A100%|██████████| 10/10 [11:22<00:00, 68.20s/it]
 10%|█         | 54/520 [3:19:09<93:48:59, 724.76s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:22<00:00, 66.49s/it][A100%|██████████| 10/10 [11:22<00:00, 68.20s/it]
 10%|█         | 54/520 [3:18:03<93:47:12, 724.53s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:22<00:00, 66.48s/it][A100%|██████████| 10/10 [11:22<00:00, 68.20s/it]
 10%|█         | 54/520 [3:18:45<93:48:22, 724.68s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:22<00:00, 66.47s/it][A100%|██████████| 10/10 [11:22<00:00, 68.20s/it]
 10%|█         | 54/520 [3:17:32<93:46:22, 724.43s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:22<00:00, 66.44s/it][A100%|██████████| 10/10 [11:22<00:00, 68.20s/it]
 10%|█         | 54/520 [3:14:22<93:41:05, 723.75s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_324
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:27<13:04, 87.14s/it][A[2024-05-30 01:13:49,876] [INFO] [logging.py:96:log_dist] [Rank 0] step=531, skipped=0, lr=[1.9793464414886774e-05], mom=[(0.9, 0.999)]
steps: 531 loss: 0.5902 iter time (s): 87.131 samples/sec: 1.469

 10%|█         | 1/10 [01:27<13:11, 87.93s/it][A
 10%|█         | 1/10 [01:27<13:11, 87.97s/it][A
 10%|█         | 1/10 [01:27<13:11, 87.95s/it][A
 10%|█         | 1/10 [01:27<13:11, 87.98s/it][A
 10%|█         | 1/10 [01:27<13:11, 87.98s/it][A
 10%|█         | 1/10 [01:27<13:11, 87.97s/it][A
 10%|█         | 1/10 [01:27<13:11, 87.99s/it][A
 20%|██        | 2/10 [02:50<11:17, 84.75s/it][A[2024-05-30 01:15:12,953] [INFO] [logging.py:96:log_dist] [Rank 0] step=532, skipped=0, lr=[1.9792317672968954e-05], mom=[(0.9, 0.999)]
steps: 532 loss: 0.5937 iter time (s): 82.294 samples/sec: 1.555

 20%|██        | 2/10 [02:51<11:20, 85.09s/it][A
 20%|██        | 2/10 [02:51<11:20, 85.10s/it][A
 20%|██        | 2/10 [02:51<11:20, 85.11s/it][A
 20%|██        | 2/10 [02:51<11:20, 85.12s/it][A
 20%|██        | 2/10 [02:51<11:20, 85.12s/it][A
 20%|██        | 2/10 [02:51<11:20, 85.11s/it][A
 20%|██        | 2/10 [02:51<11:20, 85.11s/it][A
 30%|███       | 3/10 [04:14<09:52, 84.66s/it][A[2024-05-30 01:16:37,515] [INFO] [logging.py:96:log_dist] [Rank 0] step=533, skipped=0, lr=[1.9791167789753372e-05], mom=[(0.9, 0.999)]
steps: 533 loss: 0.6008 iter time (s): 83.751 samples/sec: 1.528

 30%|███       | 3/10 [04:15<09:53, 84.83s/it][A
 30%|███       | 3/10 [04:15<09:53, 84.82s/it][A
 30%|███       | 3/10 [04:15<09:53, 84.85s/it][A
 30%|███       | 3/10 [04:15<09:53, 84.84s/it][A
 30%|███       | 3/10 [04:15<09:54, 84.86s/it][A
 30%|███       | 3/10 [04:15<09:53, 84.85s/it][A
 30%|███       | 3/10 [04:15<09:53, 84.85s/it][A
 40%|████      | 4/10 [05:45<08:41, 86.89s/it][A[2024-05-30 01:18:07,344] [INFO] [logging.py:96:log_dist] [Rank 0] step=534, skipped=0, lr=[1.9790014765608948e-05], mom=[(0.9, 0.999)]
steps: 534 loss: 0.6042 iter time (s): 89.050 samples/sec: 1.437

 40%|████      | 4/10 [05:45<08:40, 86.80s/it][A
 40%|████      | 4/10 [05:45<08:40, 86.79s/it][A
 40%|████      | 4/10 [05:45<08:40, 86.81s/it][A
 40%|████      | 4/10 [05:45<08:40, 86.80s/it][A
 40%|████      | 4/10 [05:45<08:40, 86.82s/it][A
 40%|████      | 4/10 [05:45<08:40, 86.81s/it][A
 40%|████      | 4/10 [05:45<08:40, 86.81s/it][A
 50%|█████     | 5/10 [07:08<07:08, 85.63s/it][A[2024-05-30 01:19:31,222] [INFO] [logging.py:96:log_dist] [Rank 0] step=535, skipped=0, lr=[1.978885860090559e-05], mom=[(0.9, 0.999)]
steps: 535 loss: 0.6002 iter time (s): 83.091 samples/sec: 1.540

 50%|█████     | 5/10 [07:09<07:08, 85.75s/it][A
 50%|█████     | 5/10 [07:09<07:08, 85.75s/it][A
 50%|█████     | 5/10 [07:09<07:08, 85.75s/it][A
 50%|█████     | 5/10 [07:09<07:08, 85.75s/it][A
 50%|█████     | 5/10 [07:09<07:08, 85.74s/it][A
 50%|█████     | 5/10 [07:09<07:08, 85.75s/it][A
 50%|█████     | 5/10 [07:09<07:08, 85.74s/it][A
 60%|██████    | 6/10 [08:30<05:38, 84.55s/it][A[2024-05-30 01:20:53,673] [INFO] [logging.py:96:log_dist] [Rank 0] step=536, skipped=0, lr=[1.9787699296014235e-05], mom=[(0.9, 0.999)]
steps: 536 loss: 0.5923 iter time (s): 81.712 samples/sec: 1.566

 60%|██████    | 6/10 [08:31<05:38, 84.63s/it][A
 60%|██████    | 6/10 [08:31<05:38, 84.64s/it][A
 60%|██████    | 6/10 [08:31<05:38, 84.63s/it][A
 60%|██████    | 6/10 [08:31<05:38, 84.65s/it][A
 60%|██████    | 6/10 [08:31<05:38, 84.64s/it][A
 60%|██████    | 6/10 [08:31<05:38, 84.64s/it][A
 60%|██████    | 6/10 [08:31<05:38, 84.64s/it][A
 70%|███████   | 7/10 [09:51<04:10, 83.37s/it][A[2024-05-30 01:22:14,595] [INFO] [logging.py:96:log_dist] [Rank 0] step=537, skipped=0, lr=[1.9786536851306807e-05], mom=[(0.9, 0.999)]
steps: 537 loss: 0.5923 iter time (s): 80.126 samples/sec: 1.597

 70%|███████   | 7/10 [09:52<04:10, 83.42s/it][A
 70%|███████   | 7/10 [09:52<04:10, 83.42s/it][A
 70%|███████   | 7/10 [09:52<04:10, 83.41s/it][A
 70%|███████   | 7/10 [09:52<04:10, 83.42s/it][A
 70%|███████   | 7/10 [09:52<04:10, 83.43s/it][A
 70%|███████   | 7/10 [09:52<04:10, 83.43s/it][A
 70%|███████   | 7/10 [09:52<04:10, 83.42s/it][A
 80%|████████  | 8/10 [11:13<02:45, 82.85s/it][A[2024-05-30 01:23:36,349] [INFO] [logging.py:96:log_dist] [Rank 0] step=538, skipped=0, lr=[1.978537126715625e-05], mom=[(0.9, 0.999)]
steps: 538 loss: 0.5931 iter time (s): 80.971 samples/sec: 1.581

 80%|████████  | 8/10 [11:14<02:45, 82.89s/it][A
 80%|████████  | 8/10 [11:14<02:45, 82.89s/it][A
 80%|████████  | 8/10 [11:14<02:45, 82.90s/it][A
 80%|████████  | 8/10 [11:14<02:45, 82.88s/it][A
 80%|████████  | 8/10 [11:14<02:45, 82.88s/it][A
 80%|████████  | 8/10 [11:14<02:45, 82.90s/it][A
 80%|████████  | 8/10 [11:14<02:45, 82.89s/it][A
 90%|█████████ | 9/10 [12:37<01:23, 83.03s/it][A[2024-05-30 01:24:59,751] [INFO] [logging.py:96:log_dist] [Rank 0] step=539, skipped=0, lr=[1.978420254393652e-05], mom=[(0.9, 0.999)]
steps: 539 loss: 0.5818 iter time (s): 82.598 samples/sec: 1.550

 90%|█████████ | 9/10 [12:37<01:23, 83.06s/it][A
 90%|█████████ | 9/10 [12:37<01:23, 83.05s/it][A
 90%|█████████ | 9/10 [12:37<01:23, 83.03s/it][A
 90%|█████████ | 9/10 [12:37<01:23, 83.04s/it][A
 90%|█████████ | 9/10 [12:37<01:23, 83.02s/it][A
 90%|█████████ | 9/10 [12:37<01:23, 83.04s/it][A
 90%|█████████ | 9/10 [12:37<01:23, 83.04s/it][A
100%|██████████| 10/10 [13:59<00:00, 82.71s/it][A100%|██████████| 10/10 [13:59<00:00, 83.90s/it]
 11%|█         | 55/520 [3:33:01<97:36:51, 755.72s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 01:26:21,740] [INFO] [logging.py:96:log_dist] [Rank 0] step=540, skipped=0, lr=[1.9783030682022566e-05], mom=[(0.9, 0.999)]
steps: 540 loss: 0.5729 iter time (s): 81.228 samples/sec: 1.576

100%|██████████| 10/10 [13:59<00:00, 82.71s/it][A100%|██████████| 10/10 [13:59<00:00, 83.98s/it]
 11%|█         | 55/520 [3:30:49<97:34:30, 755.42s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:59<00:00, 82.70s/it][A100%|██████████| 10/10 [13:59<00:00, 83.97s/it]
 11%|█         | 55/520 [3:33:10<97:37:16, 755.78s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:59<00:00, 82.69s/it][A100%|██████████| 10/10 [13:59<00:00, 83.97s/it]
 11%|█         | 55/520 [3:33:09<97:37:12, 755.77s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:59<00:00, 82.70s/it][A100%|██████████| 10/10 [13:59<00:00, 83.98s/it]
 11%|█         | 55/520 [3:32:03<97:35:58, 755.61s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:59<00:00, 82.70s/it][A100%|██████████| 10/10 [13:59<00:00, 83.98s/it]
 11%|█         | 55/520 [3:31:32<97:35:23, 755.53s/it]
100%|██████████| 10/10 [13:59<00:00, 82.71s/it][A100%|██████████| 10/10 [13:59<00:00, 83.98s/it]
 11%|█         | 55/520 [3:32:45<97:36:56, 755.73s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:59<00:00, 82.70s/it][A100%|██████████| 10/10 [13:59<00:00, 83.98s/it]
 11%|█         | 55/520 [3:28:22<97:31:32, 755.04s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_74
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:20<12:03, 80.36s/it][A[2024-05-30 01:27:42,140] [INFO] [logging.py:96:log_dist] [Rank 0] step=541, skipped=0, lr=[1.9781855681790346e-05], mom=[(0.9, 0.999)]
steps: 541 loss: 1.1336 iter time (s): 79.580 samples/sec: 1.608

 10%|█         | 1/10 [01:20<12:03, 80.34s/it][A
 10%|█         | 1/10 [01:20<12:03, 80.41s/it][A
 10%|█         | 1/10 [01:20<12:03, 80.37s/it][A
 10%|█         | 1/10 [01:20<12:02, 80.33s/it][A
 10%|█         | 1/10 [01:20<12:02, 80.27s/it][A
 10%|█         | 1/10 [01:20<12:02, 80.32s/it][A
 10%|█         | 1/10 [01:20<12:02, 80.31s/it][A
 20%|██        | 2/10 [02:41<10:46, 80.82s/it][A[2024-05-30 01:29:03,285] [INFO] [logging.py:96:log_dist] [Rank 0] step=542, skipped=0, lr=[1.9780677543616837e-05], mom=[(0.9, 0.999)]
steps: 542 loss: 1.1266 iter time (s): 80.500 samples/sec: 1.590

 20%|██        | 2/10 [02:41<10:46, 80.82s/it][A
 20%|██        | 2/10 [02:41<10:46, 80.83s/it][A
 20%|██        | 2/10 [02:41<10:46, 80.85s/it][A
 20%|██        | 2/10 [02:41<10:46, 80.85s/it][A
 20%|██        | 2/10 [02:41<10:46, 80.83s/it][A
 20%|██        | 2/10 [02:41<10:46, 80.84s/it][A
 20%|██        | 2/10 [02:41<10:46, 80.84s/it][A
 30%|███       | 3/10 [04:02<09:25, 80.74s/it][A[2024-05-30 01:30:23,921] [INFO] [logging.py:96:log_dist] [Rank 0] step=543, skipped=0, lr=[1.9779496267880012e-05], mom=[(0.9, 0.999)]
steps: 543 loss: 1.1061 iter time (s): 79.943 samples/sec: 1.601

 30%|███       | 3/10 [04:02<09:25, 80.75s/it][A
 30%|███       | 3/10 [04:02<09:25, 80.73s/it][A
 30%|███       | 3/10 [04:02<09:25, 80.75s/it][A
 30%|███       | 3/10 [04:02<09:25, 80.78s/it][A
 30%|███       | 3/10 [04:02<09:25, 80.75s/it][A
 30%|███       | 3/10 [04:02<09:25, 80.75s/it][A
 30%|███       | 3/10 [04:02<09:25, 80.76s/it][A
 40%|████      | 4/10 [05:20<07:58, 79.81s/it][A[2024-05-30 01:31:42,325] [INFO] [logging.py:96:log_dist] [Rank 0] step=544, skipped=0, lr=[1.9778311854958855e-05], mom=[(0.9, 0.999)]
steps: 544 loss: 1.1072 iter time (s): 77.667 samples/sec: 1.648

 40%|████      | 4/10 [05:20<07:58, 79.82s/it][A
 40%|████      | 4/10 [05:20<07:58, 79.81s/it][A
 40%|████      | 4/10 [05:20<07:58, 79.79s/it][A
 40%|████      | 4/10 [05:20<07:59, 79.84s/it][A
 40%|████      | 4/10 [05:20<07:58, 79.79s/it][A
 40%|████      | 4/10 [05:20<07:58, 79.81s/it][A
 40%|████      | 4/10 [05:20<07:58, 79.79s/it][A
 50%|█████     | 5/10 [06:37<06:34, 78.92s/it][A[2024-05-30 01:32:59,653] [INFO] [logging.py:96:log_dist] [Rank 0] step=545, skipped=0, lr=[1.9777124305233354e-05], mom=[(0.9, 0.999)]
steps: 545 loss: 1.1144 iter time (s): 76.694 samples/sec: 1.669

 50%|█████     | 5/10 [06:37<06:34, 78.94s/it][A
 50%|█████     | 5/10 [06:37<06:34, 78.92s/it][A
 50%|█████     | 5/10 [06:37<06:34, 78.92s/it][A
 50%|█████     | 5/10 [06:37<06:34, 78.92s/it][A
 50%|█████     | 5/10 [06:37<06:34, 78.91s/it][A
 50%|█████     | 5/10 [06:37<06:34, 78.92s/it][A
 50%|█████     | 5/10 [06:37<06:34, 78.92s/it][A
 60%|██████    | 6/10 [07:54<05:12, 78.20s/it][A[2024-05-30 01:34:16,451] [INFO] [logging.py:96:log_dist] [Rank 0] step=546, skipped=0, lr=[1.97759336190845e-05], mom=[(0.9, 0.999)]
steps: 546 loss: 1.1136 iter time (s): 76.098 samples/sec: 1.682

 60%|██████    | 6/10 [07:54<05:12, 78.17s/it][A
 60%|██████    | 6/10 [07:54<05:12, 78.21s/it][A
 60%|██████    | 6/10 [07:54<05:12, 78.22s/it][A
 60%|██████    | 6/10 [07:54<05:12, 78.20s/it][A
 60%|██████    | 6/10 [07:54<05:12, 78.21s/it][A
 60%|██████    | 6/10 [07:54<05:12, 78.20s/it][A
 60%|██████    | 6/10 [07:54<05:12, 78.20s/it][A
 70%|███████   | 7/10 [09:10<03:51, 77.32s/it][A[2024-05-30 01:35:31,940] [INFO] [logging.py:96:log_dist] [Rank 0] step=547, skipped=0, lr=[1.97747397968943e-05], mom=[(0.9, 0.999)]
steps: 547 loss: 1.0976 iter time (s): 74.783 samples/sec: 1.712

 70%|███████   | 7/10 [09:10<03:52, 77.40s/it][A
 70%|███████   | 7/10 [09:10<03:52, 77.40s/it][A
 70%|███████   | 7/10 [09:10<03:52, 77.39s/it][A
 70%|███████   | 7/10 [09:10<03:52, 77.38s/it][A
 70%|███████   | 7/10 [09:10<03:52, 77.41s/it][A
 70%|███████   | 7/10 [09:10<03:52, 77.40s/it][A
 70%|███████   | 7/10 [09:10<03:52, 77.40s/it][A
 80%|████████  | 8/10 [10:26<02:34, 77.03s/it][A[2024-05-30 01:36:48,354] [INFO] [logging.py:96:log_dist] [Rank 0] step=548, skipped=0, lr=[1.9773542839045763e-05], mom=[(0.9, 0.999)]
steps: 548 loss: 1.0892 iter time (s): 75.461 samples/sec: 1.696

 80%|████████  | 8/10 [10:26<02:33, 77.00s/it][A
 80%|████████  | 8/10 [10:26<02:33, 77.00s/it][A
 80%|████████  | 8/10 [10:26<02:33, 76.98s/it][A
 80%|████████  | 8/10 [10:26<02:33, 77.00s/it][A
 80%|████████  | 8/10 [10:26<02:34, 77.01s/it][A
 80%|████████  | 8/10 [10:26<02:33, 77.00s/it][A
 80%|████████  | 8/10 [10:26<02:34, 77.00s/it][A
 90%|█████████ | 9/10 [11:41<01:16, 76.50s/it][A[2024-05-30 01:38:03,740] [INFO] [logging.py:96:log_dist] [Rank 0] step=549, skipped=0, lr=[1.97723427459229e-05], mom=[(0.9, 0.999)]
steps: 549 loss: 1.0860 iter time (s): 74.714 samples/sec: 1.713

 90%|█████████ | 9/10 [11:42<01:16, 76.58s/it][A
 90%|█████████ | 9/10 [11:42<01:16, 76.55s/it][A
 90%|█████████ | 9/10 [11:42<01:16, 76.54s/it][A
 90%|█████████ | 9/10 [11:42<01:16, 76.57s/it][A
 90%|█████████ | 9/10 [11:42<01:16, 76.56s/it][A
 90%|█████████ | 9/10 [11:42<01:16, 76.59s/it][A
 90%|█████████ | 9/10 [11:42<01:16, 76.78s/it][A
100%|██████████| 10/10 [13:01<00:00, 77.41s/it][A100%|██████████| 10/10 [13:01<00:00, 78.14s/it]
 11%|█         | 56/520 [3:46:03<98:19:52, 762.92s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 01:39:23,159] [INFO] [logging.py:96:log_dist] [Rank 0] step=550, skipped=0, lr=[1.977113951791073e-05], mom=[(0.9, 0.999)]
steps: 550 loss: 1.0797 iter time (s): 77.861 samples/sec: 1.644

100%|██████████| 10/10 [13:01<00:00, 77.39s/it][A100%|██████████| 10/10 [13:01<00:00, 78.15s/it]
 11%|█         | 56/520 [3:43:50<98:17:56, 762.67s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:01<00:00, 77.40s/it][A100%|██████████| 10/10 [13:01<00:00, 78.15s/it]
 11%|█         | 56/520 [3:46:11<98:19:56, 762.92s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:01<00:00, 77.39s/it][A100%|██████████| 10/10 [13:01<00:00, 78.14s/it]
 11%|█         | 56/520 [3:46:11<98:19:52, 762.91s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:01<00:00, 77.38s/it][A100%|██████████| 10/10 [13:01<00:00, 78.14s/it]
 11%|█         | 56/520 [3:45:04<98:18:55, 762.79s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:01<00:00, 77.39s/it][A100%|██████████| 10/10 [13:01<00:00, 78.14s/it]
 11%|█         | 56/520 [3:45:46<98:19:30, 762.87s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:01<00:00, 77.38s/it][A100%|██████████| 10/10 [13:01<00:00, 78.14s/it]
 11%|█         | 56/520 [3:44:34<98:18:26, 762.73s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:01<00:00, 77.32s/it][A100%|██████████| 10/10 [13:01<00:00, 78.14s/it]
 11%|█         | 56/520 [3:41:23<98:15:41, 762.37s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_37
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:41<15:14, 101.62s/it][A[2024-05-30 01:41:05,742] [INFO] [logging.py:96:log_dist] [Rank 0] step=551, skipped=0, lr=[1.976993315539528e-05], mom=[(0.9, 0.999)]
steps: 551 loss: 0.8520 iter time (s): 101.782 samples/sec: 1.258

 10%|█         | 1/10 [01:42<15:24, 102.72s/it][A
 10%|█         | 1/10 [01:42<15:24, 102.77s/it][A
 10%|█         | 1/10 [01:42<15:25, 102.81s/it][A
 10%|█         | 1/10 [01:42<15:25, 102.83s/it][A
 10%|█         | 1/10 [01:42<15:25, 102.82s/it][A
 10%|█         | 1/10 [01:42<15:25, 102.82s/it][A
 10%|█         | 1/10 [01:42<15:25, 102.83s/it][A
 20%|██        | 2/10 [03:20<13:19, 99.97s/it] [A[2024-05-30 01:42:44,552] [INFO] [logging.py:96:log_dist] [Rank 0] step=552, skipped=0, lr=[1.976872365876358e-05], mom=[(0.9, 0.999)]
steps: 552 loss: 0.8391 iter time (s): 97.893 samples/sec: 1.308

 20%|██        | 2/10 [03:21<13:22, 100.35s/it][A
 20%|██        | 2/10 [03:21<13:22, 100.36s/it][A
 20%|██        | 2/10 [03:21<13:23, 100.43s/it][A
 20%|██        | 2/10 [03:21<13:23, 100.39s/it][A
 20%|██        | 2/10 [03:21<13:23, 100.41s/it][A
 20%|██        | 2/10 [03:21<13:23, 100.42s/it][A
 20%|██        | 2/10 [03:21<13:23, 100.41s/it][A
 30%|███       | 3/10 [04:57<11:30, 98.70s/it][A[2024-05-30 01:44:21,732] [INFO] [logging.py:96:log_dist] [Rank 0] step=553, skipped=0, lr=[1.9767511028403668e-05], mom=[(0.9, 0.999)]
steps: 553 loss: 0.8821 iter time (s): 96.321 samples/sec: 1.329

 30%|███       | 3/10 [04:58<11:32, 98.92s/it] [A
 30%|███       | 3/10 [04:58<11:32, 98.95s/it] [A
 30%|███       | 3/10 [04:58<11:32, 98.94s/it] [A
 30%|███       | 3/10 [04:58<11:32, 98.94s/it] [A
 30%|███       | 3/10 [04:58<11:32, 98.94s/it] [A
 30%|███       | 3/10 [04:58<11:32, 98.94s/it] [A
 30%|███       | 3/10 [04:58<11:32, 98.94s/it] [A
 40%|████      | 4/10 [06:35<09:50, 98.45s/it][A[2024-05-30 01:45:59,818] [INFO] [logging.py:96:log_dist] [Rank 0] step=554, skipped=0, lr=[1.9766295264704586e-05], mom=[(0.9, 0.999)]
steps: 554 loss: 0.8563 iter time (s): 97.220 samples/sec: 1.317

 40%|████      | 4/10 [06:36<09:51, 98.57s/it][A
 40%|████      | 4/10 [06:36<09:51, 98.58s/it][A
 40%|████      | 4/10 [06:36<09:51, 98.61s/it][A
 40%|████      | 4/10 [06:36<09:51, 98.58s/it][A
 40%|████      | 4/10 [06:36<09:51, 98.59s/it][A
 40%|████      | 4/10 [06:36<09:51, 98.61s/it][A
 40%|████      | 4/10 [06:36<09:51, 98.60s/it][A
 50%|█████     | 5/10 [08:13<08:10, 98.07s/it][A[2024-05-30 01:47:37,177] [INFO] [logging.py:96:log_dist] [Rank 0] step=555, skipped=0, lr=[1.9765076368056377e-05], mom=[(0.9, 0.999)]
steps: 555 loss: 0.8698 iter time (s): 96.461 samples/sec: 1.327

 50%|█████     | 5/10 [08:13<08:10, 98.09s/it][A
 50%|█████     | 5/10 [08:14<08:10, 98.11s/it][A
 50%|█████     | 5/10 [08:14<08:10, 98.10s/it][A
 50%|█████     | 5/10 [08:14<08:10, 98.12s/it][A
 50%|█████     | 5/10 [08:14<08:10, 98.13s/it][A
 50%|█████     | 5/10 [08:14<08:10, 98.12s/it][A
 50%|█████     | 5/10 [08:14<08:10, 98.13s/it][A
 60%|██████    | 6/10 [09:52<06:34, 98.53s/it][A[2024-05-30 01:49:16,634] [INFO] [logging.py:96:log_dist] [Rank 0] step=556, skipped=0, lr=[1.9763854338850096e-05], mom=[(0.9, 0.999)]
steps: 556 loss: 0.8571 iter time (s): 98.656 samples/sec: 1.297

 60%|██████    | 6/10 [09:53<06:34, 98.60s/it][A
 60%|██████    | 6/10 [09:53<06:34, 98.59s/it][A
 60%|██████    | 6/10 [09:53<06:34, 98.61s/it][A
 60%|██████    | 6/10 [09:53<06:34, 98.60s/it][A
 60%|██████    | 6/10 [09:53<06:34, 98.60s/it][A
 60%|██████    | 6/10 [09:53<06:34, 98.61s/it][A
 60%|██████    | 6/10 [09:53<06:34, 98.60s/it][A
 70%|███████   | 7/10 [11:29<04:54, 98.13s/it][A[2024-05-30 01:50:53,945] [INFO] [logging.py:96:log_dist] [Rank 0] step=557, skipped=0, lr=[1.9762629177477806e-05], mom=[(0.9, 0.999)]
steps: 557 loss: 0.8307 iter time (s): 96.441 samples/sec: 1.327

 70%|███████   | 7/10 [11:30<04:54, 98.17s/it][A
 70%|███████   | 7/10 [11:30<04:54, 98.13s/it][A
 70%|███████   | 7/10 [11:30<04:54, 98.18s/it][A
 70%|███████   | 7/10 [11:30<04:54, 98.16s/it][A
 70%|███████   | 7/10 [11:30<04:54, 98.16s/it][A
 70%|███████   | 7/10 [11:30<04:54, 98.16s/it][A
 70%|███████   | 7/10 [11:30<04:54, 98.16s/it][A
 80%|████████  | 8/10 [13:08<03:16, 98.26s/it][A[2024-05-30 01:52:32,449] [INFO] [logging.py:96:log_dist] [Rank 0] step=558, skipped=0, lr=[1.976140088433256e-05], mom=[(0.9, 0.999)]
steps: 558 loss: 0.8374 iter time (s): 97.715 samples/sec: 1.310

 80%|████████  | 8/10 [13:09<03:16, 98.27s/it][A
 80%|████████  | 8/10 [13:09<03:16, 98.28s/it][A
 80%|████████  | 8/10 [13:09<03:16, 98.27s/it][A
 80%|████████  | 8/10 [13:09<03:16, 98.29s/it][A
 80%|████████  | 8/10 [13:09<03:16, 98.30s/it][A
 80%|████████  | 8/10 [13:09<03:16, 98.30s/it][A
 80%|████████  | 8/10 [13:09<03:16, 98.30s/it][A
 90%|█████████ | 9/10 [14:46<01:38, 98.11s/it][A[2024-05-30 01:54:10,245] [INFO] [logging.py:96:log_dist] [Rank 0] step=559, skipped=0, lr=[1.976016945980843e-05], mom=[(0.9, 0.999)]
steps: 559 loss: 0.8420 iter time (s): 96.907 samples/sec: 1.321

 90%|█████████ | 9/10 [14:47<01:38, 98.15s/it][A
 90%|█████████ | 9/10 [14:47<01:38, 98.13s/it][A
 90%|█████████ | 9/10 [14:47<01:38, 98.14s/it][A
 90%|█████████ | 9/10 [14:47<01:38, 98.14s/it][A
 90%|█████████ | 9/10 [14:47<01:38, 98.14s/it][A
 90%|█████████ | 9/10 [14:47<01:38, 98.14s/it][A
 90%|█████████ | 9/10 [14:47<01:38, 98.14s/it][A
100%|██████████| 10/10 [16:23<00:00, 97.73s/it][A100%|██████████| 10/10 [16:23<00:00, 98.30s/it]
 11%|█         | 57/520 [4:02:26<106:10:59, 825.61s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 01:55:47,115] [INFO] [logging.py:96:log_dist] [Rank 0] step=560, skipped=0, lr=[1.9758934904300483e-05], mom=[(0.9, 0.999)]
steps: 560 loss: 0.8539 iter time (s): 95.990 samples/sec: 1.333

100%|██████████| 10/10 [16:23<00:00, 97.74s/it][A100%|██████████| 10/10 [16:23<00:00, 98.40s/it]
 11%|█         | 57/520 [4:00:14<106:10:50, 825.60s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:24<00:00, 97.77s/it][A100%|██████████| 10/10 [16:24<00:00, 98.41s/it]
 11%|█         | 57/520 [4:02:36<106:12:27, 825.80s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:24<00:00, 97.73s/it][A100%|██████████| 10/10 [16:24<00:00, 98.41s/it]
 11%|█         | 57/520 [4:02:35<106:12:23, 825.80s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:24<00:00, 97.74s/it][A100%|██████████| 10/10 [16:24<00:00, 98.41s/it]
 11%|█         | 57/520 [4:01:28<106:11:43, 825.71s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:24<00:00, 97.73s/it][A100%|██████████| 10/10 [16:24<00:00, 98.41s/it]
 11%|█         | 57/520 [4:02:10<106:12:10, 825.77s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:24<00:00, 97.73s/it][A100%|██████████| 10/10 [16:24<00:00, 98.41s/it]
 11%|█         | 57/520 [4:00:58<106:11:26, 825.67s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [16:24<00:00, 97.73s/it][A100%|██████████| 10/10 [16:24<00:00, 98.41s/it]
 11%|█         | 57/520 [3:57:47<106:09:28, 825.42s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_286
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:32<13:54, 92.76s/it][A[2024-05-30 01:57:19,818] [INFO] [logging.py:96:log_dist] [Rank 0] step=561, skipped=0, lr=[1.9757697218204802e-05], mom=[(0.9, 0.999)]
steps: 561 loss: 0.5787 iter time (s): 91.755 samples/sec: 1.395

 10%|█         | 1/10 [01:32<13:53, 92.64s/it][A
 10%|█         | 1/10 [01:32<13:53, 92.57s/it][A
 10%|█         | 1/10 [01:32<13:53, 92.64s/it][A
 10%|█         | 1/10 [01:32<13:53, 92.57s/it][A
 10%|█         | 1/10 [01:32<13:53, 92.63s/it][A
 10%|█         | 1/10 [01:32<13:53, 92.63s/it][A
 10%|█         | 1/10 [01:32<13:53, 92.62s/it][A
 20%|██        | 2/10 [02:55<11:35, 86.92s/it][A[2024-05-30 01:58:42,643] [INFO] [logging.py:96:log_dist] [Rank 0] step=562, skipped=0, lr=[1.9756456401918464e-05], mom=[(0.9, 0.999)]
steps: 562 loss: 0.5691 iter time (s): 82.080 samples/sec: 1.559

 20%|██        | 2/10 [02:55<11:35, 86.90s/it][A
 20%|██        | 2/10 [02:55<11:34, 86.86s/it][A
 20%|██        | 2/10 [02:55<11:34, 86.86s/it][A
 20%|██        | 2/10 [02:55<11:35, 86.89s/it][A
 20%|██        | 2/10 [02:55<11:35, 86.89s/it][A
 20%|██        | 2/10 [02:55<11:35, 86.88s/it][A
 20%|██        | 2/10 [02:55<11:34, 86.87s/it][A
 30%|███       | 3/10 [04:21<10:05, 86.48s/it][A[2024-05-30 02:00:08,601] [INFO] [logging.py:96:log_dist] [Rank 0] step=563, skipped=0, lr=[1.9755212455839552e-05], mom=[(0.9, 0.999)]
steps: 563 loss: 0.5687 iter time (s): 85.164 samples/sec: 1.503

 30%|███       | 3/10 [04:21<10:05, 86.45s/it][A
 30%|███       | 3/10 [04:21<10:04, 86.42s/it][A
 30%|███       | 3/10 [04:21<10:05, 86.45s/it][A
 30%|███       | 3/10 [04:21<10:05, 86.48s/it][A
 30%|███       | 3/10 [04:21<10:05, 86.44s/it][A
 30%|███       | 3/10 [04:21<10:05, 86.45s/it][A
 30%|███       | 3/10 [04:21<10:05, 86.44s/it][A
 40%|████      | 4/10 [05:46<08:35, 85.95s/it][A[2024-05-30 02:01:33,735] [INFO] [logging.py:96:log_dist] [Rank 0] step=564, skipped=0, lr=[1.9753965380367157e-05], mom=[(0.9, 0.999)]
steps: 564 loss: 0.5480 iter time (s): 84.376 samples/sec: 1.517

 40%|████      | 4/10 [05:46<08:35, 85.92s/it][A
 40%|████      | 4/10 [05:46<08:35, 85.92s/it][A
 40%|████      | 4/10 [05:46<08:35, 85.95s/it][A
 40%|████      | 4/10 [05:46<08:35, 85.93s/it][A
 40%|████      | 4/10 [05:46<08:35, 85.92s/it][A
 40%|████      | 4/10 [05:46<08:35, 85.92s/it][A
 40%|████      | 4/10 [05:46<08:35, 85.92s/it][A
 50%|█████     | 5/10 [07:09<07:04, 84.97s/it][A[2024-05-30 02:02:56,966] [INFO] [logging.py:96:log_dist] [Rank 0] step=565, skipped=0, lr=[1.9752715175901373e-05], mom=[(0.9, 0.999)]
steps: 565 loss: 0.5402 iter time (s): 82.469 samples/sec: 1.552

 50%|█████     | 5/10 [07:09<07:04, 84.97s/it][A
 50%|█████     | 5/10 [07:09<07:04, 84.98s/it][A
 50%|█████     | 5/10 [07:09<07:04, 84.94s/it][A
 50%|█████     | 5/10 [07:09<07:04, 84.95s/it][A
 50%|█████     | 5/10 [07:09<07:04, 84.96s/it][A
 50%|█████     | 5/10 [07:09<07:05, 85.00s/it][A
 50%|█████     | 5/10 [07:09<07:05, 85.00s/it][A
 60%|██████    | 6/10 [08:30<05:33, 83.36s/it][A[2024-05-30 02:04:17,199] [INFO] [logging.py:96:log_dist] [Rank 0] step=566, skipped=0, lr=[1.975146184284329e-05], mom=[(0.9, 0.999)]
steps: 566 loss: 0.5572 iter time (s): 79.332 samples/sec: 1.613

 60%|██████    | 6/10 [08:30<05:33, 83.35s/it][A
 60%|██████    | 6/10 [08:29<05:33, 83.35s/it][A
 60%|██████    | 6/10 [08:29<05:33, 83.34s/it][A
 60%|██████    | 6/10 [08:30<05:33, 83.36s/it][A
 60%|██████    | 6/10 [08:30<05:33, 83.42s/it][A
 60%|██████    | 6/10 [08:30<05:33, 83.41s/it][A
 60%|██████    | 6/10 [08:30<05:33, 83.41s/it][A
 70%|███████   | 7/10 [09:52<04:09, 83.18s/it][A[2024-05-30 02:05:39,970] [INFO] [logging.py:96:log_dist] [Rank 0] step=567, skipped=0, lr=[1.9750205381595017e-05], mom=[(0.9, 0.999)]
steps: 567 loss: 0.5514 iter time (s): 81.786 samples/sec: 1.565

 70%|███████   | 7/10 [09:52<04:09, 83.15s/it][A
 70%|███████   | 7/10 [09:52<04:09, 83.15s/it][A
 70%|███████   | 7/10 [09:52<04:09, 83.19s/it][A
 70%|███████   | 7/10 [09:52<04:09, 83.16s/it][A
 70%|███████   | 7/10 [09:52<04:09, 83.14s/it][A
 70%|███████   | 7/10 [09:52<04:09, 83.13s/it][A
 70%|███████   | 7/10 [09:52<04:09, 83.14s/it][A
 80%|████████  | 8/10 [11:18<02:47, 83.79s/it][A[2024-05-30 02:07:05,110] [INFO] [logging.py:96:log_dist] [Rank 0] step=568, skipped=0, lr=[1.974894579255965e-05], mom=[(0.9, 0.999)]
steps: 568 loss: 0.5428 iter time (s): 84.354 samples/sec: 1.517

 80%|████████  | 8/10 [11:17<02:47, 83.81s/it][A
 80%|████████  | 8/10 [11:17<02:47, 83.82s/it][A
 80%|████████  | 8/10 [11:18<02:47, 83.84s/it][A
 80%|████████  | 8/10 [11:18<02:47, 83.83s/it][A
 80%|████████  | 8/10 [11:18<02:47, 83.80s/it][A
 80%|████████  | 8/10 [11:18<02:47, 83.87s/it][A
 80%|████████  | 8/10 [11:18<02:48, 84.00s/it][A
 90%|█████████ | 9/10 [12:43<01:24, 84.35s/it][A[2024-05-30 02:08:30,684] [INFO] [logging.py:96:log_dist] [Rank 0] step=569, skipped=0, lr=[1.9747683076141307e-05], mom=[(0.9, 0.999)]
steps: 569 loss: 0.5155 iter time (s): 84.120 samples/sec: 1.522

 90%|█████████ | 9/10 [12:43<01:24, 84.37s/it][A
 90%|█████████ | 9/10 [12:43<01:24, 84.35s/it][A
 90%|█████████ | 9/10 [12:43<01:24, 84.33s/it][A
 90%|█████████ | 9/10 [12:43<01:24, 84.35s/it][A
 90%|█████████ | 9/10 [12:43<01:24, 84.33s/it][A
 90%|█████████ | 9/10 [12:43<01:24, 84.35s/it][A
 90%|█████████ | 9/10 [12:43<01:24, 84.29s/it][A
100%|██████████| 10/10 [14:08<00:00, 84.66s/it][A100%|██████████| 10/10 [14:08<00:00, 84.90s/it]
 11%|█         | 58/520 [4:16:35<106:49:52, 832.45s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 02:09:56,025] [INFO] [logging.py:96:log_dist] [Rank 0] step=570, skipped=0, lr=[1.974641723274509e-05], mom=[(0.9, 0.999)]
steps: 570 loss: 0.5282 iter time (s): 84.510 samples/sec: 1.515

100%|██████████| 10/10 [14:08<00:00, 84.66s/it][A100%|██████████| 10/10 [14:08<00:00, 84.89s/it]
 11%|█         | 58/520 [4:14:23<106:48:55, 832.33s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:08<00:00, 84.65s/it][A100%|██████████| 10/10 [14:08<00:00, 84.88s/it]
 11%|█         | 58/520 [4:16:44<106:49:51, 832.45s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:08<00:00, 84.64s/it][A100%|██████████| 10/10 [14:08<00:00, 84.88s/it]
 11%|█         | 58/520 [4:16:43<106:49:55, 832.46s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:08<00:00, 84.64s/it][A100%|██████████| 10/10 [14:08<00:00, 84.88s/it]
 11%|█         | 58/520 [4:15:37<106:49:25, 832.39s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:08<00:00, 84.62s/it][A100%|██████████| 10/10 [14:08<00:00, 84.88s/it]
 11%|█         | 58/520 [4:16:19<106:49:45, 832.44s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:08<00:00, 84.63s/it][A100%|██████████| 10/10 [14:08<00:00, 84.88s/it]
 11%|█         | 58/520 [4:15:06<106:49:15, 832.37s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:08<00:00, 84.60s/it][A100%|██████████| 10/10 [14:08<00:00, 84.88s/it]
 11%|█         | 58/520 [4:11:56<106:47:51, 832.19s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_53
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:04<09:40, 64.54s/it][A[2024-05-30 02:11:00,404] [INFO] [logging.py:96:log_dist] [Rank 0] step=571, skipped=0, lr=[1.974514826277711e-05], mom=[(0.9, 0.999)]
steps: 571 loss: 1.2401 iter time (s): 63.509 samples/sec: 2.015

 10%|█         | 1/10 [01:04<09:38, 64.30s/it][A
 10%|█         | 1/10 [01:04<09:38, 64.31s/it][A
 10%|█         | 1/10 [01:04<09:38, 64.27s/it][A
 10%|█         | 1/10 [01:04<09:38, 64.26s/it][A
 10%|█         | 1/10 [01:04<09:38, 64.27s/it][A
 10%|█         | 1/10 [01:04<09:38, 64.25s/it][A
 10%|█         | 1/10 [01:04<09:38, 64.26s/it][A
 20%|██        | 2/10 [02:10<08:45, 65.65s/it][A[2024-05-30 02:12:06,516] [INFO] [logging.py:96:log_dist] [Rank 0] step=572, skipped=0, lr=[1.9743876166644496e-05], mom=[(0.9, 0.999)]
steps: 572 loss: 1.2361 iter time (s): 65.410 samples/sec: 1.957

 20%|██        | 2/10 [02:10<08:42, 65.37s/it][A
 20%|██        | 2/10 [02:10<08:42, 65.33s/it][A
 20%|██        | 2/10 [02:10<08:42, 65.36s/it][A
 20%|██        | 2/10 [02:10<08:42, 65.35s/it][A
 20%|██        | 2/10 [02:10<08:42, 65.34s/it][A
 20%|██        | 2/10 [02:10<08:42, 65.34s/it][A
 20%|██        | 2/10 [02:10<08:42, 65.32s/it][A
 30%|███       | 3/10 [03:17<07:42, 66.07s/it][A[2024-05-30 02:13:13,393] [INFO] [logging.py:96:log_dist] [Rank 0] step=573, skipped=0, lr=[1.9742600944755358e-05], mom=[(0.9, 0.999)]
steps: 573 loss: 1.2451 iter time (s): 66.263 samples/sec: 1.932

 30%|███       | 3/10 [03:17<07:42, 66.06s/it][A
 30%|███       | 3/10 [03:17<07:42, 66.07s/it][A
 30%|███       | 3/10 [03:17<07:42, 66.07s/it][A
 30%|███       | 3/10 [03:17<07:42, 66.06s/it][A
 30%|███       | 3/10 [03:17<07:42, 66.06s/it][A
 30%|███       | 3/10 [03:17<07:42, 66.05s/it][A
 30%|███       | 3/10 [03:17<07:42, 66.06s/it][A
 40%|████      | 4/10 [04:22<06:33, 65.62s/it][A[2024-05-30 02:14:18,341] [INFO] [logging.py:96:log_dist] [Rank 0] step=574, skipped=0, lr=[1.9741322597518824e-05], mom=[(0.9, 0.999)]
steps: 574 loss: 1.2487 iter time (s): 64.240 samples/sec: 1.993

 40%|████      | 4/10 [04:22<06:33, 65.60s/it][A
 40%|████      | 4/10 [04:22<06:33, 65.62s/it][A
 40%|████      | 4/10 [04:22<06:33, 65.61s/it][A
 40%|████      | 4/10 [04:22<06:33, 65.62s/it][A
 40%|████      | 4/10 [04:22<06:33, 65.61s/it][A
 40%|████      | 4/10 [04:22<06:33, 65.61s/it][A
 40%|████      | 4/10 [04:22<06:33, 65.62s/it][A
 50%|█████     | 5/10 [05:30<05:32, 66.44s/it][A[2024-05-30 02:15:26,242] [INFO] [logging.py:96:log_dist] [Rank 0] step=575, skipped=0, lr=[1.9740041125345016e-05], mom=[(0.9, 0.999)]
steps: 575 loss: 1.2233 iter time (s): 67.242 samples/sec: 1.904

 50%|█████     | 5/10 [05:30<05:32, 66.41s/it][A
 50%|█████     | 5/10 [05:30<05:32, 66.43s/it][A
 50%|█████     | 5/10 [05:30<05:32, 66.42s/it][A
 50%|█████     | 5/10 [05:30<05:32, 66.46s/it][A
 50%|█████     | 5/10 [05:30<05:32, 66.46s/it][A
 50%|█████     | 5/10 [05:30<05:32, 66.44s/it][A
 50%|█████     | 5/10 [05:30<05:32, 66.44s/it][A
 60%|██████    | 6/10 [06:41<04:32, 68.04s/it][A[2024-05-30 02:16:37,385] [INFO] [logging.py:96:log_dist] [Rank 0] step=576, skipped=0, lr=[1.973875652864506e-05], mom=[(0.9, 0.999)]
steps: 576 loss: 1.2296 iter time (s): 70.447 samples/sec: 1.817

 60%|██████    | 6/10 [06:41<04:32, 68.04s/it][A
 60%|██████    | 6/10 [06:41<04:32, 68.02s/it][A
 60%|██████    | 6/10 [06:41<04:32, 68.04s/it][A
 60%|██████    | 6/10 [06:41<04:32, 68.02s/it][A
 60%|██████    | 6/10 [06:41<04:32, 68.04s/it][A
 60%|██████    | 6/10 [06:41<04:32, 68.02s/it][A
 60%|██████    | 6/10 [06:41<04:32, 68.02s/it][A
 70%|███████   | 7/10 [07:47<03:21, 67.21s/it][A[2024-05-30 02:17:42,874] [INFO] [logging.py:96:log_dist] [Rank 0] step=577, skipped=0, lr=[1.9737468807831098e-05], mom=[(0.9, 0.999)]
steps: 577 loss: 1.2301 iter time (s): 64.854 samples/sec: 1.974

 70%|███████   | 7/10 [07:46<03:21, 67.21s/it][A
 70%|███████   | 7/10 [07:46<03:21, 67.21s/it][A
 70%|███████   | 7/10 [07:46<03:21, 67.21s/it][A
 70%|███████   | 7/10 [07:46<03:21, 67.21s/it][A
 70%|███████   | 7/10 [07:46<03:21, 67.21s/it][A
 70%|███████   | 7/10 [07:46<03:21, 67.21s/it][A
 70%|███████   | 7/10 [07:46<03:21, 67.21s/it][A
 80%|████████  | 8/10 [08:54<02:14, 67.42s/it][A[2024-05-30 02:18:50,745] [INFO] [logging.py:96:log_dist] [Rank 0] step=578, skipped=0, lr=[1.9736177963316252e-05], mom=[(0.9, 0.999)]
steps: 578 loss: 1.2078 iter time (s): 67.177 samples/sec: 1.905

 80%|████████  | 8/10 [08:54<02:14, 67.45s/it][A
 80%|████████  | 8/10 [08:54<02:14, 67.44s/it][A
 80%|████████  | 8/10 [08:54<02:14, 67.47s/it][A
 80%|████████  | 8/10 [08:54<02:14, 67.46s/it][A
 80%|████████  | 8/10 [08:54<02:14, 67.47s/it][A
 80%|████████  | 8/10 [08:54<02:14, 67.48s/it][A
 80%|████████  | 8/10 [08:54<02:14, 67.48s/it][A
 90%|█████████ | 9/10 [10:03<01:07, 67.83s/it][A[2024-05-30 02:19:59,472] [INFO] [logging.py:96:log_dist] [Rank 0] step=579, skipped=0, lr=[1.9734883995514658e-05], mom=[(0.9, 0.999)]
steps: 579 loss: 1.2232 iter time (s): 67.875 samples/sec: 1.886

 90%|█████████ | 9/10 [10:03<01:07, 67.81s/it][A
 90%|█████████ | 9/10 [10:03<01:07, 67.83s/it][A
 90%|█████████ | 9/10 [10:03<01:07, 67.80s/it][A
 90%|█████████ | 9/10 [10:03<01:07, 67.83s/it][A
 90%|█████████ | 9/10 [10:03<01:07, 67.79s/it][A
 90%|█████████ | 9/10 [10:03<01:07, 67.80s/it][A
 90%|█████████ | 9/10 [10:03<01:07, 67.80s/it][A
100%|██████████| 10/10 [11:09<00:00, 67.29s/it][A100%|██████████| 10/10 [11:09<00:00, 66.97s/it]
 11%|█▏        | 59/520 [4:27:45<100:31:24, 785.00s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 02:21:05,566] [INFO] [logging.py:96:log_dist] [Rank 0] step=580, skipped=0, lr=[1.9733586904841457e-05], mom=[(0.9, 0.999)]
steps: 580 loss: 1.2157 iter time (s): 65.439 samples/sec: 1.956

100%|██████████| 10/10 [11:09<00:00, 67.30s/it][A100%|██████████| 10/10 [11:09<00:00, 66.95s/it]
 11%|█▏        | 59/520 [4:25:32<100:29:32, 784.76s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:09<00:00, 67.30s/it][A100%|██████████| 10/10 [11:09<00:00, 66.95s/it]
 11%|█▏        | 59/520 [4:27:54<100:30:12, 784.84s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:09<00:00, 67.30s/it][A100%|██████████| 10/10 [11:09<00:00, 66.95s/it]
 11%|█▏        | 59/520 [4:27:53<100:30:19, 784.86s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:09<00:00, 67.30s/it][A100%|██████████| 10/10 [11:09<00:00, 66.95s/it]
 11%|█▏        | 59/520 [4:27:29<100:30:06, 784.83s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:09<00:00, 67.33s/it][A100%|██████████| 10/10 [11:09<00:00, 66.96s/it]
 11%|█▏        | 59/520 [4:26:47<100:30:08, 784.83s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:09<00:00, 67.33s/it][A100%|██████████| 10/10 [11:09<00:00, 66.96s/it]
 11%|█▏        | 59/520 [4:26:16<100:30:01, 784.82s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [11:09<00:00, 67.42s/it][A100%|██████████| 10/10 [11:09<00:00, 66.98s/it]
 11%|█▏        | 59/520 [4:23:06<100:29:38, 784.77s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_158
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:16<20:24, 136.05s/it][A[2024-05-30 02:23:23,832] [INFO] [logging.py:96:log_dist] [Rank 0] step=581, skipped=0, lr=[1.9732286691712786e-05], mom=[(0.9, 0.999)]
steps: 581 loss: 0.5937 iter time (s): 137.013 samples/sec: 0.934

 10%|█         | 1/10 [02:18<20:43, 138.19s/it][A
 10%|█         | 1/10 [02:18<20:43, 138.20s/it][A
 10%|█         | 1/10 [02:18<20:44, 138.25s/it][A
 10%|█         | 1/10 [02:18<20:43, 138.16s/it][A
 10%|█         | 1/10 [02:18<20:44, 138.26s/it][A
 10%|█         | 1/10 [02:18<20:42, 138.11s/it][A
 10%|█         | 1/10 [02:17<20:40, 137.83s/it][A
 20%|██        | 2/10 [04:31<18:03, 135.49s/it][A[2024-05-30 02:25:38,949] [INFO] [logging.py:96:log_dist] [Rank 0] step=582, skipped=0, lr=[1.9730983356545785e-05], mom=[(0.9, 0.999)]
steps: 582 loss: 0.5772 iter time (s): 134.420 samples/sec: 0.952

 20%|██        | 2/10 [04:33<18:11, 136.41s/it][A
 20%|██        | 2/10 [04:33<18:11, 136.43s/it][A
 20%|██        | 2/10 [04:33<18:11, 136.40s/it][A
 20%|██        | 2/10 [04:33<18:10, 136.35s/it][A
 20%|██        | 2/10 [04:33<18:11, 136.42s/it][A
 20%|██        | 2/10 [04:33<18:10, 136.36s/it][A
 20%|██        | 2/10 [04:32<18:09, 136.25s/it][A
 30%|███       | 3/10 [06:46<15:49, 135.64s/it][A[2024-05-30 02:27:54,753] [INFO] [logging.py:96:log_dist] [Rank 0] step=583, skipped=0, lr=[1.9729676899758596e-05], mom=[(0.9, 0.999)]
steps: 583 loss: 0.6005 iter time (s): 135.088 samples/sec: 0.948

 30%|███       | 3/10 [06:49<15:52, 136.13s/it][A
 30%|███       | 3/10 [06:49<15:52, 136.11s/it][A
 30%|███       | 3/10 [06:49<15:52, 136.11s/it][A
 30%|███       | 3/10 [06:48<15:52, 136.08s/it][A
 30%|███       | 3/10 [06:49<15:52, 136.11s/it][A
 30%|███       | 3/10 [06:48<15:52, 136.07s/it][A
 30%|███       | 3/10 [06:48<15:52, 136.01s/it][A
 40%|████      | 4/10 [09:04<13:38, 136.39s/it][A[2024-05-30 02:30:12,286] [INFO] [logging.py:96:log_dist] [Rank 0] step=584, skipped=0, lr=[1.9728367321770367e-05], mom=[(0.9, 0.999)]
steps: 584 loss: 0.5905 iter time (s): 136.882 samples/sec: 0.935

 40%|████      | 4/10 [09:06<13:40, 136.70s/it][A
 40%|████      | 4/10 [09:06<13:40, 136.71s/it][A
 40%|████      | 4/10 [09:06<13:40, 136.68s/it][A
 40%|████      | 4/10 [09:06<13:40, 136.67s/it][A
 40%|████      | 4/10 [09:06<13:40, 136.69s/it][A
 40%|████      | 4/10 [09:06<13:39, 136.63s/it][A
 40%|████      | 4/10 [09:06<13:40, 136.68s/it][A
 50%|█████     | 5/10 [11:20<11:21, 136.34s/it][A[2024-05-30 02:32:28,531] [INFO] [logging.py:96:log_dist] [Rank 0] step=585, skipped=0, lr=[1.9727054623001234e-05], mom=[(0.9, 0.999)]
steps: 585 loss: 0.5910 iter time (s): 135.616 samples/sec: 0.944

 50%|█████     | 5/10 [11:23<11:22, 136.56s/it][A
 50%|█████     | 5/10 [11:23<11:22, 136.55s/it][A
 50%|█████     | 5/10 [11:23<11:22, 136.56s/it][A
 50%|█████     | 5/10 [11:22<11:22, 136.54s/it][A
 50%|█████     | 5/10 [11:23<11:22, 136.56s/it][A
 50%|█████     | 5/10 [11:22<11:22, 136.54s/it][A
 50%|█████     | 5/10 [11:22<11:22, 136.52s/it][A
 60%|██████    | 6/10 [13:35<09:03, 135.94s/it][A[2024-05-30 02:34:43,710] [INFO] [logging.py:96:log_dist] [Rank 0] step=586, skipped=0, lr=[1.9725738803872353e-05], mom=[(0.9, 0.999)]
steps: 586 loss: 0.5664 iter time (s): 134.432 samples/sec: 0.952

 60%|██████    | 6/10 [13:38<09:04, 136.06s/it][A
 60%|██████    | 6/10 [13:38<09:04, 136.07s/it][A
 60%|██████    | 6/10 [13:38<09:04, 136.07s/it][A
 60%|██████    | 6/10 [13:38<09:04, 136.06s/it][A
 60%|██████    | 6/10 [13:38<09:04, 136.09s/it][A
 60%|██████    | 6/10 [13:38<09:04, 136.07s/it][A
 60%|██████    | 6/10 [13:37<09:04, 136.05s/it][A
 70%|███████   | 7/10 [15:52<06:48, 136.02s/it][A[2024-05-30 02:36:59,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=587, skipped=0, lr=[1.9724419864805866e-05], mom=[(0.9, 0.999)]
steps: 587 loss: 0.5817 iter time (s): 135.460 samples/sec: 0.945

 70%|███████   | 7/10 [15:54<06:48, 136.09s/it][A
 70%|███████   | 7/10 [15:54<06:48, 136.09s/it][A
 70%|███████   | 7/10 [15:54<06:48, 136.12s/it][A
 70%|███████   | 7/10 [15:54<06:48, 136.11s/it][A
 70%|███████   | 7/10 [15:54<06:48, 136.15s/it][A
 70%|███████   | 7/10 [15:54<06:48, 136.15s/it][A
 70%|███████   | 7/10 [15:54<06:48, 136.14s/it][A
 80%|████████  | 8/10 [18:07<04:31, 135.91s/it][A[2024-05-30 02:39:15,559] [INFO] [logging.py:96:log_dist] [Rank 0] step=588, skipped=0, lr=[1.9723097806224922e-05], mom=[(0.9, 0.999)]
steps: 588 loss: 0.5760 iter time (s): 134.801 samples/sec: 0.950

 80%|████████  | 8/10 [18:09<04:31, 135.95s/it][A
 80%|████████  | 8/10 [18:09<04:31, 135.97s/it][A
 80%|████████  | 8/10 [18:09<04:31, 135.94s/it][A
 80%|████████  | 8/10 [18:09<04:31, 135.93s/it][A
 80%|████████  | 8/10 [18:09<04:31, 135.95s/it][A
 80%|████████  | 8/10 [18:09<04:31, 135.91s/it][A
 80%|████████  | 8/10 [18:09<04:31, 135.93s/it][A
 90%|█████████ | 9/10 [20:23<02:15, 135.77s/it][A[2024-05-30 02:41:31,032] [INFO] [logging.py:96:log_dist] [Rank 0] step=589, skipped=0, lr=[1.9721772628553675e-05], mom=[(0.9, 0.999)]
steps: 589 loss: 0.5527 iter time (s): 134.863 samples/sec: 0.949

 90%|█████████ | 9/10 [20:25<02:15, 135.81s/it][A
 90%|█████████ | 9/10 [20:25<02:15, 135.81s/it][A
 90%|█████████ | 9/10 [20:25<02:15, 135.81s/it][A
 90%|█████████ | 9/10 [20:25<02:15, 135.82s/it][A
 90%|█████████ | 9/10 [20:25<02:15, 135.86s/it][A
 90%|█████████ | 9/10 [20:25<02:15, 135.86s/it][A
 90%|█████████ | 9/10 [20:25<02:15, 135.86s/it][A
100%|██████████| 10/10 [22:38<00:00, 135.66s/it][A100%|██████████| 10/10 [22:38<00:00, 135.86s/it]
[2024-05-30 02:43:46,438] [INFO] [logging.py:96:log_dist] [Rank 0] step=590, skipped=0, lr=[1.9720444332217268e-05], mom=[(0.9, 0.999)]
steps: 590 loss: 0.5656 iter time (s): 134.505 samples/sec: 0.952

100%|██████████| 10/10 [22:40<00:00, 135.70s/it][A100%|██████████| 10/10 [22:40<00:00, 136.09s/it]

100%|██████████| 10/10 [22:40<00:00, 135.69s/it][A100%|██████████| 10/10 [22:40<00:00, 136.09s/it]

100%|██████████| 10/10 [22:40<00:00, 135.68s/it][A100%|██████████| 10/10 [22:40<00:00, 136.08s/it]

100%|██████████| 10/10 [22:40<00:00, 135.68s/it][A100%|██████████| 10/10 [22:40<00:00, 136.08s/it]

100%|██████████| 10/10 [22:40<00:00, 135.67s/it][A100%|██████████| 10/10 [22:40<00:00, 136.09s/it]

100%|██████████| 10/10 [22:40<00:00, 135.65s/it][A100%|██████████| 10/10 [22:40<00:00, 136.07s/it]

100%|██████████| 10/10 [22:40<00:00, 135.66s/it][A100%|██████████| 10/10 [22:40<00:00, 136.04s/it]
Checkpointing at shard 60
[2024-05-30 02:43:47,152] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step590 is about to be saved!
[2024-05-30 02:43:48,152] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_00-model_states.pt...
[2024-05-30 02:43:50,540] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_00-model_states.pt.
[2024-05-30 02:43:54,857] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_02-model_states.pt...
[2024-05-30 02:43:55,103] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_05-model_states.pt...
[2024-05-30 02:43:55,417] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_04-model_states.pt...
[2024-05-30 02:43:57,332] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_03-model_states.pt...
[2024-05-30 02:43:57,367] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_06-model_states.pt...
[2024-05-30 02:44:02,604] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_01-model_states.pt...
[2024-05-30 02:44:02,713] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_07-model_states.pt...
[2024-05-30 02:44:03,038] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_08-model_states.pt...
[2024-05-30 02:47:48,582] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_07-model_states.pt.
[2024-05-30 02:47:49,330] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_06_model_states.pt...
[2024-05-30 02:47:50,982] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_06_model_states.pt.
[2024-05-30 02:47:50,983] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step590 is ready now!
[2024-05-30 02:48:05,752] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_03-model_states.pt.
[2024-05-30 02:48:05,877] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_04-model_states.pt.
[2024-05-30 02:48:05,877] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_05-model_states.pt.
[2024-05-30 02:48:05,879] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_02-model_states.pt.
[2024-05-30 02:48:06,480] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_02_model_states.pt...
[2024-05-30 02:48:06,599] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_03_model_states.pt...
[2024-05-30 02:48:06,972] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_04_model_states.pt...
[2024-05-30 02:48:07,071] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_01_model_states.pt
[2024-05-30 02:48:07,071] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_01_model_states.pt...
[2024-05-30 02:48:07,185] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_02_model_states.pt.
[2024-05-30 02:48:07,185] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step590 is ready now!
[2024-05-30 02:48:07,247] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_03_model_states.pt.
[2024-05-30 02:48:07,248] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step590 is ready now!
[2024-05-30 02:48:07,473] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_04_model_states.pt.
[2024-05-30 02:48:07,473] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step590 is ready now!
[2024-05-30 02:48:07,580] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_01_model_states.pt.
[2024-05-30 02:48:07,580] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step590 is ready now!
[2024-05-30 02:48:26,498] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_06-model_states.pt.
[2024-05-30 02:48:27,247] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_05_model_states.pt...
[2024-05-30 02:48:27,768] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_05_model_states.pt.
[2024-05-30 02:48:27,768] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step590 is ready now!
[2024-05-30 02:48:30,628] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_01-model_states.pt.
[2024-05-30 02:48:31,078] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_08-model_states.pt.
[2024-05-30 02:48:31,719] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_00_model_states.pt
[2024-05-30 02:48:31,719] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_00_model_states.pt...
[2024-05-30 02:48:32,274] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_09-model_states.pt...
[2024-05-30 02:48:32,667] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_00_model_states.pt.
[2024-05-30 02:48:32,667] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step590 is ready now!
[2024-05-30 02:48:33,421] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/layer_09-model_states.pt.
[2024-05-30 02:48:33,460] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_07_model_states.pt...
[2024-05-30 02:48:33,624] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step590/mp_rank_07_model_states.pt.
[2024-05-30 02:48:33,624] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step590 is ready now!
Checkpoint saved using --- 286.4742183685303 seconds ---
 12%|█▏        | 60/520 [4:55:21<132:44:45, 1038.88s/it] 12%|█▏        | 60/520 [4:55:15<132:49:30, 1039.50s/it] 12%|█▏        | 60/520 [4:50:33<132:42:45, 1038.62s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_88
 12%|█▏        | 60/520 [4:55:20<132:44:32, 1038.85s/it] 12%|█▏        | 60/520 [4:54:14<132:44:02, 1038.79s/it] 12%|█▏        | 60/520 [4:53:43<132:43:42, 1038.74s/it] 12%|█▏        | 60/520 [4:54:56<132:44:08, 1038.80s/it] 12%|█▏        | 60/520 [4:53:00<132:44:31, 1038.85s/it]Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:20<12:02, 80.32s/it][A[2024-05-30 02:49:56,150] [INFO] [logging.py:96:log_dist] [Rank 0] step=591, skipped=0, lr=[1.9719112917641853e-05], mom=[(0.9, 0.999)]
steps: 591 loss: 1.0977 iter time (s): 81.982 samples/sec: 1.561

 10%|█         | 1/10 [01:22<12:20, 82.31s/it][A
 10%|█         | 1/10 [01:22<12:22, 82.47s/it][A
 10%|█         | 1/10 [01:22<12:23, 82.57s/it][A
 10%|█         | 1/10 [01:22<12:23, 82.61s/it][A
 10%|█         | 1/10 [01:22<12:24, 82.71s/it][A
 10%|█         | 1/10 [01:22<12:24, 82.72s/it][A
 10%|█         | 1/10 [01:22<12:25, 82.78s/it][A
 20%|██        | 2/10 [02:35<10:20, 77.50s/it][A[2024-05-30 02:51:11,681] [INFO] [logging.py:96:log_dist] [Rank 0] step=592, skipped=0, lr=[1.9717778385254585e-05], mom=[(0.9, 0.999)]
steps: 592 loss: 1.1148 iter time (s): 74.668 samples/sec: 1.714

 20%|██        | 2/10 [02:37<10:26, 78.29s/it][A
 20%|██        | 2/10 [02:37<10:26, 78.29s/it][A
 20%|██        | 2/10 [02:37<10:26, 78.33s/it][A
 20%|██        | 2/10 [02:38<10:27, 78.39s/it][A
 20%|██        | 2/10 [02:38<10:27, 78.41s/it][A
 20%|██        | 2/10 [02:38<10:27, 78.42s/it][A
 20%|██        | 2/10 [02:38<10:27, 78.42s/it][A
 30%|███       | 3/10 [03:49<08:49, 75.64s/it][A[2024-05-30 02:52:25,098] [INFO] [logging.py:96:log_dist] [Rank 0] step=593, skipped=0, lr=[1.971644073548361e-05], mom=[(0.9, 0.999)]
steps: 593 loss: 1.1174 iter time (s): 72.701 samples/sec: 1.761

 30%|███       | 3/10 [03:51<08:52, 76.02s/it][A
 30%|███       | 3/10 [03:51<08:52, 76.08s/it][A
 30%|███       | 3/10 [03:51<08:52, 76.07s/it][A
 30%|███       | 3/10 [03:51<08:52, 76.08s/it][A
 30%|███       | 3/10 [03:51<08:52, 76.10s/it][A
 30%|███       | 3/10 [03:51<08:52, 76.11s/it][A
 30%|███       | 3/10 [03:51<08:52, 76.12s/it][A
 40%|████      | 4/10 [05:02<07:28, 74.69s/it][A[2024-05-30 02:53:38,327] [INFO] [logging.py:96:log_dist] [Rank 0] step=594, skipped=0, lr=[1.9715099968758085e-05], mom=[(0.9, 0.999)]
steps: 594 loss: 1.1130 iter time (s): 72.552 samples/sec: 1.764

 40%|████      | 4/10 [05:04<07:29, 74.94s/it][A
 40%|████      | 4/10 [05:04<07:29, 74.96s/it][A
 40%|████      | 4/10 [05:04<07:29, 74.95s/it][A
 40%|████      | 4/10 [05:04<07:29, 74.98s/it][A
 40%|████      | 4/10 [05:04<07:29, 74.98s/it][A
 40%|████      | 4/10 [05:04<07:29, 74.98s/it][A
 40%|████      | 4/10 [05:04<07:29, 74.98s/it][A
 50%|█████     | 5/10 [06:15<06:10, 74.19s/it][A[2024-05-30 02:54:51,629] [INFO] [logging.py:96:log_dist] [Rank 0] step=595, skipped=0, lr=[1.9713756085508156e-05], mom=[(0.9, 0.999)]
steps: 595 loss: 1.0952 iter time (s): 72.620 samples/sec: 1.763

 50%|█████     | 5/10 [06:17<06:11, 74.32s/it][A
 50%|█████     | 5/10 [06:17<06:11, 74.35s/it][A
 50%|█████     | 5/10 [06:17<06:11, 74.36s/it][A
 50%|█████     | 5/10 [06:17<06:11, 74.38s/it][A
 50%|█████     | 5/10 [06:18<06:11, 74.37s/it][A
 50%|█████     | 5/10 [06:18<06:11, 74.38s/it][A
 50%|█████     | 5/10 [06:18<06:11, 74.38s/it][A
 60%|██████    | 6/10 [07:28<04:54, 73.75s/it][A[2024-05-30 02:56:04,516] [INFO] [logging.py:96:log_dist] [Rank 0] step=596, skipped=0, lr=[1.9712409086164978e-05], mom=[(0.9, 0.999)]
steps: 596 loss: 1.1064 iter time (s): 72.191 samples/sec: 1.773

 60%|██████    | 6/10 [07:30<04:55, 73.86s/it][A
 60%|██████    | 6/10 [07:30<04:55, 73.87s/it][A
 60%|██████    | 6/10 [07:30<04:55, 73.93s/it][A
 60%|██████    | 6/10 [07:30<04:55, 73.90s/it][A
 60%|██████    | 6/10 [07:30<04:55, 73.90s/it][A
 60%|██████    | 6/10 [07:31<04:56, 74.04s/it][A
 60%|██████    | 6/10 [07:31<04:56, 74.16s/it][A
 70%|███████   | 7/10 [08:44<03:43, 74.36s/it][A[2024-05-30 02:57:20,145] [INFO] [logging.py:96:log_dist] [Rank 0] step=597, skipped=0, lr=[1.9711058971160696e-05], mom=[(0.9, 0.999)]
steps: 597 loss: 1.0755 iter time (s): 74.090 samples/sec: 1.728

 70%|███████   | 7/10 [08:46<03:43, 74.44s/it][A
 70%|███████   | 7/10 [08:46<03:43, 74.43s/it][A
 70%|███████   | 7/10 [08:46<03:43, 74.43s/it][A
 70%|███████   | 7/10 [08:46<03:43, 74.43s/it][A
 70%|███████   | 7/10 [08:46<03:43, 74.45s/it][A
 70%|███████   | 7/10 [08:46<03:43, 74.41s/it][A
 70%|███████   | 7/10 [08:46<03:43, 74.37s/it][A
 80%|████████  | 8/10 [10:00<02:29, 74.93s/it][A[2024-05-30 02:58:36,283] [INFO] [logging.py:96:log_dist] [Rank 0] step=598, skipped=0, lr=[1.9709705740928466e-05], mom=[(0.9, 0.999)]
steps: 598 loss: 1.0815 iter time (s): 75.434 samples/sec: 1.697

 80%|████████  | 8/10 [10:02<02:29, 74.97s/it][A
 80%|████████  | 8/10 [10:02<02:29, 74.97s/it][A
 80%|████████  | 8/10 [10:02<02:29, 74.97s/it][A
 80%|████████  | 8/10 [10:02<02:29, 74.98s/it][A
 80%|████████  | 8/10 [10:02<02:29, 74.98s/it][A
 80%|████████  | 8/10 [10:02<02:29, 74.95s/it][A
 80%|████████  | 8/10 [10:02<02:29, 74.93s/it][A
 90%|█████████ | 9/10 [11:19<01:16, 76.26s/it][A[2024-05-30 02:59:55,490] [INFO] [logging.py:96:log_dist] [Rank 0] step=599, skipped=0, lr=[1.9708349395902437e-05], mom=[(0.9, 0.999)]
steps: 599 loss: 1.0839 iter time (s): 78.527 samples/sec: 1.630

 90%|█████████ | 9/10 [11:21<01:16, 76.30s/it][A
 90%|█████████ | 9/10 [11:21<01:16, 76.32s/it][A
 90%|█████████ | 9/10 [11:21<01:16, 76.32s/it][A
 90%|█████████ | 9/10 [11:21<01:16, 76.31s/it][A
 90%|█████████ | 9/10 [11:21<01:16, 76.33s/it][A
 90%|█████████ | 9/10 [11:21<01:16, 76.28s/it][A
 90%|█████████ | 9/10 [11:21<01:16, 76.30s/it][A
100%|██████████| 10/10 [12:39<00:00, 77.34s/it][A100%|██████████| 10/10 [12:39<00:00, 75.94s/it]
 12%|█▏        | 61/520 [5:07:55<121:59:09, 956.75s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 03:01:15,224] [INFO] [logging.py:96:log_dist] [Rank 0] step=600, skipped=0, lr=[1.9706989936517756e-05], mom=[(0.9, 0.999)]
steps: 600 loss: 1.0841 iter time (s): 79.006 samples/sec: 1.620

100%|██████████| 10/10 [12:41<00:00, 77.36s/it][A100%|██████████| 10/10 [12:41<00:00, 76.13s/it]
 12%|█▏        | 61/520 [5:05:42<121:59:54, 956.85s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:41<00:00, 77.35s/it][A100%|██████████| 10/10 [12:41<00:00, 76.14s/it]
 12%|█▏        | 61/520 [5:08:03<122:00:20, 956.91s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:41<00:00, 77.36s/it][A100%|██████████| 10/10 [12:41<00:00, 76.15s/it]
 12%|█▏        | 61/520 [5:08:03<122:00:27, 956.92s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:41<00:00, 77.37s/it][A100%|██████████| 10/10 [12:41<00:00, 76.16s/it]
 12%|█▏        | 61/520 [5:06:56<122:00:22, 956.91s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:41<00:00, 77.37s/it][A100%|██████████| 10/10 [12:41<00:00, 76.17s/it]
 12%|█▏        | 61/520 [5:07:38<122:00:30, 956.93s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:41<00:00, 77.35s/it][A100%|██████████| 10/10 [12:41<00:00, 76.17s/it]
 12%|█▏        | 61/520 [5:06:26<122:00:18, 956.90s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:41<00:00, 77.35s/it][A100%|██████████| 10/10 [12:41<00:00, 76.17s/it]
 12%|█▏        | 61/520 [5:03:15<121:59:41, 956.82s/it] Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_240
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:00<09:07, 60.89s/it][A[2024-05-30 03:02:16,034] [INFO] [logging.py:96:log_dist] [Rank 0] step=601, skipped=0, lr=[1.9705627363210574e-05], mom=[(0.9, 0.999)]
steps: 601 loss: 0.6691 iter time (s): 59.995 samples/sec: 2.134

 10%|█         | 1/10 [01:00<09:07, 60.78s/it][A
 10%|█         | 1/10 [01:00<09:06, 60.75s/it][A
 10%|█         | 1/10 [01:00<09:06, 60.75s/it][A
 10%|█         | 1/10 [01:00<09:05, 60.65s/it][A
 10%|█         | 1/10 [01:00<09:06, 60.72s/it][A
 10%|█         | 1/10 [01:00<09:06, 60.70s/it][A
 10%|█         | 1/10 [01:00<09:06, 60.73s/it][A
 20%|██        | 2/10 [02:02<08:12, 61.54s/it][A[2024-05-30 03:03:18,022] [INFO] [logging.py:96:log_dist] [Rank 0] step=602, skipped=0, lr=[1.970426167641804e-05], mom=[(0.9, 0.999)]
steps: 602 loss: 0.6990 iter time (s): 61.342 samples/sec: 2.087

 20%|██        | 2/10 [02:02<08:12, 61.50s/it][A
 20%|██        | 2/10 [02:02<08:12, 61.53s/it][A
 20%|██        | 2/10 [02:02<08:11, 61.48s/it][A
 20%|██        | 2/10 [02:02<08:11, 61.44s/it][A
 20%|██        | 2/10 [02:02<08:11, 61.46s/it][A
 20%|██        | 2/10 [02:02<08:11, 61.43s/it][A
 20%|██        | 2/10 [02:02<08:11, 61.45s/it][A
 30%|███       | 3/10 [03:05<07:14, 62.10s/it][A[2024-05-30 03:04:20,792] [INFO] [logging.py:96:log_dist] [Rank 0] step=603, skipped=0, lr=[1.970289287657829e-05], mom=[(0.9, 0.999)]
steps: 603 loss: 0.6853 iter time (s): 62.159 samples/sec: 2.059

 30%|███       | 3/10 [03:05<07:14, 62.06s/it][A
 30%|███       | 3/10 [03:05<07:14, 62.06s/it][A
 30%|███       | 3/10 [03:05<07:14, 62.06s/it][A
 30%|███       | 3/10 [03:05<07:14, 62.06s/it][A
 30%|███       | 3/10 [03:05<07:14, 62.05s/it][A
 30%|███       | 3/10 [03:05<07:14, 62.07s/it][A
 30%|███       | 3/10 [03:05<07:14, 62.06s/it][A
 40%|████      | 4/10 [04:06<06:09, 61.56s/it][A[2024-05-30 03:05:21,530] [INFO] [logging.py:96:log_dist] [Rank 0] step=604, skipped=0, lr=[1.970152096413048e-05], mom=[(0.9, 0.999)]
steps: 604 loss: 0.6466 iter time (s): 60.096 samples/sec: 2.130

 40%|████      | 4/10 [04:06<06:09, 61.51s/it][A
 40%|████      | 4/10 [04:06<06:09, 61.52s/it][A
 40%|████      | 4/10 [04:06<06:09, 61.53s/it][A
 40%|████      | 4/10 [04:06<06:09, 61.54s/it][A
 40%|████      | 4/10 [04:06<06:09, 61.54s/it][A
 40%|████      | 4/10 [04:06<06:09, 61.53s/it][A
 40%|████      | 4/10 [04:06<06:09, 61.53s/it][A
 50%|█████     | 5/10 [05:03<04:59, 59.91s/it][A[2024-05-30 03:06:18,503] [INFO] [logging.py:96:log_dist] [Rank 0] step=605, skipped=0, lr=[1.9700145939514747e-05], mom=[(0.9, 0.999)]
steps: 605 loss: 0.6105 iter time (s): 56.364 samples/sec: 2.271

 50%|█████     | 5/10 [05:03<04:59, 59.92s/it][A
 50%|█████     | 5/10 [05:03<04:59, 59.89s/it][A
 50%|█████     | 5/10 [05:03<04:59, 59.90s/it][A
 50%|█████     | 5/10 [05:03<04:59, 59.88s/it][A
 50%|█████     | 5/10 [05:03<04:59, 59.90s/it][A
 50%|█████     | 5/10 [05:03<04:59, 59.90s/it][A
 50%|█████     | 5/10 [05:03<04:59, 59.90s/it][A
 60%|██████    | 6/10 [06:03<03:59, 59.97s/it][A[2024-05-30 03:07:18,580] [INFO] [logging.py:96:log_dist] [Rank 0] step=606, skipped=0, lr=[1.9698767803172238e-05], mom=[(0.9, 0.999)]
steps: 606 loss: 0.6121 iter time (s): 59.436 samples/sec: 2.154

 60%|██████    | 6/10 [06:03<03:59, 59.95s/it][A
 60%|██████    | 6/10 [06:03<03:59, 59.97s/it][A
 60%|██████    | 6/10 [06:03<03:59, 59.97s/it][A
 60%|██████    | 6/10 [06:03<03:59, 59.98s/it][A
 60%|██████    | 6/10 [06:03<03:59, 59.96s/it][A
 60%|██████    | 6/10 [06:03<03:59, 59.97s/it][A
 60%|██████    | 6/10 [06:03<03:59, 59.96s/it][A
 70%|███████   | 7/10 [07:00<02:57, 59.11s/it][A[2024-05-30 03:08:15,950] [INFO] [logging.py:96:log_dist] [Rank 0] step=607, skipped=0, lr=[1.9697386555545092e-05], mom=[(0.9, 0.999)]
steps: 607 loss: 0.5700 iter time (s): 56.728 samples/sec: 2.256

 70%|███████   | 7/10 [07:00<02:57, 59.13s/it][A
 70%|███████   | 7/10 [07:00<02:57, 59.12s/it][A
 70%|███████   | 7/10 [07:00<02:57, 59.10s/it][A
 70%|███████   | 7/10 [07:00<02:57, 59.12s/it][A
 70%|███████   | 7/10 [07:00<02:57, 59.11s/it][A
 70%|███████   | 7/10 [07:00<02:57, 59.12s/it][A
 70%|███████   | 7/10 [07:00<02:57, 59.11s/it][A
 80%|████████  | 8/10 [08:02<02:00, 60.01s/it][A[2024-05-30 03:09:17,857] [INFO] [logging.py:96:log_dist] [Rank 0] step=608, skipped=0, lr=[1.9696002197076443e-05], mom=[(0.9, 0.999)]
steps: 608 loss: 0.6074 iter time (s): 61.284 samples/sec: 2.089

 80%|████████  | 8/10 [08:02<02:00, 60.03s/it][A
 80%|████████  | 8/10 [08:02<01:59, 59.99s/it][A
 80%|████████  | 8/10 [08:02<02:00, 60.01s/it][A
 80%|████████  | 8/10 [08:02<02:00, 60.00s/it][A
 80%|████████  | 8/10 [08:02<02:00, 60.01s/it][A
 80%|████████  | 8/10 [08:02<02:00, 60.01s/it][A
 80%|████████  | 8/10 [08:02<02:00, 60.00s/it][A
 90%|█████████ | 9/10 [09:01<00:59, 59.47s/it][A[2024-05-30 03:10:16,160] [INFO] [logging.py:96:log_dist] [Rank 0] step=609, skipped=0, lr=[1.9694614728210435e-05], mom=[(0.9, 0.999)]
steps: 609 loss: 0.5889 iter time (s): 57.647 samples/sec: 2.220

 90%|█████████ | 9/10 [09:00<00:59, 59.48s/it][A
 90%|█████████ | 9/10 [09:00<00:59, 59.47s/it][A
 90%|█████████ | 9/10 [09:00<00:59, 59.47s/it][A
 90%|█████████ | 9/10 [09:00<00:59, 59.46s/it][A
 90%|█████████ | 9/10 [09:00<00:59, 59.47s/it][A
 90%|█████████ | 9/10 [09:00<00:59, 59.47s/it][A
 90%|█████████ | 9/10 [09:00<00:59, 59.47s/it][A
100%|██████████| 10/10 [10:01<00:00, 59.70s/it][A100%|██████████| 10/10 [10:01<00:00, 60.12s/it]
 12%|█▏        | 62/520 [5:17:56<108:17:22, 851.18s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 03:11:16,368] [INFO] [logging.py:96:log_dist] [Rank 0] step=610, skipped=0, lr=[1.96932241493922e-05], mom=[(0.9, 0.999)]
steps: 610 loss: 0.5919 iter time (s): 59.606 samples/sec: 2.147

100%|██████████| 10/10 [10:01<00:00, 59.71s/it][A100%|██████████| 10/10 [10:01<00:00, 60.12s/it]
 12%|█▏        | 62/520 [5:15:43<108:16:59, 851.14s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:01<00:00, 59.72s/it][A100%|██████████| 10/10 [10:01<00:00, 60.11s/it]
 12%|█▏        | 62/520 [5:18:04<108:17:16, 851.17s/it]
100%|██████████| 10/10 [10:01<00:00, 59.76s/it][A100%|██████████| 10/10 [10:01<00:00, 60.13s/it]
 12%|█▏        | 62/520 [5:18:05<108:17:30, 851.20s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:01<00:00, 59.77s/it][A100%|██████████| 10/10 [10:01<00:00, 60.13s/it]
 12%|█▏        | 62/520 [5:16:58<108:17:29, 851.20s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:01<00:00, 59.75s/it][A100%|██████████| 10/10 [10:01<00:00, 60.12s/it]
 12%|█▏        | 62/520 [5:16:27<108:17:18, 851.18s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:01<00:00, 59.76s/it][A100%|██████████| 10/10 [10:01<00:00, 60.13s/it]
 12%|█▏        | 62/520 [5:17:40<108:17:35, 851.21s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:01<00:00, 59.76s/it][A100%|██████████| 10/10 [10:01<00:00, 60.12s/it]
 12%|█▏        | 62/520 [5:13:17<108:16:55, 851.13s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_297
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:29<13:22, 89.11s/it][A[2024-05-30 03:12:46,380] [INFO] [logging.py:96:log_dist] [Rank 0] step=611, skipped=0, lr=[1.9691830461067862e-05], mom=[(0.9, 0.999)]
steps: 611 loss: 0.5927 iter time (s): 89.090 samples/sec: 1.437

 10%|█         | 1/10 [01:30<13:30, 90.01s/it][A
 10%|█         | 1/10 [01:29<13:29, 89.93s/it][A
 10%|█         | 1/10 [01:30<13:30, 90.05s/it][A
 10%|█         | 1/10 [01:29<13:29, 89.93s/it][A
 10%|█         | 1/10 [01:30<13:30, 90.03s/it][A
 10%|█         | 1/10 [01:30<13:31, 90.14s/it][A
 10%|█         | 1/10 [01:30<13:31, 90.12s/it][A
 20%|██        | 2/10 [02:59<12:00, 90.06s/it][A[2024-05-30 03:14:17,113] [INFO] [logging.py:96:log_dist] [Rank 0] step=612, skipped=0, lr=[1.9690433663684562e-05], mom=[(0.9, 0.999)]
steps: 612 loss: 0.6018 iter time (s): 89.797 samples/sec: 1.425

 20%|██        | 2/10 [03:00<12:03, 90.41s/it][A
 20%|██        | 2/10 [03:00<12:03, 90.42s/it][A
 20%|██        | 2/10 [03:00<12:03, 90.41s/it][A
 20%|██        | 2/10 [03:00<12:03, 90.38s/it][A
 20%|██        | 2/10 [03:00<12:03, 90.38s/it][A
 20%|██        | 2/10 [03:00<12:03, 90.42s/it][A
 20%|██        | 2/10 [03:00<12:03, 90.46s/it][A
 30%|███       | 3/10 [04:28<10:25, 89.31s/it][A[2024-05-30 03:15:45,531] [INFO] [logging.py:96:log_dist] [Rank 0] step=613, skipped=0, lr=[1.968903375769042e-05], mom=[(0.9, 0.999)]
steps: 613 loss: 0.6030 iter time (s): 87.546 samples/sec: 1.462

 30%|███       | 3/10 [04:29<10:26, 89.53s/it][A
 30%|███       | 3/10 [04:29<10:26, 89.51s/it][A
 30%|███       | 3/10 [04:29<10:26, 89.53s/it][A
 30%|███       | 3/10 [04:29<10:26, 89.48s/it][A
 30%|███       | 3/10 [04:29<10:26, 89.48s/it][A
 30%|███       | 3/10 [04:29<10:26, 89.50s/it][A
 30%|███       | 3/10 [04:29<10:26, 89.47s/it][A
 40%|████      | 4/10 [05:55<08:50, 88.49s/it][A[2024-05-30 03:17:12,749] [INFO] [logging.py:96:log_dist] [Rank 0] step=614, skipped=0, lr=[1.9687630743534567e-05], mom=[(0.9, 0.999)]
steps: 614 loss: 0.5909 iter time (s): 86.418 samples/sec: 1.481

 40%|████      | 4/10 [05:56<08:51, 88.58s/it][A
 40%|████      | 4/10 [05:56<08:51, 88.58s/it][A
 40%|████      | 4/10 [05:56<08:51, 88.59s/it][A
 40%|████      | 4/10 [05:56<08:51, 88.59s/it][A
 40%|████      | 4/10 [05:56<08:51, 88.57s/it][A
 40%|████      | 4/10 [05:56<08:51, 88.60s/it][A
 40%|████      | 4/10 [05:56<08:51, 88.58s/it][A
 50%|█████     | 5/10 [07:19<07:13, 86.79s/it][A[2024-05-30 03:18:36,535] [INFO] [logging.py:96:log_dist] [Rank 0] step=615, skipped=0, lr=[1.968622462166712e-05], mom=[(0.9, 0.999)]
steps: 615 loss: 0.5872 iter time (s): 82.995 samples/sec: 1.542

 50%|█████     | 5/10 [07:20<07:14, 86.86s/it][A
 50%|█████     | 5/10 [07:20<07:14, 86.84s/it][A
 50%|█████     | 5/10 [07:20<07:14, 86.89s/it][A
 50%|█████     | 5/10 [07:20<07:14, 86.86s/it][A
 50%|█████     | 5/10 [07:20<07:14, 86.86s/it][A
 50%|█████     | 5/10 [07:20<07:14, 86.86s/it][A
 50%|█████     | 5/10 [07:20<07:14, 86.85s/it][A
 60%|██████    | 6/10 [08:45<05:46, 86.61s/it][A[2024-05-30 03:20:02,778] [INFO] [logging.py:96:log_dist] [Rank 0] step=616, skipped=0, lr=[1.9684815392539197e-05], mom=[(0.9, 0.999)]
steps: 616 loss: 0.5982 iter time (s): 85.444 samples/sec: 1.498

 60%|██████    | 6/10 [08:46<05:46, 86.64s/it][A
 60%|██████    | 6/10 [08:46<05:46, 86.64s/it][A
 60%|██████    | 6/10 [08:46<05:46, 86.66s/it][A
 60%|██████    | 6/10 [08:46<05:46, 86.64s/it][A
 60%|██████    | 6/10 [08:46<05:46, 86.64s/it][A
 60%|██████    | 6/10 [08:46<05:46, 86.65s/it][A
 60%|██████    | 6/10 [08:46<05:46, 86.65s/it][A
 70%|███████   | 7/10 [10:11<04:19, 86.48s/it][A[2024-05-30 03:21:28,999] [INFO] [logging.py:96:log_dist] [Rank 0] step=617, skipped=0, lr=[1.968340305660292e-05], mom=[(0.9, 0.999)]
steps: 617 loss: 0.5971 iter time (s): 85.491 samples/sec: 1.497

 70%|███████   | 7/10 [10:12<04:19, 86.53s/it][A
 70%|███████   | 7/10 [10:12<04:19, 86.54s/it][A
 70%|███████   | 7/10 [10:12<04:19, 86.53s/it][A
 70%|███████   | 7/10 [10:12<04:19, 86.52s/it][A
 70%|███████   | 7/10 [10:12<04:19, 86.54s/it][A
 70%|███████   | 7/10 [10:12<04:19, 86.54s/it][A
 70%|███████   | 7/10 [10:12<04:19, 86.53s/it][A
 80%|████████  | 8/10 [11:32<02:49, 84.81s/it][A[2024-05-30 03:22:50,237] [INFO] [logging.py:96:log_dist] [Rank 0] step=618, skipped=0, lr=[1.9681987614311394e-05], mom=[(0.9, 0.999)]
steps: 618 loss: 0.5931 iter time (s): 80.359 samples/sec: 1.593

 80%|████████  | 8/10 [11:33<02:49, 84.84s/it][A
 80%|████████  | 8/10 [11:33<02:49, 84.84s/it][A
 80%|████████  | 8/10 [11:33<02:49, 84.86s/it][A
 80%|████████  | 8/10 [11:33<02:49, 84.85s/it][A
 80%|████████  | 8/10 [11:33<02:49, 84.86s/it][A
 80%|████████  | 8/10 [11:33<02:49, 84.86s/it][A
 80%|████████  | 8/10 [11:34<02:49, 84.88s/it][A
 90%|█████████ | 9/10 [12:53<01:23, 83.58s/it][A[2024-05-30 03:24:11,108] [INFO] [logging.py:96:log_dist] [Rank 0] step=619, skipped=0, lr=[1.9680569066118732e-05], mom=[(0.9, 0.999)]
steps: 619 loss: 0.5863 iter time (s): 79.944 samples/sec: 1.601

 90%|█████████ | 9/10 [12:54<01:23, 83.58s/it][A
 90%|█████████ | 9/10 [12:54<01:23, 83.59s/it][A
 90%|█████████ | 9/10 [12:54<01:23, 83.57s/it][A
 90%|█████████ | 9/10 [12:54<01:23, 83.59s/it][A
 90%|█████████ | 9/10 [12:54<01:23, 83.56s/it][A
 90%|█████████ | 9/10 [12:54<01:23, 83.56s/it][A
 90%|█████████ | 9/10 [12:54<01:23, 83.57s/it][A
100%|██████████| 10/10 [14:15<00:00, 83.12s/it][A100%|██████████| 10/10 [14:15<00:00, 85.59s/it]
 12%|█▏        | 63/520 [5:32:12<108:14:29, 852.67s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 03:25:32,999] [INFO] [logging.py:96:log_dist] [Rank 0] step=620, skipped=0, lr=[1.9679147412480035e-05], mom=[(0.9, 0.999)]
steps: 620 loss: 0.5945 iter time (s): 81.154 samples/sec: 1.577

100%|██████████| 10/10 [14:16<00:00, 83.09s/it][A100%|██████████| 10/10 [14:16<00:00, 85.66s/it]
 12%|█▏        | 63/520 [5:30:00<108:15:22, 852.79s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:16<00:00, 83.08s/it][A100%|██████████| 10/10 [14:16<00:00, 85.66s/it]
 12%|█▏        | 63/520 [5:32:21<108:15:34, 852.81s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:16<00:00, 83.06s/it][A100%|██████████| 10/10 [14:16<00:00, 85.66s/it]
 12%|█▏        | 63/520 [5:32:20<108:15:34, 852.81s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:16<00:00, 83.07s/it][A100%|██████████| 10/10 [14:16<00:00, 85.65s/it]
 12%|█▏        | 63/520 [5:31:14<108:15:27, 852.80s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:16<00:00, 83.06s/it][A100%|██████████| 10/10 [14:16<00:00, 85.65s/it]
 12%|█▏        | 63/520 [5:31:56<108:15:30, 852.80s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:16<00:00, 83.07s/it][A100%|██████████| 10/10 [14:16<00:00, 85.66s/it]
 12%|█▏        | 63/520 [5:30:43<108:15:32, 852.81s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [14:16<00:00, 83.06s/it][A100%|██████████| 10/10 [14:16<00:00, 85.66s/it]
 12%|█▏        | 63/520 [5:27:33<108:15:12, 852.76s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_plain_texts/shard_2
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:02<18:22, 122.47s/it][A[2024-05-30 03:27:36,861] [INFO] [logging.py:96:log_dist] [Rank 0] step=621, skipped=0, lr=[1.9677722653851413e-05], mom=[(0.9, 0.999)]
steps: 621 loss: 0.8596 iter time (s): 123.101 samples/sec: 1.040

 10%|█         | 1/10 [02:04<18:36, 124.02s/it][A
 10%|█         | 1/10 [02:04<18:37, 124.13s/it][A
 10%|█         | 1/10 [02:04<18:36, 124.05s/it][A
 10%|█         | 1/10 [02:04<18:37, 124.21s/it][A
 10%|█         | 1/10 [02:04<18:37, 124.12s/it][A
 10%|█         | 1/10 [02:04<18:36, 124.09s/it][A
 10%|█         | 1/10 [02:04<18:36, 124.10s/it][A
 20%|██        | 2/10 [04:06<16:26, 123.26s/it][A[2024-05-30 03:29:40,666] [INFO] [logging.py:96:log_dist] [Rank 0] step=622, skipped=0, lr=[1.967629479068996e-05], mom=[(0.9, 0.999)]
steps: 622 loss: 0.8452 iter time (s): 122.996 samples/sec: 1.041

 20%|██        | 2/10 [04:08<16:32, 124.01s/it][A
 20%|██        | 2/10 [04:07<16:31, 123.95s/it][A
 20%|██        | 2/10 [04:08<16:31, 123.98s/it][A
 20%|██        | 2/10 [04:07<16:31, 123.95s/it][A
 20%|██        | 2/10 [04:07<16:31, 123.95s/it][A
 20%|██        | 2/10 [04:07<16:31, 123.94s/it][A
 20%|██        | 2/10 [04:07<16:31, 123.96s/it][A
 30%|███       | 3/10 [06:10<14:25, 123.63s/it][A[2024-05-30 03:31:44,740] [INFO] [logging.py:96:log_dist] [Rank 0] step=623, skipped=0, lr=[1.9674863823453768e-05], mom=[(0.9, 0.999)]
steps: 623 loss: 0.8291 iter time (s): 123.216 samples/sec: 1.039

 30%|███       | 3/10 [06:12<14:28, 124.03s/it][A
 30%|███       | 3/10 [06:12<14:28, 124.01s/it][A
 30%|███       | 3/10 [06:12<14:28, 124.03s/it][A
 30%|███       | 3/10 [06:12<14:28, 124.01s/it][A
 30%|███       | 3/10 [06:12<14:28, 124.02s/it][A
 30%|███       | 3/10 [06:12<14:28, 124.01s/it][A
 30%|███       | 3/10 [06:12<14:28, 124.02s/it][A
 40%|████      | 4/10 [08:14<12:21, 123.66s/it][A[2024-05-30 03:33:48,444] [INFO] [logging.py:96:log_dist] [Rank 0] step=624, skipped=0, lr=[1.9673429752601926e-05], mom=[(0.9, 0.999)]
steps: 624 loss: 0.8557 iter time (s): 122.798 samples/sec: 1.042

 40%|████      | 4/10 [08:15<12:23, 123.86s/it][A
 40%|████      | 4/10 [08:15<12:23, 123.86s/it][A
 40%|████      | 4/10 [08:15<12:22, 123.83s/it][A
 40%|████      | 4/10 [08:15<12:23, 123.84s/it][A
 40%|████      | 4/10 [08:15<12:23, 123.84s/it][A
 40%|████      | 4/10 [08:15<12:23, 123.83s/it][A
 40%|████      | 4/10 [08:15<12:23, 123.84s/it][A
 50%|█████     | 5/10 [10:17<10:18, 123.62s/it][A[2024-05-30 03:35:51,990] [INFO] [logging.py:96:log_dist] [Rank 0] step=625, skipped=0, lr=[1.967199257859452e-05], mom=[(0.9, 0.999)]
steps: 625 loss: 0.8346 iter time (s): 122.777 samples/sec: 1.043

 50%|█████     | 5/10 [10:19<10:18, 123.73s/it][A
 50%|█████     | 5/10 [10:19<10:18, 123.74s/it][A
 50%|█████     | 5/10 [10:19<10:18, 123.74s/it][A
 50%|█████     | 5/10 [10:19<10:18, 123.78s/it][A
 50%|█████     | 5/10 [10:19<10:18, 123.76s/it][A
 50%|█████     | 5/10 [10:19<10:18, 123.79s/it][A
 50%|█████     | 5/10 [10:19<10:18, 123.78s/it][A
 60%|██████    | 6/10 [12:21<08:15, 123.76s/it][A[2024-05-30 03:37:56,000] [INFO] [logging.py:96:log_dist] [Rank 0] step=626, skipped=0, lr=[1.967055230189264e-05], mom=[(0.9, 0.999)]
steps: 626 loss: 0.8683 iter time (s): 123.225 samples/sec: 1.039

 60%|██████    | 6/10 [12:23<08:15, 123.87s/it][A
 60%|██████    | 6/10 [12:23<08:15, 123.87s/it][A
 60%|██████    | 6/10 [12:23<08:15, 123.87s/it][A
 60%|██████    | 6/10 [12:23<08:15, 123.86s/it][A
 60%|██████    | 6/10 [12:23<08:15, 123.88s/it][A
 60%|██████    | 6/10 [12:23<08:15, 123.86s/it][A
 60%|██████    | 6/10 [12:23<08:15, 123.87s/it][A
 70%|███████   | 7/10 [14:25<06:11, 123.83s/it][A[2024-05-30 03:39:59,987] [INFO] [logging.py:96:log_dist] [Rank 0] step=627, skipped=0, lr=[1.9669108922958348e-05], mom=[(0.9, 0.999)]
steps: 627 loss: 0.8418 iter time (s): 123.056 samples/sec: 1.040

 70%|███████   | 7/10 [14:27<06:11, 123.90s/it][A
 70%|███████   | 7/10 [14:27<06:11, 123.88s/it][A
 70%|███████   | 7/10 [14:27<06:11, 123.90s/it][A
 70%|███████   | 7/10 [14:27<06:11, 123.95s/it][A
 70%|███████   | 7/10 [14:27<06:11, 123.90s/it][A
 70%|███████   | 7/10 [14:27<06:11, 123.91s/it][A
 70%|███████   | 7/10 [14:27<06:11, 123.90s/it][A
 80%|████████  | 8/10 [16:29<04:07, 123.81s/it][A[2024-05-30 03:42:03,736] [INFO] [logging.py:96:log_dist] [Rank 0] step=628, skipped=0, lr=[1.9667662442254724e-05], mom=[(0.9, 0.999)]
steps: 628 loss: 0.8729 iter time (s): 122.908 samples/sec: 1.041

 80%|████████  | 8/10 [16:30<04:07, 123.84s/it][A
 80%|████████  | 8/10 [16:31<04:07, 123.88s/it][A
 80%|████████  | 8/10 [16:31<04:07, 123.86s/it][A
 80%|████████  | 8/10 [16:31<04:07, 123.88s/it][A
 80%|████████  | 8/10 [16:31<04:07, 123.89s/it][A
 80%|████████  | 8/10 [16:31<04:07, 123.89s/it][A
 80%|████████  | 8/10 [16:32<04:08, 124.29s/it][A
 90%|█████████ | 9/10 [18:34<02:04, 124.30s/it][A[2024-05-30 03:44:09,100] [INFO] [logging.py:96:log_dist] [Rank 0] step=629, skipped=0, lr=[1.9666212860245836e-05], mom=[(0.9, 0.999)]
steps: 629 loss: 0.8120 iter time (s): 123.144 samples/sec: 1.039

 90%|█████████ | 9/10 [18:36<02:04, 124.38s/it][A
 90%|█████████ | 9/10 [18:36<02:04, 124.41s/it][A
 90%|█████████ | 9/10 [18:36<02:04, 124.39s/it][A
 90%|█████████ | 9/10 [18:36<02:04, 124.36s/it][A
 90%|█████████ | 9/10 [18:36<02:04, 124.40s/it][A
 90%|█████████ | 9/10 [18:36<02:04, 124.25s/it][A
 90%|█████████ | 9/10 [18:36<02:04, 124.39s/it][A
100%|██████████| 10/10 [20:38<00:00, 124.23s/it][A100%|██████████| 10/10 [20:38<00:00, 123.88s/it]
 12%|█▏        | 64/520 [5:52:51<122:37:15, 968.06s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 03:46:13,195] [INFO] [logging.py:96:log_dist] [Rank 0] step=630, skipped=0, lr=[1.9664760177396745e-05], mom=[(0.9, 0.999)]
steps: 630 loss: 0.7837 iter time (s): 123.040 samples/sec: 1.040

100%|██████████| 10/10 [20:40<00:00, 124.22s/it][A100%|██████████| 10/10 [20:40<00:00, 124.04s/it]
 12%|█▏        | 64/520 [5:50:40<122:40:58, 968.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [20:40<00:00, 124.23s/it][A100%|██████████| 10/10 [20:40<00:00, 124.05s/it]
 12%|█▏        | 64/520 [5:53:02<122:41:17, 968.59s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [20:40<00:00, 124.22s/it][A100%|██████████| 10/10 [20:40<00:00, 124.05s/it]
 12%|█▏        | 64/520 [5:53:01<122:41:20, 968.60s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [20:40<00:00, 124.25s/it][A100%|██████████| 10/10 [20:40<00:00, 124.06s/it]
 12%|█▏        | 64/520 [5:51:55<122:41:24, 968.61s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [20:40<00:00, 124.25s/it][A100%|██████████| 10/10 [20:40<00:00, 124.06s/it]
 12%|█▏        | 64/520 [5:52:37<122:41:31, 968.62s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [20:40<00:00, 124.16s/it][A100%|██████████| 10/10 [20:40<00:00, 124.05s/it]
 12%|█▏        | 64/520 [5:48:14<122:41:07, 968.57s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_127
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [20:40<00:00, 124.26s/it][A100%|██████████| 10/10 [20:40<00:00, 124.06s/it]
 12%|█▏        | 64/520 [5:51:24<122:41:25, 968.61s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:45<15:51, 105.73s/it][A[2024-05-30 03:47:58,638] [INFO] [logging.py:96:log_dist] [Rank 0] step=631, skipped=0, lr=[1.9663304394173507e-05], mom=[(0.9, 0.999)]
steps: 631 loss: 0.5767 iter time (s): 104.298 samples/sec: 1.227

 10%|█         | 1/10 [01:45<15:46, 105.12s/it][A
 10%|█         | 1/10 [01:45<15:45, 105.05s/it][A
 10%|█         | 1/10 [01:45<15:45, 105.08s/it][A
 10%|█         | 1/10 [01:44<15:44, 105.00s/it][A
 10%|█         | 1/10 [01:45<15:45, 105.01s/it][A
 10%|█         | 1/10 [01:44<15:44, 105.00s/it][A
 10%|█         | 1/10 [01:45<15:45, 105.03s/it][A
 20%|██        | 2/10 [03:32<14:10, 106.37s/it][A[2024-05-30 03:49:45,455] [INFO] [logging.py:96:log_dist] [Rank 0] step=632, skipped=0, lr=[1.9661845511043168e-05], mom=[(0.9, 0.999)]
steps: 632 loss: 0.5891 iter time (s): 106.073 samples/sec: 1.207

 20%|██        | 2/10 [03:31<14:08, 106.12s/it][A
 20%|██        | 2/10 [03:31<14:08, 106.12s/it][A
 20%|██        | 2/10 [03:31<14:09, 106.14s/it][A
 20%|██        | 2/10 [03:31<14:08, 106.06s/it][A
 20%|██        | 2/10 [03:31<14:08, 106.06s/it][A
 20%|██        | 2/10 [03:31<14:08, 106.06s/it][A
 20%|██        | 2/10 [03:31<14:08, 106.09s/it][A
 30%|███       | 3/10 [05:19<12:26, 106.71s/it][A[2024-05-30 03:51:32,567] [INFO] [logging.py:96:log_dist] [Rank 0] step=633, skipped=0, lr=[1.9660383528473782e-05], mom=[(0.9, 0.999)]
steps: 633 loss: 0.5622 iter time (s): 106.344 samples/sec: 1.204

 30%|███       | 3/10 [05:19<12:25, 106.55s/it][A
 30%|███       | 3/10 [05:18<12:25, 106.52s/it][A
 30%|███       | 3/10 [05:19<12:25, 106.56s/it][A
 30%|███       | 3/10 [05:18<12:25, 106.53s/it][A
 30%|███       | 3/10 [05:18<12:25, 106.54s/it][A
 30%|███       | 3/10 [05:18<12:25, 106.53s/it][A
 30%|███       | 3/10 [05:18<12:25, 106.53s/it][A
 40%|████      | 4/10 [07:17<11:07, 111.27s/it][A[2024-05-30 03:53:30,812] [INFO] [logging.py:96:log_dist] [Rank 0] step=634, skipped=0, lr=[1.965891844693439e-05], mom=[(0.9, 0.999)]
steps: 634 loss: 0.5702 iter time (s): 117.558 samples/sec: 1.089

 40%|████      | 4/10 [07:17<11:07, 111.20s/it][A
 40%|████      | 4/10 [07:17<11:07, 111.19s/it][A
 40%|████      | 4/10 [07:17<11:06, 111.16s/it][A
 40%|████      | 4/10 [07:17<11:06, 111.15s/it][A
 40%|████      | 4/10 [07:17<11:06, 111.15s/it][A
 40%|████      | 4/10 [07:17<11:06, 111.16s/it][A
 40%|████      | 4/10 [07:17<11:07, 111.17s/it][A
 50%|█████     | 5/10 [09:10<09:19, 111.92s/it][A[2024-05-30 03:55:23,886] [INFO] [logging.py:96:log_dist] [Rank 0] step=635, skipped=0, lr=[1.9657450266895016e-05], mom=[(0.9, 0.999)]
steps: 635 loss: 0.5934 iter time (s): 112.315 samples/sec: 1.140

 50%|█████     | 5/10 [09:10<09:19, 111.87s/it][A
 50%|█████     | 5/10 [09:10<09:19, 111.83s/it][A
 50%|█████     | 5/10 [09:10<09:19, 111.86s/it][A
 50%|█████     | 5/10 [09:10<09:19, 111.85s/it][A
 50%|█████     | 5/10 [09:10<09:19, 111.84s/it][A
 50%|█████     | 5/10 [09:10<09:19, 111.84s/it][A
 50%|█████     | 5/10 [09:10<09:19, 111.85s/it][A
 60%|██████    | 6/10 [10:57<07:20, 110.24s/it][A[2024-05-30 03:57:10,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=636, skipped=0, lr=[1.96559789888267e-05], mom=[(0.9, 0.999)]
steps: 636 loss: 0.5888 iter time (s): 106.274 samples/sec: 1.204

 60%|██████    | 6/10 [10:57<07:20, 110.20s/it][A
 60%|██████    | 6/10 [10:57<07:20, 110.19s/it][A
 60%|██████    | 6/10 [10:57<07:20, 110.19s/it][A
 60%|██████    | 6/10 [10:57<07:20, 110.20s/it][A
 60%|██████    | 6/10 [10:57<07:20, 110.20s/it][A
 60%|██████    | 6/10 [10:57<07:20, 110.19s/it][A
 60%|██████    | 6/10 [10:57<07:20, 110.19s/it][A
 70%|███████   | 7/10 [12:42<05:24, 108.29s/it][A[2024-05-30 03:58:55,159] [INFO] [logging.py:96:log_dist] [Rank 0] step=637, skipped=0, lr=[1.9654504613201456e-05], mom=[(0.9, 0.999)]
steps: 637 loss: 0.5816 iter time (s): 103.575 samples/sec: 1.236

 70%|███████   | 7/10 [12:41<05:24, 108.27s/it][A
 70%|███████   | 7/10 [12:41<05:24, 108.28s/it][A
 70%|███████   | 7/10 [12:41<05:24, 108.27s/it][A
 70%|███████   | 7/10 [12:41<05:24, 108.27s/it][A
 70%|███████   | 7/10 [12:41<05:24, 108.28s/it][A
 70%|███████   | 7/10 [12:41<05:24, 108.27s/it][A
 70%|███████   | 7/10 [12:41<05:24, 108.28s/it][A
 80%|████████  | 8/10 [14:26<03:34, 107.08s/it][A[2024-05-30 04:00:39,635] [INFO] [logging.py:96:log_dist] [Rank 0] step=638, skipped=0, lr=[1.9653027140492307e-05], mom=[(0.9, 0.999)]
steps: 638 loss: 0.5565 iter time (s): 103.718 samples/sec: 1.234

 80%|████████  | 8/10 [14:26<03:34, 107.05s/it][A
 80%|████████  | 8/10 [14:26<03:34, 107.07s/it][A
 80%|████████  | 8/10 [14:26<03:34, 107.08s/it][A
 80%|████████  | 8/10 [14:26<03:34, 107.07s/it][A
 80%|████████  | 8/10 [14:25<03:34, 107.06s/it][A
 80%|████████  | 8/10 [14:25<03:34, 107.06s/it][A
 80%|████████  | 8/10 [14:26<03:34, 107.06s/it][A
 90%|█████████ | 9/10 [16:11<01:46, 106.45s/it][A[2024-05-30 04:02:24,708] [INFO] [logging.py:96:log_dist] [Rank 0] step=639, skipped=0, lr=[1.9651546571173262e-05], mom=[(0.9, 0.999)]
steps: 639 loss: 0.5852 iter time (s): 104.324 samples/sec: 1.227

 90%|█████████ | 9/10 [16:11<01:46, 106.45s/it][A
 90%|█████████ | 9/10 [16:11<01:46, 106.43s/it][A
 90%|█████████ | 9/10 [16:11<01:46, 106.43s/it][A
 90%|█████████ | 9/10 [16:11<01:46, 106.43s/it][A
 90%|█████████ | 9/10 [16:11<01:46, 106.43s/it][A
 90%|█████████ | 9/10 [16:11<01:46, 106.44s/it][A
 90%|█████████ | 9/10 [16:11<01:46, 106.43s/it][A
100%|██████████| 10/10 [18:00<00:00, 107.04s/it][A100%|██████████| 10/10 [18:00<00:00, 108.02s/it]
 12%|█▎        | 65/520 [6:10:52<126:35:25, 1001.59s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 04:04:13,088] [INFO] [logging.py:96:log_dist] [Rank 0] step=640, skipped=0, lr=[1.9650062905719316e-05], mom=[(0.9, 0.999)]
steps: 640 loss: 0.5668 iter time (s): 107.653 samples/sec: 1.189

100%|██████████| 10/10 [17:59<00:00, 107.03s/it][A100%|██████████| 10/10 [17:59<00:00, 107.96s/it]
 12%|█▎        | 65/520 [6:08:40<126:36:36, 1001.75s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:59<00:00, 107.04s/it][A100%|██████████| 10/10 [17:59<00:00, 107.95s/it]
 12%|█▎        | 65/520 [6:11:01<126:36:39, 1001.76s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:59<00:00, 107.03s/it][A100%|██████████| 10/10 [17:59<00:00, 107.95s/it]
 12%|█▎        | 65/520 [6:11:00<126:36:44, 1001.77s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:59<00:00, 107.02s/it][A100%|██████████| 10/10 [17:59<00:00, 107.94s/it]
 12%|█▎        | 65/520 [6:09:54<126:36:28, 1001.73s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:59<00:00, 107.01s/it][A100%|██████████| 10/10 [17:59<00:00, 107.93s/it]
 12%|█▎        | 65/520 [6:10:36<126:36:30, 1001.74s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:59<00:00, 107.02s/it][A100%|██████████| 10/10 [17:59<00:00, 107.94s/it]
 12%|█▎        | 65/520 [6:09:23<126:36:29, 1001.73s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:59<00:00, 107.02s/it][A100%|██████████| 10/10 [17:59<00:00, 107.94s/it]
 12%|█▎        | 65/520 [6:06:13<126:36:21, 1001.72s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_314
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:40<15:06, 100.73s/it][A[2024-05-30 04:05:53,458] [INFO] [logging.py:96:log_dist] [Rank 0] step=641, skipped=0, lr=[1.9648576144606476e-05], mom=[(0.9, 0.999)]
steps: 641 loss: 0.5800 iter time (s): 99.576 samples/sec: 1.285

 10%|█         | 1/10 [01:40<15:03, 100.39s/it][A
 10%|█         | 1/10 [01:40<15:04, 100.47s/it][A
 10%|█         | 1/10 [01:40<15:03, 100.38s/it][A
 10%|█         | 1/10 [01:40<15:03, 100.42s/it][A
 10%|█         | 1/10 [01:40<15:04, 100.51s/it][A
 10%|█         | 1/10 [01:40<15:04, 100.50s/it][A
 10%|█         | 1/10 [01:40<15:04, 100.48s/it][A
 20%|██        | 2/10 [03:29<14:02, 105.27s/it][A[2024-05-30 04:07:41,893] [INFO] [logging.py:96:log_dist] [Rank 0] step=642, skipped=0, lr=[1.9647086288311728e-05], mom=[(0.9, 0.999)]
steps: 642 loss: 0.5941 iter time (s): 107.634 samples/sec: 1.189

 20%|██        | 2/10 [03:28<14:01, 105.13s/it][A
 20%|██        | 2/10 [03:28<14:00, 105.12s/it][A
 20%|██        | 2/10 [03:28<14:00, 105.12s/it][A
 20%|██        | 2/10 [03:28<14:01, 105.16s/it][A
 20%|██        | 2/10 [03:28<14:01, 105.16s/it][A
 20%|██        | 2/10 [03:28<14:01, 105.15s/it][A
 20%|██        | 2/10 [03:28<14:01, 105.17s/it][A
 30%|███       | 3/10 [05:13<12:15, 105.03s/it][A[2024-05-30 04:09:26,645] [INFO] [logging.py:96:log_dist] [Rank 0] step=643, skipped=0, lr=[1.9645593337313054e-05], mom=[(0.9, 0.999)]
steps: 643 loss: 0.5821 iter time (s): 103.959 samples/sec: 1.231

 30%|███       | 3/10 [05:13<12:14, 104.96s/it][A
 30%|███       | 3/10 [05:13<12:14, 104.97s/it][A
 30%|███       | 3/10 [05:13<12:14, 104.98s/it][A
 30%|███       | 3/10 [05:13<12:15, 105.00s/it][A
 30%|███       | 3/10 [05:13<12:14, 104.99s/it][A
 30%|███       | 3/10 [05:13<12:15, 105.00s/it][A
 30%|███       | 3/10 [05:13<12:14, 104.99s/it][A
 40%|████      | 4/10 [06:54<10:20, 103.34s/it][A[2024-05-30 04:11:06,781] [INFO] [logging.py:96:log_dist] [Rank 0] step=644, skipped=0, lr=[1.964409729208943e-05], mom=[(0.9, 0.999)]
steps: 644 loss: 0.5972 iter time (s): 99.286 samples/sec: 1.289

 40%|████      | 4/10 [06:53<10:18, 103.04s/it][A
 40%|████      | 4/10 [06:53<10:18, 103.05s/it][A
 40%|████      | 4/10 [06:53<10:18, 103.03s/it][A
 40%|████      | 4/10 [06:53<10:18, 103.04s/it][A
 40%|████      | 4/10 [06:53<10:18, 103.04s/it][A
 40%|████      | 4/10 [06:53<10:18, 103.04s/it][A
 40%|████      | 4/10 [06:53<10:18, 103.04s/it][A
 50%|█████     | 5/10 [08:20<08:06, 97.20s/it] [A[2024-05-30 04:12:33,714] [INFO] [logging.py:96:log_dist] [Rank 0] step=645, skipped=0, lr=[1.9642598153120828e-05], mom=[(0.9, 0.999)]
steps: 645 loss: 0.5909 iter time (s): 86.167 samples/sec: 1.485

 50%|█████     | 5/10 [08:20<08:06, 97.26s/it] [A
 50%|█████     | 5/10 [08:20<08:06, 97.24s/it] [A
 50%|█████     | 5/10 [08:20<08:06, 97.24s/it] [A
 50%|█████     | 5/10 [08:20<08:06, 97.31s/it] [A
 50%|█████     | 5/10 [08:20<08:06, 97.31s/it] [A
 50%|█████     | 5/10 [08:20<08:06, 97.34s/it] [A
 50%|█████     | 5/10 [08:20<08:06, 97.33s/it] [A
 60%|██████    | 6/10 [09:44<06:10, 92.64s/it][A[2024-05-30 04:13:57,494] [INFO] [logging.py:96:log_dist] [Rank 0] step=646, skipped=0, lr=[1.9641095920888203e-05], mom=[(0.9, 0.999)]
steps: 646 loss: 0.5866 iter time (s): 82.743 samples/sec: 1.547

 60%|██████    | 6/10 [09:44<06:10, 92.67s/it][A
 60%|██████    | 6/10 [09:44<06:10, 92.65s/it][A
 60%|██████    | 6/10 [09:44<06:10, 92.67s/it][A
 60%|██████    | 6/10 [09:44<06:10, 92.67s/it][A
 60%|██████    | 6/10 [09:44<06:10, 92.65s/it][A
 60%|██████    | 6/10 [09:44<06:10, 92.66s/it][A
 60%|██████    | 6/10 [09:44<06:10, 92.66s/it][A
 70%|███████   | 7/10 [11:06<04:27, 89.08s/it][A[2024-05-30 04:15:19,255] [INFO] [logging.py:96:log_dist] [Rank 0] step=647, skipped=0, lr=[1.9639590595873516e-05], mom=[(0.9, 0.999)]
steps: 647 loss: 0.5802 iter time (s): 80.922 samples/sec: 1.582

 70%|███████   | 7/10 [11:06<04:27, 89.09s/it][A
 70%|███████   | 7/10 [11:06<04:27, 89.09s/it][A
 70%|███████   | 7/10 [11:06<04:27, 89.09s/it][A
 70%|███████   | 7/10 [11:06<04:27, 89.07s/it][A
 70%|███████   | 7/10 [11:06<04:27, 89.08s/it][A
 70%|███████   | 7/10 [11:06<04:27, 89.09s/it][A
 70%|███████   | 7/10 [11:06<04:27, 89.08s/it][A
 80%|████████  | 8/10 [12:29<02:54, 87.02s/it][A[2024-05-30 04:16:41,857] [INFO] [logging.py:96:log_dist] [Rank 0] step=648, skipped=0, lr=[1.9638082178559704e-05], mom=[(0.9, 0.999)]
steps: 648 loss: 0.5900 iter time (s): 81.820 samples/sec: 1.564

 80%|████████  | 8/10 [12:28<02:54, 87.01s/it][A
 80%|████████  | 8/10 [12:28<02:54, 87.04s/it][A
 80%|████████  | 8/10 [12:28<02:54, 87.03s/it][A
 80%|████████  | 8/10 [12:28<02:54, 87.01s/it][A
 80%|████████  | 8/10 [12:28<02:54, 87.02s/it][A
 80%|████████  | 8/10 [12:28<02:54, 87.02s/it][A
 80%|████████  | 8/10 [12:28<02:54, 87.02s/it][A
 90%|█████████ | 9/10 [13:54<01:26, 86.50s/it][A[2024-05-30 04:18:06,521] [INFO] [logging.py:96:log_dist] [Rank 0] step=649, skipped=0, lr=[1.9636570669430706e-05], mom=[(0.9, 0.999)]
steps: 649 loss: 0.5753 iter time (s): 83.882 samples/sec: 1.526

 90%|█████████ | 9/10 [13:53<01:26, 86.31s/it][A
 90%|█████████ | 9/10 [13:53<01:26, 86.27s/it][A
 90%|█████████ | 9/10 [13:53<01:26, 86.30s/it][A
 90%|█████████ | 9/10 [13:53<01:26, 86.29s/it][A
 90%|█████████ | 9/10 [13:53<01:26, 86.28s/it][A
 90%|█████████ | 9/10 [13:53<01:26, 86.30s/it][A
 90%|█████████ | 9/10 [13:53<01:26, 86.29s/it][A
100%|██████████| 10/10 [15:18<00:00, 85.62s/it][A100%|██████████| 10/10 [15:18<00:00, 91.81s/it]
 13%|█▎        | 66/520 [6:26:10<123:10:21, 976.70s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 04:19:30,873] [INFO] [logging.py:96:log_dist] [Rank 0] step=650, skipped=0, lr=[1.963505606897146e-05], mom=[(0.9, 0.999)]
steps: 650 loss: 0.5786 iter time (s): 83.533 samples/sec: 1.532

100%|██████████| 10/10 [15:17<00:00, 85.68s/it][A100%|██████████| 10/10 [15:17<00:00, 91.78s/it]
 13%|█▎        | 66/520 [6:23:58<123:09:46, 976.62s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:17<00:00, 85.69s/it][A100%|██████████| 10/10 [15:17<00:00, 91.78s/it]
 13%|█▎        | 66/520 [6:26:19<123:09:51, 976.63s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:17<00:00, 85.68s/it][A100%|██████████| 10/10 [15:17<00:00, 91.78s/it]
 13%|█▎        | 66/520 [6:26:18<123:09:50, 976.63s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:17<00:00, 85.68s/it][A100%|██████████| 10/10 [15:17<00:00, 91.78s/it]
 13%|█▎        | 66/520 [6:25:12<123:09:48, 976.63s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:17<00:00, 85.68s/it][A100%|██████████| 10/10 [15:17<00:00, 91.79s/it]
 13%|█▎        | 66/520 [6:25:54<123:09:55, 976.64s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:17<00:00, 85.68s/it][A100%|██████████| 10/10 [15:17<00:00, 91.79s/it]
 13%|█▎        | 66/520 [6:24:41<123:09:51, 976.63s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [15:17<00:00, 85.68s/it][A100%|██████████| 10/10 [15:17<00:00, 91.79s/it]
 13%|█▎        | 66/520 [6:21:31<123:09:48, 976.63s/it] Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_160
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:49<16:29, 109.98s/it][A[2024-05-30 04:21:21,677] [INFO] [logging.py:96:log_dist] [Rank 0] step=651, skipped=0, lr=[1.963353837766788e-05], mom=[(0.9, 0.999)]
steps: 651 loss: 0.5453 iter time (s): 109.876 samples/sec: 1.165

 10%|█         | 1/10 [01:50<16:37, 110.78s/it][A
 10%|█         | 1/10 [01:50<16:36, 110.72s/it][A
 10%|█         | 1/10 [01:50<16:37, 110.84s/it][A
 10%|█         | 1/10 [01:50<16:36, 110.77s/it][A
 10%|█         | 1/10 [01:50<16:36, 110.69s/it][A
 10%|█         | 1/10 [01:50<16:36, 110.75s/it][A
 10%|█         | 1/10 [01:50<16:36, 110.73s/it][A
 20%|██        | 2/10 [03:36<14:24, 108.02s/it][A[2024-05-30 04:23:07,850] [INFO] [logging.py:96:log_dist] [Rank 0] step=652, skipped=0, lr=[1.963201759600688e-05], mom=[(0.9, 0.999)]
steps: 652 loss: 0.5399 iter time (s): 105.443 samples/sec: 1.214

 20%|██        | 2/10 [03:36<14:24, 108.07s/it][A
 20%|██        | 2/10 [03:36<14:24, 108.06s/it][A
 20%|██        | 2/10 [03:36<14:24, 108.02s/it][A
 20%|██        | 2/10 [03:37<14:24, 108.10s/it][A
 20%|██        | 2/10 [03:36<14:24, 108.05s/it][A
 20%|██        | 2/10 [03:36<14:24, 108.05s/it][A
 20%|██        | 2/10 [03:36<14:24, 108.05s/it][A
 30%|███       | 3/10 [05:24<12:34, 107.81s/it][A[2024-05-30 04:24:55,886] [INFO] [logging.py:96:log_dist] [Rank 0] step=653, skipped=0, lr=[1.963049372447637e-05], mom=[(0.9, 0.999)]
steps: 653 loss: 0.5562 iter time (s): 107.304 samples/sec: 1.193

 30%|███       | 3/10 [05:24<12:36, 108.04s/it][A
 30%|███       | 3/10 [05:24<12:36, 108.03s/it][A
 30%|███       | 3/10 [05:25<12:36, 108.05s/it][A
 30%|███       | 3/10 [05:24<12:36, 108.07s/it][A
 30%|███       | 3/10 [05:24<12:36, 108.07s/it][A
 30%|███       | 3/10 [05:25<12:36, 108.10s/it][A
 30%|███       | 3/10 [05:25<12:36, 108.10s/it][A
 40%|████      | 4/10 [07:11<10:44, 107.47s/it][A[2024-05-30 04:26:42,837] [INFO] [logging.py:96:log_dist] [Rank 0] step=654, skipped=0, lr=[1.9628966763565235e-05], mom=[(0.9, 0.999)]
steps: 654 loss: 0.5424 iter time (s): 106.154 samples/sec: 1.206

 40%|████      | 4/10 [07:11<10:45, 107.62s/it][A
 40%|████      | 4/10 [07:11<10:45, 107.63s/it][A
 40%|████      | 4/10 [07:12<10:45, 107.64s/it][A
 40%|████      | 4/10 [07:11<10:45, 107.65s/it][A
 40%|████      | 4/10 [07:11<10:45, 107.64s/it][A
 40%|████      | 4/10 [07:11<10:45, 107.62s/it][A
 40%|████      | 4/10 [07:11<10:45, 107.62s/it][A
 50%|█████     | 5/10 [08:59<08:59, 107.96s/it][A[2024-05-30 04:28:31,667] [INFO] [logging.py:96:log_dist] [Rank 0] step=655, skipped=0, lr=[1.962743671376337e-05], mom=[(0.9, 0.999)]
steps: 655 loss: 0.5539 iter time (s): 108.050 samples/sec: 1.185

 50%|█████     | 5/10 [09:00<09:00, 108.05s/it][A
 50%|█████     | 5/10 [09:00<09:00, 108.04s/it][A
 50%|█████     | 5/10 [09:00<09:00, 108.04s/it][A
 50%|█████     | 5/10 [09:00<09:00, 108.02s/it][A
 50%|█████     | 5/10 [09:00<09:00, 108.03s/it][A
 50%|█████     | 5/10 [09:00<09:00, 108.02s/it][A
 50%|█████     | 5/10 [09:00<09:00, 108.02s/it][A
 60%|██████    | 6/10 [10:46<07:10, 107.55s/it][A[2024-05-30 04:30:18,421] [INFO] [logging.py:96:log_dist] [Rank 0] step=656, skipped=0, lr=[1.9625903575561652e-05], mom=[(0.9, 0.999)]
steps: 656 loss: 0.5626 iter time (s): 106.075 samples/sec: 1.207

 60%|██████    | 6/10 [10:47<07:10, 107.62s/it][A
 60%|██████    | 6/10 [10:47<07:10, 107.62s/it][A
 60%|██████    | 6/10 [10:47<07:10, 107.62s/it][A
 60%|██████    | 6/10 [10:47<07:10, 107.62s/it][A
 60%|██████    | 6/10 [10:47<07:10, 107.62s/it][A
 60%|██████    | 6/10 [10:47<07:10, 107.63s/it][A
 60%|██████    | 6/10 [10:47<07:10, 107.65s/it][A
 70%|███████   | 7/10 [12:33<05:21, 107.16s/it][A[2024-05-30 04:32:04,776] [INFO] [logging.py:96:log_dist] [Rank 0] step=657, skipped=0, lr=[1.9624367349451948e-05], mom=[(0.9, 0.999)]
steps: 657 loss: 0.5519 iter time (s): 105.559 samples/sec: 1.213

 70%|███████   | 7/10 [12:34<05:21, 107.28s/it][A
 70%|███████   | 7/10 [12:34<05:21, 107.26s/it][A
 70%|███████   | 7/10 [12:33<05:21, 107.22s/it][A
 70%|███████   | 7/10 [12:33<05:21, 107.25s/it][A
 70%|███████   | 7/10 [12:34<05:21, 107.28s/it][A
 70%|███████   | 7/10 [12:34<05:22, 107.40s/it][A
 70%|███████   | 7/10 [12:34<05:22, 107.43s/it][A
 80%|████████  | 8/10 [14:20<03:34, 107.21s/it][A[2024-05-30 04:33:52,106] [INFO] [logging.py:96:log_dist] [Rank 0] step=658, skipped=0, lr=[1.962282803592712e-05], mom=[(0.9, 0.999)]
steps: 658 loss: 0.5582 iter time (s): 105.932 samples/sec: 1.208

 80%|████████  | 8/10 [14:21<03:34, 107.22s/it][A
 80%|████████  | 8/10 [14:21<03:34, 107.24s/it][A
 80%|████████  | 8/10 [14:21<03:34, 107.23s/it][A
 80%|████████  | 8/10 [14:21<03:34, 107.22s/it][A
 80%|████████  | 8/10 [14:21<03:34, 107.22s/it][A
 80%|████████  | 8/10 [14:21<03:34, 107.17s/it][A
 80%|████████  | 8/10 [14:21<03:34, 107.17s/it][A
 90%|█████████ | 9/10 [16:14<01:49, 109.38s/it][A[2024-05-30 04:35:46,253] [INFO] [logging.py:96:log_dist] [Rank 0] step=659, skipped=0, lr=[1.9621285635481014e-05], mom=[(0.9, 0.999)]
steps: 659 loss: 0.5342 iter time (s): 113.424 samples/sec: 1.129

 90%|█████████ | 9/10 [16:15<01:49, 109.40s/it][A
 90%|█████████ | 9/10 [16:15<01:49, 109.39s/it][A
 90%|█████████ | 9/10 [16:15<01:49, 109.40s/it][A
 90%|█████████ | 9/10 [16:15<01:49, 109.40s/it][A
 90%|█████████ | 9/10 [16:15<01:49, 109.40s/it][A
 90%|█████████ | 9/10 [16:15<01:49, 109.36s/it][A
 90%|█████████ | 9/10 [16:15<01:49, 109.36s/it][A
100%|██████████| 10/10 [17:59<00:00, 108.10s/it][A100%|██████████| 10/10 [17:59<00:00, 107.98s/it]
 13%|█▎        | 67/520 [6:44:10<126:47:35, 1007.63s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 04:37:31,460] [INFO] [logging.py:96:log_dist] [Rank 0] step=660, skipped=0, lr=[1.961974014860848e-05], mom=[(0.9, 0.999)]
steps: 660 loss: 0.5410 iter time (s): 104.457 samples/sec: 1.225

100%|██████████| 10/10 [18:00<00:00, 108.09s/it][A100%|██████████| 10/10 [18:00<00:00, 108.06s/it]
 13%|█▎        | 67/520 [6:41:58<126:48:35, 1007.76s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [18:00<00:00, 108.10s/it][A100%|██████████| 10/10 [18:00<00:00, 108.05s/it]
 13%|█▎        | 67/520 [6:44:20<126:48:34, 1007.76s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [18:00<00:00, 108.09s/it][A100%|██████████| 10/10 [18:00<00:00, 108.05s/it]
 13%|█▎        | 67/520 [6:44:19<126:48:35, 1007.76s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [18:00<00:00, 108.08s/it][A100%|██████████| 10/10 [18:00<00:00, 108.05s/it]
 13%|█▎        | 67/520 [6:43:12<126:48:27, 1007.74s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [18:00<00:00, 108.08s/it][A100%|██████████| 10/10 [18:00<00:00, 108.05s/it]
 13%|█▎        | 67/520 [6:43:55<126:48:30, 1007.75s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [18:00<00:00, 108.06s/it][A100%|██████████| 10/10 [18:00<00:00, 108.05s/it]
 13%|█▎        | 67/520 [6:42:42<126:48:29, 1007.75s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [18:00<00:00, 108.10s/it][A100%|██████████| 10/10 [18:00<00:00, 108.06s/it]
 13%|█▎        | 67/520 [6:39:32<126:48:44, 1007.78s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_475
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:19<11:53, 79.33s/it][A[2024-05-30 04:38:50,254] [INFO] [logging.py:96:log_dist] [Rank 0] step=661, skipped=0, lr=[1.9618191575805334e-05], mom=[(0.9, 0.999)]
steps: 661 loss: 2.0719 iter time (s): 77.823 samples/sec: 1.645

 10%|█         | 1/10 [01:18<11:48, 78.76s/it][A
 10%|█         | 1/10 [01:18<11:48, 78.77s/it][A
 10%|█         | 1/10 [01:18<11:49, 78.78s/it][A
 10%|█         | 1/10 [01:18<11:49, 78.81s/it][A
 10%|█         | 1/10 [01:18<11:49, 78.79s/it][A
 10%|█         | 1/10 [01:18<11:49, 78.82s/it][A
 10%|█         | 1/10 [01:18<11:48, 78.67s/it][A
 20%|██        | 2/10 [02:38<10:32, 79.10s/it][A[2024-05-30 04:40:09,180] [INFO] [logging.py:96:log_dist] [Rank 0] step=662, skipped=0, lr=[1.9616639917568404e-05], mom=[(0.9, 0.999)]
steps: 662 loss: 1.8763 iter time (s): 78.205 samples/sec: 1.637

 20%|██        | 2/10 [02:37<10:30, 78.86s/it][A
 20%|██        | 2/10 [02:37<10:30, 78.85s/it][A
 20%|██        | 2/10 [02:37<10:31, 78.89s/it][A
 20%|██        | 2/10 [02:37<10:31, 78.89s/it][A
 20%|██        | 2/10 [02:37<10:31, 78.88s/it][A
 20%|██        | 2/10 [02:37<10:31, 78.88s/it][A
 20%|██        | 2/10 [02:37<10:30, 78.82s/it][A
 30%|███       | 3/10 [03:58<09:15, 79.42s/it][A[2024-05-30 04:41:28,980] [INFO] [logging.py:96:log_dist] [Rank 0] step=663, skipped=0, lr=[1.9615085174395502e-05], mom=[(0.9, 0.999)]
steps: 663 loss: 1.7357 iter time (s): 79.110 samples/sec: 1.618

 30%|███       | 3/10 [03:57<09:15, 79.31s/it][A
 30%|███       | 3/10 [03:57<09:14, 79.28s/it][A
 30%|███       | 3/10 [03:57<09:15, 79.32s/it][A
 30%|███       | 3/10 [03:57<09:15, 79.30s/it][A
 30%|███       | 3/10 [03:57<09:15, 79.29s/it][A
 30%|███       | 3/10 [03:57<09:15, 79.34s/it][A
 30%|███       | 3/10 [03:57<09:14, 79.27s/it][A
 40%|████      | 4/10 [05:18<07:59, 79.88s/it][A[2024-05-30 04:42:49,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=664, skipped=0, lr=[1.9613527346785424e-05], mom=[(0.9, 0.999)]
steps: 664 loss: 1.6042 iter time (s): 79.898 samples/sec: 1.602

 40%|████      | 4/10 [05:18<07:58, 79.82s/it][A
 40%|████      | 4/10 [05:18<07:58, 79.82s/it][A
 40%|████      | 4/10 [05:18<07:58, 79.78s/it][A
 40%|████      | 4/10 [05:18<07:58, 79.80s/it][A
 40%|████      | 4/10 [05:18<07:58, 79.80s/it][A
 40%|████      | 4/10 [05:18<07:58, 79.80s/it][A
 40%|████      | 4/10 [05:17<07:58, 79.78s/it][A
 50%|█████     | 5/10 [06:36<06:35, 79.01s/it][A[2024-05-30 04:44:06,531] [INFO] [logging.py:96:log_dist] [Rank 0] step=665, skipped=0, lr=[1.9611966435237965e-05], mom=[(0.9, 0.999)]
steps: 665 loss: 1.5167 iter time (s): 76.257 samples/sec: 1.679

 50%|█████     | 5/10 [06:35<06:33, 78.78s/it][A
 50%|█████     | 5/10 [06:35<06:33, 78.77s/it][A
 50%|█████     | 5/10 [06:35<06:33, 78.77s/it][A
 50%|█████     | 5/10 [06:35<06:33, 78.78s/it][A
 50%|█████     | 5/10 [06:35<06:33, 78.78s/it][A
 50%|█████     | 5/10 [06:34<06:33, 78.76s/it][A
 50%|█████     | 5/10 [06:35<06:33, 78.78s/it][A
 60%|██████    | 6/10 [07:55<05:15, 78.98s/it][A[2024-05-30 04:45:25,828] [INFO] [logging.py:96:log_dist] [Rank 0] step=666, skipped=0, lr=[1.9610402440253906e-05], mom=[(0.9, 0.999)]
steps: 666 loss: 1.4463 iter time (s): 78.589 samples/sec: 1.629

 60%|██████    | 6/10 [07:54<05:15, 78.93s/it][A
 60%|██████    | 6/10 [07:54<05:15, 78.94s/it][A
 60%|██████    | 6/10 [07:54<05:15, 78.94s/it][A
 60%|██████    | 6/10 [07:54<05:15, 78.93s/it][A
 60%|██████    | 6/10 [07:54<05:15, 78.94s/it][A
 60%|██████    | 6/10 [07:54<05:15, 78.93s/it][A
 60%|██████    | 6/10 [07:54<05:15, 78.94s/it][A
 70%|███████   | 7/10 [09:12<03:55, 78.46s/it][A[2024-05-30 04:46:43,347] [INFO] [logging.py:96:log_dist] [Rank 0] step=667, skipped=0, lr=[1.9608835362335003e-05], mom=[(0.9, 0.999)]
steps: 667 loss: 1.4023 iter time (s): 76.851 samples/sec: 1.666

 70%|███████   | 7/10 [09:11<03:55, 78.49s/it][A
 70%|███████   | 7/10 [09:11<03:55, 78.48s/it][A
 70%|███████   | 7/10 [09:11<03:55, 78.48s/it][A
 70%|███████   | 7/10 [09:11<03:55, 78.48s/it][A
 70%|███████   | 7/10 [09:11<03:55, 78.48s/it][A
 70%|███████   | 7/10 [09:11<03:55, 78.47s/it][A
 70%|███████   | 7/10 [09:11<03:55, 78.47s/it][A
 80%|████████  | 8/10 [10:28<02:35, 77.75s/it][A[2024-05-30 04:47:59,592] [INFO] [logging.py:96:log_dist] [Rank 0] step=668, skipped=0, lr=[1.9607265201984024e-05], mom=[(0.9, 0.999)]
steps: 668 loss: 1.2986 iter time (s): 75.578 samples/sec: 1.694

 80%|████████  | 8/10 [10:28<02:35, 77.78s/it][A
 80%|████████  | 8/10 [10:28<02:35, 77.80s/it][A
 80%|████████  | 8/10 [10:28<02:35, 77.78s/it][A
 80%|████████  | 8/10 [10:28<02:35, 77.78s/it][A
 80%|████████  | 8/10 [10:28<02:35, 77.78s/it][A
 80%|████████  | 8/10 [10:28<02:35, 77.78s/it][A
 80%|████████  | 8/10 [10:27<02:35, 77.77s/it][A
 90%|█████████ | 9/10 [11:43<01:16, 76.70s/it][A[2024-05-30 04:49:13,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=669, skipped=0, lr=[1.9605691959704714e-05], mom=[(0.9, 0.999)]
steps: 669 loss: 1.3098 iter time (s): 73.671 samples/sec: 1.737

 90%|█████████ | 9/10 [11:42<01:16, 76.71s/it][A
 90%|█████████ | 9/10 [11:42<01:16, 76.71s/it][A
 90%|█████████ | 9/10 [11:42<01:16, 76.70s/it][A
 90%|█████████ | 9/10 [11:42<01:16, 76.71s/it][A
 90%|█████████ | 9/10 [11:42<01:16, 76.72s/it][A
 90%|█████████ | 9/10 [11:42<01:16, 76.71s/it][A
 90%|█████████ | 9/10 [11:42<01:16, 76.71s/it][A
100%|██████████| 10/10 [12:58<00:00, 76.25s/it][A100%|██████████| 10/10 [12:58<00:00, 77.83s/it]
 13%|█▎        | 68/520 [6:57:09<117:53:42, 938.99s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 04:50:29,215] [INFO] [logging.py:96:log_dist] [Rank 0] step=670, skipped=0, lr=[1.960411563600181e-05], mom=[(0.9, 0.999)]
steps: 670 loss: 1.2613 iter time (s): 74.554 samples/sec: 1.717

100%|██████████| 10/10 [12:57<00:00, 76.25s/it][A100%|██████████| 10/10 [12:57<00:00, 77.77s/it]
 13%|█▎        | 68/520 [6:54:56<117:52:28, 938.83s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:57<00:00, 76.24s/it][A100%|██████████| 10/10 [12:57<00:00, 77.77s/it]
 13%|█▎        | 68/520 [6:57:17<117:52:23, 938.81s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:57<00:00, 76.26s/it][A100%|██████████| 10/10 [12:57<00:00, 77.77s/it]
 13%|█▎        | 68/520 [6:57:17<117:52:34, 938.84s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:57<00:00, 76.24s/it][A100%|██████████| 10/10 [12:57<00:00, 77.77s/it]
 13%|█▎        | 68/520 [6:56:10<117:52:21, 938.81s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:57<00:00, 76.25s/it][A100%|██████████| 10/10 [12:57<00:00, 77.77s/it]
 13%|█▎        | 68/520 [6:56:52<117:52:27, 938.82s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:57<00:00, 76.25s/it][A100%|██████████| 10/10 [12:57<00:00, 77.77s/it]
 13%|█▎        | 68/520 [6:55:40<117:52:24, 938.81s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:57<00:00, 76.25s/it][A100%|██████████| 10/10 [12:57<00:00, 77.76s/it]
 13%|█▎        | 68/520 [6:52:29<117:52:14, 938.79s/it] Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_92
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:16<11:32, 77.00s/it][A[2024-05-30 04:51:46,408] [INFO] [logging.py:96:log_dist] [Rank 0] step=671, skipped=0, lr=[1.9602536231381025e-05], mom=[(0.9, 0.999)]
steps: 671 loss: 1.1249 iter time (s): 76.442 samples/sec: 1.674

 10%|█         | 1/10 [01:17<11:34, 77.17s/it][A
 10%|█         | 1/10 [01:17<11:34, 77.21s/it][A
 10%|█         | 1/10 [01:17<11:34, 77.19s/it][A
 10%|█         | 1/10 [01:17<11:34, 77.20s/it][A
 10%|█         | 1/10 [01:17<11:35, 77.30s/it][A
 10%|█         | 1/10 [01:17<11:35, 77.24s/it][A
 10%|█         | 1/10 [01:17<11:35, 77.26s/it][A
 20%|██        | 2/10 [02:34<10:17, 77.20s/it][A[2024-05-30 04:53:03,741] [INFO] [logging.py:96:log_dist] [Rank 0] step=672, skipped=0, lr=[1.9600953746349084e-05], mom=[(0.9, 0.999)]
steps: 672 loss: 1.1605 iter time (s): 76.605 samples/sec: 1.671

 20%|██        | 2/10 [02:34<10:18, 77.29s/it][A
 20%|██        | 2/10 [02:34<10:18, 77.30s/it][A
 20%|██        | 2/10 [02:34<10:18, 77.28s/it][A
 20%|██        | 2/10 [02:34<10:18, 77.30s/it][A
 20%|██        | 2/10 [02:34<10:18, 77.29s/it][A
 20%|██        | 2/10 [02:34<10:18, 77.29s/it][A
 20%|██        | 2/10 [02:34<10:18, 77.31s/it][A
 30%|███       | 3/10 [03:51<09:00, 77.27s/it][A[2024-05-30 04:54:21,090] [INFO] [logging.py:96:log_dist] [Rank 0] step=673, skipped=0, lr=[1.959936818141368e-05], mom=[(0.9, 0.999)]
steps: 673 loss: 1.1195 iter time (s): 76.620 samples/sec: 1.671

 30%|███       | 3/10 [03:51<09:01, 77.30s/it][A
 30%|███       | 3/10 [03:51<09:01, 77.32s/it][A
 30%|███       | 3/10 [03:51<09:01, 77.30s/it][A
 30%|███       | 3/10 [03:51<09:01, 77.32s/it][A
 30%|███       | 3/10 [03:51<09:01, 77.31s/it][A
 30%|███       | 3/10 [03:51<09:01, 77.32s/it][A
 30%|███       | 3/10 [03:51<09:01, 77.32s/it][A
 40%|████      | 4/10 [05:09<07:44, 77.39s/it][A[2024-05-30 04:55:38,664] [INFO] [logging.py:96:log_dist] [Rank 0] step=674, skipped=0, lr=[1.9597779537083507e-05], mom=[(0.9, 0.999)]
steps: 674 loss: 1.1330 iter time (s): 76.840 samples/sec: 1.666

 40%|████      | 4/10 [05:09<07:44, 77.41s/it][A
 40%|████      | 4/10 [05:09<07:44, 77.41s/it][A
 40%|████      | 4/10 [05:09<07:44, 77.42s/it][A
 40%|████      | 4/10 [05:09<07:44, 77.43s/it][A
 40%|████      | 4/10 [05:09<07:44, 77.42s/it][A
 40%|████      | 4/10 [05:09<07:44, 77.41s/it][A
 40%|████      | 4/10 [05:09<07:44, 77.41s/it][A
 50%|█████     | 5/10 [06:26<06:27, 77.46s/it][A[2024-05-30 04:56:56,267] [INFO] [logging.py:96:log_dist] [Rank 0] step=675, skipped=0, lr=[1.9596187813868238e-05], mom=[(0.9, 0.999)]
steps: 675 loss: 1.1489 iter time (s): 76.887 samples/sec: 1.665

 50%|█████     | 5/10 [06:27<06:27, 77.48s/it][A
 50%|█████     | 5/10 [06:27<06:27, 77.47s/it][A
 50%|█████     | 5/10 [06:27<06:27, 77.49s/it][A
 50%|█████     | 5/10 [06:27<06:27, 77.48s/it][A
 50%|█████     | 5/10 [06:27<06:27, 77.48s/it][A
 50%|█████     | 5/10 [06:27<06:27, 77.48s/it][A
 50%|█████     | 5/10 [06:27<06:27, 77.48s/it][A
 60%|██████    | 6/10 [07:43<05:08, 77.07s/it][A[2024-05-30 04:58:12,568] [INFO] [logging.py:96:log_dist] [Rank 0] step=676, skipped=0, lr=[1.9594593012278537e-05], mom=[(0.9, 0.999)]
steps: 676 loss: 1.1282 iter time (s): 75.591 samples/sec: 1.693

 60%|██████    | 6/10 [07:43<05:08, 77.08s/it][A
 60%|██████    | 6/10 [07:43<05:08, 77.11s/it][A
 60%|██████    | 6/10 [07:43<05:08, 77.07s/it][A
 60%|██████    | 6/10 [07:43<05:08, 77.09s/it][A
 60%|██████    | 6/10 [07:43<05:08, 77.08s/it][A
 60%|██████    | 6/10 [07:43<05:08, 77.09s/it][A
 60%|██████    | 6/10 [07:43<05:08, 77.08s/it][A
 70%|███████   | 7/10 [09:03<03:54, 78.02s/it][A[2024-05-30 04:59:32,558] [INFO] [logging.py:96:log_dist] [Rank 0] step=677, skipped=0, lr=[1.959299513282606e-05], mom=[(0.9, 0.999)]
steps: 677 loss: 1.1281 iter time (s): 79.331 samples/sec: 1.613

 70%|███████   | 7/10 [09:03<03:54, 78.05s/it][A
 70%|███████   | 7/10 [09:03<03:54, 78.05s/it][A
 70%|███████   | 7/10 [09:03<03:54, 78.04s/it][A
 70%|███████   | 7/10 [09:03<03:54, 78.04s/it][A
 70%|███████   | 7/10 [09:03<03:54, 78.03s/it][A
 70%|███████   | 7/10 [09:03<03:54, 78.04s/it][A
 70%|███████   | 7/10 [09:03<03:54, 78.04s/it][A
 80%|████████  | 8/10 [10:21<02:36, 78.17s/it][A[2024-05-30 05:00:50,773] [INFO] [logging.py:96:log_dist] [Rank 0] step=678, skipped=0, lr=[1.959139417602344e-05], mom=[(0.9, 0.999)]
steps: 678 loss: 1.1068 iter time (s): 77.496 samples/sec: 1.652

 80%|████████  | 8/10 [10:21<02:36, 78.09s/it][A
 80%|████████  | 8/10 [10:21<02:36, 78.08s/it][A
 80%|████████  | 8/10 [10:21<02:36, 78.09s/it][A
 80%|████████  | 8/10 [10:21<02:36, 78.08s/it][A
 80%|████████  | 8/10 [10:21<02:36, 78.09s/it][A
 80%|████████  | 8/10 [10:21<02:36, 78.10s/it][A
 80%|████████  | 8/10 [10:21<02:36, 78.09s/it][A
 90%|█████████ | 9/10 [11:42<01:19, 79.08s/it][A[2024-05-30 05:02:12,120] [INFO] [logging.py:96:log_dist] [Rank 0] step=679, skipped=0, lr=[1.9589790142384307e-05], mom=[(0.9, 0.999)]
steps: 679 loss: 1.0911 iter time (s): 80.653 samples/sec: 1.587

 90%|█████████ | 9/10 [11:42<01:19, 79.12s/it][A
 90%|█████████ | 9/10 [11:42<01:19, 79.11s/it][A
 90%|█████████ | 9/10 [11:43<01:19, 79.14s/it][A
 90%|█████████ | 9/10 [11:43<01:19, 79.12s/it][A
 90%|█████████ | 9/10 [11:42<01:19, 79.12s/it][A
 90%|█████████ | 9/10 [11:43<01:19, 79.13s/it][A
 90%|█████████ | 9/10 [11:42<01:19, 79.12s/it][A
100%|██████████| 10/10 [13:01<00:00, 78.98s/it][A100%|██████████| 10/10 [13:01<00:00, 78.15s/it]
 13%|█▎        | 69/520 [7:10:10<111:43:27, 891.81s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 05:03:30,873] [INFO] [logging.py:96:log_dist] [Rank 0] step=680, skipped=0, lr=[1.9588183032423273e-05], mom=[(0.9, 0.999)]
steps: 680 loss: 1.0911 iter time (s): 77.993 samples/sec: 1.641

100%|██████████| 10/10 [13:01<00:00, 78.98s/it][A100%|██████████| 10/10 [13:01<00:00, 78.16s/it]
 13%|█▎        | 69/520 [7:07:58<111:42:37, 891.70s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:01<00:00, 79.00s/it][A100%|██████████| 10/10 [13:01<00:00, 78.17s/it]
 13%|█▎        | 69/520 [7:10:19<111:42:44, 891.72s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:01<00:00, 79.01s/it][A100%|██████████| 10/10 [13:01<00:00, 78.17s/it]
 13%|█▎        | 69/520 [7:10:18<111:42:55, 891.74s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:01<00:00, 79.00s/it][A100%|██████████| 10/10 [13:01<00:00, 78.17s/it]
 13%|█▎        | 69/520 [7:09:12<111:42:48, 891.73s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:01<00:00, 79.00s/it][A100%|██████████| 10/10 [13:01<00:00, 78.17s/it]
 13%|█▎        | 69/520 [7:09:54<111:42:48, 891.73s/it]
100%|██████████| 10/10 [13:01<00:00, 78.99s/it][A100%|██████████| 10/10 [13:01<00:00, 78.17s/it]
 13%|█▎        | 69/520 [7:08:41<111:42:43, 891.72s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:01<00:00, 79.00s/it][A100%|██████████| 10/10 [13:01<00:00, 78.17s/it]
 13%|█▎        | 69/520 [7:05:31<111:42:40, 891.71s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_100
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:17<11:37, 77.46s/it][A[2024-05-30 05:04:48,715] [INFO] [logging.py:96:log_dist] [Rank 0] step=681, skipped=0, lr=[1.9586572846655943e-05], mom=[(0.9, 0.999)]
steps: 681 loss: 1.0784 iter time (s): 77.047 samples/sec: 1.661

 10%|█         | 1/10 [01:17<11:41, 77.94s/it][A
 10%|█         | 1/10 [01:17<11:40, 77.84s/it][A
 10%|█         | 1/10 [01:17<11:40, 77.81s/it][A
 10%|█         | 1/10 [01:17<11:40, 77.87s/it][A
 10%|█         | 1/10 [01:17<11:40, 77.88s/it][A
 10%|█         | 1/10 [01:17<11:40, 77.89s/it][A
 10%|█         | 1/10 [01:17<11:40, 77.88s/it][A
 20%|██        | 2/10 [02:36<10:25, 78.21s/it][A[2024-05-30 05:06:07,071] [INFO] [logging.py:96:log_dist] [Rank 0] step=682, skipped=0, lr=[1.9584959585598902e-05], mom=[(0.9, 0.999)]
steps: 682 loss: 1.0923 iter time (s): 77.588 samples/sec: 1.650

 20%|██        | 2/10 [02:36<10:25, 78.16s/it][A
 20%|██        | 2/10 [02:36<10:24, 78.12s/it][A
 20%|██        | 2/10 [02:36<10:24, 78.11s/it][A
 20%|██        | 2/10 [02:36<10:24, 78.12s/it][A
 20%|██        | 2/10 [02:36<10:24, 78.09s/it][A
 20%|██        | 2/10 [02:36<10:24, 78.12s/it][A
 20%|██        | 2/10 [02:36<10:24, 78.12s/it][A
 30%|███       | 3/10 [03:52<08:59, 77.13s/it][A[2024-05-30 05:07:23,299] [INFO] [logging.py:96:log_dist] [Rank 0] step=683, skipped=0, lr=[1.9583343249769725e-05], mom=[(0.9, 0.999)]
steps: 683 loss: 1.0797 iter time (s): 75.526 samples/sec: 1.695

 30%|███       | 3/10 [03:52<09:00, 77.27s/it][A
 30%|███       | 3/10 [03:52<09:00, 77.28s/it][A
 30%|███       | 3/10 [03:52<09:00, 77.24s/it][A
 30%|███       | 3/10 [03:52<09:00, 77.24s/it][A
 30%|███       | 3/10 [03:52<09:00, 77.26s/it][A
 30%|███       | 3/10 [03:52<09:00, 77.26s/it][A
 30%|███       | 3/10 [03:52<09:00, 77.25s/it][A
 40%|████      | 4/10 [05:08<07:41, 76.93s/it][A[2024-05-30 05:08:39,921] [INFO] [logging.py:96:log_dist] [Rank 0] step=684, skipped=0, lr=[1.958172383968697e-05], mom=[(0.9, 0.999)]
steps: 684 loss: 1.0841 iter time (s): 75.928 samples/sec: 1.686

 40%|████      | 4/10 [05:09<07:42, 77.00s/it][A
 40%|████      | 4/10 [05:09<07:42, 77.01s/it][A
 40%|████      | 4/10 [05:08<07:41, 76.98s/it][A
 40%|████      | 4/10 [05:08<07:41, 76.99s/it][A
 40%|████      | 4/10 [05:08<07:42, 77.00s/it][A
 40%|████      | 4/10 [05:09<07:41, 77.00s/it][A
 40%|████      | 4/10 [05:08<07:41, 76.99s/it][A
 50%|█████     | 5/10 [06:26<06:26, 77.39s/it][A[2024-05-30 05:09:58,135] [INFO] [logging.py:96:log_dist] [Rank 0] step=685, skipped=0, lr=[1.9580101355870188e-05], mom=[(0.9, 0.999)]
steps: 685 loss: 1.0661 iter time (s): 77.570 samples/sec: 1.650

 50%|█████     | 5/10 [06:27<06:27, 77.46s/it][A
 50%|█████     | 5/10 [06:27<06:27, 77.45s/it][A
 50%|█████     | 5/10 [06:27<06:27, 77.44s/it][A
 50%|█████     | 5/10 [06:27<06:27, 77.46s/it][A
 50%|█████     | 5/10 [06:27<06:27, 77.45s/it][A
 50%|█████     | 5/10 [06:27<06:27, 77.46s/it][A
 50%|█████     | 5/10 [06:27<06:27, 77.45s/it][A
 60%|██████    | 6/10 [07:45<05:11, 77.93s/it][A[2024-05-30 05:11:17,099] [INFO] [logging.py:96:log_dist] [Rank 0] step=686, skipped=0, lr=[1.957847579883991e-05], mom=[(0.9, 0.999)]
steps: 686 loss: 1.0714 iter time (s): 78.239 samples/sec: 1.636

 60%|██████    | 6/10 [07:46<05:11, 77.97s/it][A
 60%|██████    | 6/10 [07:46<05:11, 77.97s/it][A
 60%|██████    | 6/10 [07:46<05:11, 77.97s/it][A
 60%|██████    | 6/10 [07:46<05:11, 77.99s/it][A
 60%|██████    | 6/10 [07:46<05:11, 77.98s/it][A
 60%|██████    | 6/10 [07:46<05:11, 77.98s/it][A
 60%|██████    | 6/10 [07:46<05:11, 77.97s/it][A
 70%|███████   | 7/10 [09:04<03:54, 78.14s/it][A[2024-05-30 05:12:35,656] [INFO] [logging.py:96:log_dist] [Rank 0] step=687, skipped=0, lr=[1.9576847169117654e-05], mom=[(0.9, 0.999)]
steps: 687 loss: 1.0678 iter time (s): 77.812 samples/sec: 1.645

 70%|███████   | 7/10 [09:04<03:54, 78.13s/it][A
 70%|███████   | 7/10 [09:04<03:54, 78.16s/it][A
 70%|███████   | 7/10 [09:04<03:54, 78.16s/it][A
 70%|███████   | 7/10 [09:04<03:54, 78.15s/it][A
 70%|███████   | 7/10 [09:04<03:54, 78.14s/it][A
 70%|███████   | 7/10 [09:04<03:54, 78.14s/it][A
 70%|███████   | 7/10 [09:04<03:54, 78.15s/it][A
 80%|████████  | 8/10 [10:18<02:33, 76.81s/it][A[2024-05-30 05:13:49,625] [INFO] [logging.py:96:log_dist] [Rank 0] step=688, skipped=0, lr=[1.9575215467225925e-05], mom=[(0.9, 0.999)]
steps: 688 loss: 1.1000 iter time (s): 73.272 samples/sec: 1.747

 80%|████████  | 8/10 [10:18<02:33, 76.83s/it][A
 80%|████████  | 8/10 [10:18<02:33, 76.80s/it][A
 80%|████████  | 8/10 [10:18<02:33, 76.81s/it][A
 80%|████████  | 8/10 [10:18<02:33, 76.82s/it][A
 80%|████████  | 8/10 [10:18<02:33, 76.81s/it][A
 80%|████████  | 8/10 [10:18<02:33, 76.81s/it][A
 80%|████████  | 8/10 [10:18<02:33, 76.81s/it][A
 90%|█████████ | 9/10 [11:39<01:18, 78.20s/it][A[2024-05-30 05:15:10,894] [INFO] [logging.py:96:log_dist] [Rank 0] step=689, skipped=0, lr=[1.9573580693688217e-05], mom=[(0.9, 0.999)]
steps: 689 loss: 1.0956 iter time (s): 80.605 samples/sec: 1.588

 90%|█████████ | 9/10 [11:39<01:18, 78.20s/it][A
 90%|█████████ | 9/10 [11:40<01:18, 78.25s/it][A
 90%|█████████ | 9/10 [11:40<01:18, 78.24s/it][A
 90%|█████████ | 9/10 [11:40<01:18, 78.22s/it][A
 90%|█████████ | 9/10 [11:40<01:18, 78.23s/it][A
 90%|█████████ | 9/10 [11:40<01:18, 78.23s/it][A
 90%|█████████ | 9/10 [11:40<01:18, 78.22s/it][A
100%|██████████| 10/10 [13:01<00:00, 79.33s/it][A100%|██████████| 10/10 [13:01<00:00, 78.15s/it]
[2024-05-30 05:16:32,724] [INFO] [logging.py:96:log_dist] [Rank 0] step=690, skipped=0, lr=[1.9571942849029e-05], mom=[(0.9, 0.999)]
steps: 690 loss: 1.0880 iter time (s): 81.205 samples/sec: 1.576

100%|██████████| 10/10 [13:01<00:00, 79.33s/it][A100%|██████████| 10/10 [13:01<00:00, 78.19s/it]

100%|██████████| 10/10 [13:01<00:00, 79.35s/it][A100%|██████████| 10/10 [13:01<00:00, 78.19s/it]

100%|██████████| 10/10 [13:01<00:00, 79.35s/it][A100%|██████████| 10/10 [13:01<00:00, 78.19s/it]

100%|██████████| 10/10 [13:01<00:00, 79.36s/it][A100%|██████████| 10/10 [13:01<00:00, 78.19s/it]

100%|██████████| 10/10 [13:01<00:00, 79.36s/it][A100%|██████████| 10/10 [13:01<00:00, 78.19s/it]

100%|██████████| 10/10 [13:01<00:00, 79.36s/it][A100%|██████████| 10/10 [13:01<00:00, 78.19s/it]

100%|██████████| 10/10 [13:01<00:00, 79.36s/it][A100%|██████████| 10/10 [13:01<00:00, 78.19s/it]
Checkpointing at shard 70
[2024-05-30 05:16:33,565] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step690 is about to be saved!
[2024-05-30 05:16:34,697] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_00-model_states.pt...
[2024-05-30 05:16:37,194] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_00-model_states.pt.
[2024-05-30 05:16:40,786] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_02-model_states.pt...
[2024-05-30 05:16:41,650] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_04-model_states.pt...
[2024-05-30 05:16:42,508] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_05-model_states.pt...
[2024-05-30 05:16:42,799] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_06-model_states.pt...
[2024-05-30 05:16:42,900] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_03-model_states.pt...
[2024-05-30 05:16:46,209] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_07-model_states.pt...
[2024-05-30 05:16:47,058] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_08-model_states.pt...
[2024-05-30 05:16:48,799] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_01-model_states.pt...
[2024-05-30 05:23:15,342] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_08-model_states.pt.
[2024-05-30 05:23:16,185] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_09-model_states.pt...
[2024-05-30 05:23:22,314] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_09-model_states.pt.
[2024-05-30 05:23:22,363] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_07_model_states.pt...
[2024-05-30 05:23:26,103] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_07_model_states.pt.
[2024-05-30 05:23:26,103] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step690 is ready now!
[2024-05-30 05:23:31,594] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_03-model_states.pt.
[2024-05-30 05:23:32,408] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_02_model_states.pt...
[2024-05-30 05:23:32,989] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_02_model_states.pt.
[2024-05-30 05:23:32,990] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step690 is ready now!
[2024-05-30 05:23:36,659] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_06-model_states.pt.
[2024-05-30 05:23:37,218] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_05_model_states.pt...
[2024-05-30 05:23:37,535] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_05_model_states.pt.
[2024-05-30 05:23:37,535] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step690 is ready now!
[2024-05-30 05:23:49,333] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_07-model_states.pt.
[2024-05-30 05:23:50,016] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_06_model_states.pt...
[2024-05-30 05:23:51,715] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_06_model_states.pt.
[2024-05-30 05:23:51,715] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step690 is ready now!
[2024-05-30 05:23:53,550] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_05-model_states.pt.
[2024-05-30 05:23:54,444] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_04_model_states.pt...
[2024-05-30 05:23:55,493] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_04_model_states.pt.
[2024-05-30 05:23:55,493] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step690 is ready now!
[2024-05-30 05:23:55,912] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_04-model_states.pt.
[2024-05-30 05:23:55,997] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_02-model_states.pt.
[2024-05-30 05:23:56,533] [INFO] [logging.py:96:log_dist] [Rank 1] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_01_model_states.pt
[2024-05-30 05:23:56,533] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_01_model_states.pt...
[2024-05-30 05:23:56,643] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_03_model_states.pt...
[2024-05-30 05:23:58,089] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_01_model_states.pt.
[2024-05-30 05:23:58,090] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step690 is ready now!
[2024-05-30 05:23:58,164] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_03_model_states.pt.
[2024-05-30 05:23:58,164] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step690 is ready now!
[2024-05-30 05:23:59,140] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/layer_01-model_states.pt.
[2024-05-30 05:24:00,096] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_00_model_states.pt
[2024-05-30 05:24:00,096] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_00_model_states.pt...
[2024-05-30 05:24:03,654] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint/global_step690/mp_rank_00_model_states.pt.
[2024-05-30 05:24:03,654] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step690 is ready now!
Checkpoint saved using --- 450.0921664237976 seconds ---
 13%|█▎        | 70/520 [7:30:51<124:13:38, 993.82s/it] 13%|█▎        | 70/520 [7:29:44<124:13:30, 993.80s/it] 13%|█▎        | 70/520 [7:26:03<124:13:09, 993.75s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_457
 13%|█▎        | 70/520 [7:29:13<124:13:17, 993.77s/it] 13%|█▎        | 70/520 [7:30:26<124:13:21, 993.78s/it] 13%|█▎        | 70/520 [7:30:51<124:13:55, 993.86s/it] 13%|█▎        | 70/520 [7:28:30<124:14:13, 993.90s/it] 13%|█▎        | 70/520 [7:30:45<124:19:02, 994.54s/it]Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:18<11:44, 78.30s/it][A[2024-05-30 05:25:23,898] [INFO] [logging.py:96:log_dist] [Rank 0] step=691, skipped=0, lr=[1.957030193377374e-05], mom=[(0.9, 0.999)]
steps: 691 loss: 0.4125 iter time (s): 79.715 samples/sec: 1.606

 10%|█         | 1/10 [01:19<11:59, 79.99s/it][A
 10%|█         | 1/10 [01:20<12:00, 80.02s/it][A
 10%|█         | 1/10 [01:20<12:01, 80.13s/it][A
 10%|█         | 1/10 [01:20<12:02, 80.28s/it][A
 10%|█         | 1/10 [01:20<12:02, 80.29s/it][A
 10%|█         | 1/10 [01:20<12:03, 80.34s/it][A
 10%|█         | 1/10 [01:20<12:03, 80.37s/it][A
 20%|██        | 2/10 [02:52<11:41, 87.65s/it][A[2024-05-30 05:26:58,085] [INFO] [logging.py:96:log_dist] [Rank 0] step=692, skipped=0, lr=[1.956865794844888e-05], mom=[(0.9, 0.999)]
steps: 692 loss: 0.3418 iter time (s): 93.451 samples/sec: 1.370

 20%|██        | 2/10 [02:54<11:46, 88.32s/it][A
 20%|██        | 2/10 [02:54<11:46, 88.34s/it][A
 20%|██        | 2/10 [02:54<11:46, 88.37s/it][A
 20%|██        | 2/10 [02:54<11:47, 88.39s/it][A
 20%|██        | 2/10 [02:54<11:47, 88.45s/it][A
 20%|██        | 2/10 [02:54<11:47, 88.46s/it][A
 20%|██        | 2/10 [02:54<11:47, 88.46s/it][A
 30%|███       | 3/10 [04:17<10:06, 86.67s/it][A[2024-05-30 05:28:23,594] [INFO] [logging.py:96:log_dist] [Rank 0] step=693, skipped=0, lr=[1.9567010893581858e-05], mom=[(0.9, 0.999)]
steps: 693 loss: 0.3210 iter time (s): 84.836 samples/sec: 1.509

 30%|███       | 3/10 [04:19<10:08, 86.99s/it][A
 30%|███       | 3/10 [04:19<10:09, 87.04s/it][A
 30%|███       | 3/10 [04:19<10:09, 87.07s/it][A
 30%|███       | 3/10 [04:19<10:09, 87.09s/it][A
 30%|███       | 3/10 [04:19<10:09, 87.10s/it][A
 30%|███       | 3/10 [04:19<10:09, 87.10s/it][A
 30%|███       | 3/10 [04:19<10:09, 87.11s/it][A
 40%|████      | 4/10 [05:36<08:20, 83.50s/it][A[2024-05-30 05:29:42,224] [INFO] [logging.py:96:log_dist] [Rank 0] step=694, skipped=0, lr=[1.956536076970108e-05], mom=[(0.9, 0.999)]
steps: 694 loss: 0.3280 iter time (s): 77.967 samples/sec: 1.642

 40%|████      | 4/10 [05:38<08:22, 83.72s/it][A
 40%|████      | 4/10 [05:38<08:22, 83.74s/it][A
 40%|████      | 4/10 [05:38<08:22, 83.75s/it][A
 40%|████      | 4/10 [05:38<08:22, 83.74s/it][A
 40%|████      | 4/10 [05:38<08:22, 83.76s/it][A
 40%|████      | 4/10 [05:38<08:22, 83.76s/it][A
 40%|████      | 4/10 [05:38<08:22, 83.76s/it][A
 50%|█████     | 5/10 [06:47<06:34, 78.97s/it][A[2024-05-30 05:30:53,181] [INFO] [logging.py:96:log_dist] [Rank 0] step=695, skipped=0, lr=[1.9563707577335952e-05], mom=[(0.9, 0.999)]
steps: 695 loss: 0.3197 iter time (s): 70.305 samples/sec: 1.821

 50%|█████     | 5/10 [06:49<06:35, 79.12s/it][A
 50%|█████     | 5/10 [06:49<06:35, 79.15s/it][A
 50%|█████     | 5/10 [06:49<06:35, 79.14s/it][A
 50%|█████     | 5/10 [06:49<06:35, 79.15s/it][A
 50%|█████     | 5/10 [06:49<06:35, 79.14s/it][A
 50%|█████     | 5/10 [06:49<06:35, 79.16s/it][A
 50%|█████     | 5/10 [06:49<06:35, 79.16s/it][A
 60%|██████    | 6/10 [07:51<04:55, 73.99s/it][A[2024-05-30 05:31:57,476] [INFO] [logging.py:96:log_dist] [Rank 0] step=696, skipped=0, lr=[1.9562051317016863e-05], mom=[(0.9, 0.999)]
steps: 696 loss: 0.3008 iter time (s): 63.602 samples/sec: 2.013

 60%|██████    | 6/10 [07:53<04:56, 74.07s/it][A
 60%|██████    | 6/10 [07:53<04:56, 74.08s/it][A
 60%|██████    | 6/10 [07:53<04:56, 74.10s/it][A
 60%|██████    | 6/10 [07:53<04:56, 74.11s/it][A
 60%|██████    | 6/10 [07:53<04:56, 74.10s/it][A
 60%|██████    | 6/10 [07:53<04:56, 74.10s/it][A
 60%|██████    | 6/10 [07:53<04:56, 74.12s/it][A
 70%|███████   | 7/10 [08:56<03:32, 70.98s/it][A[2024-05-30 05:33:02,281] [INFO] [logging.py:96:log_dist] [Rank 0] step=697, skipped=0, lr=[1.9560391989275175e-05], mom=[(0.9, 0.999)]
steps: 697 loss: 0.3185 iter time (s): 64.104 samples/sec: 1.997

 70%|███████   | 7/10 [08:58<03:33, 71.04s/it][A
 70%|███████   | 7/10 [08:58<03:33, 71.06s/it][A
 70%|███████   | 7/10 [08:58<03:33, 71.04s/it][A
 70%|███████   | 7/10 [08:58<03:33, 71.08s/it][A
 70%|███████   | 7/10 [08:58<03:33, 71.06s/it][A
 70%|███████   | 7/10 [08:58<03:33, 71.07s/it][A
 70%|███████   | 7/10 [08:58<03:33, 71.07s/it][A
 80%|████████  | 8/10 [10:02<02:18, 69.27s/it][A[2024-05-30 05:34:07,885] [INFO] [logging.py:96:log_dist] [Rank 0] step=698, skipped=0, lr=[1.9558729594643247e-05], mom=[(0.9, 0.999)]
steps: 698 loss: 0.3033 iter time (s): 64.906 samples/sec: 1.972

 80%|████████  | 8/10 [10:03<02:18, 69.32s/it][A
 80%|████████  | 8/10 [10:04<02:18, 69.32s/it][A
 80%|████████  | 8/10 [10:04<02:18, 69.32s/it][A
 80%|████████  | 8/10 [10:04<02:18, 69.31s/it][A
 80%|████████  | 8/10 [10:04<02:18, 69.32s/it][A
 80%|████████  | 8/10 [10:04<02:18, 69.33s/it][A
 80%|████████  | 8/10 [10:04<02:18, 69.32s/it][A
 90%|█████████ | 9/10 [11:06<01:07, 67.75s/it][A[2024-05-30 05:35:12,279] [INFO] [logging.py:96:log_dist] [Rank 0] step=699, skipped=0, lr=[1.9557064133654417e-05], mom=[(0.9, 0.999)]
steps: 699 loss: 0.2901 iter time (s): 63.704 samples/sec: 2.009

 90%|█████████ | 9/10 [11:08<01:07, 67.78s/it][A
 90%|█████████ | 9/10 [11:08<01:07, 67.79s/it][A
 90%|█████████ | 9/10 [11:08<01:07, 67.77s/it][A
 90%|█████████ | 9/10 [11:08<01:07, 67.77s/it][A
 90%|█████████ | 9/10 [11:08<01:07, 67.78s/it][A
 90%|█████████ | 9/10 [11:08<01:07, 67.78s/it][A
 90%|█████████ | 9/10 [11:08<01:07, 67.78s/it][A
100%|██████████| 10/10 [12:11<00:00, 66.93s/it][A100%|██████████| 10/10 [12:11<00:00, 73.18s/it]
 14%|█▎        | 71/520 [7:42:57<114:14:12, 915.93s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 05:36:17,383] [INFO] [logging.py:96:log_dist] [Rank 0] step=700, skipped=0, lr=[1.9555395606842998e-05], mom=[(0.9, 0.999)]
steps: 700 loss: 0.2887 iter time (s): 64.422 samples/sec: 1.987

100%|██████████| 10/10 [12:13<00:00, 66.95s/it][A100%|██████████| 10/10 [12:13<00:00, 73.34s/it]
 14%|█▎        | 71/520 [7:40:44<114:14:27, 915.96s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:13<00:00, 66.93s/it][A100%|██████████| 10/10 [12:13<00:00, 73.35s/it]
 14%|█▎        | 71/520 [7:43:06<114:14:24, 915.96s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:13<00:00, 66.94s/it][A100%|██████████| 10/10 [12:13<00:00, 73.36s/it]
 14%|█▎        | 71/520 [7:43:05<114:14:24, 915.96s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:13<00:00, 66.94s/it][A100%|██████████| 10/10 [12:13<00:00, 73.36s/it]
 14%|█▎        | 71/520 [7:41:58<114:14:28, 915.97s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:13<00:00, 66.95s/it][A100%|██████████| 10/10 [12:13<00:00, 73.38s/it]
 14%|█▎        | 71/520 [7:42:41<114:14:38, 915.99s/it]
100%|██████████| 10/10 [12:13<00:00, 66.95s/it][A100%|██████████| 10/10 [12:13<00:00, 73.38s/it]
 14%|█▎        | 71/520 [7:41:28<114:14:35, 915.98s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:13<00:00, 66.95s/it][A100%|██████████| 10/10 [12:13<00:00, 73.38s/it]
 14%|█▎        | 71/520 [7:38:17<114:14:33, 915.98s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_109
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:13<10:59, 73.26s/it][A[2024-05-30 05:37:31,072] [INFO] [logging.py:96:log_dist] [Rank 0] step=701, skipped=0, lr=[1.9553724014744304e-05], mom=[(0.9, 0.999)]
steps: 701 loss: 1.0617 iter time (s): 72.947 samples/sec: 1.755

 10%|█         | 1/10 [01:13<11:03, 73.75s/it][A
 10%|█         | 1/10 [01:13<11:03, 73.68s/it][A
 10%|█         | 1/10 [01:13<11:04, 73.83s/it][A
 10%|█         | 1/10 [01:13<11:04, 73.80s/it][A
 10%|█         | 1/10 [01:13<11:03, 73.74s/it][A
 10%|█         | 1/10 [01:13<11:03, 73.77s/it][A
 10%|█         | 1/10 [01:13<11:04, 73.79s/it][A
 20%|██        | 2/10 [02:29<09:59, 74.89s/it][A[2024-05-30 05:38:47,104] [INFO] [logging.py:96:log_dist] [Rank 0] step=702, skipped=0, lr=[1.955204935789462e-05], mom=[(0.9, 0.999)]
steps: 702 loss: 1.0959 iter time (s): 75.289 samples/sec: 1.700

 20%|██        | 2/10 [02:29<10:00, 75.10s/it][A
 20%|██        | 2/10 [02:29<10:00, 75.10s/it][A
 20%|██        | 2/10 [02:29<10:00, 75.07s/it][A
 20%|██        | 2/10 [02:29<10:00, 75.08s/it][A
 20%|██        | 2/10 [02:29<10:00, 75.08s/it][A
 20%|██        | 2/10 [02:29<10:00, 75.09s/it][A
 20%|██        | 2/10 [02:29<10:00, 75.09s/it][A
 30%|███       | 3/10 [03:44<08:45, 75.04s/it][A[2024-05-30 05:40:02,300] [INFO] [logging.py:96:log_dist] [Rank 0] step=703, skipped=0, lr=[1.9550371636831217e-05], mom=[(0.9, 0.999)]
steps: 703 loss: 1.0576 iter time (s): 74.473 samples/sec: 1.719

 30%|███       | 3/10 [03:44<08:45, 75.12s/it][A
 30%|███       | 3/10 [03:44<08:45, 75.11s/it][A
 30%|███       | 3/10 [03:44<08:45, 75.13s/it][A
 30%|███       | 3/10 [03:44<08:45, 75.14s/it][A
 30%|███       | 3/10 [03:44<08:45, 75.11s/it][A
 30%|███       | 3/10 [03:44<08:45, 75.11s/it][A
 30%|███       | 3/10 [03:44<08:45, 75.12s/it][A
 40%|████      | 4/10 [05:00<07:31, 75.26s/it][A[2024-05-30 05:41:17,924] [INFO] [logging.py:96:log_dist] [Rank 0] step=704, skipped=0, lr=[1.9548690852092347e-05], mom=[(0.9, 0.999)]
steps: 704 loss: 1.0769 iter time (s): 74.975 samples/sec: 1.707

 40%|████      | 4/10 [05:00<07:31, 75.31s/it][A
 40%|████      | 4/10 [05:00<07:31, 75.33s/it][A
 40%|████      | 4/10 [05:00<07:31, 75.32s/it][A
 40%|████      | 4/10 [05:00<07:31, 75.30s/it][A
 40%|████      | 4/10 [05:00<07:32, 75.34s/it][A
 40%|████      | 4/10 [05:00<07:31, 75.31s/it][A
 40%|████      | 4/10 [05:00<07:31, 75.31s/it][A
 50%|█████     | 5/10 [06:15<06:16, 75.35s/it][A[2024-05-30 05:42:33,414] [INFO] [logging.py:96:log_dist] [Rank 0] step=705, skipped=0, lr=[1.9547007004217252e-05], mom=[(0.9, 0.999)]
steps: 705 loss: 1.0482 iter time (s): 74.830 samples/sec: 1.711

 50%|█████     | 5/10 [06:16<06:16, 75.40s/it][A
 50%|█████     | 5/10 [06:16<06:16, 75.40s/it][A
 50%|█████     | 5/10 [06:16<06:16, 75.39s/it][A
 50%|█████     | 5/10 [06:16<06:17, 75.40s/it][A
 50%|█████     | 5/10 [06:16<06:16, 75.39s/it][A
 50%|█████     | 5/10 [06:16<06:16, 75.40s/it][A
 50%|█████     | 5/10 [06:16<06:16, 75.40s/it][A
 60%|██████    | 6/10 [07:31<05:01, 75.45s/it][A[2024-05-30 05:43:49,075] [INFO] [logging.py:96:log_dist] [Rank 0] step=706, skipped=0, lr=[1.9545320093746153e-05], mom=[(0.9, 0.999)]
steps: 706 loss: 1.0548 iter time (s): 74.944 samples/sec: 1.708

 60%|██████    | 6/10 [07:31<05:01, 75.45s/it][A
 60%|██████    | 6/10 [07:31<05:01, 75.46s/it][A
 60%|██████    | 6/10 [07:31<05:01, 75.46s/it][A
 60%|██████    | 6/10 [07:31<05:01, 75.47s/it][A
 60%|██████    | 6/10 [07:31<05:01, 75.48s/it][A
 60%|██████    | 6/10 [07:31<05:01, 75.49s/it][A
 60%|██████    | 6/10 [07:31<05:01, 75.49s/it][A
 70%|███████   | 7/10 [08:46<03:46, 75.35s/it][A[2024-05-30 05:45:04,219] [INFO] [logging.py:96:log_dist] [Rank 0] step=707, skipped=0, lr=[1.9543630121220246e-05], mom=[(0.9, 0.999)]
steps: 707 loss: 1.0637 iter time (s): 74.421 samples/sec: 1.720

 70%|███████   | 7/10 [08:46<03:46, 75.40s/it][A
 70%|███████   | 7/10 [08:46<03:46, 75.40s/it][A
 70%|███████   | 7/10 [08:46<03:46, 75.40s/it][A
 70%|███████   | 7/10 [08:46<03:46, 75.40s/it][A
 70%|███████   | 7/10 [08:47<03:46, 75.43s/it][A
 70%|███████   | 7/10 [08:47<03:46, 75.56s/it][A
 70%|███████   | 7/10 [08:47<03:47, 75.70s/it][A
 80%|████████  | 8/10 [10:01<02:30, 75.34s/it][A[2024-05-30 05:46:19,523] [INFO] [logging.py:96:log_dist] [Rank 0] step=708, skipped=0, lr=[1.954193708718172e-05], mom=[(0.9, 0.999)]
steps: 708 loss: 1.0653 iter time (s): 73.574 samples/sec: 1.740

 80%|████████  | 8/10 [10:02<02:30, 75.34s/it][A
 80%|████████  | 8/10 [10:02<02:30, 75.36s/it][A
 80%|████████  | 8/10 [10:02<02:30, 75.35s/it][A
 80%|████████  | 8/10 [10:02<02:30, 75.34s/it][A
 80%|████████  | 8/10 [10:02<02:30, 75.36s/it][A
 80%|████████  | 8/10 [10:02<02:30, 75.30s/it][A
 80%|████████  | 8/10 [10:02<02:30, 75.26s/it][A
 90%|█████████ | 9/10 [11:15<01:14, 74.88s/it][A[2024-05-30 05:47:33,407] [INFO] [logging.py:96:log_dist] [Rank 0] step=709, skipped=0, lr=[1.9540240992173746e-05], mom=[(0.9, 0.999)]
steps: 709 loss: 1.0901 iter time (s): 73.173 samples/sec: 1.749

 90%|█████████ | 9/10 [11:16<01:14, 74.91s/it][A
 90%|█████████ | 9/10 [11:16<01:14, 74.90s/it][A
 90%|█████████ | 9/10 [11:16<01:14, 74.90s/it][A
 90%|█████████ | 9/10 [11:16<01:14, 74.89s/it][A
 90%|█████████ | 9/10 [11:16<01:14, 74.90s/it][A
 90%|█████████ | 9/10 [11:16<01:14, 74.86s/it][A
 90%|█████████ | 9/10 [11:16<01:14, 74.83s/it][A
100%|██████████| 10/10 [12:30<00:00, 74.92s/it][A100%|██████████| 10/10 [12:30<00:00, 75.06s/it]
 14%|█▍        | 72/520 [7:55:28<107:49:04, 866.39s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 05:48:48,401] [INFO] [logging.py:96:log_dist] [Rank 0] step=710, skipped=0, lr=[1.953854183674047e-05], mom=[(0.9, 0.999)]
steps: 710 loss: 1.0446 iter time (s): 74.312 samples/sec: 1.722

100%|██████████| 10/10 [12:31<00:00, 74.92s/it][A100%|██████████| 10/10 [12:31<00:00, 75.11s/it]
 14%|█▍        | 72/520 [7:53:15<107:49:54, 866.51s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:31<00:00, 74.96s/it][A100%|██████████| 10/10 [12:31<00:00, 75.12s/it]
 14%|█▍        | 72/520 [7:55:37<107:50:09, 866.54s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:31<00:00, 74.95s/it][A100%|██████████| 10/10 [12:31<00:00, 75.12s/it]
 14%|█▍        | 72/520 [7:55:36<107:50:11, 866.54s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:31<00:00, 74.93s/it][A100%|██████████| 10/10 [12:31<00:00, 75.12s/it]
 14%|█▍        | 72/520 [7:54:30<107:50:10, 866.54s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:31<00:00, 74.95s/it][A100%|██████████| 10/10 [12:31<00:00, 75.11s/it]
 14%|█▍        | 72/520 [7:55:12<107:50:14, 866.55s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [12:31<00:00, 74.93s/it][A100%|██████████| 10/10 [12:31<00:00, 75.12s/it]
 14%|█▍        | 72/520 [7:53:59<107:50:17, 866.56s/it]
100%|██████████| 10/10 [12:31<00:00, 74.90s/it][A100%|██████████| 10/10 [12:31<00:00, 75.12s/it]
 14%|█▍        | 72/520 [7:50:49<107:50:14, 866.55s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_228

  0%|          | 0/10 [00:00<?, ?it/s][ATraining on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [00:57<08:39, 57.70s/it][A[2024-05-30 05:49:45,815] [INFO] [logging.py:96:log_dist] [Rank 0] step=711, skipped=0, lr=[1.9536839621427022e-05], mom=[(0.9, 0.999)]
steps: 711 loss: 0.7024 iter time (s): 56.492 samples/sec: 2.266

 10%|█         | 1/10 [00:57<08:35, 57.25s/it][A
 10%|█         | 1/10 [00:57<08:35, 57.30s/it][A
 10%|█         | 1/10 [00:57<08:34, 57.22s/it][A
 10%|█         | 1/10 [00:57<08:35, 57.29s/it][A
 10%|█         | 1/10 [00:57<08:34, 57.21s/it][A
 10%|█         | 1/10 [00:57<08:34, 57.19s/it][A
 10%|█         | 1/10 [00:57<08:34, 57.21s/it][A
 20%|██        | 2/10 [01:55<07:42, 57.82s/it][A[2024-05-30 05:50:43,752] [INFO] [logging.py:96:log_dist] [Rank 0] step=712, skipped=0, lr=[1.9535134346779515e-05], mom=[(0.9, 0.999)]
steps: 712 loss: 0.6406 iter time (s): 57.325 samples/sec: 2.233

 20%|██        | 2/10 [01:55<07:41, 57.74s/it][A
 20%|██        | 2/10 [01:55<07:41, 57.65s/it][A
 20%|██        | 2/10 [01:55<07:41, 57.64s/it][A
 20%|██        | 2/10 [01:55<07:41, 57.64s/it][A
 20%|██        | 2/10 [01:55<07:41, 57.72s/it][A
 20%|██        | 2/10 [01:55<07:41, 57.65s/it][A
 20%|██        | 2/10 [01:55<07:41, 57.66s/it][A
 30%|███       | 3/10 [02:55<06:51, 58.82s/it][A[2024-05-30 05:51:43,717] [INFO] [logging.py:96:log_dist] [Rank 0] step=713, skipped=0, lr=[1.9533426013345048e-05], mom=[(0.9, 0.999)]
steps: 713 loss: 0.6587 iter time (s): 59.314 samples/sec: 2.158

 30%|███       | 3/10 [02:55<06:51, 58.76s/it][A
 30%|███       | 3/10 [02:55<06:50, 58.70s/it][A
 30%|███       | 3/10 [02:55<06:50, 58.71s/it][A
 30%|███       | 3/10 [02:55<06:51, 58.74s/it][A
 30%|███       | 3/10 [02:55<06:51, 58.78s/it][A
 30%|███       | 3/10 [02:55<06:51, 58.78s/it][A
 30%|███       | 3/10 [02:55<06:51, 58.78s/it][A
 40%|████      | 4/10 [03:52<05:48, 58.16s/it][A[2024-05-30 05:52:40,878] [INFO] [logging.py:96:log_dist] [Rank 0] step=714, skipped=0, lr=[1.9531714621671693e-05], mom=[(0.9, 0.999)]
steps: 714 loss: 0.6258 iter time (s): 56.385 samples/sec: 2.270

 40%|████      | 4/10 [03:52<05:48, 58.13s/it][A
 40%|████      | 4/10 [03:52<05:48, 58.09s/it][A
 40%|████      | 4/10 [03:52<05:48, 58.10s/it][A
 40%|████      | 4/10 [03:52<05:48, 58.11s/it][A
 40%|████      | 4/10 [03:52<05:48, 58.07s/it][A
 40%|████      | 4/10 [03:52<05:48, 58.09s/it][A
 40%|████      | 4/10 [03:52<05:48, 58.08s/it][A
 50%|█████     | 5/10 [04:52<04:53, 58.77s/it][A[2024-05-30 05:53:40,731] [INFO] [logging.py:96:log_dist] [Rank 0] step=715, skipped=0, lr=[1.953000017230851e-05], mom=[(0.9, 0.999)]
steps: 715 loss: 0.6469 iter time (s): 59.211 samples/sec: 2.162

 50%|█████     | 5/10 [04:52<04:53, 58.74s/it][A
 50%|█████     | 5/10 [04:52<04:53, 58.73s/it][A
 50%|█████     | 5/10 [04:52<04:53, 58.72s/it][A
 50%|█████     | 5/10 [04:52<04:53, 58.73s/it][A
 50%|█████     | 5/10 [04:52<04:53, 58.71s/it][A
 50%|█████     | 5/10 [04:52<04:53, 58.71s/it][A
 50%|█████     | 5/10 [04:52<04:53, 58.71s/it][A
 60%|██████    | 6/10 [05:49<03:52, 58.10s/it][A[2024-05-30 05:54:37,507] [INFO] [logging.py:96:log_dist] [Rank 0] step=716, skipped=0, lr=[1.9528282665805523e-05], mom=[(0.9, 0.999)]
steps: 716 loss: 0.6375 iter time (s): 56.176 samples/sec: 2.279

 60%|██████    | 6/10 [05:49<03:52, 58.07s/it][A
 60%|██████    | 6/10 [05:48<03:52, 58.05s/it][A
 60%|██████    | 6/10 [05:48<03:52, 58.04s/it][A
 60%|██████    | 6/10 [05:48<03:52, 58.06s/it][A
 60%|██████    | 6/10 [05:48<03:52, 58.05s/it][A
 60%|██████    | 6/10 [05:48<03:52, 58.05s/it][A
 60%|██████    | 6/10 [05:48<03:52, 58.05s/it][A
 70%|███████   | 7/10 [06:46<02:53, 57.72s/it][A[2024-05-30 05:55:34,476] [INFO] [logging.py:96:log_dist] [Rank 0] step=717, skipped=0, lr=[1.9526562102713776e-05], mom=[(0.9, 0.999)]
steps: 717 loss: 0.6819 iter time (s): 56.351 samples/sec: 2.271

 70%|███████   | 7/10 [06:45<02:53, 57.69s/it][A
 70%|███████   | 7/10 [06:45<02:53, 57.71s/it][A
 70%|███████   | 7/10 [06:45<02:53, 57.69s/it][A
 70%|███████   | 7/10 [06:45<02:53, 57.67s/it][A
 70%|███████   | 7/10 [06:45<02:53, 57.68s/it][A
 70%|███████   | 7/10 [06:45<02:53, 57.68s/it][A
 70%|███████   | 7/10 [06:45<02:53, 57.69s/it][A
 80%|████████  | 8/10 [07:42<01:54, 57.34s/it][A[2024-05-30 05:56:30,988] [INFO] [logging.py:96:log_dist] [Rank 0] step=718, skipped=0, lr=[1.9524838483585245e-05], mom=[(0.9, 0.999)]
steps: 718 loss: 0.6143 iter time (s): 55.932 samples/sec: 2.288

 80%|████████  | 8/10 [07:42<01:54, 57.31s/it][A
 80%|████████  | 8/10 [07:42<01:54, 57.32s/it][A
 80%|████████  | 8/10 [07:42<01:54, 57.32s/it][A
 80%|████████  | 8/10 [07:42<01:54, 57.32s/it][A
 80%|████████  | 8/10 [07:42<01:54, 57.35s/it][A
 80%|████████  | 8/10 [07:42<01:54, 57.32s/it][A
 80%|████████  | 8/10 [07:42<01:54, 57.33s/it][A
 90%|█████████ | 9/10 [08:38<00:56, 56.94s/it][A[2024-05-30 05:57:27,061] [INFO] [logging.py:96:log_dist] [Rank 0] step=719, skipped=0, lr=[1.9523111808972924e-05], mom=[(0.9, 0.999)]
steps: 719 loss: 0.6313 iter time (s): 55.468 samples/sec: 2.308

 90%|█████████ | 9/10 [08:38<00:56, 56.93s/it][A
 90%|█████████ | 9/10 [08:38<00:56, 56.96s/it][A
 90%|█████████ | 9/10 [08:38<00:56, 56.95s/it][A
 90%|█████████ | 9/10 [08:38<00:56, 56.94s/it][A
 90%|█████████ | 9/10 [08:38<00:56, 56.94s/it][A
 90%|█████████ | 9/10 [08:38<00:56, 56.95s/it][A
 90%|█████████ | 9/10 [08:38<00:56, 56.94s/it][A
100%|██████████| 10/10 [09:37<00:00, 57.44s/it][A100%|██████████| 10/10 [09:37<00:00, 57.75s/it]
 14%|█▍        | 73/520 [8:05:06<96:49:30, 779.80s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 05:58:25,632] [INFO] [logging.py:96:log_dist] [Rank 0] step=720, skipped=0, lr=[1.9521382079430765e-05], mom=[(0.9, 0.999)]
steps: 720 loss: 0.6529 iter time (s): 57.911 samples/sec: 2.210

100%|██████████| 10/10 [09:37<00:00, 57.44s/it][A100%|██████████| 10/10 [09:37<00:00, 57.71s/it]
 14%|█▍        | 73/520 [8:02:52<96:48:53, 779.72s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:37<00:00, 57.43s/it][A100%|██████████| 10/10 [09:37<00:00, 57.70s/it]
 14%|█▍        | 73/520 [8:05:14<96:48:49, 779.71s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:37<00:00, 57.46s/it][A100%|██████████| 10/10 [09:37<00:00, 57.71s/it]
 14%|█▍        | 73/520 [8:05:13<96:49:01, 779.74s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:37<00:00, 57.44s/it][A100%|██████████| 10/10 [09:37<00:00, 57.71s/it]
 14%|█▍        | 73/520 [8:04:07<96:48:58, 779.73s/it] 
100%|██████████| 10/10 [09:37<00:00, 57.43s/it][A100%|██████████| 10/10 [09:37<00:00, 57.70s/it]
 14%|█▍        | 73/520 [8:04:49<96:48:48, 779.71s/it] 

  0%|          | 0/10 [00:00<?, ?it/s][A  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:37<00:00, 57.44s/it][A100%|██████████| 10/10 [09:37<00:00, 57.70s/it]
 14%|█▍        | 73/520 [8:03:36<96:48:52, 779.72s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:37<00:00, 57.43s/it][A100%|██████████| 10/10 [09:37<00:00, 57.70s/it]
 14%|█▍        | 73/520 [8:00:26<96:48:50, 779.71s/it] Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_304
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:23<12:27, 83.08s/it][A[2024-05-30 05:59:49,589] [INFO] [logging.py:96:log_dist] [Rank 0] step=721, skipped=0, lr=[1.9519649295513715e-05], mom=[(0.9, 0.999)]
steps: 721 loss: 0.6272 iter time (s): 83.253 samples/sec: 1.537

 10%|█         | 1/10 [01:23<12:35, 83.97s/it][A
 10%|█         | 1/10 [01:24<12:36, 84.02s/it][A
 10%|█         | 1/10 [01:23<12:35, 83.98s/it][A
 10%|█         | 1/10 [01:24<12:36, 84.03s/it][A
 10%|█         | 1/10 [01:24<12:36, 84.05s/it][A
 10%|█         | 1/10 [01:24<12:36, 84.04s/it][A
 10%|█         | 1/10 [01:24<12:36, 84.05s/it][A
 20%|██        | 2/10 [02:46<11:06, 83.32s/it][A[2024-05-30 06:01:13,077] [INFO] [logging.py:96:log_dist] [Rank 0] step=722, skipped=0, lr=[1.9517913457777686e-05], mom=[(0.9, 0.999)]
steps: 722 loss: 0.6146 iter time (s): 82.759 samples/sec: 1.547

 20%|██        | 2/10 [02:47<11:09, 83.69s/it][A
 20%|██        | 2/10 [02:47<11:09, 83.72s/it][A
 20%|██        | 2/10 [02:47<11:09, 83.66s/it][A
 20%|██        | 2/10 [02:47<11:09, 83.70s/it][A
 20%|██        | 2/10 [02:47<11:09, 83.74s/it][A
 20%|██        | 2/10 [02:47<11:09, 83.73s/it][A
 20%|██        | 2/10 [02:47<11:09, 83.73s/it][A
 30%|███       | 3/10 [04:09<09:41, 83.13s/it][A[2024-05-30 06:02:35,969] [INFO] [logging.py:96:log_dist] [Rank 0] step=723, skipped=0, lr=[1.9516174566779588e-05], mom=[(0.9, 0.999)]
steps: 723 loss: 0.5987 iter time (s): 82.161 samples/sec: 1.558

 30%|███       | 3/10 [04:10<09:43, 83.33s/it][A
 30%|███       | 3/10 [04:10<09:43, 83.35s/it][A
 30%|███       | 3/10 [04:10<09:43, 83.31s/it][A
 30%|███       | 3/10 [04:10<09:43, 83.32s/it][A
 30%|███       | 3/10 [04:10<09:43, 83.35s/it][A
 30%|███       | 3/10 [04:10<09:43, 83.35s/it][A
 30%|███       | 3/10 [04:10<09:43, 83.35s/it][A
 40%|████      | 4/10 [05:32<08:17, 82.95s/it][A[2024-05-30 06:03:58,631] [INFO] [logging.py:96:log_dist] [Rank 0] step=724, skipped=0, lr=[1.951443262307729e-05], mom=[(0.9, 0.999)]
steps: 724 loss: 0.5918 iter time (s): 81.908 samples/sec: 1.563

 40%|████      | 4/10 [05:33<08:18, 83.07s/it][A
 40%|████      | 4/10 [05:33<08:18, 83.09s/it][A
 40%|████      | 4/10 [05:32<08:18, 83.06s/it][A
 40%|████      | 4/10 [05:33<08:18, 83.08s/it][A
 40%|████      | 4/10 [05:33<08:18, 83.09s/it][A
 40%|████      | 4/10 [05:33<08:18, 83.10s/it][A
 40%|████      | 4/10 [05:33<08:18, 83.10s/it][A
 50%|█████     | 5/10 [06:54<06:54, 82.90s/it][A[2024-05-30 06:05:21,456] [INFO] [logging.py:96:log_dist] [Rank 0] step=725, skipped=0, lr=[1.9512687627229657e-05], mom=[(0.9, 0.999)]
steps: 725 loss: 0.5916 iter time (s): 82.025 samples/sec: 1.560

 50%|█████     | 5/10 [06:55<06:54, 82.98s/it][A
 50%|█████     | 5/10 [06:55<06:54, 82.99s/it][A
 50%|█████     | 5/10 [06:55<06:54, 82.99s/it][A
 50%|█████     | 5/10 [06:55<06:54, 82.99s/it][A
 50%|█████     | 5/10 [06:56<06:55, 83.01s/it][A
 50%|█████     | 5/10 [06:55<06:54, 83.00s/it][A
 50%|█████     | 5/10 [06:55<06:54, 83.00s/it][A
 60%|██████    | 6/10 [08:18<05:32, 83.04s/it][A[2024-05-30 06:06:44,777] [INFO] [logging.py:96:log_dist] [Rank 0] step=726, skipped=0, lr=[1.9510939579796526e-05], mom=[(0.9, 0.999)]
steps: 726 loss: 0.5908 iter time (s): 82.583 samples/sec: 1.550

 60%|██████    | 6/10 [08:19<05:32, 83.13s/it][A
 60%|██████    | 6/10 [08:19<05:32, 83.10s/it][A
 60%|██████    | 6/10 [08:19<05:32, 83.10s/it][A
 60%|██████    | 6/10 [08:19<05:32, 83.12s/it][A
 60%|██████    | 6/10 [08:19<05:32, 83.10s/it][A
 60%|██████    | 6/10 [08:19<05:32, 83.12s/it][A
 60%|██████    | 6/10 [08:19<05:32, 83.11s/it][A
 70%|███████   | 7/10 [09:41<04:09, 83.09s/it][A[2024-05-30 06:08:07,563] [INFO] [logging.py:96:log_dist] [Rank 0] step=727, skipped=0, lr=[1.9509188481338714e-05], mom=[(0.9, 0.999)]
steps: 727 loss: 0.5772 iter time (s): 81.994 samples/sec: 1.561

 70%|███████   | 7/10 [09:41<04:08, 83.00s/it][A
 70%|███████   | 7/10 [09:41<04:08, 82.98s/it][A
 70%|███████   | 7/10 [09:41<04:08, 82.99s/it][A
 70%|███████   | 7/10 [09:42<04:09, 83.01s/it][A
 70%|███████   | 7/10 [09:42<04:09, 83.00s/it][A
 70%|███████   | 7/10 [09:42<04:09, 83.01s/it][A
 70%|███████   | 7/10 [09:42<04:09, 83.01s/it][A
 80%|████████  | 8/10 [11:03<02:45, 82.84s/it][A[2024-05-30 06:09:30,255] [INFO] [logging.py:96:log_dist] [Rank 0] step=728, skipped=0, lr=[1.9507434332418014e-05], mom=[(0.9, 0.999)]
steps: 728 loss: 0.5659 iter time (s): 81.879 samples/sec: 1.563

 80%|████████  | 8/10 [11:04<02:45, 82.90s/it][A
 80%|████████  | 8/10 [11:04<02:45, 82.91s/it][A
 80%|████████  | 8/10 [11:04<02:45, 82.88s/it][A
 80%|████████  | 8/10 [11:04<02:45, 82.88s/it][A
 80%|████████  | 8/10 [11:04<02:45, 82.89s/it][A
 80%|████████  | 8/10 [11:04<02:45, 82.89s/it][A
 80%|████████  | 8/10 [11:04<02:45, 82.89s/it][A
 90%|█████████ | 9/10 [12:25<01:22, 82.64s/it][A[2024-05-30 06:10:52,482] [INFO] [logging.py:96:log_dist] [Rank 0] step=729, skipped=0, lr=[1.9505677133597203e-05], mom=[(0.9, 0.999)]
steps: 729 loss: 0.5872 iter time (s): 81.475 samples/sec: 1.571

 90%|█████████ | 9/10 [12:26<01:22, 82.70s/it][A
 90%|█████████ | 9/10 [12:26<01:22, 82.66s/it][A
 90%|█████████ | 9/10 [12:26<01:22, 82.70s/it][A
 90%|█████████ | 9/10 [12:26<01:22, 82.68s/it][A
 90%|█████████ | 9/10 [12:26<01:22, 82.66s/it][A
 90%|█████████ | 9/10 [12:26<01:22, 82.68s/it][A
 90%|█████████ | 9/10 [12:26<01:22, 82.68s/it][A
100%|██████████| 10/10 [13:47<00:00, 82.40s/it][A100%|██████████| 10/10 [13:47<00:00, 82.78s/it]
 14%|█▍        | 74/520 [8:18:54<98:23:56, 794.25s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 06:12:14,308] [INFO] [logging.py:96:log_dist] [Rank 0] step=730, skipped=0, lr=[1.9503916885440035e-05], mom=[(0.9, 0.999)]
steps: 730 loss: 0.5845 iter time (s): 81.094 samples/sec: 1.578

100%|██████████| 10/10 [13:48<00:00, 82.41s/it][A100%|██████████| 10/10 [13:48<00:00, 82.87s/it]
 14%|█▍        | 74/520 [8:16:41<98:25:09, 794.42s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:48<00:00, 82.45s/it][A100%|██████████| 10/10 [13:48<00:00, 82.88s/it]
 14%|█▍        | 74/520 [8:19:03<98:25:23, 794.45s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:48<00:00, 82.43s/it][A100%|██████████| 10/10 [13:48<00:00, 82.87s/it]
 14%|█▍        | 74/520 [8:19:02<98:25:15, 794.43s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:48<00:00, 82.43s/it][A100%|██████████| 10/10 [13:48<00:00, 82.88s/it]
 14%|█▍        | 74/520 [8:17:55<98:25:22, 794.44s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:48<00:00, 82.43s/it][A100%|██████████| 10/10 [13:48<00:00, 82.88s/it]
 14%|█▍        | 74/520 [8:18:38<98:25:22, 794.45s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:48<00:00, 82.43s/it][A100%|██████████| 10/10 [13:48<00:00, 82.88s/it]
 14%|█▍        | 74/520 [8:17:25<98:25:25, 794.45s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [13:48<00:00, 82.43s/it][A100%|██████████| 10/10 [13:48<00:00, 82.88s/it]
 14%|█▍        | 74/520 [8:14:15<98:25:25, 794.45s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_201
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [00:59<08:58, 59.83s/it][A[2024-05-30 06:13:13,694] [INFO] [logging.py:96:log_dist] [Rank 0] step=731, skipped=0, lr=[1.950215358851124e-05], mom=[(0.9, 0.999)]
steps: 731 loss: 0.6073 iter time (s): 58.472 samples/sec: 2.189

 10%|█         | 1/10 [00:59<08:53, 59.32s/it][A
 10%|█         | 1/10 [00:59<08:52, 59.21s/it][A
 10%|█         | 1/10 [00:59<08:53, 59.27s/it][A
 10%|█         | 1/10 [00:59<08:53, 59.25s/it][A
 10%|█         | 1/10 [00:59<08:53, 59.24s/it][A
 10%|█         | 1/10 [00:59<08:52, 59.22s/it][A
 10%|█         | 1/10 [00:59<08:52, 59.21s/it][A
 20%|██        | 2/10 [01:56<07:44, 58.03s/it][A[2024-05-30 06:14:10,467] [INFO] [logging.py:96:log_dist] [Rank 0] step=732, skipped=0, lr=[1.9500387243376528e-05], mom=[(0.9, 0.999)]
steps: 732 loss: 0.6024 iter time (s): 56.144 samples/sec: 2.280

 20%|██        | 2/10 [01:56<07:42, 57.85s/it][A
 20%|██        | 2/10 [01:56<07:42, 57.81s/it][A
 20%|██        | 2/10 [01:56<07:42, 57.82s/it][A
 20%|██        | 2/10 [01:56<07:42, 57.85s/it][A
 20%|██        | 2/10 [01:56<07:42, 57.84s/it][A
 20%|██        | 2/10 [01:56<07:42, 57.81s/it][A
 20%|██        | 2/10 [01:56<07:42, 57.83s/it][A
 30%|███       | 3/10 [02:53<06:42, 57.46s/it][A[2024-05-30 06:15:07,213] [INFO] [logging.py:96:log_dist] [Rank 0] step=733, skipped=0, lr=[1.9498617850602584e-05], mom=[(0.9, 0.999)]
steps: 733 loss: 0.6127 iter time (s): 56.004 samples/sec: 2.286

 30%|███       | 3/10 [02:52<06:41, 57.32s/it][A
 30%|███       | 3/10 [02:52<06:41, 57.30s/it][A
 30%|███       | 3/10 [02:52<06:41, 57.31s/it][A
 30%|███       | 3/10 [02:52<06:40, 57.27s/it][A
 30%|███       | 3/10 [02:52<06:41, 57.29s/it][A
 30%|███       | 3/10 [02:52<06:40, 57.27s/it][A
 30%|███       | 3/10 [02:52<06:40, 57.26s/it][A
 40%|████      | 4/10 [03:52<05:48, 58.14s/it][A[2024-05-30 06:16:06,192] [INFO] [logging.py:96:log_dist] [Rank 0] step=734, skipped=0, lr=[1.949684541075708e-05], mom=[(0.9, 0.999)]
steps: 734 loss: 0.6469 iter time (s): 58.420 samples/sec: 2.191

 40%|████      | 4/10 [03:51<05:47, 57.98s/it][A
 40%|████      | 4/10 [03:51<05:47, 57.97s/it][A
 40%|████      | 4/10 [03:51<05:47, 57.97s/it][A
 40%|████      | 4/10 [03:51<05:47, 57.95s/it][A
 40%|████      | 4/10 [03:51<05:47, 57.99s/it][A
 40%|████      | 4/10 [03:51<05:47, 57.97s/it][A
 40%|████      | 4/10 [03:51<05:47, 57.96s/it][A
 50%|█████     | 5/10 [04:48<04:47, 57.52s/it][A[2024-05-30 06:17:02,582] [INFO] [logging.py:96:log_dist] [Rank 0] step=735, skipped=0, lr=[1.9495069924408652e-05], mom=[(0.9, 0.999)]
steps: 735 loss: 0.6086 iter time (s): 55.764 samples/sec: 2.295

 50%|█████     | 5/10 [04:48<04:47, 57.43s/it][A
 50%|█████     | 5/10 [04:48<04:47, 57.41s/it][A
 50%|█████     | 5/10 [04:48<04:46, 57.39s/it][A
 50%|█████     | 5/10 [04:48<04:46, 57.40s/it][A
 50%|█████     | 5/10 [04:48<04:47, 57.40s/it][A
 50%|█████     | 5/10 [04:48<04:47, 57.40s/it][A
 50%|█████     | 5/10 [04:48<04:46, 57.40s/it][A
 60%|██████    | 6/10 [05:46<03:49, 57.42s/it][A[2024-05-30 06:18:00,098] [INFO] [logging.py:96:log_dist] [Rank 0] step=736, skipped=0, lr=[1.949329139212692e-05], mom=[(0.9, 0.999)]
steps: 736 loss: 0.5614 iter time (s): 56.889 samples/sec: 2.250

 60%|██████    | 6/10 [05:45<03:49, 57.44s/it][A
 60%|██████    | 6/10 [05:45<03:49, 57.41s/it][A
 60%|██████    | 6/10 [05:45<03:49, 57.45s/it][A
 60%|██████    | 6/10 [05:45<03:49, 57.42s/it][A
 60%|██████    | 6/10 [05:45<03:49, 57.43s/it][A
 60%|██████    | 6/10 [05:45<03:49, 57.44s/it][A
 60%|██████    | 6/10 [05:45<03:49, 57.44s/it][A
 70%|███████   | 7/10 [06:43<02:52, 57.49s/it][A[2024-05-30 06:18:57,715] [INFO] [logging.py:96:log_dist] [Rank 0] step=737, skipped=0, lr=[1.9491509814482483e-05], mom=[(0.9, 0.999)]
steps: 737 loss: 0.6014 iter time (s): 56.978 samples/sec: 2.246

 70%|███████   | 7/10 [06:43<02:52, 57.49s/it][A
 70%|███████   | 7/10 [06:43<02:52, 57.51s/it][A
 70%|███████   | 7/10 [06:43<02:52, 57.49s/it][A
 70%|███████   | 7/10 [06:43<02:52, 57.50s/it][A

 70%|███████   | 7/10 [06:43<02:52, 57.50s/it][A 70%|███████   | 7/10 [06:43<02:52, 57.48s/it][A
 70%|███████   | 7/10 [06:43<02:52, 57.49s/it][A
 80%|████████  | 8/10 [07:42<01:55, 57.85s/it][A[2024-05-30 06:19:56,349] [INFO] [logging.py:96:log_dist] [Rank 0] step=738, skipped=0, lr=[1.948972519204692e-05], mom=[(0.9, 0.999)]
steps: 738 loss: 0.6514 iter time (s): 58.049 samples/sec: 2.205

 80%|████████  | 8/10 [07:42<01:55, 57.88s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.87s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.86s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.89s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.86s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.88s/it][A
 80%|████████  | 8/10 [07:41<01:55, 57.87s/it][A
 90%|█████████ | 9/10 [08:40<00:58, 58.06s/it][A[2024-05-30 06:20:54,860] [INFO] [logging.py:96:log_dist] [Rank 0] step=739, skipped=0, lr=[1.9487937525392773e-05], mom=[(0.9, 0.999)]
steps: 739 loss: 0.5750 iter time (s): 57.858 samples/sec: 2.212

 90%|█████████ | 9/10 [08:40<00:58, 58.06s/it][A
 90%|█████████ | 9/10 [08:40<00:58, 58.08s/it][A
 90%|█████████ | 9/10 [08:40<00:58, 58.07s/it][A
 90%|█████████ | 9/10 [08:40<00:58, 58.06s/it][A
 90%|█████████ | 9/10 [08:40<00:58, 58.05s/it][A
 90%|█████████ | 9/10 [08:40<00:58, 58.06s/it][A
 90%|█████████ | 9/10 [08:40<00:58, 58.06s/it][A
100%|██████████| 10/10 [09:38<00:00, 57.79s/it][A100%|██████████| 10/10 [09:38<00:00, 57.82s/it]
 14%|█▍        | 75/520 [8:28:32<90:10:31, 729.51s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 06:21:52,046] [INFO] [logging.py:96:log_dist] [Rank 0] step=740, skipped=0, lr=[1.9486146815093573e-05], mom=[(0.9, 0.999)]
steps: 740 loss: 0.6263 iter time (s): 56.575 samples/sec: 2.262

100%|██████████| 10/10 [09:37<00:00, 57.80s/it][A100%|██████████| 10/10 [09:37<00:00, 57.77s/it]
 14%|█▍        | 75/520 [8:26:19<90:09:49, 729.41s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:37<00:00, 57.78s/it][A100%|██████████| 10/10 [09:37<00:00, 57.76s/it]
 14%|█▍        | 75/520 [8:28:40<90:09:38, 729.39s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:37<00:00, 57.79s/it][A100%|██████████| 10/10 [09:37<00:00, 57.76s/it]
 14%|█▍        | 75/520 [8:28:39<90:09:36, 729.39s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:37<00:00, 57.79s/it][A100%|██████████| 10/10 [09:37<00:00, 57.76s/it]
 14%|█▍        | 75/520 [8:27:33<90:09:43, 729.40s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:37<00:00, 57.78s/it][A100%|██████████| 10/10 [09:37<00:00, 57.76s/it]
 14%|█▍        | 75/520 [8:28:15<90:09:38, 729.39s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:37<00:00, 57.78s/it][A100%|██████████| 10/10 [09:37<00:00, 57.75s/it]
 14%|█▍        | 75/520 [8:27:02<90:09:35, 729.38s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [09:37<00:00, 57.78s/it][A100%|██████████| 10/10 [09:37<00:00, 57.75s/it]
 14%|█▍        | 75/520 [8:23:52<90:09:34, 729.38s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_182
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:46<15:56, 106.23s/it][A[2024-05-30 06:23:39,783] [INFO] [logging.py:96:log_dist] [Rank 0] step=741, skipped=0, lr=[1.948435306172383e-05], mom=[(0.9, 0.999)]
steps: 741 loss: 0.6037 iter time (s): 107.022 samples/sec: 1.196

 10%|█         | 1/10 [01:47<16:09, 107.76s/it][A
 10%|█         | 1/10 [01:47<16:09, 107.76s/it][A
 10%|█         | 1/10 [01:47<16:10, 107.79s/it][A
 10%|█         | 1/10 [01:47<16:09, 107.77s/it][A
 10%|█         | 1/10 [01:47<16:10, 107.82s/it][A
 10%|█         | 1/10 [01:47<16:10, 107.85s/it][A
 10%|█         | 1/10 [01:47<16:10, 107.85s/it][A
 20%|██        | 2/10 [03:32<14:08, 106.03s/it][A[2024-05-30 06:25:25,664] [INFO] [logging.py:96:log_dist] [Rank 0] step=742, skipped=0, lr=[1.948255626585902e-05], mom=[(0.9, 0.999)]
steps: 742 loss: 0.6144 iter time (s): 105.180 samples/sec: 1.217

 20%|██        | 2/10 [03:33<14:13, 106.69s/it][A
 20%|██        | 2/10 [03:33<14:13, 106.69s/it][A
 20%|██        | 2/10 [03:33<14:13, 106.65s/it][A
 20%|██        | 2/10 [03:33<14:13, 106.73s/it][A
 20%|██        | 2/10 [03:33<14:13, 106.70s/it][A
 20%|██        | 2/10 [03:33<14:13, 106.71s/it][A
 20%|██        | 2/10 [03:33<14:13, 106.71s/it][A
 30%|███       | 3/10 [05:23<12:40, 108.67s/it][A[2024-05-30 06:27:17,488] [INFO] [logging.py:96:log_dist] [Rank 0] step=743, skipped=0, lr=[1.94807564280756e-05], mom=[(0.9, 0.999)]
steps: 743 loss: 0.6054 iter time (s): 111.089 samples/sec: 1.152

 30%|███       | 3/10 [05:25<12:42, 108.98s/it][A
 30%|███       | 3/10 [05:25<12:42, 108.97s/it][A
 30%|███       | 3/10 [05:25<12:43, 109.02s/it][A
 30%|███       | 3/10 [05:25<12:43, 109.01s/it][A
 30%|███       | 3/10 [05:25<12:43, 109.00s/it][A
 30%|███       | 3/10 [05:25<12:43, 109.02s/it][A
 30%|███       | 3/10 [05:25<12:43, 109.02s/it][A
 40%|████      | 4/10 [07:14<10:57, 109.52s/it][A[2024-05-30 06:29:07,927] [INFO] [logging.py:96:log_dist] [Rank 0] step=744, skipped=0, lr=[1.9478953548951004e-05], mom=[(0.9, 0.999)]
steps: 744 loss: 0.5873 iter time (s): 109.764 samples/sec: 1.166

 40%|████      | 4/10 [07:15<10:57, 109.58s/it][A
 40%|████      | 4/10 [07:15<10:57, 109.58s/it][A
 40%|████      | 4/10 [07:15<10:57, 109.58s/it][A
 40%|████      | 4/10 [07:15<10:57, 109.58s/it][A
 40%|████      | 4/10 [07:15<10:57, 109.59s/it][A
 40%|████      | 4/10 [07:15<10:57, 109.59s/it][A
 40%|████      | 4/10 [07:16<10:57, 109.60s/it][A
 50%|█████     | 5/10 [09:00<09:00, 108.06s/it][A[2024-05-30 06:30:53,771] [INFO] [logging.py:96:log_dist] [Rank 0] step=745, skipped=0, lr=[1.9477147629063637e-05], mom=[(0.9, 0.999)]
steps: 745 loss: 0.5919 iter time (s): 105.126 samples/sec: 1.218

 50%|█████     | 5/10 [09:01<09:01, 108.21s/it][A
 50%|█████     | 5/10 [09:01<09:01, 108.23s/it][A
 50%|█████     | 5/10 [09:01<09:01, 108.23s/it][A
 50%|█████     | 5/10 [09:01<09:01, 108.22s/it][A
 50%|█████     | 5/10 [09:01<09:01, 108.25s/it][A
 50%|█████     | 5/10 [09:01<09:01, 108.23s/it][A
 50%|█████     | 5/10 [09:01<09:01, 108.23s/it][A
 60%|██████    | 6/10 [10:43<07:06, 106.54s/it][A[2024-05-30 06:32:37,368] [INFO] [logging.py:96:log_dist] [Rank 0] step=746, skipped=0, lr=[1.9475338668992883e-05], mom=[(0.9, 0.999)]
steps: 746 loss: 0.5883 iter time (s): 102.918 samples/sec: 1.244

 60%|██████    | 6/10 [10:45<07:06, 106.66s/it][A
 60%|██████    | 6/10 [10:45<07:06, 106.67s/it][A
 60%|██████    | 6/10 [10:45<07:06, 106.66s/it][A
 60%|██████    | 6/10 [10:45<07:06, 106.67s/it][A
 60%|██████    | 6/10 [10:45<07:06, 106.68s/it][A
 60%|██████    | 6/10 [10:45<07:06, 106.69s/it][A
 60%|██████    | 6/10 [10:45<07:06, 106.69s/it][A
 70%|███████   | 7/10 [12:27<05:17, 105.71s/it][A[2024-05-30 06:34:21,294] [INFO] [logging.py:96:log_dist] [Rank 0] step=747, skipped=0, lr=[1.947352666931911e-05], mom=[(0.9, 0.999)]
steps: 747 loss: 0.5477 iter time (s): 103.142 samples/sec: 1.241

 70%|███████   | 7/10 [12:29<05:17, 105.76s/it][A
 70%|███████   | 7/10 [12:29<05:17, 105.78s/it][A
 70%|███████   | 7/10 [12:29<05:17, 105.77s/it][A
 70%|███████   | 7/10 [12:29<05:17, 105.75s/it][A
 70%|███████   | 7/10 [12:29<05:17, 105.76s/it][A
 70%|███████   | 7/10 [12:29<05:17, 105.75s/it][A
 70%|███████   | 7/10 [12:29<05:17, 105.75s/it][A
 80%|████████  | 8/10 [14:11<03:30, 105.11s/it][A[2024-05-30 06:36:05,175] [INFO] [logging.py:96:log_dist] [Rank 0] step=748, skipped=0, lr=[1.947171163062364e-05], mom=[(0.9, 0.999)]
steps: 748 loss: 0.5400 iter time (s): 103.205 samples/sec: 1.240

 80%|████████  | 8/10 [14:13<03:30, 105.21s/it][A
 80%|████████  | 8/10 [14:13<03:30, 105.25s/it][A
 80%|████████  | 8/10 [14:13<03:30, 105.22s/it][A
 80%|████████  | 8/10 [14:13<03:30, 105.22s/it][A
 80%|████████  | 8/10 [14:13<03:30, 105.24s/it][A
 80%|████████  | 8/10 [14:13<03:30, 105.24s/it][A
 80%|████████  | 8/10 [14:13<03:30, 105.30s/it][A
 90%|█████████ | 9/10 [15:55<01:44, 104.74s/it][A[2024-05-30 06:37:49,108] [INFO] [logging.py:96:log_dist] [Rank 0] step=749, skipped=0, lr=[1.9469893553488793e-05], mom=[(0.9, 0.999)]
steps: 749 loss: 0.5742 iter time (s): 102.793 samples/sec: 1.245

 90%|█████████ | 9/10 [15:57<01:44, 104.75s/it][A
 90%|█████████ | 9/10 [15:57<01:44, 104.78s/it][A
 90%|█████████ | 9/10 [15:57<01:44, 104.75s/it][A
 90%|█████████ | 9/10 [15:57<01:44, 104.77s/it][A
 90%|█████████ | 9/10 [15:57<01:44, 104.75s/it][A
 90%|█████████ | 9/10 [15:57<01:44, 104.76s/it][A
 90%|█████████ | 9/10 [15:57<01:44, 104.74s/it][A
100%|██████████| 10/10 [17:38<00:00, 104.33s/it][A100%|██████████| 10/10 [17:38<00:00, 105.90s/it]
 15%|█▍        | 76/520 [8:46:11<102:10:08, 828.40s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 06:39:32,501] [INFO] [logging.py:96:log_dist] [Rank 0] step=750, skipped=0, lr=[1.946807243849784e-05], mom=[(0.9, 0.999)]
steps: 750 loss: 0.5630 iter time (s): 102.675 samples/sec: 1.247

100%|██████████| 10/10 [17:40<00:00, 104.33s/it][A100%|██████████| 10/10 [17:40<00:00, 106.04s/it]
 15%|█▍        | 76/520 [8:43:59<102:12:30, 828.72s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:40<00:00, 104.33s/it][A100%|██████████| 10/10 [17:40<00:00, 106.05s/it]
 15%|█▍        | 76/520 [8:46:21<102:12:29, 828.72s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:40<00:00, 104.35s/it][A100%|██████████| 10/10 [17:40<00:00, 106.06s/it]
 15%|█▍        | 76/520 [8:46:20<102:12:37, 828.73s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:40<00:00, 104.33s/it][A100%|██████████| 10/10 [17:40<00:00, 106.05s/it]
 15%|█▍        | 76/520 [8:45:14<102:12:32, 828.72s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:40<00:00, 104.34s/it][A100%|██████████| 10/10 [17:40<00:00, 106.06s/it]
 15%|█▍        | 76/520 [8:45:56<102:12:38, 828.74s/it]
100%|██████████| 10/10 [17:40<00:00, 104.33s/it][A100%|██████████| 10/10 [17:40<00:00, 106.05s/it]
 15%|█▍        | 76/520 [8:44:43<102:12:35, 828.73s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [17:40<00:00, 104.32s/it][A100%|██████████| 10/10 [17:40<00:00, 106.06s/it]
 15%|█▍        | 76/520 [8:41:33<102:12:36, 828.73s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_180
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:35<23:20, 155.60s/it][A[2024-05-30 06:42:09,897] [INFO] [logging.py:96:log_dist] [Rank 0] step=751, skipped=0, lr=[1.946624828623506e-05], mom=[(0.9, 0.999)]
steps: 751 loss: 0.5772 iter time (s): 156.583 samples/sec: 0.817

 10%|█         | 1/10 [02:36<23:30, 156.74s/it][A
 10%|█         | 1/10 [02:37<23:36, 157.37s/it][A
 10%|█         | 1/10 [02:37<23:35, 157.32s/it][A
 10%|█         | 1/10 [02:37<23:36, 157.37s/it][A
 10%|█         | 1/10 [02:37<23:36, 157.35s/it][A
 10%|█         | 1/10 [02:37<23:35, 157.29s/it][A
 10%|█         | 1/10 [02:37<23:35, 157.30s/it][A
 20%|██        | 2/10 [05:13<20:54, 156.86s/it][A[2024-05-30 06:44:47,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=752, skipped=0, lr=[1.9464421097285668e-05], mom=[(0.9, 0.999)]
steps: 752 loss: 0.5511 iter time (s): 157.581 samples/sec: 0.812

 20%|██        | 2/10 [05:14<20:59, 157.50s/it][A
 20%|██        | 2/10 [05:15<21:00, 157.54s/it][A
 20%|██        | 2/10 [05:14<21:00, 157.51s/it][A
 20%|██        | 2/10 [05:15<21:00, 157.54s/it][A
 20%|██        | 2/10 [05:14<21:00, 157.51s/it][A
 20%|██        | 2/10 [05:14<21:00, 157.61s/it][A
 20%|██        | 2/10 [05:14<21:00, 157.53s/it][A
 30%|███       | 3/10 [07:49<18:16, 156.71s/it][A[2024-05-30 06:47:24,053] [INFO] [logging.py:96:log_dist] [Rank 0] step=753, skipped=0, lr=[1.946259087223588e-05], mom=[(0.9, 0.999)]
steps: 753 loss: 0.5699 iter time (s): 155.872 samples/sec: 0.821

 30%|███       | 3/10 [07:51<18:19, 157.08s/it][A
 30%|███       | 3/10 [07:51<18:19, 157.09s/it][A
 30%|███       | 3/10 [07:51<18:19, 157.07s/it][A
 30%|███       | 3/10 [07:51<18:19, 157.10s/it][A
 30%|███       | 3/10 [07:51<18:19, 157.08s/it][A
 30%|███       | 3/10 [07:51<18:19, 157.12s/it][A
 30%|███       | 3/10 [07:51<18:19, 157.08s/it][A
 40%|████      | 4/10 [10:27<15:41, 156.98s/it][A[2024-05-30 06:50:01,624] [INFO] [logging.py:96:log_dist] [Rank 0] step=754, skipped=0, lr=[1.9460757611672877e-05], mom=[(0.9, 0.999)]
steps: 754 loss: 0.5609 iter time (s): 156.910 samples/sec: 0.816

 40%|████      | 4/10 [10:28<15:42, 157.06s/it][A
 40%|████      | 4/10 [10:28<15:43, 157.23s/it][A
 40%|████      | 4/10 [10:29<15:43, 157.27s/it][A
 40%|████      | 4/10 [10:29<15:43, 157.23s/it][A
 40%|████      | 4/10 [10:29<15:43, 157.25s/it][A
 40%|████      | 4/10 [10:28<15:43, 157.23s/it][A
 40%|████      | 4/10 [10:29<15:43, 157.23s/it][A
 50%|█████     | 5/10 [13:04<13:04, 156.93s/it][A[2024-05-30 06:52:38,300] [INFO] [logging.py:96:log_dist] [Rank 0] step=755, skipped=0, lr=[1.945892131618481e-05], mom=[(0.9, 0.999)]
steps: 755 loss: 0.5508 iter time (s): 156.630 samples/sec: 0.817

 50%|█████     | 5/10 [13:05<13:05, 157.07s/it][A
 50%|█████     | 5/10 [13:05<13:05, 157.05s/it][A
 50%|█████     | 5/10 [13:05<13:05, 157.06s/it][A
 50%|█████     | 5/10 [13:05<13:05, 157.06s/it][A
 50%|█████     | 5/10 [13:05<13:05, 157.07s/it][A
 50%|█████     | 5/10 [13:05<13:05, 157.15s/it][A
 50%|█████     | 5/10 [13:05<13:05, 157.07s/it][A
 60%|██████    | 6/10 [15:41<10:27, 156.93s/it][A[2024-05-30 06:55:15,240] [INFO] [logging.py:96:log_dist] [Rank 0] step=756, skipped=0, lr=[1.9457081986360816e-05], mom=[(0.9, 0.999)]
steps: 756 loss: 0.5440 iter time (s): 156.279 samples/sec: 0.819

 60%|██████    | 6/10 [15:42<10:28, 157.02s/it][A
 60%|██████    | 6/10 [15:42<10:28, 157.02s/it][A
 60%|██████    | 6/10 [15:42<10:28, 157.02s/it][A
 60%|██████    | 6/10 [15:42<10:28, 157.02s/it][A
 60%|██████    | 6/10 [15:42<10:28, 157.01s/it][A
 60%|██████    | 6/10 [15:42<10:28, 157.02s/it][A
 60%|██████    | 6/10 [15:42<10:28, 157.07s/it][A
 70%|███████   | 7/10 [18:19<07:52, 157.50s/it][A[2024-05-30 06:57:53,918] [INFO] [logging.py:96:log_dist] [Rank 0] step=757, skipped=0, lr=[1.945523962279099e-05], mom=[(0.9, 0.999)]
steps: 757 loss: 0.5687 iter time (s): 158.018 samples/sec: 0.810

 70%|███████   | 7/10 [18:21<07:52, 157.56s/it][A
 70%|███████   | 7/10 [18:21<07:52, 157.58s/it][A
 70%|███████   | 7/10 [18:21<07:52, 157.54s/it][A
 70%|███████   | 7/10 [18:21<07:52, 157.56s/it][A
 70%|███████   | 7/10 [18:21<07:52, 157.55s/it][A
 70%|███████   | 7/10 [18:21<07:52, 157.55s/it][A
 70%|███████   | 7/10 [18:21<07:52, 157.59s/it][A
 80%|████████  | 8/10 [20:56<05:14, 157.15s/it][A[2024-05-30 07:00:30,295] [INFO] [logging.py:96:log_dist] [Rank 0] step=758, skipped=0, lr=[1.945339422606641e-05], mom=[(0.9, 0.999)]
steps: 758 loss: 0.5571 iter time (s): 155.786 samples/sec: 0.822

 80%|████████  | 8/10 [20:57<05:14, 157.21s/it][A
 80%|████████  | 8/10 [20:57<05:14, 157.19s/it][A
 80%|████████  | 8/10 [20:57<05:14, 157.21s/it][A
 80%|████████  | 8/10 [20:57<05:14, 157.21s/it][A
 80%|████████  | 8/10 [20:57<05:14, 157.21s/it][A
 80%|████████  | 8/10 [20:57<05:14, 157.21s/it][A
 80%|████████  | 8/10 [20:57<05:14, 157.20s/it][A
 90%|█████████ | 9/10 [23:34<02:37, 157.62s/it][A[2024-05-30 07:03:08,561] [INFO] [logging.py:96:log_dist] [Rank 0] step=759, skipped=0, lr=[1.9451545796779134e-05], mom=[(0.9, 0.999)]
steps: 759 loss: 0.5708 iter time (s): 157.622 samples/sec: 0.812

 90%|█████████ | 9/10 [23:36<02:37, 157.56s/it][A
 90%|█████████ | 9/10 [23:36<02:37, 157.54s/it][A
 90%|█████████ | 9/10 [23:36<02:37, 157.57s/it][A
 90%|█████████ | 9/10 [23:36<02:37, 157.57s/it][A
 90%|█████████ | 9/10 [23:36<02:37, 157.58s/it][A
 90%|█████████ | 9/10 [23:36<02:37, 157.59s/it][A
 90%|█████████ | 9/10 [23:36<02:37, 157.61s/it][A
100%|██████████| 10/10 [26:11<00:00, 157.31s/it][A100%|██████████| 10/10 [26:11<00:00, 157.14s/it]
 15%|█▍        | 77/520 [9:12:23<129:22:30, 1051.36s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 07:05:45,568] [INFO] [logging.py:96:log_dist] [Rank 0] step=760, skipped=0, lr=[1.9449694335522173e-05], mom=[(0.9, 0.999)]
steps: 760 loss: 0.5854 iter time (s): 156.132 samples/sec: 0.820

100%|██████████| 10/10 [26:13<00:00, 157.35s/it][A100%|██████████| 10/10 [26:13<00:00, 157.31s/it]
 15%|█▍        | 77/520 [9:10:12<129:27:21, 1052.01s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [26:13<00:00, 157.35s/it][A100%|██████████| 10/10 [26:13<00:00, 157.31s/it]
 15%|█▍        | 77/520 [9:12:34<129:27:23, 1052.02s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [26:13<00:00, 157.35s/it][A100%|██████████| 10/10 [26:13<00:00, 157.31s/it]
 15%|█▍        | 77/520 [9:12:33<129:27:29, 1052.03s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [26:13<00:00, 157.36s/it][A100%|██████████| 10/10 [26:13<00:00, 157.31s/it]
 15%|█▍        | 77/520 [9:11:27<129:27:24, 1052.02s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [26:13<00:00, 157.35s/it][A100%|██████████| 10/10 [26:13<00:00, 157.31s/it]
 15%|█▍        | 77/520 [9:12:09<129:27:27, 1052.03s/it]
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [26:13<00:00, 157.37s/it][A100%|██████████| 10/10 [26:13<00:00, 157.30s/it]
 15%|█▍        | 77/520 [9:07:46<129:27:24, 1052.02s/it]Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_448

100%|██████████| 10/10 [26:13<00:00, 157.36s/it][A100%|██████████| 10/10 [26:13<00:00, 157.31s/it]
 15%|█▍        | 77/520 [9:10:56<129:27:28, 1052.03s/it]Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [01:03<09:30, 63.42s/it][A[2024-05-30 07:06:46,578] [INFO] [logging.py:96:log_dist] [Rank 0] step=761, skipped=0, lr=[1.9447839842889523e-05], mom=[(0.9, 0.999)]
steps: 761 loss: 0.3069 iter time (s): 60.172 samples/sec: 2.127

 10%|█         | 1/10 [01:00<09:08, 60.97s/it][A
 10%|█         | 1/10 [01:00<09:08, 60.93s/it][A
 10%|█         | 1/10 [01:00<09:07, 60.88s/it][A
 10%|█         | 1/10 [01:00<09:08, 60.90s/it][A
 10%|█         | 1/10 [01:00<09:07, 60.84s/it][A
 10%|█         | 1/10 [01:00<09:07, 60.89s/it][A
 10%|█         | 1/10 [01:00<09:07, 60.89s/it][A
 20%|██        | 2/10 [02:03<08:13, 61.70s/it][A[2024-05-30 07:07:47,083] [INFO] [logging.py:96:log_dist] [Rank 0] step=762, skipped=0, lr=[1.9445982319476153e-05], mom=[(0.9, 0.999)]
steps: 762 loss: 0.2842 iter time (s): 59.928 samples/sec: 2.136

 20%|██        | 2/10 [02:01<08:05, 60.70s/it][A
 20%|██        | 2/10 [02:01<08:05, 60.70s/it][A
 20%|██        | 2/10 [02:01<08:05, 60.67s/it][A
 20%|██        | 2/10 [02:01<08:05, 60.69s/it][A
 20%|██        | 2/10 [02:01<08:05, 60.68s/it][A
 20%|██        | 2/10 [02:01<08:05, 60.69s/it][A
 20%|██        | 2/10 [02:01<08:05, 60.69s/it][A
 30%|███       | 3/10 [03:06<07:13, 61.95s/it][A[2024-05-30 07:08:49,331] [INFO] [logging.py:96:log_dist] [Rank 0] step=763, skipped=0, lr=[1.9444121765878002e-05], mom=[(0.9, 0.999)]
steps: 763 loss: 0.2883 iter time (s): 61.621 samples/sec: 2.077

 30%|███       | 3/10 [03:03<07:09, 61.41s/it][A
 30%|███       | 3/10 [03:03<07:09, 61.40s/it][A
 30%|███       | 3/10 [03:03<07:09, 61.35s/it][A
 30%|███       | 3/10 [03:03<07:09, 61.39s/it][A
 30%|███       | 3/10 [03:03<07:09, 61.38s/it][A
 30%|███       | 3/10 [03:03<07:09, 61.38s/it][A
 30%|███       | 3/10 [03:03<07:09, 61.38s/it][A
 40%|████      | 4/10 [04:07<06:09, 61.65s/it][A[2024-05-30 07:09:50,514] [INFO] [logging.py:96:log_dist] [Rank 0] step=764, skipped=0, lr=[1.944225818269199e-05], mom=[(0.9, 0.999)]
steps: 764 loss: 0.3090 iter time (s): 60.652 samples/sec: 2.110

 40%|████      | 4/10 [04:04<06:08, 61.35s/it][A
 40%|████      | 4/10 [04:04<06:08, 61.34s/it][A
 40%|████      | 4/10 [04:04<06:07, 61.33s/it][A
 40%|████      | 4/10 [04:04<06:08, 61.36s/it][A
 40%|████      | 4/10 [04:04<06:08, 61.35s/it][A
 40%|████      | 4/10 [04:04<06:08, 61.35s/it][A
 40%|████      | 4/10 [04:04<06:08, 61.35s/it][A
 50%|█████     | 5/10 [05:08<05:06, 61.30s/it][A[2024-05-30 07:10:51,207] [INFO] [logging.py:96:log_dist] [Rank 0] step=765, skipped=0, lr=[1.9440391570515985e-05], mom=[(0.9, 0.999)]
steps: 765 loss: 0.2811 iter time (s): 59.983 samples/sec: 2.134

 50%|█████     | 5/10 [05:05<05:05, 61.10s/it][A
 50%|█████     | 5/10 [05:05<05:05, 61.09s/it][A
 50%|█████     | 5/10 [05:05<05:05, 61.09s/it][A
 50%|█████     | 5/10 [05:05<05:05, 61.10s/it][A
 50%|█████     | 5/10 [05:05<05:05, 61.09s/it][A
 50%|█████     | 5/10 [05:05<05:05, 61.10s/it][A
 50%|█████     | 5/10 [05:05<05:05, 61.11s/it][A
 60%|██████    | 6/10 [06:09<04:04, 61.24s/it][A[2024-05-30 07:11:52,302] [INFO] [logging.py:96:log_dist] [Rank 0] step=766, skipped=0, lr=[1.9438521929948858e-05], mom=[(0.9, 0.999)]
steps: 766 loss: 0.2739 iter time (s): 60.411 samples/sec: 2.119

 60%|██████    | 6/10 [06:06<04:04, 61.08s/it][A
 60%|██████    | 6/10 [06:06<04:04, 61.10s/it][A
 60%|██████    | 6/10 [06:06<04:04, 61.10s/it][A
 60%|██████    | 6/10 [06:06<04:04, 61.10s/it][A
 60%|██████    | 6/10 [06:06<04:04, 61.10s/it][A
 60%|██████    | 6/10 [06:06<04:04, 61.09s/it][A
 60%|██████    | 6/10 [06:06<04:04, 61.09s/it][A
 70%|███████   | 7/10 [07:09<03:02, 60.96s/it][A[2024-05-30 07:12:52,718] [INFO] [logging.py:96:log_dist] [Rank 0] step=767, skipped=0, lr=[1.9436649261590425e-05], mom=[(0.9, 0.999)]
steps: 767 loss: 0.2715 iter time (s): 59.772 samples/sec: 2.141

 70%|███████   | 7/10 [07:07<03:02, 60.88s/it][A
 70%|███████   | 7/10 [07:07<03:02, 60.86s/it][A
 70%|███████   | 7/10 [07:07<03:02, 60.86s/it][A
 70%|███████   | 7/10 [07:07<03:02, 60.89s/it][A
 70%|███████   | 7/10 [07:07<03:02, 60.87s/it][A
 70%|███████   | 7/10 [07:07<03:02, 60.87s/it][A
 70%|███████   | 7/10 [07:07<03:02, 60.87s/it][A
 80%|████████  | 8/10 [08:10<02:01, 60.92s/it][A[2024-05-30 07:13:53,525] [INFO] [logging.py:96:log_dist] [Rank 0] step=768, skipped=0, lr=[1.9434773566041492e-05], mom=[(0.9, 0.999)]
steps: 768 loss: 0.2866 iter time (s): 60.152 samples/sec: 2.128

 80%|████████  | 8/10 [08:07<02:01, 60.86s/it][A
 80%|████████  | 8/10 [08:07<02:01, 60.85s/it][A
 80%|████████  | 8/10 [08:07<02:01, 60.84s/it][A
 80%|████████  | 8/10 [08:07<02:01, 60.85s/it][A
 80%|████████  | 8/10 [08:07<02:01, 60.85s/it][A
 80%|████████  | 8/10 [08:07<02:01, 60.85s/it][A
 80%|████████  | 8/10 [08:07<02:01, 60.85s/it][A
 90%|█████████ | 9/10 [09:11<01:00, 60.91s/it][A[2024-05-30 07:14:54,439] [INFO] [logging.py:96:log_dist] [Rank 0] step=769, skipped=0, lr=[1.9432894843903823e-05], mom=[(0.9, 0.999)]
steps: 769 loss: 0.2881 iter time (s): 60.263 samples/sec: 2.124

 90%|█████████ | 9/10 [09:08<01:00, 60.86s/it][A
 90%|█████████ | 9/10 [09:08<01:00, 60.87s/it][A
 90%|█████████ | 9/10 [09:08<01:00, 60.85s/it][A
 90%|█████████ | 9/10 [09:08<01:00, 60.86s/it][A
 90%|█████████ | 9/10 [09:08<01:00, 60.86s/it][A
 90%|█████████ | 9/10 [09:08<01:00, 60.86s/it][A
 90%|█████████ | 9/10 [09:08<01:00, 60.86s/it][A
100%|██████████| 10/10 [10:12<00:00, 61.06s/it][A100%|██████████| 10/10 [10:12<00:00, 61.27s/it]
 15%|█▌        | 78/520 [9:22:36<112:56:00, 919.82s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A[2024-05-30 07:15:55,828] [INFO] [logging.py:96:log_dist] [Rank 0] step=770, skipped=0, lr=[1.943101309578016e-05], mom=[(0.9, 0.999)]
steps: 770 loss: 0.2728 iter time (s): 60.755 samples/sec: 2.107

100%|██████████| 10/10 [10:10<00:00, 61.05s/it][A100%|██████████| 10/10 [10:10<00:00, 61.03s/it]
 15%|█▌        | 78/520 [9:22:44<112:53:39, 919.50s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:10<00:00, 61.09s/it][A100%|██████████| 10/10 [10:10<00:00, 61.04s/it]
 15%|█▌        | 78/520 [9:20:23<112:54:00, 919.55s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:10<00:00, 61.06s/it][A100%|██████████| 10/10 [10:10<00:00, 61.02s/it]
 15%|█▌        | 78/520 [9:22:43<112:53:40, 919.50s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:10<00:00, 61.06s/it][A100%|██████████| 10/10 [10:10<00:00, 61.03s/it]
 15%|█▌        | 78/520 [9:21:37<112:53:40, 919.50s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:10<00:00, 61.06s/it][A100%|██████████| 10/10 [10:10<00:00, 61.03s/it]
 15%|█▌        | 78/520 [9:21:06<112:53:43, 919.51s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:10<00:00, 61.09s/it][A100%|██████████| 10/10 [10:10<00:00, 61.04s/it]
 15%|█▌        | 78/520 [9:22:19<112:53:55, 919.54s/it] 
  0%|          | 0/10 [00:00<?, ?it/s][A
100%|██████████| 10/10 [10:10<00:00, 61.08s/it][A100%|██████████| 10/10 [10:10<00:00, 61.04s/it]
 15%|█▌        | 78/520 [9:17:56<112:53:51, 919.53s/it] Loading dataset from /home/atuin/b207dd/b207dd11/LLaVA-PEFT_processed_dataset_with_images/shard_369
Training on 1280 of 1280 sentences.

  0%|          | 0/10 [00:00<?, ?it/s][A
 10%|█         | 1/10 [02:34<23:09, 154.42s/it][A[2024-05-30 07:18:33,187] [INFO] [logging.py:96:log_dist] [Rank 0] step=771, skipped=0, lr=[1.9429128322274217e-05], mom=[(0.9, 0.999)]
steps: 771 loss: 0.8006 iter time (s): 156.429 samples/sec: 0.818

 10%|█         | 1/10 [02:36<23:29, 156.58s/it][A
 10%|█         | 1/10 [02:37<23:34, 157.18s/it][A
 10%|█         | 1/10 [02:37<23:35, 157.31s/it][A
 10%|█         | 1/10 [02:37<23:35, 157.31s/it][A
 10%|█         | 1/10 [02:37<23:35, 157.32s/it][A
 10%|█         | 1/10 [02:37<23:34, 157.15s/it][A
 10%|█         | 1/10 [02:37<23:35, 157.23s/it][A
 20%|██        | 2/10 [05:11<20:46, 155.81s/it][A[2024-05-30 07:21:09,816] [INFO] [logging.py:96:log_dist] [Rank 0] step=772, skipped=0, lr=[1.9427240523990677e-05], mom=[(0.9, 0.999)]
steps: 772 loss: 0.7838 iter time (s): 156.597 samples/sec: 0.817

 20%|██        | 2/10 [05:13<20:55, 156.90s/it][A
 20%|██        | 2/10 [05:13<20:55, 156.93s/it][A
 20%|██        | 2/10 [05:13<20:55, 156.94s/it][A
 20%|██        | 2/10 [05:14<20:55, 156.95s/it][A
 20%|██        | 2/10 [05:13<20:56, 157.04s/it][A
 20%|██        | 2/10 [05:13<20:55, 156.95s/it][A
 20%|██        | 2/10 [05:14<20:55, 156.98s/it][A 20%|██        | 2/10 [07:15<29:02, 217.81s/it]
 15%|█▌        | 78/520 [9:25:12<53:22:48, 434.77s/it] 
Traceback (most recent call last):
  File "llava/train_parallel_deepspeed_mixtral_lora.py", line 401, in <module>
    main()
  File "llava/train_parallel_deepspeed_mixtral_lora.py", line 379, in main
    loss = engine.train_batch(data_iter=training_dataloader)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/pipe/engine.py", line 373, in train_batch
    self._exec_schedule(sched)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/pipe/engine.py", line 1373, in _exec_schedule
    self._exec_instr(**cmd.kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/pipe/engine.py", line 679, in _exec_forward_pass
    outputs = super().forward(inputs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    ret_val = func(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/engine.py", line 1852, in forward
    loss = self.module(*inputs, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/pipe/module.py", line 351, in forward
    x = func(forward_input)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/deepspeed/runtime/pipe/module.py", line 344, in exec_func
    inputs = layer(inputs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/llava/deepspeed_pipeline_model.py", line 135, in forward
    layer_outputs = layer(
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/llava/mixtral_modification/modeling_mixtral.py", line 1110, in forward
    hidden_states, router_logits, shared_sparse_adapter_router_logits = self.block_sparse_moe(hidden_states)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/llava/mixtral_modification/modeling_mixtral.py", line 992, in forward
    current_hidden_states = expert_layer(current_state) * routing_weights[top_x_list, idx_list, None]
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/llava/mixtral_modification/modeling_mixtral.py", line 882, in forward
    current_hidden_states = self.act_fn(self.w1(hidden_states)) * self.w3(hidden_states)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 118.00 MiB. GPU 0 has a total capacity of 79.14 GiB of which 112.75 MiB is free. Including non-PyTorch memory, this process has 79.02 GiB memory in use. Of the allocated memory 68.01 GiB is allocated by PyTorch, and 6.39 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[2024-05-30 07:23:38,537] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1794366
[2024-05-30 07:23:38,561] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1794367
[2024-05-30 07:23:39,911] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1794368
[2024-05-30 07:23:41,686] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1794369
[2024-05-30 07:23:43,625] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1794370
[2024-05-30 07:23:45,205] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1794371
[2024-05-30 07:23:46,703] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1794372
[2024-05-30 07:23:48,561] [INFO] [launch.py:316:sigkill_handler] Killing subprocess 1794373
[2024-05-30 07:23:51,921] [ERROR] [launch.py:322:sigkill_handler] ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=7', '--num_stages=8', '--lora_r=256', '--lora_alpha=512', '--save_model_shard=10', '--skip_shard=40', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_256_512_checkpoint'] exits with return code = 1
