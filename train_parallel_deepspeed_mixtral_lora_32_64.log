[2024-08-16 00:55:49,092] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-08-16 00:55:57,620] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-08-16 00:55:57,621] [INFO] [runner.py:568:main] cmd = /home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgMywgNCwgNSwgNiwgN119 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None llava/train_parallel_deepspeed_mixtral_lora.py --num_stages=8 --lora_r=32 --lora_alpha=64 --save_model_shard=50 --skip_shard=0 --checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_32_64_checkpoint
[2024-08-16 00:56:00,397] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-08-16 00:56:01,716] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]}
[2024-08-16 00:56:01,716] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=8, node_rank=0
[2024-08-16 00:56:01,716] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]})
[2024-08-16 00:56:01,716] [INFO] [launch.py:163:main] dist_world_size=8
[2024-08-16 00:56:01,716] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
[2024-08-16 00:56:01,727] [INFO] [launch.py:253:main] process 48826 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=0', '--num_stages=8', '--lora_r=32', '--lora_alpha=64', '--save_model_shard=50', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_32_64_checkpoint']
[2024-08-16 00:56:01,738] [INFO] [launch.py:253:main] process 48827 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=1', '--num_stages=8', '--lora_r=32', '--lora_alpha=64', '--save_model_shard=50', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_32_64_checkpoint']
[2024-08-16 00:56:01,748] [INFO] [launch.py:253:main] process 48828 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=2', '--num_stages=8', '--lora_r=32', '--lora_alpha=64', '--save_model_shard=50', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_32_64_checkpoint']
[2024-08-16 00:56:01,757] [INFO] [launch.py:253:main] process 48829 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=3', '--num_stages=8', '--lora_r=32', '--lora_alpha=64', '--save_model_shard=50', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_32_64_checkpoint']
[2024-08-16 00:56:01,766] [INFO] [launch.py:253:main] process 48830 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=4', '--num_stages=8', '--lora_r=32', '--lora_alpha=64', '--save_model_shard=50', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_32_64_checkpoint']
[2024-08-16 00:56:01,776] [INFO] [launch.py:253:main] process 48831 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=5', '--num_stages=8', '--lora_r=32', '--lora_alpha=64', '--save_model_shard=50', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_32_64_checkpoint']
[2024-08-16 00:56:01,783] [INFO] [launch.py:253:main] process 48832 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=6', '--num_stages=8', '--lora_r=32', '--lora_alpha=64', '--save_model_shard=50', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_32_64_checkpoint']
[2024-08-16 00:56:01,793] [INFO] [launch.py:253:main] process 48833 spawned with command: ['/home/hpc/b207dd/b207dd11/miniconda3/envs/py38/bin/python', '-u', 'llava/train_parallel_deepspeed_mixtral_lora.py', '--local_rank=7', '--num_stages=8', '--lora_r=32', '--lora_alpha=64', '--save_model_shard=50', '--skip_shard=0', '--checkpoint_dir=/home/atuin/b207dd/b207dd11/LLaVA-PEFT_lora_32_64_checkpoint']
[2024-08-16 00:56:15,963] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-08-16 00:56:16,040] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-08-16 00:56:16,047] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-08-16 00:56:16,058] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-08-16 00:56:16,616] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-08-16 00:56:17,340] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-08-16 00:56:17,340] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-08-16 00:56:17,340] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-08-16 00:56:17,340] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-08-16 00:56:17,340] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-08-16 00:56:21,904] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-08-16 00:56:21,952] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-08-16 00:56:22,183] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-08-16 00:56:22,459] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-08-16 00:56:22,459] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-08-16 00:56:22,522] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-08-16 00:56:22,761] [INFO] [comm.py:637:init_distributed] cdb=None
Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/20 [00:00<?, ?it/s]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:26,  1.38s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:32,  1.69s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:28,  1.50s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:29,  1.53s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:36,  1.90s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:01<00:33,  1.76s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:02<00:41,  2.19s/it]Loading checkpoint shards:   5%|▌         | 1/20 [00:02<00:43,  2.32s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:35,  1.95s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:30,  1.67s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:32,  1.81s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:31,  1.74s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:29,  1.65s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:33,  1.87s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:03<00:34,  1.94s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:29,  1.74s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:31,  1.87s/it]Loading checkpoint shards:  10%|█         | 2/20 [00:05<00:45,  2.55s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:04<00:27,  1.64s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:30,  1.81s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:30,  1.82s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:05<00:33,  1.94s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:06<00:37,  2.18s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:29,  1.84s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:28,  1.76s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:31,  1.98s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:06<00:28,  1.75s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:31,  1.98s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:07<00:32,  2.01s/it]Loading checkpoint shards:  15%|█▌        | 3/20 [00:07<00:44,  2.63s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:08<00:36,  2.27s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:28,  1.91s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:08<00:26,  1.76s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:27,  1.81s/it]Loading checkpoint shards:  20%|██        | 4/20 [00:09<00:34,  2.16s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:29,  1.98s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:09<00:28,  1.90s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:10<00:32,  2.20s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:10<00:25,  1.80s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:10<00:25,  1.81s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:27,  1.94s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:11<00:34,  2.27s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:11<00:28,  2.01s/it]Loading checkpoint shards:  25%|██▌       | 5/20 [00:11<00:31,  2.13s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:31,  2.25s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:33,  2.37s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:26,  1.91s/it]Loading checkpoint shards:  30%|███       | 6/20 [00:12<00:29,  2.10s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:12<00:24,  1.89s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:13<00:26,  2.07s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:14<00:28,  2.17s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:14<00:29,  2.28s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:14<00:26,  2.03s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:14<00:23,  1.83s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:14<00:29,  2.24s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:14<00:21,  1.83s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:15<00:23,  1.98s/it]Loading checkpoint shards:  35%|███▌      | 7/20 [00:15<00:27,  2.09s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:15<00:23,  2.00s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:15<00:25,  2.10s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:16<00:25,  2.12s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:16<00:24,  2.03s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:16<00:27,  2.27s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:17<00:20,  1.90s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:16<00:22,  2.01s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:17<00:22,  2.04s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:17<00:22,  2.05s/it]Loading checkpoint shards:  40%|████      | 8/20 [00:18<00:28,  2.41s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:18<00:21,  1.96s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:19<00:19,  1.94s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:18<00:20,  2.02s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:19<00:24,  2.26s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:19<00:25,  2.36s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:20<00:20,  2.05s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:20<00:21,  2.11s/it]Loading checkpoint shards:  45%|████▌     | 9/20 [00:20<00:26,  2.42s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:20<00:21,  2.12s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:20<00:18,  2.03s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:21<00:22,  2.28s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:22<00:18,  2.04s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:21<00:19,  2.15s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:22<00:19,  2.15s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:22<00:25,  2.50s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:22<00:16,  2.04s/it]Loading checkpoint shards:  50%|█████     | 10/20 [00:23<00:24,  2.44s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:23<00:16,  2.01s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:23<00:20,  2.26s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:24<00:16,  2.05s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:23<00:20,  2.29s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:25<00:18,  2.37s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:25<00:20,  2.27s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:25<00:13,  1.97s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:24<00:14,  2.04s/it]Loading checkpoint shards:  55%|█████▌    | 11/20 [00:25<00:24,  2.68s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:25<00:16,  2.09s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:25<00:13,  1.96s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:25<00:18,  2.33s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:27<00:11,  1.99s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:26<00:12,  2.03s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:27<00:16,  2.34s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:27<00:11,  1.98s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:27<00:18,  2.37s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:27<00:15,  2.25s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:28<00:16,  2.32s/it]Loading checkpoint shards:  60%|██████    | 12/20 [00:28<00:22,  2.84s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:28<00:09,  1.91s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:28<00:10,  2.01s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:29<00:13,  2.28s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:30<00:11,  2.29s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:30<00:13,  2.32s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:30<00:13,  2.31s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:30<00:07,  1.90s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:31<00:18,  2.65s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:31<00:10,  2.15s/it]Loading checkpoint shards:  65%|██████▌   | 13/20 [00:31<00:20,  2.88s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:31<00:09,  2.28s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:32<00:08,  2.19s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:32<00:11,  2.25s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:33<00:12,  2.46s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:33<00:06,  2.05s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:34<00:09,  2.34s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:34<00:16,  2.78s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:34<00:06,  2.10s/it]Loading checkpoint shards:  70%|███████   | 14/20 [00:34<00:17,  2.88s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:34<00:07,  2.49s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:35<00:09,  2.32s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:35<00:04,  2.14s/it]Loading checkpoint shards:  85%|████████▌ | 17/20 [00:36<00:06,  2.28s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:36<00:04,  2.10s/it]Loading checkpoint shards:  80%|████████  | 16/20 [00:36<00:11,  2.76s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:36<00:13,  2.75s/it]Loading checkpoint shards:  75%|███████▌  | 15/20 [00:37<00:14,  2.88s/it]Loading checkpoint shards:  95%|█████████▌| 19/20 [00:37<00:02,  2.10s/it]Loading checkpoint shards:  90%|█████████ | 18/20 [00:37<00:05,  2.58s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:38<00:00,  1.63s/it]Loading checkpoint shards: 100%|██████████| 20/20 [00:38<00:00,  1.91s/it]
Loading checkpoint shards:  85%|████████▌ | 17/20 [00:38<00:07,  2.59s/it]